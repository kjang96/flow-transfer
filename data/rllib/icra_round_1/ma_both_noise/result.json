{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 473.07894736842104, "episodes_this_iter": 38, "policy_reward_mean": {"av": -2229.0481398662687, "action_adversary": 2229.0481398662687}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.557899407894631, "mean_processing_ms": 2.3542330622883436, "mean_inference_ms": 1.0669654325145892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19968, "num_steps_sampled": 20000, "sample_time_ms": 17253.743, "load_time_ms": 198.815, "grad_time_ms": 6076.887, "update_time_ms": 2413.091, "learner": {"action_adversary": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 35519.62109375, "policy_loss": -0.01049801055341959, "vf_loss": 35519.62890625, "vf_explained_var": 6.927358481334522e-05, "kl": 0.005717714317142963, "entropy": 31.21061134338379, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 35460.3984375, "policy_loss": -0.0055097974836826324, "vf_loss": 35460.3984375, "vf_explained_var": 8.162703306879848e-05, "kl": 0.00699661998078227, "entropy": 2.8428971767425537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 20000, "episodes_total": 38, "training_iteration": 1, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-25-50", "timestamp": 1567646750, "time_this_iter_s": 26.09876275062561, "time_total_s": 26.09876275062561, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b758c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26.09876275062561, "timesteps_since_restore": 20000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.66052631578948, "ram_util_percent": 13.771052631578948}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 462.3048780487805, "episodes_this_iter": 44, "policy_reward_mean": {"av": -1838.7790103215873, "action_adversary": 1838.7790103215873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.3088198163453, "mean_processing_ms": 2.4341005294100677, "mean_inference_ms": 1.0335168154512266}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39936, "num_steps_sampled": 40000, "sample_time_ms": 16399.841, "load_time_ms": 116.632, "grad_time_ms": 5533.667, "update_time_ms": 1210.061, "learner": {"action_adversary": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 19946.4453125, "policy_loss": -0.012272801250219345, "vf_loss": 19946.455078125, "vf_explained_var": 2.8118491172790527e-05, "kl": 0.007433932740241289, "entropy": 31.161029815673828, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 19957.396484375, "policy_loss": -0.004930712282657623, "vf_loss": 19957.400390625, "vf_explained_var": 3.288724474259652e-05, "kl": 0.008546965196728706, "entropy": 2.828803062438965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 40000, "episodes_total": 82, "training_iteration": 2, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-26-10", "timestamp": 1567646770, "time_this_iter_s": 20.594731092453003, "time_total_s": 46.69349384307861, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7a4510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46.69349384307861, "timesteps_since_restore": 40000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.29655172413793, "ram_util_percent": 14.048275862068962}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 470.21, "episodes_this_iter": 41, "policy_reward_mean": {"av": -1393.3970832576929, "action_adversary": 1393.3970832576929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.082823807115675, "mean_processing_ms": 2.470366581285758, "mean_inference_ms": 1.0075007020096534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59904, "num_steps_sampled": 60000, "sample_time_ms": 15439.374, "load_time_ms": 86.313, "grad_time_ms": 5346.44, "update_time_ms": 809.275, "learner": {"action_adversary": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3636.806396484375, "policy_loss": -0.014097421430051327, "vf_loss": 3636.820068359375, "vf_explained_var": 2.605028566904366e-05, "kl": 0.008254160173237324, "entropy": 31.150394439697266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3639.365478515625, "policy_loss": -0.005196238402277231, "vf_loss": 3639.369873046875, "vf_explained_var": 3.177653343300335e-05, "kl": 0.009976767934858799, "entropy": 2.8210017681121826, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 60000, "episodes_total": 123, "training_iteration": 3, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-26-29", "timestamp": 1567646789, "time_this_iter_s": 18.539957284927368, "time_total_s": 65.23345112800598, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7769d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 65.23345112800598, "timesteps_since_restore": 60000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.22222222222222, "ram_util_percent": 14.070370370370373}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 487.99, "episodes_this_iter": 41, "policy_reward_mean": {"av": -720.8043464595206, "action_adversary": 720.8043464595206}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.7656879085457486, "mean_processing_ms": 2.48008599606758, "mean_inference_ms": 0.9845821852957272}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79872, "num_steps_sampled": 80000, "sample_time_ms": 14839.204, "load_time_ms": 72.754, "grad_time_ms": 5255.965, "update_time_ms": 608.798, "learner": {"action_adversary": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1311.726318359375, "policy_loss": -0.01245849672704935, "vf_loss": 1311.7386474609375, "vf_explained_var": 3.236723205191083e-05, "kl": 0.006233093794435263, "entropy": 31.161136627197266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 1311.9620361328125, "policy_loss": -0.0026347178500145674, "vf_loss": 1311.964599609375, "vf_explained_var": 3.697780630318448e-05, "kl": 0.006392803508788347, "entropy": 2.8078315258026123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 80000, "episodes_total": 164, "training_iteration": 4, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-26-47", "timestamp": 1567646807, "time_this_iter_s": 18.078247547149658, "time_total_s": 83.31169867515564, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b782b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 83.31169867515564, "timesteps_since_restore": 80000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.334615384615386, "ram_util_percent": 14.13076923076923}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 491.68, "episodes_this_iter": 41, "policy_reward_mean": {"av": -315.37068771896185, "action_adversary": 315.37068771896185}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5063857019150464, "mean_processing_ms": 2.493696479878906, "mean_inference_ms": 0.9713627162006861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99840, "num_steps_sampled": 100000, "sample_time_ms": 14488.412, "load_time_ms": 65.1, "grad_time_ms": 5201.999, "update_time_ms": 488.466, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 455.6301574707031, "policy_loss": -0.014357970096170902, "vf_loss": 455.6444396972656, "vf_explained_var": 1.8869837731472217e-05, "kl": 0.008497006259858608, "entropy": 31.1389102935791, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 455.7443542480469, "policy_loss": -0.00770080229267478, "vf_loss": 455.75189208984375, "vf_explained_var": 2.0911296815029345e-05, "kl": 0.010455328971147537, "entropy": 2.783700704574585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 100000, "episodes_total": 205, "training_iteration": 5, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-27-05", "timestamp": 1567646825, "time_this_iter_s": 18.129321336746216, "time_total_s": 101.44102001190186, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b782d90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 101.44102001190186, "timesteps_since_restore": 100000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.596, "ram_util_percent": 14.128}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 490.74, "episodes_this_iter": 41, "policy_reward_mean": {"av": -114.28572083236166, "action_adversary": 114.28572083236166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3106394813786495, "mean_processing_ms": 2.4937496548604243, "mean_inference_ms": 0.9627005771953202}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119808, "num_steps_sampled": 120000, "sample_time_ms": 14237.382, "load_time_ms": 59.542, "grad_time_ms": 5164.91, "update_time_ms": 408.382, "learner": {"action_adversary": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 632.1165161132812, "policy_loss": -0.015900744125247, "vf_loss": 632.1323852539062, "vf_explained_var": 3.439913780312054e-05, "kl": 0.00850753951817751, "entropy": 31.128223419189453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 632.0400390625, "policy_loss": -0.005962285678833723, "vf_loss": 632.0458984375, "vf_explained_var": 2.4072634914773516e-05, "kl": 0.010423867963254452, "entropy": 2.757882833480835, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 120000, "episodes_total": 246, "training_iteration": 6, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-27-23", "timestamp": 1567646843, "time_this_iter_s": 18.01691961288452, "time_total_s": 119.45793962478638, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b855f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 119.45793962478638, "timesteps_since_restore": 120000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.9, "ram_util_percent": 14.126923076923076}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 492.13, "episodes_this_iter": 41, "policy_reward_mean": {"av": -53.035810243255234, "action_adversary": 53.035810243255234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2134303345736015, "mean_processing_ms": 2.493601386123176, "mean_inference_ms": 0.9590198256439432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139776, "num_steps_sampled": 140000, "sample_time_ms": 14033.811, "load_time_ms": 56.14, "grad_time_ms": 5140.276, "update_time_ms": 351.171, "learner": {"action_adversary": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 404.660400390625, "policy_loss": -0.01210789754986763, "vf_loss": 404.6725158691406, "vf_explained_var": -1.1781086868722923e-05, "kl": 0.008668677881360054, "entropy": 31.11107063293457, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 404.7791442871094, "policy_loss": -0.0077027250081300735, "vf_loss": 404.78668212890625, "vf_explained_var": -1.2724445696221665e-05, "kl": 0.01293336134403944, "entropy": 2.7325432300567627, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 140000, "episodes_total": 287, "training_iteration": 7, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-27-41", "timestamp": 1567646861, "time_this_iter_s": 17.864012718200684, "time_total_s": 137.32195234298706, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b861840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 137.32195234298706, "timesteps_since_restore": 140000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.753846153846155, "ram_util_percent": 14.069230769230769}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 493.1, "episodes_this_iter": 41, "policy_reward_mean": {"av": 5.440053462678334, "action_adversary": -5.440053462678334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1365482777520937, "mean_processing_ms": 2.486575932047133, "mean_inference_ms": 0.9588285872214205}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159744, "num_steps_sampled": 160000, "sample_time_ms": 13909.382, "load_time_ms": 53.424, "grad_time_ms": 5121.605, "update_time_ms": 308.304, "learner": {"action_adversary": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 197.51231384277344, "policy_loss": -0.013906223699450493, "vf_loss": 197.52621459960938, "vf_explained_var": 0.104863241314888, "kl": 0.009757480584084988, "entropy": 31.122177124023438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 197.79879760742188, "policy_loss": -0.007347994949668646, "vf_loss": 197.80604553222656, "vf_explained_var": 0.10281191021203995, "kl": 0.007157088723033667, "entropy": 2.710292100906372, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 160000, "episodes_total": 328, "training_iteration": 8, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-27-59", "timestamp": 1567646879, "time_this_iter_s": 18.088054180145264, "time_total_s": 155.41000652313232, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b86c9d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 155.41000652313232, "timesteps_since_restore": 160000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.464000000000002, "ram_util_percent": 14.072000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 493.1, "episodes_this_iter": 39, "policy_reward_mean": {"av": 74.7714468388528, "action_adversary": -74.7714468388528}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.079436605079668, "mean_processing_ms": 2.485661977911995, "mean_inference_ms": 0.9603200066612532}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 180000, "sample_time_ms": 13806.997, "load_time_ms": 51.323, "grad_time_ms": 5106.09, "update_time_ms": 274.935, "learner": {"action_adversary": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 220.870849609375, "policy_loss": -0.012926653027534485, "vf_loss": 220.88375854492188, "vf_explained_var": 0.13829253613948822, "kl": 0.009460840374231339, "entropy": 31.07828140258789, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 220.32992553710938, "policy_loss": -0.009297911077737808, "vf_loss": 220.33914184570312, "vf_explained_var": 0.14007878303527832, "kl": 0.01124094519764185, "entropy": 2.6889777183532715, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 180000, "episodes_total": 367, "training_iteration": 9, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-28-17", "timestamp": 1567646897, "time_this_iter_s": 18.027899265289307, "time_total_s": 173.43790578842163, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b87e2f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 173.43790578842163, "timesteps_since_restore": 180000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.38461538461538, "ram_util_percent": 14.084615384615384}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 496.9, "episodes_this_iter": 41, "policy_reward_mean": {"av": 139.6619410249748, "action_adversary": -139.6619410249748}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.034277176379169, "mean_processing_ms": 2.4850770159766284, "mean_inference_ms": 0.9607658858978562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199680, "num_steps_sampled": 200000, "sample_time_ms": 13708.205, "load_time_ms": 49.622, "grad_time_ms": 5093.751, "update_time_ms": 248.378, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 188.9215545654297, "policy_loss": -0.013464081101119518, "vf_loss": 188.93502807617188, "vf_explained_var": 0.10026749223470688, "kl": 0.010558051988482475, "entropy": 31.022308349609375, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 187.00877380371094, "policy_loss": -0.007780586834996939, "vf_loss": 187.01649475097656, "vf_explained_var": 0.11009081453084946, "kl": 0.010912365280091763, "entropy": 2.654697895050049, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 200000, "episodes_total": 408, "training_iteration": 10, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-28-35", "timestamp": 1567646915, "time_this_iter_s": 17.861652374267578, "time_total_s": 191.2995581626892, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 191.2995581626892, "timesteps_since_restore": 200000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.47307692307692, "ram_util_percent": 14.146153846153844}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 189.75190740693984, "action_adversary": -189.75190740693984}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9914509806351965, "mean_processing_ms": 2.481238680640182, "mean_inference_ms": 0.9607105522829422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 219648, "num_steps_sampled": 220000, "sample_time_ms": 13270.762, "load_time_ms": 32.908, "grad_time_ms": 4983.038, "update_time_ms": 7.902, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 197.97918701171875, "policy_loss": -0.012113525532186031, "vf_loss": 197.99130249023438, "vf_explained_var": 0.034844934940338135, "kl": 0.010313336737453938, "entropy": 31.034605026245117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 197.327392578125, "policy_loss": -0.008368239738047123, "vf_loss": 197.33566284179688, "vf_explained_var": 0.03371255099773407, "kl": 0.013844332657754421, "entropy": 2.6345605850219727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 220000, "episodes_total": 448, "training_iteration": 11, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-28-53", "timestamp": 1567646933, "time_this_iter_s": 17.90590810775757, "time_total_s": 209.20546627044678, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6cad08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 209.20546627044678, "timesteps_since_restore": 220000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.44, "ram_util_percent": 14.128}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 226.43997684529037, "action_adversary": -226.43997684529037}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.988866726063719, "mean_processing_ms": 2.4811133909894925, "mean_inference_ms": 0.9605228575023638}, "off_policy_estimator": {}, "info": {"num_steps_trained": 239616, "num_steps_sampled": 240000, "sample_time_ms": 13021.633, "load_time_ms": 32.925, "grad_time_ms": 4981.103, "update_time_ms": 7.974, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 219.0029296875, "policy_loss": -0.012768398970365524, "vf_loss": 219.0156707763672, "vf_explained_var": 0.019586727023124695, "kl": 0.01170728262513876, "entropy": 31.030548095703125, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 218.93539428710938, "policy_loss": -0.00823966134339571, "vf_loss": 218.94351196289062, "vf_explained_var": 0.021048570051789284, "kl": 0.018717395141720772, "entropy": 2.611799478530884, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 240000, "episodes_total": 489, "training_iteration": 12, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-29-11", "timestamp": 1567646951, "time_this_iter_s": 18.084367752075195, "time_total_s": 227.28983402252197, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6d8ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 227.28983402252197, "timesteps_since_restore": 240000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.853846153846156, "ram_util_percent": 14.080769230769231}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 255.72457099227074, "action_adversary": -255.72457099227074}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.971723254613782, "mean_processing_ms": 2.479144499968521, "mean_inference_ms": 0.9610007411212549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259584, "num_steps_sampled": 260000, "sample_time_ms": 12985.542, "load_time_ms": 33.837, "grad_time_ms": 4980.986, "update_time_ms": 7.97, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 239.21278381347656, "policy_loss": -0.012763485312461853, "vf_loss": 239.22555541992188, "vf_explained_var": 0.02392948977649212, "kl": 0.01220363937318325, "entropy": 31.00482940673828, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 239.0516357421875, "policy_loss": -0.009219806641340256, "vf_loss": 239.0606689453125, "vf_explained_var": 0.02407492697238922, "kl": 0.02787618711590767, "entropy": 2.624997615814209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 260000, "episodes_total": 529, "training_iteration": 13, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-29-29", "timestamp": 1567646969, "time_this_iter_s": 18.187844038009644, "time_total_s": 245.47767806053162, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6e97b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 245.47767806053162, "timesteps_since_restore": 260000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.673076923076927, "ram_util_percent": 14.088461538461537}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 269.05323781094864, "action_adversary": -269.05323781094864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9559988016763783, "mean_processing_ms": 2.4768674020297556, "mean_inference_ms": 0.9615917535993528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279552, "num_steps_sampled": 280000, "sample_time_ms": 12998.961, "load_time_ms": 34.059, "grad_time_ms": 4979.764, "update_time_ms": 8.039, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 236.3678436279297, "policy_loss": -0.013528795912861824, "vf_loss": 236.38136291503906, "vf_explained_var": 0.0036225789226591587, "kl": 0.01406368799507618, "entropy": 31.002973556518555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 236.34616088867188, "policy_loss": -0.007328758016228676, "vf_loss": 236.35336303710938, "vf_explained_var": 0.0035040932707488537, "kl": 0.015356132760643959, "entropy": 2.5834033489227295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 280000, "episodes_total": 568, "training_iteration": 14, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-29-47", "timestamp": 1567646987, "time_this_iter_s": 18.203667163848877, "time_total_s": 263.6813452243805, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6f1950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 263.6813452243805, "timesteps_since_restore": 280000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 31.40384615384615, "ram_util_percent": 14.099999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 281.69964069940755, "action_adversary": -281.69964069940755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.939423455017587, "mean_processing_ms": 2.474935550726225, "mean_inference_ms": 0.96233652446741}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299520, "num_steps_sampled": 300000, "sample_time_ms": 12999.435, "load_time_ms": 34.037, "grad_time_ms": 4980.007, "update_time_ms": 8.075, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 246.19679260253906, "policy_loss": -0.013380493968725204, "vf_loss": 246.2101287841797, "vf_explained_var": 0.002799440175294876, "kl": 0.014315198175609112, "entropy": 31.018081665039062, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 246.0546417236328, "policy_loss": -0.004583956673741341, "vf_loss": 246.05918884277344, "vf_explained_var": 0.0030906822066754103, "kl": 0.007518554572016001, "entropy": 2.56010365486145, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 300000, "episodes_total": 609, "training_iteration": 15, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-30-05", "timestamp": 1567647005, "time_this_iter_s": 18.136192798614502, "time_total_s": 281.817538022995, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b704268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 281.817538022995, "timesteps_since_restore": 300000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.796153846153842, "ram_util_percent": 14.096153846153847}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 289.93306202415334, "action_adversary": -289.93306202415334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.917542524955917, "mean_processing_ms": 2.472629093075922, "mean_inference_ms": 0.9629514616460377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 319488, "num_steps_sampled": 320000, "sample_time_ms": 13006.918, "load_time_ms": 34.1, "grad_time_ms": 4979.756, "update_time_ms": 8.057, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 254.24609375, "policy_loss": -0.014175193384289742, "vf_loss": 254.26026916503906, "vf_explained_var": 0.0034426026977598667, "kl": 0.014585326425731182, "entropy": 31.005815505981445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 254.21495056152344, "policy_loss": -0.006193478126078844, "vf_loss": 254.22109985351562, "vf_explained_var": 0.002597818849608302, "kl": 0.011193342506885529, "entropy": 2.53818678855896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 320000, "episodes_total": 648, "training_iteration": 16, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-30-24", "timestamp": 1567647024, "time_this_iter_s": 18.090099811553955, "time_total_s": 299.90763783454895, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518438400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 299.90763783454895, "timesteps_since_restore": 320000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.376923076923074, "ram_util_percent": 14.146153846153844}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 295.58944147566234, "action_adversary": -295.58944147566234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9126643051456256, "mean_processing_ms": 2.470870629910717, "mean_inference_ms": 0.9633176306157053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 339456, "num_steps_sampled": 340000, "sample_time_ms": 13018.72, "load_time_ms": 33.737, "grad_time_ms": 4978.747, "update_time_ms": 8.041, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 254.1844024658203, "policy_loss": -0.013231598772108555, "vf_loss": 254.19761657714844, "vf_explained_var": 0.0034053558483719826, "kl": 0.013965344056487083, "entropy": 31.0040225982666, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 254.1884307861328, "policy_loss": -0.0069513763301074505, "vf_loss": 254.1953125, "vf_explained_var": 0.003164534457027912, "kl": 0.021008232608437538, "entropy": 2.5675017833709717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 340000, "episodes_total": 689, "training_iteration": 17, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-30-42", "timestamp": 1567647042, "time_this_iter_s": 17.968671560287476, "time_total_s": 317.8763093948364, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518438c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 317.8763093948364, "timesteps_since_restore": 340000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.004, "ram_util_percent": 14.139999999999997}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 297.5223293560788, "action_adversary": -297.5223293560788}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9012236037579533, "mean_processing_ms": 2.4698337296699027, "mean_inference_ms": 0.9641562083049899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 359424, "num_steps_sampled": 360000, "sample_time_ms": 13027.024, "load_time_ms": 33.755, "grad_time_ms": 4978.109, "update_time_ms": 7.942, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 262.934326171875, "policy_loss": -0.013419637456536293, "vf_loss": 262.94775390625, "vf_explained_var": 0.004539331886917353, "kl": 0.015510549768805504, "entropy": 31.050809860229492, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 262.80218505859375, "policy_loss": -0.006241971161216497, "vf_loss": 262.8083801269531, "vf_explained_var": 0.004201220814138651, "kl": 0.010168017819523811, "entropy": 2.532984733581543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 360000, "episodes_total": 729, "training_iteration": 18, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-31-00", "timestamp": 1567647060, "time_this_iter_s": 18.163325548171997, "time_total_s": 336.0396349430084, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51844ae18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 336.0396349430084, "timesteps_since_restore": 360000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.407692307692304, "ram_util_percent": 14.10384615384615}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 300.39938263062623, "action_adversary": -300.39938263062623}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.89650675218885, "mean_processing_ms": 2.4682702868683832, "mean_inference_ms": 0.9652960745050055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 379392, "num_steps_sampled": 380000, "sample_time_ms": 13033.675, "load_time_ms": 33.759, "grad_time_ms": 4978.174, "update_time_ms": 7.89, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 263.9374084472656, "policy_loss": -0.01324011106044054, "vf_loss": 263.95062255859375, "vf_explained_var": 0.0015723311807960272, "kl": 0.015006591565907001, "entropy": 31.023136138916016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 263.8771057128906, "policy_loss": -0.007314193062484264, "vf_loss": 263.8843078613281, "vf_explained_var": 0.0017231997335329652, "kl": 0.026109257712960243, "entropy": 2.55663800239563, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 380000, "episodes_total": 768, "training_iteration": 19, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-31-18", "timestamp": 1567647078, "time_this_iter_s": 18.095268726348877, "time_total_s": 354.1349036693573, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518454730>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 354.1349036693573, "timesteps_since_restore": 380000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.37692307692308, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 302.3939220035937, "action_adversary": -302.3939220035937}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8807662477971654, "mean_processing_ms": 2.4672197102519764, "mean_inference_ms": 0.965452558213905}, "off_policy_estimator": {}, "info": {"num_steps_trained": 399360, "num_steps_sampled": 400000, "sample_time_ms": 13047.026, "load_time_ms": 33.757, "grad_time_ms": 4978.448, "update_time_ms": 7.744, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 266.8086853027344, "policy_loss": -0.014218142256140709, "vf_loss": 266.8229064941406, "vf_explained_var": 0.001283695688471198, "kl": 0.016588224098086357, "entropy": 31.023969650268555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 266.78985595703125, "policy_loss": -0.005269918125122786, "vf_loss": 266.7950744628906, "vf_explained_var": 0.0020921158138662577, "kl": 0.020484445616602898, "entropy": 2.5481038093566895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 400000, "episodes_total": 809, "training_iteration": 20, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-31-36", "timestamp": 1567647096, "time_this_iter_s": 17.996453285217285, "time_total_s": 372.1313569545746, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184638c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 372.1313569545746, "timesteps_since_restore": 400000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.28846153846154, "ram_util_percent": 14.12307692307692}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 301.1130435197212, "action_adversary": -301.1130435197212}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.862493982287532, "mean_processing_ms": 2.465959090660343, "mean_inference_ms": 0.9654978798772751}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419328, "num_steps_sampled": 420000, "sample_time_ms": 13050.121, "load_time_ms": 34.202, "grad_time_ms": 4980.321, "update_time_ms": 7.69, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 259.5832214355469, "policy_loss": -0.014516598545014858, "vf_loss": 259.59771728515625, "vf_explained_var": 0.0029723159968852997, "kl": 0.015451033599674702, "entropy": 31.002973556518555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 259.6790771484375, "policy_loss": -0.0030622584745287895, "vf_loss": 259.68212890625, "vf_explained_var": 0.002905977424234152, "kl": 0.00943480059504509, "entropy": 2.5215437412261963, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 420000, "episodes_total": 848, "training_iteration": 21, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-31-54", "timestamp": 1567647114, "time_this_iter_s": 17.958032608032227, "time_total_s": 390.0893895626068, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518463f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 390.0893895626068, "timesteps_since_restore": 420000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.784000000000006, "ram_util_percent": 14.116}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 296.710334515684, "action_adversary": -296.710334515684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8611698230603917, "mean_processing_ms": 2.4650949977752377, "mean_inference_ms": 0.9649745211595153}, "off_policy_estimator": {}, "info": {"num_steps_trained": 439296, "num_steps_sampled": 440000, "sample_time_ms": 13038.922, "load_time_ms": 34.154, "grad_time_ms": 4981.692, "update_time_ms": 7.695, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 266.5053405761719, "policy_loss": -0.012811247259378433, "vf_loss": 266.51812744140625, "vf_explained_var": 0.003970760386437178, "kl": 0.015269806608557701, "entropy": 30.988285064697266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 266.30169677734375, "policy_loss": -0.007131798192858696, "vf_loss": 266.3088073730469, "vf_explained_var": 0.0038034343160688877, "kl": 0.02520826831459999, "entropy": 2.5283286571502686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 440000, "episodes_total": 889, "training_iteration": 22, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-32-12", "timestamp": 1567647132, "time_this_iter_s": 17.985273122787476, "time_total_s": 408.0746626853943, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183eef28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 408.0746626853943, "timesteps_since_restore": 440000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.380769230769236, "ram_util_percent": 14.226923076923079}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 295.03077861850176, "action_adversary": -295.03077861850176}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8378297321764268, "mean_processing_ms": 2.4634913853259537, "mean_inference_ms": 0.9647790798402498}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459264, "num_steps_sampled": 460000, "sample_time_ms": 12990.336, "load_time_ms": 34.139, "grad_time_ms": 4984.104, "update_time_ms": 7.737, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 264.1370849609375, "policy_loss": -0.01374115515500307, "vf_loss": 264.1508483886719, "vf_explained_var": 0.004221976734697819, "kl": 0.014092552475631237, "entropy": 31.044546127319336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 264.13983154296875, "policy_loss": -0.0034023893531411886, "vf_loss": 264.1432189941406, "vf_explained_var": 0.004159628413617611, "kl": 0.010054940357804298, "entropy": 2.492079973220825, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 460000, "episodes_total": 927, "training_iteration": 23, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-32-30", "timestamp": 1567647150, "time_this_iter_s": 17.725434064865112, "time_total_s": 425.8000967502594, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518422158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 425.8000967502594, "timesteps_since_restore": 460000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.331999999999997, "ram_util_percent": 14.187999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 294.78721998696756, "action_adversary": -294.78721998696756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.838817974868307, "mean_processing_ms": 2.4616376342272646, "mean_inference_ms": 0.9637073336051075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 479232, "num_steps_sampled": 480000, "sample_time_ms": 12937.812, "load_time_ms": 33.876, "grad_time_ms": 4985.138, "update_time_ms": 7.643, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 266.881591796875, "policy_loss": -0.012672328390181065, "vf_loss": 266.89422607421875, "vf_explained_var": 0.003459014929831028, "kl": 0.014962010085582733, "entropy": 31.035497665405273, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 266.9689025878906, "policy_loss": -0.0039411443285644054, "vf_loss": 266.9728698730469, "vf_explained_var": 0.003384512150660157, "kl": 0.007394509389996529, "entropy": 2.474111795425415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 480000, "episodes_total": 968, "training_iteration": 24, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-32-47", "timestamp": 1567647167, "time_this_iter_s": 17.68423891067505, "time_total_s": 443.48433566093445, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184546a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 443.48433566093445, "timesteps_since_restore": 480000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.95384615384615, "ram_util_percent": 14.200000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 294.9067663778787, "action_adversary": -294.9067663778787}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.810607206396761, "mean_processing_ms": 2.4600049310047143, "mean_inference_ms": 0.9629400313655109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499200, "num_steps_sampled": 500000, "sample_time_ms": 12900.917, "load_time_ms": 33.963, "grad_time_ms": 4985.563, "update_time_ms": 7.65, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 268.9749450683594, "policy_loss": -0.014234655536711216, "vf_loss": 268.98919677734375, "vf_explained_var": 0.0032990342006087303, "kl": 0.016469543799757957, "entropy": 30.999130249023438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 269.19281005859375, "policy_loss": -0.005338436458259821, "vf_loss": 269.1981201171875, "vf_explained_var": 0.00227564200758934, "kl": 0.02154640294611454, "entropy": 2.4442102909088135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 500000, "episodes_total": 1007, "training_iteration": 25, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-33-05", "timestamp": 1567647185, "time_this_iter_s": 17.77240562438965, "time_total_s": 461.2567412853241, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b776d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 461.2567412853241, "timesteps_since_restore": 500000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.555999999999994, "ram_util_percent": 14.156}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 297.0719955043714, "action_adversary": -297.0719955043714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8180427928556595, "mean_processing_ms": 2.4595397687406684, "mean_inference_ms": 0.962015272289332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 519168, "num_steps_sampled": 520000, "sample_time_ms": 12872.793, "load_time_ms": 34.185, "grad_time_ms": 4986.286, "update_time_ms": 7.65, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 267.470458984375, "policy_loss": -0.015941476449370384, "vf_loss": 267.48638916015625, "vf_explained_var": 0.002393875038251281, "kl": 0.017235664650797844, "entropy": 30.976337432861328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 267.5794677734375, "policy_loss": -0.0032927249558269978, "vf_loss": 267.582763671875, "vf_explained_var": 0.001927306642755866, "kl": 0.008760161697864532, "entropy": 2.4097275733947754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 520000, "episodes_total": 1048, "training_iteration": 26, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-33-23", "timestamp": 1567647203, "time_this_iter_s": 17.818213939666748, "time_total_s": 479.07495522499084, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7937b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 479.07495522499084, "timesteps_since_restore": 520000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.844, "ram_util_percent": 14.164000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 300.0210328275108, "action_adversary": -300.0210328275108}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.811561082830484, "mean_processing_ms": 2.459171059318722, "mean_inference_ms": 0.9617652824805092}, "off_policy_estimator": {}, "info": {"num_steps_trained": 539136, "num_steps_sampled": 540000, "sample_time_ms": 12849.259, "load_time_ms": 34.486, "grad_time_ms": 4986.064, "update_time_ms": 7.644, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 274.5207214355469, "policy_loss": -0.013258390128612518, "vf_loss": 274.5339660644531, "vf_explained_var": 0.0008827440324239433, "kl": 0.017060918733477592, "entropy": 30.990591049194336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 274.7419738769531, "policy_loss": -0.002917688339948654, "vf_loss": 274.744873046875, "vf_explained_var": 0.0007873815484344959, "kl": 0.007591826841235161, "entropy": 2.3930845260620117, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 540000, "episodes_total": 1089, "training_iteration": 27, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-33-41", "timestamp": 1567647221, "time_this_iter_s": 17.733365058898926, "time_total_s": 496.80832028388977, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518463e18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 496.80832028388977, "timesteps_since_restore": 540000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.034615384615385, "ram_util_percent": 14.188461538461537}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 304.0424233041945, "action_adversary": -304.0424233041945}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8064263619855687, "mean_processing_ms": 2.4590491341693683, "mean_inference_ms": 0.9616947486739582}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559104, "num_steps_sampled": 560000, "sample_time_ms": 12811.554, "load_time_ms": 34.505, "grad_time_ms": 4985.83, "update_time_ms": 7.66, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 279.8238220214844, "policy_loss": -0.011951706372201443, "vf_loss": 279.8357238769531, "vf_explained_var": 0.0012956307036802173, "kl": 0.014362399466335773, "entropy": 30.99959373474121, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 280.0343322753906, "policy_loss": -0.004830968100577593, "vf_loss": 280.0391540527344, "vf_explained_var": 0.0009585535153746605, "kl": 0.013247492723166943, "entropy": 2.3548145294189453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 560000, "episodes_total": 1127, "training_iteration": 28, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-33-59", "timestamp": 1567647239, "time_this_iter_s": 17.785361289978027, "time_total_s": 514.5936815738678, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184227b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 514.5936815738678, "timesteps_since_restore": 560000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.796, "ram_util_percent": 14.164000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 304.9956169022243, "action_adversary": -304.9956169022243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8061860399536376, "mean_processing_ms": 2.4582307148276907, "mean_inference_ms": 0.9618481143027381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 579072, "num_steps_sampled": 580000, "sample_time_ms": 12795.998, "load_time_ms": 34.528, "grad_time_ms": 4985.97, "update_time_ms": 7.929, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 282.61376953125, "policy_loss": -0.01313851773738861, "vf_loss": 282.6269226074219, "vf_explained_var": 0.0020430057775229216, "kl": 0.01695573702454567, "entropy": 31.058788299560547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 282.8671569824219, "policy_loss": -0.006035950500518084, "vf_loss": 282.8731994628906, "vf_explained_var": 0.00216261250898242, "kl": 0.018025334924459457, "entropy": 2.326894998550415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 580000, "episodes_total": 1168, "training_iteration": 29, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-34-16", "timestamp": 1567647256, "time_this_iter_s": 17.942740201950073, "time_total_s": 532.5364217758179, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51843d0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 532.5364217758179, "timesteps_since_restore": 580000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.284615384615385, "ram_util_percent": 14.157692307692308}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 304.814811970833, "action_adversary": -304.814811970833}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7814047081014075, "mean_processing_ms": 2.456963208517318, "mean_inference_ms": 0.9617294009754052}, "off_policy_estimator": {}, "info": {"num_steps_trained": 599040, "num_steps_sampled": 600000, "sample_time_ms": 12756.916, "load_time_ms": 34.532, "grad_time_ms": 4983.797, "update_time_ms": 8.147, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 281.77301025390625, "policy_loss": -0.015440636314451694, "vf_loss": 281.7884521484375, "vf_explained_var": 0.004489842802286148, "kl": 0.01918885111808777, "entropy": 31.0394229888916, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 282.0009460449219, "policy_loss": -0.010211027227342129, "vf_loss": 282.01116943359375, "vf_explained_var": 0.004254069644957781, "kl": 0.034168366342782974, "entropy": 2.369878053665161, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 600000, "episodes_total": 1207, "training_iteration": 30, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-34-34", "timestamp": 1567647274, "time_this_iter_s": 17.585080862045288, "time_total_s": 550.1215026378632, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518449268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 550.1215026378632, "timesteps_since_restore": 600000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.772, "ram_util_percent": 14.264000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 302.8920475985591, "action_adversary": -302.8920475985591}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.789121853240382, "mean_processing_ms": 2.4572834209544983, "mean_inference_ms": 0.9612598787059322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 619008, "num_steps_sampled": 620000, "sample_time_ms": 12763.135, "load_time_ms": 34.376, "grad_time_ms": 4982.787, "update_time_ms": 8.201, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 281.6193542480469, "policy_loss": -0.013423829339444637, "vf_loss": 281.63275146484375, "vf_explained_var": 0.0018269129795953631, "kl": 0.016752906143665314, "entropy": 30.990081787109375, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 281.6391906738281, "policy_loss": -0.006673424504697323, "vf_loss": 281.6458435058594, "vf_explained_var": 0.0017401701770722866, "kl": 0.018022067844867706, "entropy": 2.3328285217285156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 620000, "episodes_total": 1249, "training_iteration": 31, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-34-52", "timestamp": 1567647292, "time_this_iter_s": 18.010925769805908, "time_total_s": 568.1324284076691, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518449ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 568.1324284076691, "timesteps_since_restore": 620000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.492000000000004, "ram_util_percent": 14.248}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 302.8708935186897, "action_adversary": -302.8708935186897}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.786383992840868, "mean_processing_ms": 2.457220284541801, "mean_inference_ms": 0.9613874145060666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 638976, "num_steps_sampled": 640000, "sample_time_ms": 12800.739, "load_time_ms": 34.438, "grad_time_ms": 4981.996, "update_time_ms": 8.196, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 281.0006103515625, "policy_loss": -0.014742579311132431, "vf_loss": 281.01531982421875, "vf_explained_var": 0.002757593523710966, "kl": 0.018724268302321434, "entropy": 31.034765243530273, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 280.9416198730469, "policy_loss": -0.0036892073694616556, "vf_loss": 280.94537353515625, "vf_explained_var": 0.003245642874389887, "kl": 0.008486059494316578, "entropy": 2.28406023979187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 640000, "episodes_total": 1289, "training_iteration": 32, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-35-10", "timestamp": 1567647310, "time_this_iter_s": 18.354179859161377, "time_total_s": 586.4866082668304, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518436c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 586.4866082668304, "timesteps_since_restore": 640000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.385185185185183, "ram_util_percent": 14.162962962962965}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 301.62440979025365, "action_adversary": -301.62440979025365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7945576134327728, "mean_processing_ms": 2.4572602487252646, "mean_inference_ms": 0.9621081491928636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 658944, "num_steps_sampled": 660000, "sample_time_ms": 12835.204, "load_time_ms": 34.439, "grad_time_ms": 4981.272, "update_time_ms": 8.185, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 284.7903747558594, "policy_loss": -0.014835687354207039, "vf_loss": 284.80523681640625, "vf_explained_var": 0.001666374271735549, "kl": 0.018045572564005852, "entropy": 31.024282455444336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 284.9211120605469, "policy_loss": -0.005379330832511187, "vf_loss": 284.9264221191406, "vf_explained_var": 0.001728787668980658, "kl": 0.02353071980178356, "entropy": 2.286290168762207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 660000, "episodes_total": 1328, "training_iteration": 33, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-35-29", "timestamp": 1567647329, "time_this_iter_s": 18.06229066848755, "time_total_s": 604.548898935318, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518438598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 604.548898935318, "timesteps_since_restore": 660000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 31.732, "ram_util_percent": 14.16}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 303.089562341177, "action_adversary": -303.089562341177}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7889063702694172, "mean_processing_ms": 2.4569384924489577, "mean_inference_ms": 0.9626618966250581}, "off_policy_estimator": {}, "info": {"num_steps_trained": 678912, "num_steps_sampled": 680000, "sample_time_ms": 12868.777, "load_time_ms": 34.735, "grad_time_ms": 4981.167, "update_time_ms": 8.231, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 290.3049011230469, "policy_loss": -0.014866087585687637, "vf_loss": 290.31976318359375, "vf_explained_var": 0.0017374298768118024, "kl": 0.01823188178241253, "entropy": 30.995079040527344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 290.353271484375, "policy_loss": -0.003890149062499404, "vf_loss": 290.357177734375, "vf_explained_var": 0.0018773552728816867, "kl": 0.01139100082218647, "entropy": 2.2555627822875977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 680000, "episodes_total": 1369, "training_iteration": 34, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-35-47", "timestamp": 1567647347, "time_this_iter_s": 18.030352115631104, "time_total_s": 622.5792510509491, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518444730>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 622.5792510509491, "timesteps_since_restore": 680000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.726923076923075, "ram_util_percent": 14.165384615384616}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 303.39811182894977, "action_adversary": -303.39811182894977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.777072488574502, "mean_processing_ms": 2.456388216068532, "mean_inference_ms": 0.9630609869038941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 698880, "num_steps_sampled": 700000, "sample_time_ms": 12886.786, "load_time_ms": 34.668, "grad_time_ms": 4981.007, "update_time_ms": 8.48, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 291.4537353515625, "policy_loss": -0.014034857042133808, "vf_loss": 291.4677429199219, "vf_explained_var": 0.0023614054080098867, "kl": 0.018079381436109543, "entropy": 30.951128005981445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 291.69537353515625, "policy_loss": -0.0062728747725486755, "vf_loss": 291.7016296386719, "vf_explained_var": 0.0022658382076770067, "kl": 0.02591473050415516, "entropy": 2.27059006690979, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 700000, "episodes_total": 1408, "training_iteration": 35, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-36-05", "timestamp": 1567647365, "time_this_iter_s": 17.95269274711609, "time_total_s": 640.5319437980652, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518426048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 640.5319437980652, "timesteps_since_restore": 700000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.86923076923077, "ram_util_percent": 14.226923076923079}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 302.5324897844983, "action_adversary": -302.5324897844983}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.781295999206851, "mean_processing_ms": 2.456010184736804, "mean_inference_ms": 0.9629236493427762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 718848, "num_steps_sampled": 720000, "sample_time_ms": 12910.402, "load_time_ms": 34.659, "grad_time_ms": 4980.955, "update_time_ms": 8.493, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 296.8382873535156, "policy_loss": -0.013493264093995094, "vf_loss": 296.8517761230469, "vf_explained_var": 0.001965845702216029, "kl": 0.018743406981229782, "entropy": 30.888559341430664, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 297.2074279785156, "policy_loss": -0.0065069482661783695, "vf_loss": 297.21392822265625, "vf_explained_var": 0.0022445672657340765, "kl": 0.02510673552751541, "entropy": 2.2965378761291504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 720000, "episodes_total": 1449, "training_iteration": 36, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-36-23", "timestamp": 1567647383, "time_this_iter_s": 18.055123567581177, "time_total_s": 658.5870673656464, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6fc1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 658.5870673656464, "timesteps_since_restore": 720000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.388461538461538, "ram_util_percent": 14.284615384615385}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.0842239285363, "action_adversary": -300.0842239285363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.777625960506877, "mean_processing_ms": 2.455853145600554, "mean_inference_ms": 0.9630135857299649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 738816, "num_steps_sampled": 740000, "sample_time_ms": 12915.35, "load_time_ms": 34.66, "grad_time_ms": 4981.21, "update_time_ms": 8.492, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 300.0567321777344, "policy_loss": -0.014092500321567059, "vf_loss": 300.0707702636719, "vf_explained_var": 0.0292039904743433, "kl": 0.019719380885362625, "entropy": 30.891651153564453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 300.4068603515625, "policy_loss": -0.006592557765543461, "vf_loss": 300.4134521484375, "vf_explained_var": 0.02388690784573555, "kl": 0.027203258126974106, "entropy": 2.3457839488983154, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 740000, "episodes_total": 1489, "training_iteration": 37, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-36-40", "timestamp": 1567647400, "time_this_iter_s": 17.785969257354736, "time_total_s": 676.3730366230011, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6fca60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 676.3730366230011, "timesteps_since_restore": 740000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.692000000000004, "ram_util_percent": 14.176000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 296.79035279533696, "action_adversary": -296.79035279533696}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7791905597362994, "mean_processing_ms": 2.4553367483153195, "mean_inference_ms": 0.9634924207585768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758784, "num_steps_sampled": 760000, "sample_time_ms": 12947.662, "load_time_ms": 34.614, "grad_time_ms": 4981.581, "update_time_ms": 8.497, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 297.8327331542969, "policy_loss": -0.013727176003158092, "vf_loss": 297.8464660644531, "vf_explained_var": 0.06012621149420738, "kl": 0.018964052200317383, "entropy": 30.920516967773438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 300.2716369628906, "policy_loss": -0.003933833446353674, "vf_loss": 300.27557373046875, "vf_explained_var": 0.05109970644116402, "kl": 0.011421110481023788, "entropy": 2.33353590965271, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 760000, "episodes_total": 1528, "training_iteration": 38, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-36-59", "timestamp": 1567647419, "time_this_iter_s": 18.111815929412842, "time_total_s": 694.4848525524139, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b701bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 694.4848525524139, "timesteps_since_restore": 760000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 30.83076923076923, "ram_util_percent": 14.23076923076923}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 292.19143306348747, "action_adversary": -292.19143306348747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.771114750559911, "mean_processing_ms": 2.4550047626741733, "mean_inference_ms": 0.9635280544469549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 778752, "num_steps_sampled": 780000, "sample_time_ms": 12951.74, "load_time_ms": 34.572, "grad_time_ms": 4981.436, "update_time_ms": 8.511, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 300.82501220703125, "policy_loss": -0.013229739852249622, "vf_loss": 300.8382263183594, "vf_explained_var": 0.10603862255811691, "kl": 0.018003931269049644, "entropy": 30.870967864990234, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 302.0503234863281, "policy_loss": -0.004042146727442741, "vf_loss": 302.05438232421875, "vf_explained_var": 0.10093626379966736, "kl": 0.012112831696867943, "entropy": 2.3234822750091553, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 780000, "episodes_total": 1569, "training_iteration": 39, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-37-17", "timestamp": 1567647437, "time_this_iter_s": 17.981877088546753, "time_total_s": 712.4667296409607, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 712.4667296409607, "timesteps_since_restore": 780000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.64, "ram_util_percent": 14.224}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 290.6660405251216, "action_adversary": -290.6660405251216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7603911904257656, "mean_processing_ms": 2.45455659550099, "mean_inference_ms": 0.9640851056381945}, "off_policy_estimator": {}, "info": {"num_steps_trained": 798720, "num_steps_sampled": 800000, "sample_time_ms": 12994.967, "load_time_ms": 34.574, "grad_time_ms": 4982.38, "update_time_ms": 8.313, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 288.6649169921875, "policy_loss": -0.015611440874636173, "vf_loss": 288.6805419921875, "vf_explained_var": 0.11135074496269226, "kl": 0.019832655787467957, "entropy": 30.794233322143555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 289.0406799316406, "policy_loss": -0.004806838929653168, "vf_loss": 289.04547119140625, "vf_explained_var": 0.11085239797830582, "kl": 0.015776459127664566, "entropy": 2.3266491889953613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 800000, "episodes_total": 1608, "training_iteration": 40, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-37-35", "timestamp": 1567647455, "time_this_iter_s": 18.025588512420654, "time_total_s": 730.4923181533813, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b84c6a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 730.4923181533813, "timesteps_since_restore": 800000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 30.72307692307692, "ram_util_percent": 14.192307692307692}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 291.78773221836116, "action_adversary": -291.78773221836116}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.765181552465799, "mean_processing_ms": 2.45434931509359, "mean_inference_ms": 0.9640370141087742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 818688, "num_steps_sampled": 820000, "sample_time_ms": 12981.706, "load_time_ms": 34.586, "grad_time_ms": 4982.563, "update_time_ms": 8.275, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 300.6430358886719, "policy_loss": -0.013235299848020077, "vf_loss": 300.65625, "vf_explained_var": 0.11558082699775696, "kl": 0.01572362519800663, "entropy": 30.804595947265625, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 301.51617431640625, "policy_loss": -0.005248012486845255, "vf_loss": 301.5213928222656, "vf_explained_var": 0.11255134642124176, "kl": 0.029575586318969727, "entropy": 2.344893217086792, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 820000, "episodes_total": 1649, "training_iteration": 41, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-37-53", "timestamp": 1567647473, "time_this_iter_s": 17.87924861907959, "time_total_s": 748.3715667724609, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b84cea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 748.3715667724609, "timesteps_since_restore": 820000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.23461538461538, "ram_util_percent": 14.184615384615386}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 290.0669166183906, "action_adversary": -290.0669166183906}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7476962879581874, "mean_processing_ms": 2.4538840028551947, "mean_inference_ms": 0.964431341386314}, "off_policy_estimator": {}, "info": {"num_steps_trained": 838656, "num_steps_sampled": 840000, "sample_time_ms": 12895.76, "load_time_ms": 34.561, "grad_time_ms": 4982.885, "update_time_ms": 8.222, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 297.58660888671875, "policy_loss": -0.013328191824257374, "vf_loss": 297.59991455078125, "vf_explained_var": 0.11653131991624832, "kl": 0.018037058413028717, "entropy": 30.83236312866211, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 297.9732360839844, "policy_loss": -0.0039694178849458694, "vf_loss": 297.97723388671875, "vf_explained_var": 0.11546729505062103, "kl": 0.0138540118932724, "entropy": 2.3317277431488037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 840000, "episodes_total": 1687, "training_iteration": 42, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-38-10", "timestamp": 1567647490, "time_this_iter_s": 17.497828722000122, "time_total_s": 765.8693954944611, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b880158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 765.8693954944611, "timesteps_since_restore": 840000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.608, "ram_util_percent": 14.196000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 288.9900288323721, "action_adversary": -288.9900288323721}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7541315088363887, "mean_processing_ms": 2.4531655373592884, "mean_inference_ms": 0.9641099249620644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 858624, "num_steps_sampled": 860000, "sample_time_ms": 12856.342, "load_time_ms": 34.589, "grad_time_ms": 4982.788, "update_time_ms": 8.122, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 301.05853271484375, "policy_loss": -0.015004320070147514, "vf_loss": 301.0735778808594, "vf_explained_var": 0.14874298870563507, "kl": 0.01907990872859955, "entropy": 30.7565975189209, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 303.19244384765625, "policy_loss": -0.002842735731974244, "vf_loss": 303.1953125, "vf_explained_var": 0.14249488711357117, "kl": 0.010134521871805191, "entropy": 2.335960626602173, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 860000, "episodes_total": 1728, "training_iteration": 43, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-38-28", "timestamp": 1567647508, "time_this_iter_s": 17.666125774383545, "time_total_s": 783.5355212688446, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b8809d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 783.5355212688446, "timesteps_since_restore": 860000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.663999999999998, "ram_util_percent": 14.192}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 291.9323124765117, "action_adversary": -291.9323124765117}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.731341044323616, "mean_processing_ms": 2.452468430948445, "mean_inference_ms": 0.9639596505495653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 878592, "num_steps_sampled": 880000, "sample_time_ms": 12824.975, "load_time_ms": 34.542, "grad_time_ms": 4983.203, "update_time_ms": 8.381, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 307.277099609375, "policy_loss": -0.013829209841787815, "vf_loss": 307.2909240722656, "vf_explained_var": 0.1445009559392929, "kl": 0.018499210476875305, "entropy": 30.810028076171875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 309.4007873535156, "policy_loss": -0.006042078603059053, "vf_loss": 309.4068603515625, "vf_explained_var": 0.14770859479904175, "kl": 0.028304368257522583, "entropy": 2.361703395843506, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 880000, "episodes_total": 1767, "training_iteration": 44, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-38-46", "timestamp": 1567647526, "time_this_iter_s": 17.71559453010559, "time_total_s": 801.2511157989502, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183bbb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 801.2511157989502, "timesteps_since_restore": 880000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.496, "ram_util_percent": 14.296000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 283.4120569459972, "action_adversary": -283.4120569459972}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7424779412257414, "mean_processing_ms": 2.4523186662113625, "mean_inference_ms": 0.9633225257055795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 898560, "num_steps_sampled": 900000, "sample_time_ms": 12813.18, "load_time_ms": 34.544, "grad_time_ms": 4982.256, "update_time_ms": 8.197, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 326.7808532714844, "policy_loss": -0.014832358807325363, "vf_loss": 326.7956848144531, "vf_explained_var": 0.1784782111644745, "kl": 0.017463425174355507, "entropy": 30.75641632080078, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 328.90380859375, "policy_loss": -0.0033985720947384834, "vf_loss": 328.9071960449219, "vf_explained_var": 0.17800688743591309, "kl": 0.012152220122516155, "entropy": 2.3463597297668457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 900000, "episodes_total": 1808, "training_iteration": 45, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-39-03", "timestamp": 1567647543, "time_this_iter_s": 17.822527170181274, "time_total_s": 819.0736429691315, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c3488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 819.0736429691315, "timesteps_since_restore": 900000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 29.707692307692312, "ram_util_percent": 14.300000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 279.09128502958464, "action_adversary": -279.09128502958464}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7399113362328995, "mean_processing_ms": 2.4523437606992395, "mean_inference_ms": 0.9632608597233449}, "off_policy_estimator": {}, "info": {"num_steps_trained": 918528, "num_steps_sampled": 920000, "sample_time_ms": 12796.786, "load_time_ms": 34.52, "grad_time_ms": 4981.589, "update_time_ms": 8.191, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 316.15960693359375, "policy_loss": -0.013199515640735626, "vf_loss": 316.1728210449219, "vf_explained_var": 0.19288639724254608, "kl": 0.01706128567457199, "entropy": 30.802827835083008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 318.293212890625, "policy_loss": -0.003671357175335288, "vf_loss": 318.29693603515625, "vf_explained_var": 0.18660126626491547, "kl": 0.013075580820441246, "entropy": 2.294614315032959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 920000, "episodes_total": 1849, "training_iteration": 46, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-39-21", "timestamp": 1567647561, "time_this_iter_s": 17.88405132293701, "time_total_s": 836.9576942920685, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183cc620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 836.9576942920685, "timesteps_since_restore": 920000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.956000000000003, "ram_util_percent": 14.300000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 283.06274827815304, "action_adversary": -283.06274827815304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7376382725208668, "mean_processing_ms": 2.4524049391786957, "mean_inference_ms": 0.9632402357603843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 938496, "num_steps_sampled": 940000, "sample_time_ms": 12795.165, "load_time_ms": 34.253, "grad_time_ms": 4981.516, "update_time_ms": 8.196, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 311.8505554199219, "policy_loss": -0.014910833910107613, "vf_loss": 311.865478515625, "vf_explained_var": 0.18864423036575317, "kl": 0.018860753625631332, "entropy": 30.778837203979492, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 311.20697021484375, "policy_loss": -0.004049204755574465, "vf_loss": 311.2110290527344, "vf_explained_var": 0.18850010633468628, "kl": 0.012300788424909115, "entropy": 2.2780494689941406, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 940000, "episodes_total": 1887, "training_iteration": 47, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-39-39", "timestamp": 1567647579, "time_this_iter_s": 17.766498565673828, "time_total_s": 854.7241928577423, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ccea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 854.7241928577423, "timesteps_since_restore": 940000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.15384615384615, "ram_util_percent": 14.242307692307694}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 287.77448352310273, "action_adversary": -287.77448352310273}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7395566309824466, "mean_processing_ms": 2.4520370149850272, "mean_inference_ms": 0.9633349356183503}, "off_policy_estimator": {}, "info": {"num_steps_trained": 958464, "num_steps_sampled": 960000, "sample_time_ms": 12742.433, "load_time_ms": 34.3, "grad_time_ms": 4980.124, "update_time_ms": 8.238, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 328.8948669433594, "policy_loss": -0.015177758410573006, "vf_loss": 328.9100646972656, "vf_explained_var": 0.18445046246051788, "kl": 0.02121792361140251, "entropy": 30.79464340209961, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 327.51898193359375, "policy_loss": -0.0021960027515888214, "vf_loss": 327.52117919921875, "vf_explained_var": 0.18995259702205658, "kl": 0.009982106275856495, "entropy": 2.2361133098602295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 960000, "episodes_total": 1928, "training_iteration": 48, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-39-57", "timestamp": 1567647597, "time_this_iter_s": 17.57152271270752, "time_total_s": 872.2957155704498, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ea0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 872.2957155704498, "timesteps_since_restore": 960000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.42, "ram_util_percent": 14.276000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 292.5009329571508, "action_adversary": -292.5009329571508}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7171866236312185, "mean_processing_ms": 2.451427595330612, "mean_inference_ms": 0.9630563206033833}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978432, "num_steps_sampled": 980000, "sample_time_ms": 12714.539, "load_time_ms": 34.344, "grad_time_ms": 4980.835, "update_time_ms": 7.953, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 333.71282958984375, "policy_loss": -0.014320683665573597, "vf_loss": 333.7271728515625, "vf_explained_var": 0.18300014734268188, "kl": 0.018245914950966835, "entropy": 30.788686752319336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 331.1405334472656, "policy_loss": -0.002730739302933216, "vf_loss": 331.1432800292969, "vf_explained_var": 0.18489748239517212, "kl": 0.012112241238355637, "entropy": 2.2376811504364014, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 980000, "episodes_total": 1967, "training_iteration": 49, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-40-14", "timestamp": 1567647614, "time_this_iter_s": 17.70801091194153, "time_total_s": 890.0037264823914, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183bb950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 890.0037264823914, "timesteps_since_restore": 980000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 31.396, "ram_util_percent": 14.300000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 296.7703759925612, "action_adversary": -296.7703759925612}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.728682634753215, "mean_processing_ms": 2.451352965671789, "mean_inference_ms": 0.9624536241718832}, "off_policy_estimator": {}, "info": {"num_steps_trained": 998400, "num_steps_sampled": 1000000, "sample_time_ms": 12686.33, "load_time_ms": 34.382, "grad_time_ms": 4981.447, "update_time_ms": 7.915, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 340.259521484375, "policy_loss": -0.013663854449987411, "vf_loss": 340.27313232421875, "vf_explained_var": 0.17766788601875305, "kl": 0.018864745274186134, "entropy": 30.72138214111328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 338.3028259277344, "policy_loss": -0.0024634473957121372, "vf_loss": 338.3052978515625, "vf_explained_var": 0.17898599803447723, "kl": 0.00883376132696867, "entropy": 2.2283923625946045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1000000, "episodes_total": 2008, "training_iteration": 50, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-40-32", "timestamp": 1567647632, "time_this_iter_s": 17.75145149230957, "time_total_s": 907.7551779747009, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b880268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 907.7551779747009, "timesteps_since_restore": 1000000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.531999999999996, "ram_util_percent": 14.304000000000004}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 296.9453379664762, "action_adversary": -296.9453379664762}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7259554583284116, "mean_processing_ms": 2.451419344998241, "mean_inference_ms": 0.9626444936505196}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018368, "num_steps_sampled": 1020000, "sample_time_ms": 12660.169, "load_time_ms": 34.382, "grad_time_ms": 4982.638, "update_time_ms": 7.817, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 352.4780578613281, "policy_loss": -0.013683325611054897, "vf_loss": 352.4917297363281, "vf_explained_var": 0.1934005320072174, "kl": 0.016478633508086205, "entropy": 30.74046516418457, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 352.14093017578125, "policy_loss": -0.005212736316025257, "vf_loss": 352.1461486816406, "vf_explained_var": 0.19170716404914856, "kl": 0.017733687534928322, "entropy": 2.233832836151123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1020000, "episodes_total": 2049, "training_iteration": 51, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-40-50", "timestamp": 1567647650, "time_this_iter_s": 17.62878441810608, "time_total_s": 925.383962392807, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 925.383962392807, "timesteps_since_restore": 1020000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 14.220000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 295.136066813533, "action_adversary": -295.136066813533}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.722942333414758, "mean_processing_ms": 2.451468095668592, "mean_inference_ms": 0.962782118231652}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1038336, "num_steps_sampled": 1040000, "sample_time_ms": 12661.416, "load_time_ms": 34.401, "grad_time_ms": 4984.163, "update_time_ms": 7.861, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 339.4133605957031, "policy_loss": -0.013355539180338383, "vf_loss": 339.42669677734375, "vf_explained_var": 0.19900375604629517, "kl": 0.017977114766836166, "entropy": 30.73777198791504, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 339.93963623046875, "policy_loss": -0.002830336568877101, "vf_loss": 339.94244384765625, "vf_explained_var": 0.1969999521970749, "kl": 0.014212718233466148, "entropy": 2.208458185195923, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1040000, "episodes_total": 2087, "training_iteration": 52, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-41-07", "timestamp": 1567647667, "time_this_iter_s": 17.52541732788086, "time_total_s": 942.9093797206879, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183cc1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 942.9093797206879, "timesteps_since_restore": 1040000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.86, "ram_util_percent": 14.255999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 299.22356778448585, "action_adversary": -299.22356778448585}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7286432751732845, "mean_processing_ms": 2.4509313325816002, "mean_inference_ms": 0.9634518641892353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1058304, "num_steps_sampled": 1060000, "sample_time_ms": 12650.593, "load_time_ms": 34.396, "grad_time_ms": 4983.409, "update_time_ms": 7.943, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 361.03216552734375, "policy_loss": -0.012645065784454346, "vf_loss": 361.0447692871094, "vf_explained_var": 0.19636893272399902, "kl": 0.019234810024499893, "entropy": 30.718936920166016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 360.98974609375, "policy_loss": -0.006326753180474043, "vf_loss": 360.99603271484375, "vf_explained_var": 0.1913640797138214, "kl": 0.03555774688720703, "entropy": 2.260650157928467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1060000, "episodes_total": 2128, "training_iteration": 53, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-41-25", "timestamp": 1567647685, "time_this_iter_s": 17.551010608673096, "time_total_s": 960.460390329361, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184229d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 960.460390329361, "timesteps_since_restore": 1060000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.471999999999998, "ram_util_percent": 14.335999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 297.38213619283755, "action_adversary": -297.38213619283755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.705649012476324, "mean_processing_ms": 2.450447652552595, "mean_inference_ms": 0.9632538077877311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1078272, "num_steps_sampled": 1080000, "sample_time_ms": 12637.755, "load_time_ms": 34.467, "grad_time_ms": 4982.294, "update_time_ms": 7.71, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 367.021240234375, "policy_loss": -0.013660178519785404, "vf_loss": 367.034912109375, "vf_explained_var": 0.18603721261024475, "kl": 0.01630236767232418, "entropy": 30.71727180480957, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 366.2967529296875, "policy_loss": -0.0019745174795389175, "vf_loss": 366.2987365722656, "vf_explained_var": 0.1867244690656662, "kl": 0.013793227262794971, "entropy": 2.262364387512207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1080000, "episodes_total": 2167, "training_iteration": 54, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-41-42", "timestamp": 1567647702, "time_this_iter_s": 17.573540925979614, "time_total_s": 978.0339312553406, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518416158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 978.0339312553406, "timesteps_since_restore": 1080000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.457692307692312, "ram_util_percent": 14.26153846153846}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 298.95809384053814, "action_adversary": -298.95809384053814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.721029143825707, "mean_processing_ms": 2.450164643865475, "mean_inference_ms": 0.963037265650275}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1098240, "num_steps_sampled": 1100000, "sample_time_ms": 12612.789, "load_time_ms": 34.455, "grad_time_ms": 4982.314, "update_time_ms": 7.616, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 371.8553771972656, "policy_loss": -0.012930774129927158, "vf_loss": 371.8682861328125, "vf_explained_var": 0.19815024733543396, "kl": 0.018232498317956924, "entropy": 30.684833526611328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 370.2785339355469, "policy_loss": -0.0035148097667843103, "vf_loss": 370.28204345703125, "vf_explained_var": 0.195819690823555, "kl": 0.014504649676382542, "entropy": 2.2335429191589355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1100000, "episodes_total": 2208, "training_iteration": 55, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-42-00", "timestamp": 1567647720, "time_this_iter_s": 17.573896646499634, "time_total_s": 995.6078279018402, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b793ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 995.6078279018402, "timesteps_since_restore": 1100000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.164, "ram_util_percent": 14.335999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.3382031952586, "action_adversary": -300.3382031952586}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.705081232111877, "mean_processing_ms": 2.4501983289880553, "mean_inference_ms": 0.9626784788662266}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118208, "num_steps_sampled": 1120000, "sample_time_ms": 12570.624, "load_time_ms": 34.513, "grad_time_ms": 4982.963, "update_time_ms": 7.571, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 376.2942810058594, "policy_loss": -0.014671843498945236, "vf_loss": 376.3089294433594, "vf_explained_var": 0.20037470757961273, "kl": 0.01813657581806183, "entropy": 30.663169860839844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 374.6512756347656, "policy_loss": -0.0024656534660607576, "vf_loss": 374.65374755859375, "vf_explained_var": 0.196807399392128, "kl": 0.01340443640947342, "entropy": 2.2380664348602295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1120000, "episodes_total": 2248, "training_iteration": 56, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-42-18", "timestamp": 1567647738, "time_this_iter_s": 17.470404148101807, "time_total_s": 1013.078232049942, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b776b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1013.078232049942, "timesteps_since_restore": 1120000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.016, "ram_util_percent": 14.328}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.6660090792804, "action_adversary": -300.6660090792804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7190496569528593, "mean_processing_ms": 2.4501709543850194, "mean_inference_ms": 0.9624110534324859}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1138176, "num_steps_sampled": 1140000, "sample_time_ms": 12566.342, "load_time_ms": 34.489, "grad_time_ms": 4983.534, "update_time_ms": 7.525, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 389.6815490722656, "policy_loss": -0.01333535648882389, "vf_loss": 389.69482421875, "vf_explained_var": 0.20548062026500702, "kl": 0.017113685607910156, "entropy": 30.67734718322754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 388.86859130859375, "policy_loss": -0.0006049829535186291, "vf_loss": 388.86920166015625, "vf_explained_var": 0.2097831666469574, "kl": 0.010846101678907871, "entropy": 2.2236719131469727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1140000, "episodes_total": 2288, "training_iteration": 57, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-42-35", "timestamp": 1567647755, "time_this_iter_s": 17.72861337661743, "time_total_s": 1030.8068454265594, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b758f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1030.8068454265594, "timesteps_since_restore": 1140000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.48, "ram_util_percent": 14.232000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 299.80737599388596, "action_adversary": -299.80737599388596}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7080895091524684, "mean_processing_ms": 2.449859380915362, "mean_inference_ms": 0.9623914200823365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1158144, "num_steps_sampled": 1160000, "sample_time_ms": 12586.947, "load_time_ms": 34.647, "grad_time_ms": 4985.205, "update_time_ms": 7.534, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 383.611572265625, "policy_loss": -0.013506472110748291, "vf_loss": 383.6250915527344, "vf_explained_var": 0.1994898021221161, "kl": 0.01789563149213791, "entropy": 30.604082107543945, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 385.58935546875, "policy_loss": -0.0021854734513908625, "vf_loss": 385.591552734375, "vf_explained_var": 0.19754505157470703, "kl": 0.01204682793468237, "entropy": 2.1977622509002686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1160000, "episodes_total": 2327, "training_iteration": 58, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-42-53", "timestamp": 1567647773, "time_this_iter_s": 17.79517650604248, "time_total_s": 1048.602021932602, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518454378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1048.602021932602, "timesteps_since_restore": 1160000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.696000000000005, "ram_util_percent": 14.259999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 300.3867742050202, "action_adversary": -300.3867742050202}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7079133351119618, "mean_processing_ms": 2.4500164695737228, "mean_inference_ms": 0.9614986681841713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1178112, "num_steps_sampled": 1180000, "sample_time_ms": 12598.108, "load_time_ms": 34.6, "grad_time_ms": 4984.54, "update_time_ms": 7.59, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 411.03118896484375, "policy_loss": -0.014998900704085827, "vf_loss": 411.046142578125, "vf_explained_var": 0.19990748167037964, "kl": 0.01787068136036396, "entropy": 30.503252029418945, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 411.8967590332031, "policy_loss": -0.0014953032368794084, "vf_loss": 411.8982238769531, "vf_explained_var": 0.19160303473472595, "kl": 0.01578727550804615, "entropy": 2.201805591583252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1180000, "episodes_total": 2369, "training_iteration": 59, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-43-11", "timestamp": 1567647791, "time_this_iter_s": 17.813159942626953, "time_total_s": 1066.4151818752289, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183eaea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1066.4151818752289, "timesteps_since_restore": 1180000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 29.253846153846155, "ram_util_percent": 14.296153846153844}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 301.0887496998198, "action_adversary": -301.0887496998198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6873169887259474, "mean_processing_ms": 2.449979056894609, "mean_inference_ms": 0.9612855316880156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1198080, "num_steps_sampled": 1200000, "sample_time_ms": 12578.542, "load_time_ms": 34.607, "grad_time_ms": 4985.594, "update_time_ms": 7.644, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 398.27935791015625, "policy_loss": -0.011772084049880505, "vf_loss": 398.2911071777344, "vf_explained_var": 0.2036006897687912, "kl": 0.01597411558032036, "entropy": 30.453901290893555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 399.8883361816406, "policy_loss": -0.0017502885311841965, "vf_loss": 399.89013671875, "vf_explained_var": 0.20079180598258972, "kl": 0.015031111426651478, "entropy": 2.1919302940368652, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1200000, "episodes_total": 2407, "training_iteration": 60, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-43-29", "timestamp": 1567647809, "time_this_iter_s": 17.565566062927246, "time_total_s": 1083.9807479381561, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184287b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1083.9807479381561, "timesteps_since_restore": 1200000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.896000000000004, "ram_util_percent": 14.36}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 300.6527987364489, "action_adversary": -300.6527987364489}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.692161081024515, "mean_processing_ms": 2.4498506658059407, "mean_inference_ms": 0.960937326346932}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1218048, "num_steps_sampled": 1220000, "sample_time_ms": 12556.462, "load_time_ms": 34.628, "grad_time_ms": 4985.146, "update_time_ms": 7.697, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 421.0989685058594, "policy_loss": -0.012459985911846161, "vf_loss": 421.11138916015625, "vf_explained_var": 0.1893613189458847, "kl": 0.01712590828537941, "entropy": 30.4079532623291, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 421.0556945800781, "policy_loss": -0.003546773921698332, "vf_loss": 421.0592041015625, "vf_explained_var": 0.18700073659420013, "kl": 0.016242537647485733, "entropy": 2.212451219558716, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1220000, "episodes_total": 2448, "training_iteration": 61, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-43-46", "timestamp": 1567647826, "time_this_iter_s": 17.403842210769653, "time_total_s": 1101.3845901489258, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184258c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1101.3845901489258, "timesteps_since_restore": 1220000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.452, "ram_util_percent": 14.271999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 302.5532802013897, "action_adversary": -302.5532802013897}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.677871265247219, "mean_processing_ms": 2.449357296500361, "mean_inference_ms": 0.9614237513713596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1238016, "num_steps_sampled": 1240000, "sample_time_ms": 12545.065, "load_time_ms": 34.714, "grad_time_ms": 4985.483, "update_time_ms": 7.735, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 421.8699035644531, "policy_loss": -0.014731960371136665, "vf_loss": 421.8846130371094, "vf_explained_var": 0.19094988703727722, "kl": 0.019464073702692986, "entropy": 30.3405818939209, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 421.7697448730469, "policy_loss": -0.0034222197718918324, "vf_loss": 421.77313232421875, "vf_explained_var": 0.19242335855960846, "kl": 0.01942494884133339, "entropy": 2.2169508934020996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1240000, "episodes_total": 2487, "training_iteration": 62, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-44-03", "timestamp": 1567647843, "time_this_iter_s": 17.415199995040894, "time_total_s": 1118.7997901439667, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518425c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1118.7997901439667, "timesteps_since_restore": 1240000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.679166666666664, "ram_util_percent": 14.329166666666666}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 301.40230516759914, "action_adversary": -301.40230516759914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.689141441669508, "mean_processing_ms": 2.4489592453231794, "mean_inference_ms": 0.960909307472064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1257984, "num_steps_sampled": 1260000, "sample_time_ms": 12555.334, "load_time_ms": 34.675, "grad_time_ms": 4986.381, "update_time_ms": 7.65, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 439.6165771484375, "policy_loss": -0.012597056105732918, "vf_loss": 439.62921142578125, "vf_explained_var": 0.19332918524742126, "kl": 0.016750749200582504, "entropy": 30.3381404876709, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 439.2380676269531, "policy_loss": -0.0014092277269810438, "vf_loss": 439.2394714355469, "vf_explained_var": 0.19386620819568634, "kl": 0.015176038257777691, "entropy": 2.2014832496643066, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1260000, "episodes_total": 2528, "training_iteration": 63, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-44-21", "timestamp": 1567647861, "time_this_iter_s": 17.66207218170166, "time_total_s": 1136.4618623256683, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c6f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1136.4618623256683, "timesteps_since_restore": 1260000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.957692307692305, "ram_util_percent": 14.369230769230768}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 302.25309941004895, "action_adversary": -302.25309941004895}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.678524608308299, "mean_processing_ms": 2.448855146246401, "mean_inference_ms": 0.9607998528224525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277952, "num_steps_sampled": 1280000, "sample_time_ms": 12550.322, "load_time_ms": 34.347, "grad_time_ms": 4987.716, "update_time_ms": 7.603, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 440.46954345703125, "policy_loss": -0.01259589847177267, "vf_loss": 440.482177734375, "vf_explained_var": 0.19801773130893707, "kl": 0.017447829246520996, "entropy": 30.303348541259766, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 439.9256286621094, "policy_loss": -0.00027374157798476517, "vf_loss": 439.9258728027344, "vf_explained_var": 0.1998550444841385, "kl": 0.014625738374888897, "entropy": 2.224311351776123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1280000, "episodes_total": 2568, "training_iteration": 64, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-44-39", "timestamp": 1567647879, "time_this_iter_s": 17.533108711242676, "time_total_s": 1153.994971036911, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6fc158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1153.994971036911, "timesteps_since_restore": 1280000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 30.528, "ram_util_percent": 14.328}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 302.525900095045, "action_adversary": -302.525900095045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.691842188028389, "mean_processing_ms": 2.449206445104848, "mean_inference_ms": 0.9606510939503685}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297920, "num_steps_sampled": 1300000, "sample_time_ms": 12558.926, "load_time_ms": 34.351, "grad_time_ms": 4987.27, "update_time_ms": 7.639, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 458.2668151855469, "policy_loss": -0.01263850461691618, "vf_loss": 458.2794494628906, "vf_explained_var": 0.19189642369747162, "kl": 0.01783827319741249, "entropy": 30.247045516967773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 457.8566589355469, "policy_loss": -0.001594381406903267, "vf_loss": 457.8582763671875, "vf_explained_var": 0.19456396996974945, "kl": 0.013414447195827961, "entropy": 2.1727662086486816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1300000, "episodes_total": 2609, "training_iteration": 65, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-44-56", "timestamp": 1567647896, "time_this_iter_s": 17.6541748046875, "time_total_s": 1171.6491458415985, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6fc9d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1171.6491458415985, "timesteps_since_restore": 1300000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.276000000000003, "ram_util_percent": 14.364}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 303.33814814949363, "action_adversary": -303.33814814949363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6783172048212442, "mean_processing_ms": 2.44933421348954, "mean_inference_ms": 0.9605133381476179}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1317888, "num_steps_sampled": 1320000, "sample_time_ms": 12596.886, "load_time_ms": 34.358, "grad_time_ms": 4987.888, "update_time_ms": 7.667, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 452.10858154296875, "policy_loss": -0.012413525022566319, "vf_loss": 452.1210021972656, "vf_explained_var": 0.1956794261932373, "kl": 0.01570703648030758, "entropy": 30.19391632080078, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 454.27783203125, "policy_loss": -0.00047444819938391447, "vf_loss": 454.2782897949219, "vf_explained_var": 0.19322678446769714, "kl": 0.012327353470027447, "entropy": 2.1586737632751465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1320000, "episodes_total": 2648, "training_iteration": 66, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-45-14", "timestamp": 1567647914, "time_this_iter_s": 17.854508876800537, "time_total_s": 1189.503654718399, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b701b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1189.503654718399, "timesteps_since_restore": 1320000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.011999999999997, "ram_util_percent": 14.276}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 305.25169485750365, "action_adversary": -305.25169485750365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.687477266615451, "mean_processing_ms": 2.449262035868495, "mean_inference_ms": 0.9606493300233595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1337856, "num_steps_sampled": 1340000, "sample_time_ms": 12593.031, "load_time_ms": 34.302, "grad_time_ms": 4989.183, "update_time_ms": 7.732, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 475.0179748535156, "policy_loss": -0.012470133602619171, "vf_loss": 475.03033447265625, "vf_explained_var": 0.18870775401592255, "kl": 0.01769702322781086, "entropy": 30.19803237915039, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 478.5106201171875, "policy_loss": -0.0018622389761731029, "vf_loss": 478.51251220703125, "vf_explained_var": 0.18515965342521667, "kl": 0.017988907173275948, "entropy": 2.1589832305908203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1340000, "episodes_total": 2688, "training_iteration": 67, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-45-32", "timestamp": 1567647932, "time_this_iter_s": 17.702636241912842, "time_total_s": 1207.206290960312, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518431488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1207.206290960312, "timesteps_since_restore": 1340000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 29.303846153846152, "ram_util_percent": 14.33076923076923}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 304.6033904332646, "action_adversary": -304.6033904332646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.665169263492676, "mean_processing_ms": 2.4488437127646114, "mean_inference_ms": 0.9603810156060948}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1357824, "num_steps_sampled": 1360000, "sample_time_ms": 12544.662, "load_time_ms": 33.84, "grad_time_ms": 4989.02, "update_time_ms": 7.708, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 468.0314636230469, "policy_loss": -0.012366033159196377, "vf_loss": 468.04376220703125, "vf_explained_var": 0.19444651901721954, "kl": 0.016478903591632843, "entropy": 30.171825408935547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 471.5333557128906, "policy_loss": -0.002539781155064702, "vf_loss": 471.53594970703125, "vf_explained_var": 0.19719763100147247, "kl": 0.015504191629588604, "entropy": 2.1452808380126953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1360000, "episodes_total": 2727, "training_iteration": 68, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-45-49", "timestamp": 1567647949, "time_this_iter_s": 17.3052818775177, "time_total_s": 1224.5115728378296, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518436620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1224.5115728378296, "timesteps_since_restore": 1360000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.045833333333334, "ram_util_percent": 14.329166666666666}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 303.5378743721256, "action_adversary": -303.5378743721256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.671295162140465, "mean_processing_ms": 2.448457254676001, "mean_inference_ms": 0.9599216027957302}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377792, "num_steps_sampled": 1380000, "sample_time_ms": 12573.111, "load_time_ms": 33.845, "grad_time_ms": 4989.439, "update_time_ms": 7.688, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 491.2918701171875, "policy_loss": -0.013640119694173336, "vf_loss": 491.30560302734375, "vf_explained_var": 0.18739628791809082, "kl": 0.01877162791788578, "entropy": 30.12215232849121, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 494.640625, "policy_loss": -0.0012506479397416115, "vf_loss": 494.6419372558594, "vf_explained_var": 0.1840764284133911, "kl": 0.01604774221777916, "entropy": 2.0960655212402344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1380000, "episodes_total": 2768, "training_iteration": 69, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-46-07", "timestamp": 1567647967, "time_this_iter_s": 18.101120948791504, "time_total_s": 1242.612693786621, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518436ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1242.612693786621, "timesteps_since_restore": 1380000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.246153846153845, "ram_util_percent": 14.280769230769229}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 302.9477272388023, "action_adversary": -302.9477272388023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6547808767567447, "mean_processing_ms": 2.448232994753073, "mean_inference_ms": 0.9601478242692795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1397760, "num_steps_sampled": 1400000, "sample_time_ms": 12563.35, "load_time_ms": 33.851, "grad_time_ms": 4989.678, "update_time_ms": 7.658, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 492.1329040527344, "policy_loss": -0.013004517182707787, "vf_loss": 492.14593505859375, "vf_explained_var": 0.19582340121269226, "kl": 0.018622277304530144, "entropy": 30.09432601928711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 495.1658630371094, "policy_loss": -0.0017774638254195452, "vf_loss": 495.16766357421875, "vf_explained_var": 0.19122527539730072, "kl": 0.016122516244649887, "entropy": 2.0959312915802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1400000, "episodes_total": 2807, "training_iteration": 70, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-46-25", "timestamp": 1567647985, "time_this_iter_s": 17.46944570541382, "time_total_s": 1260.082139492035, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183710d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1260.082139492035, "timesteps_since_restore": 1400000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 31.516000000000005, "ram_util_percent": 14.296}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 305.7363716843793, "action_adversary": -305.7363716843793}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.668161697319289, "mean_processing_ms": 2.4482611281635873, "mean_inference_ms": 0.9597473038129597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1417728, "num_steps_sampled": 1420000, "sample_time_ms": 12580.598, "load_time_ms": 33.871, "grad_time_ms": 4990.135, "update_time_ms": 7.639, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 511.97515869140625, "policy_loss": -0.011783180758357048, "vf_loss": 511.9869689941406, "vf_explained_var": 0.19328323006629944, "kl": 0.017927154898643494, "entropy": 30.039926528930664, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 514.0150146484375, "policy_loss": -3.125805233139545e-05, "vf_loss": 514.0150146484375, "vf_explained_var": 0.19009895622730255, "kl": 0.01471691858023405, "entropy": 2.1038365364074707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1420000, "episodes_total": 2848, "training_iteration": 71, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-46-42", "timestamp": 1567648002, "time_this_iter_s": 17.581108331680298, "time_total_s": 1277.6632478237152, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518371950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1277.6632478237152, "timesteps_since_restore": 1420000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.619999999999994, "ram_util_percent": 14.283999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 307.5153514939612, "action_adversary": -307.5153514939612}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.663924148293799, "mean_processing_ms": 2.4485100989251096, "mean_inference_ms": 0.9594877853033225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1437696, "num_steps_sampled": 1440000, "sample_time_ms": 12613.452, "load_time_ms": 33.471, "grad_time_ms": 4989.252, "update_time_ms": 7.734, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 518.540283203125, "policy_loss": -0.012454338371753693, "vf_loss": 518.5526733398438, "vf_explained_var": 0.1973714530467987, "kl": 0.017810145393013954, "entropy": 30.075414657592773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 519.4368896484375, "policy_loss": -0.0003973532293457538, "vf_loss": 519.4373168945312, "vf_explained_var": 0.20304621756076813, "kl": 0.016534464433789253, "entropy": 2.0733325481414795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1440000, "episodes_total": 2889, "training_iteration": 72, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-47-00", "timestamp": 1567648020, "time_this_iter_s": 17.732959985733032, "time_total_s": 1295.3962078094482, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518381ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1295.3962078094482, "timesteps_since_restore": 1440000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 31.56, "ram_util_percent": 14.328}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 307.46059143404574, "action_adversary": -307.46059143404574}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.672206041408633, "mean_processing_ms": 2.448611606405344, "mean_inference_ms": 0.9597928746309927}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1457664, "num_steps_sampled": 1460000, "sample_time_ms": 12633.528, "load_time_ms": 33.468, "grad_time_ms": 4988.028, "update_time_ms": 7.785, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 513.269775390625, "policy_loss": -0.012756550684571266, "vf_loss": 513.2825317382812, "vf_explained_var": 0.19855576753616333, "kl": 0.017444834113121033, "entropy": 30.00983428955078, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 514.2110595703125, "policy_loss": -0.00025662503321655095, "vf_loss": 514.2113037109375, "vf_explained_var": 0.19935253262519836, "kl": 0.01792886108160019, "entropy": 2.066106081008911, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1460000, "episodes_total": 2928, "training_iteration": 73, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-47-18", "timestamp": 1567648038, "time_this_iter_s": 17.850886583328247, "time_total_s": 1313.2470943927765, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518389400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1313.2470943927765, "timesteps_since_restore": 1460000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 30.43846153846154, "ram_util_percent": 14.323076923076922}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 305.9622852325499, "action_adversary": -305.9622852325499}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.671313423196078, "mean_processing_ms": 2.448789886372219, "mean_inference_ms": 0.9599517693510711}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477632, "num_steps_sampled": 1480000, "sample_time_ms": 12664.987, "load_time_ms": 33.785, "grad_time_ms": 4988.19, "update_time_ms": 7.78, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 544.1373291015625, "policy_loss": -0.013999245129525661, "vf_loss": 544.1513061523438, "vf_explained_var": 0.1919025480747223, "kl": 0.01673738844692707, "entropy": 30.008472442626953, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 542.3424682617188, "policy_loss": -0.00013083640078548342, "vf_loss": 542.3425903320312, "vf_explained_var": 0.1959507167339325, "kl": 0.01448081061244011, "entropy": 2.0479986667633057, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1480000, "episodes_total": 2969, "training_iteration": 74, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-47-36", "timestamp": 1567648056, "time_this_iter_s": 17.853453397750854, "time_total_s": 1331.1005477905273, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518398598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1331.1005477905273, "timesteps_since_restore": 1480000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 31.204, "ram_util_percent": 14.296}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 306.9585746159283, "action_adversary": -306.9585746159283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.662586037806622, "mean_processing_ms": 2.448676470312932, "mean_inference_ms": 0.9604689782933462}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1497600, "num_steps_sampled": 1500000, "sample_time_ms": 12691.899, "load_time_ms": 33.794, "grad_time_ms": 4989.666, "update_time_ms": 7.832, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 539.5498657226562, "policy_loss": -0.012233613058924675, "vf_loss": 539.5620727539062, "vf_explained_var": 0.19395913183689117, "kl": 0.01573425717651844, "entropy": 29.98240852355957, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 542.1604614257812, "policy_loss": -0.00025914417346939445, "vf_loss": 542.1607666015625, "vf_explained_var": 0.19718044996261597, "kl": 0.018869947642087936, "entropy": 2.0112905502319336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1500000, "episodes_total": 3008, "training_iteration": 75, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-47-54", "timestamp": 1567648074, "time_this_iter_s": 17.939133405685425, "time_total_s": 1349.0396811962128, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518371b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1349.0396811962128, "timesteps_since_restore": 1500000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.111538461538466, "ram_util_percent": 14.365384615384615}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 308.23699845208563, "action_adversary": -308.23699845208563}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.67007171674956, "mean_processing_ms": 2.4486302379600944, "mean_inference_ms": 0.9605231887810356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1517568, "num_steps_sampled": 1520000, "sample_time_ms": 12701.102, "load_time_ms": 33.749, "grad_time_ms": 4989.184, "update_time_ms": 7.797, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 559.9390258789062, "policy_loss": -0.012717798352241516, "vf_loss": 559.9517211914062, "vf_explained_var": 0.19523143768310547, "kl": 0.018076252192258835, "entropy": 29.969200134277344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 562.0671997070312, "policy_loss": -0.0010742818703874946, "vf_loss": 562.0682373046875, "vf_explained_var": 0.19261209666728973, "kl": 0.0236650500446558, "entropy": 1.9953405857086182, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1520000, "episodes_total": 3049, "training_iteration": 76, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-48-12", "timestamp": 1567648092, "time_this_iter_s": 17.940534114837646, "time_total_s": 1366.9802153110504, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b87cbf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1366.9802153110504, "timesteps_since_restore": 1520000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 30.34615384615385, "ram_util_percent": 14.307692307692305}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 307.5743398001925, "action_adversary": -307.5743398001925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6613879701824295, "mean_processing_ms": 2.4484905532123764, "mean_inference_ms": 0.9609205230521407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1537536, "num_steps_sampled": 1540000, "sample_time_ms": 12724.745, "load_time_ms": 34.034, "grad_time_ms": 4987.567, "update_time_ms": 7.723, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 552.7741088867188, "policy_loss": -0.011366273276507854, "vf_loss": 552.7855834960938, "vf_explained_var": 0.1974264234304428, "kl": 0.015922952443361282, "entropy": 29.931697845458984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 554.6248779296875, "policy_loss": 0.0005703230272047222, "vf_loss": 554.6243286132812, "vf_explained_var": 0.19476132094860077, "kl": 0.01384973805397749, "entropy": 2.005730390548706, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1540000, "episodes_total": 3088, "training_iteration": 77, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-48-30", "timestamp": 1567648110, "time_this_iter_s": 17.925435543060303, "time_total_s": 1384.9056508541107, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184360d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1384.9056508541107, "timesteps_since_restore": 1540000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 31.224, "ram_util_percent": 14.303999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 305.7035605673918, "action_adversary": -305.7035605673918}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.668771865663358, "mean_processing_ms": 2.448521623101427, "mean_inference_ms": 0.9607895216219601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1557504, "num_steps_sampled": 1560000, "sample_time_ms": 12783.007, "load_time_ms": 34.343, "grad_time_ms": 4986.323, "update_time_ms": 7.688, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 586.3458251953125, "policy_loss": -0.013485029339790344, "vf_loss": 586.359375, "vf_explained_var": 0.1973990648984909, "kl": 0.01836858130991459, "entropy": 29.906143188476562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 584.3980102539062, "policy_loss": -6.219515489647165e-05, "vf_loss": 584.3980102539062, "vf_explained_var": 0.19712133705615997, "kl": 0.017720749601721764, "entropy": 1.9828908443450928, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1560000, "episodes_total": 3129, "training_iteration": 78, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-48-48", "timestamp": 1567648128, "time_this_iter_s": 17.877766132354736, "time_total_s": 1402.7834169864655, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183816a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1402.7834169864655, "timesteps_since_restore": 1560000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.311538461538458, "ram_util_percent": 14.307692307692308}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 305.70575299027104, "action_adversary": -305.70575299027104}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.660152667995736, "mean_processing_ms": 2.448404290107393, "mean_inference_ms": 0.9611601569322105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1577472, "num_steps_sampled": 1580000, "sample_time_ms": 12767.508, "load_time_ms": 34.383, "grad_time_ms": 4987.02, "update_time_ms": 7.643, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 574.9644165039062, "policy_loss": -0.012269626371562481, "vf_loss": 574.9766845703125, "vf_explained_var": 0.1947336196899414, "kl": 0.016909608617424965, "entropy": 29.810604095458984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 576.7623901367188, "policy_loss": -0.00032977646333165467, "vf_loss": 576.7626953125, "vf_explained_var": 0.1955273151397705, "kl": 0.024095386266708374, "entropy": 1.957627534866333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1580000, "episodes_total": 3168, "training_iteration": 79, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-49-06", "timestamp": 1567648146, "time_this_iter_s": 17.955404043197632, "time_total_s": 1420.738821029663, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518428c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1420.738821029663, "timesteps_since_restore": 1580000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 31.768, "ram_util_percent": 14.311999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 303.706424608492, "action_adversary": -303.706424608492}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.667625895542086, "mean_processing_ms": 2.448377909421465, "mean_inference_ms": 0.961000200734157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1597440, "num_steps_sampled": 1600000, "sample_time_ms": 12808.862, "load_time_ms": 34.379, "grad_time_ms": 4984.888, "update_time_ms": 7.6, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 603.3949584960938, "policy_loss": -0.01282157190144062, "vf_loss": 603.4077758789062, "vf_explained_var": 0.18809445202350616, "kl": 0.016376394778490067, "entropy": 29.759414672851562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 601.1100463867188, "policy_loss": -0.0011910059256479144, "vf_loss": 601.1112060546875, "vf_explained_var": 0.1890561878681183, "kl": 0.02019137516617775, "entropy": 1.9317861795425415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1600000, "episodes_total": 3209, "training_iteration": 80, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-49-24", "timestamp": 1567648164, "time_this_iter_s": 17.860676288604736, "time_total_s": 1438.5994973182678, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183eab70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1438.5994973182678, "timesteps_since_restore": 1600000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.096153846153847, "ram_util_percent": 14.315384615384612}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 302.5325536019847, "action_adversary": -302.5325536019847}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.658968199919716, "mean_processing_ms": 2.4482774215322105, "mean_inference_ms": 0.9612791496663662}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1617408, "num_steps_sampled": 1620000, "sample_time_ms": 12836.646, "load_time_ms": 34.355, "grad_time_ms": 4985.727, "update_time_ms": 7.619, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 601.2765502929688, "policy_loss": -0.012476599775254726, "vf_loss": 601.2890625, "vf_explained_var": 0.18897946178913116, "kl": 0.016667913645505905, "entropy": 29.74846649169922, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 600.3074951171875, "policy_loss": -0.0004142268735449761, "vf_loss": 600.3079223632812, "vf_explained_var": 0.1892758458852768, "kl": 0.017410079017281532, "entropy": 1.9483059644699097, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1620000, "episodes_total": 3248, "training_iteration": 81, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-49-41", "timestamp": 1567648181, "time_this_iter_s": 17.86764907836914, "time_total_s": 1456.467146396637, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184548c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1456.467146396637, "timesteps_since_restore": 1620000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 31.484, "ram_util_percent": 14.315999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 302.1571571009749, "action_adversary": -302.1571571009749}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.666344409830012, "mean_processing_ms": 2.448344422869519, "mean_inference_ms": 0.9610688482049534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1637376, "num_steps_sampled": 1640000, "sample_time_ms": 12859.107, "load_time_ms": 34.692, "grad_time_ms": 4984.261, "update_time_ms": 7.535, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 631.30908203125, "policy_loss": -0.012857328169047832, "vf_loss": 631.3218994140625, "vf_explained_var": 0.19361324608325958, "kl": 0.01647144928574562, "entropy": 29.699321746826172, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 631.9468994140625, "policy_loss": 0.0016407236689701676, "vf_loss": 631.9453125, "vf_explained_var": 0.19169756770133972, "kl": 0.028306221589446068, "entropy": 1.9442342519760132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1640000, "episodes_total": 3289, "training_iteration": 82, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-49-59", "timestamp": 1567648199, "time_this_iter_s": 17.94666624069214, "time_total_s": 1474.413812637329, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184160d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1474.413812637329, "timesteps_since_restore": 1640000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 29.969230769230766, "ram_util_percent": 14.315384615384612}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 301.72889646992394, "action_adversary": -301.72889646992394}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.657727149442155, "mean_processing_ms": 2.448258706951267, "mean_inference_ms": 0.9614603847972757}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657344, "num_steps_sampled": 1660000, "sample_time_ms": 12859.417, "load_time_ms": 34.716, "grad_time_ms": 4984.369, "update_time_ms": 7.502, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 625.7501220703125, "policy_loss": -0.011945169419050217, "vf_loss": 625.7621459960938, "vf_explained_var": 0.1880262792110443, "kl": 0.016367711126804352, "entropy": 29.652652740478516, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 625.087646484375, "policy_loss": 0.00022030793479643762, "vf_loss": 625.0874633789062, "vf_explained_var": 0.18641161918640137, "kl": 0.02453789673745632, "entropy": 1.9287383556365967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1660000, "episodes_total": 3328, "training_iteration": 83, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-50-17", "timestamp": 1567648217, "time_this_iter_s": 17.854348182678223, "time_total_s": 1492.2681608200073, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b776ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1492.2681608200073, "timesteps_since_restore": 1660000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.956, "ram_util_percent": 14.324000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 304.3680123129047, "action_adversary": -304.3680123129047}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6698253525210744, "mean_processing_ms": 2.448068862141178, "mean_inference_ms": 0.9616856307317164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1677312, "num_steps_sampled": 1680000, "sample_time_ms": 12850.453, "load_time_ms": 34.692, "grad_time_ms": 4984.609, "update_time_ms": 7.523, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 638.7984008789062, "policy_loss": -0.011482487432658672, "vf_loss": 638.8098754882812, "vf_explained_var": 0.19374780356884003, "kl": 0.016164759173989296, "entropy": 29.64500617980957, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 639.2074584960938, "policy_loss": 0.0023033875040709972, "vf_loss": 639.205078125, "vf_explained_var": 0.18841201066970825, "kl": 0.027705205604434013, "entropy": 1.9313968420028687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1680000, "episodes_total": 3368, "training_iteration": 84, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-50-35", "timestamp": 1567648235, "time_this_iter_s": 17.765865802764893, "time_total_s": 1510.0340266227722, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184639d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1510.0340266227722, "timesteps_since_restore": 1680000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 30.065384615384616, "ram_util_percent": 14.430769230769231}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 305.45187111944267, "action_adversary": -305.45187111944267}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.664436453095036, "mean_processing_ms": 2.448028040900462, "mean_inference_ms": 0.9614100540370839}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1697280, "num_steps_sampled": 1700000, "sample_time_ms": 12843.233, "load_time_ms": 34.707, "grad_time_ms": 4983.606, "update_time_ms": 7.432, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 656.927978515625, "policy_loss": -0.011360686272382736, "vf_loss": 656.9393310546875, "vf_explained_var": 0.19232691824436188, "kl": 0.014027049764990807, "entropy": 29.67348289489746, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 661.3079833984375, "policy_loss": 0.0032707296777516603, "vf_loss": 661.3048095703125, "vf_explained_var": 0.18899227678775787, "kl": 0.030429210513830185, "entropy": 1.9372034072875977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1700000, "episodes_total": 3409, "training_iteration": 85, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-50-53", "timestamp": 1567648253, "time_this_iter_s": 17.85556983947754, "time_total_s": 1527.8895964622498, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518422510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1527.8895964622498, "timesteps_since_restore": 1700000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.883999999999997, "ram_util_percent": 14.352}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 306.94146258587966, "action_adversary": -306.94146258587966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6640093434108123, "mean_processing_ms": 2.4480747650365147, "mean_inference_ms": 0.9616014947986831}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1717248, "num_steps_sampled": 1720000, "sample_time_ms": 12846.715, "load_time_ms": 34.728, "grad_time_ms": 4983.858, "update_time_ms": 7.463, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 645.7448120117188, "policy_loss": -0.01166752353310585, "vf_loss": 645.7564697265625, "vf_explained_var": 0.19222399592399597, "kl": 0.014411996118724346, "entropy": 29.650453567504883, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 651.1264038085938, "policy_loss": 4.195746805635281e-05, "vf_loss": 651.1262817382812, "vf_explained_var": 0.18715636432170868, "kl": 0.01561764907091856, "entropy": 1.9395443201065063, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1720000, "episodes_total": 3448, "training_iteration": 86, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-51-11", "timestamp": 1567648271, "time_this_iter_s": 17.977476119995117, "time_total_s": 1545.8670725822449, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183cc400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1545.8670725822449, "timesteps_since_restore": 1720000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 31.165384615384614, "ram_util_percent": 14.36153846153846}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 307.1542267051667, "action_adversary": -307.1542267051667}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6634394119556317, "mean_processing_ms": 2.448135811752823, "mean_inference_ms": 0.9617310340991668}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1737216, "num_steps_sampled": 1740000, "sample_time_ms": 12833.938, "load_time_ms": 34.738, "grad_time_ms": 4983.12, "update_time_ms": 7.479, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 682.8897094726562, "policy_loss": -0.010455027222633362, "vf_loss": 682.9000854492188, "vf_explained_var": 0.18616001307964325, "kl": 0.014264176599681377, "entropy": 29.611478805541992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 687.4993896484375, "policy_loss": -0.0009058572468347847, "vf_loss": 687.5003051757812, "vf_explained_var": 0.1844019740819931, "kl": 0.01757451333105564, "entropy": 1.9245916604995728, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1740000, "episodes_total": 3489, "training_iteration": 87, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-51-29", "timestamp": 1567648289, "time_this_iter_s": 17.79046058654785, "time_total_s": 1563.6575331687927, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1563.6575331687927, "timesteps_since_restore": 1740000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 30.92, "ram_util_percent": 14.364}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 307.148438897727, "action_adversary": -307.148438897727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.654967362531796, "mean_processing_ms": 2.44801206193638, "mean_inference_ms": 0.9621347016411081}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1757184, "num_steps_sampled": 1760000, "sample_time_ms": 12835.022, "load_time_ms": 34.698, "grad_time_ms": 4984.435, "update_time_ms": 7.484, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 677.3631591796875, "policy_loss": -0.012208175845444202, "vf_loss": 677.3754272460938, "vf_explained_var": 0.18864405155181885, "kl": 0.015637699514627457, "entropy": 29.61191749572754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 678.5977172851562, "policy_loss": 0.004954732954502106, "vf_loss": 678.5927734375, "vf_explained_var": 0.19044238328933716, "kl": 0.03922988474369049, "entropy": 1.9093133211135864, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1760000, "episodes_total": 3528, "training_iteration": 88, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-51-47", "timestamp": 1567648307, "time_this_iter_s": 17.901659727096558, "time_total_s": 1581.5591928958893, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b880378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1581.5591928958893, "timesteps_since_restore": 1760000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.08846153846154, "ram_util_percent": 14.353846153846156}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 304.707814728733, "action_adversary": -304.707814728733}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.666837747376783, "mean_processing_ms": 2.4478388448018524, "mean_inference_ms": 0.9622965000250064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1777152, "num_steps_sampled": 1780000, "sample_time_ms": 12815.4, "load_time_ms": 34.693, "grad_time_ms": 4982.099, "update_time_ms": 7.787, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 689.9817504882812, "policy_loss": -0.013746047392487526, "vf_loss": 689.9954833984375, "vf_explained_var": 0.19239655137062073, "kl": 0.016790088266134262, "entropy": 29.52907371520996, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 694.7197265625, "policy_loss": 0.004228207282721996, "vf_loss": 694.7154541015625, "vf_explained_var": 0.19056248664855957, "kl": 0.03521681949496269, "entropy": 1.939652681350708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1780000, "episodes_total": 3568, "training_iteration": 89, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-52-04", "timestamp": 1567648324, "time_this_iter_s": 17.737224817276, "time_total_s": 1599.2964177131653, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183bbea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1599.2964177131653, "timesteps_since_restore": 1780000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 30.220000000000006, "ram_util_percent": 14.443999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 303.02940739874686, "action_adversary": -303.02940739874686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.647004528898314, "mean_processing_ms": 2.4476967843038593, "mean_inference_ms": 0.9621695496611055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1797120, "num_steps_sampled": 1800000, "sample_time_ms": 12769.371, "load_time_ms": 34.408, "grad_time_ms": 4983.167, "update_time_ms": 7.808, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 699.25439453125, "policy_loss": -0.012443284504115582, "vf_loss": 699.266845703125, "vf_explained_var": 0.2032981663942337, "kl": 0.017096534371376038, "entropy": 29.500913619995117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 707.6425170898438, "policy_loss": 0.0009356018854305148, "vf_loss": 707.6415405273438, "vf_explained_var": 0.20089010894298553, "kl": 0.020268680527806282, "entropy": 1.920235514640808, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1800000, "episodes_total": 3608, "training_iteration": 90, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-52-22", "timestamp": 1567648342, "time_this_iter_s": 17.40938448905945, "time_total_s": 1616.7058022022247, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183988c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1616.7058022022247, "timesteps_since_restore": 1800000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.471999999999998, "ram_util_percent": 14.415999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 302.93642972507234, "action_adversary": -302.93642972507234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6529916419198343, "mean_processing_ms": 2.447659434922033, "mean_inference_ms": 0.9618433117913053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1817088, "num_steps_sampled": 1820000, "sample_time_ms": 12718.669, "load_time_ms": 34.402, "grad_time_ms": 4980.93, "update_time_ms": 7.839, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 709.5690307617188, "policy_loss": -0.013228350318968296, "vf_loss": 709.5821533203125, "vf_explained_var": 0.19947414100170135, "kl": 0.017036551609635353, "entropy": 29.49730110168457, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 723.3355102539062, "policy_loss": 0.0016500166384503245, "vf_loss": 723.3338623046875, "vf_explained_var": 0.19213122129440308, "kl": 0.01925833150744438, "entropy": 1.9160782098770142, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1820000, "episodes_total": 3648, "training_iteration": 91, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-52-39", "timestamp": 1567648359, "time_this_iter_s": 17.337509155273438, "time_total_s": 1634.0433113574982, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184311e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1634.0433113574982, "timesteps_since_restore": 1820000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 30.471999999999998, "ram_util_percent": 14.364}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 302.6753878945715, "action_adversary": -302.6753878945715}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.636476740204048, "mean_processing_ms": 2.4475945107769403, "mean_inference_ms": 0.9622366209933165}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837056, "num_steps_sampled": 1840000, "sample_time_ms": 12665.335, "load_time_ms": 34.406, "grad_time_ms": 4981.818, "update_time_ms": 7.775, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 715.0962524414062, "policy_loss": -0.013353862799704075, "vf_loss": 715.1094970703125, "vf_explained_var": 0.19950154423713684, "kl": 0.017000995576381683, "entropy": 29.409730911254883, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 723.3489990234375, "policy_loss": 0.0021185295190662146, "vf_loss": 723.346923828125, "vf_explained_var": 0.1992902308702469, "kl": 0.02640722319483757, "entropy": 1.8998465538024902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1840000, "episodes_total": 3687, "training_iteration": 92, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-52-57", "timestamp": 1567648377, "time_this_iter_s": 17.41978907585144, "time_total_s": 1651.4631004333496, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518438378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1651.4631004333496, "timesteps_since_restore": 1840000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.851999999999997, "ram_util_percent": 14.364}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 303.52096338737863, "action_adversary": -303.52096338737863}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.648813143087628, "mean_processing_ms": 2.44735580561915, "mean_inference_ms": 0.9618175241828711}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1857024, "num_steps_sampled": 1860000, "sample_time_ms": 12612.459, "load_time_ms": 34.408, "grad_time_ms": 4981.605, "update_time_ms": 7.794, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 751.5695190429688, "policy_loss": -0.009567426517605782, "vf_loss": 751.5790405273438, "vf_explained_var": 0.19322288036346436, "kl": 0.015017809346318245, "entropy": 29.389867782592773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 762.19873046875, "policy_loss": 0.004963940475136042, "vf_loss": 762.1937866210938, "vf_explained_var": 0.18834155797958374, "kl": 0.03564189001917839, "entropy": 1.871301531791687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1860000, "episodes_total": 3728, "training_iteration": 93, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-53-14", "timestamp": 1567648394, "time_this_iter_s": 17.325672149658203, "time_total_s": 1668.7887725830078, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518438bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1668.7887725830078, "timesteps_since_restore": 1860000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 31.2625, "ram_util_percent": 14.362500000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 301.51898909706796, "action_adversary": -301.51898909706796}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6389391046572688, "mean_processing_ms": 2.4472999235219213, "mean_inference_ms": 0.9620414796765249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1876992, "num_steps_sampled": 1880000, "sample_time_ms": 12582.18, "load_time_ms": 34.43, "grad_time_ms": 4980.916, "update_time_ms": 7.815, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 737.2880249023438, "policy_loss": -0.010846813209354877, "vf_loss": 737.2988891601562, "vf_explained_var": 0.19712825119495392, "kl": 0.014918070286512375, "entropy": 29.387256622314453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 745.7247314453125, "policy_loss": 0.004350351169705391, "vf_loss": 745.7203979492188, "vf_explained_var": 0.19684797525405884, "kl": 0.035100314766168594, "entropy": 1.8898018598556519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1880000, "episodes_total": 3768, "training_iteration": 94, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-53-31", "timestamp": 1567648411, "time_this_iter_s": 17.456483125686646, "time_total_s": 1686.2452557086945, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183e9d90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1686.2452557086945, "timesteps_since_restore": 1880000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.896000000000004, "ram_util_percent": 14.36}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.14105261276575, "action_adversary": -299.14105261276575}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.648233162054739, "mean_processing_ms": 2.4474271659416433, "mean_inference_ms": 0.9619247874464776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1896960, "num_steps_sampled": 1900000, "sample_time_ms": 12520.058, "load_time_ms": 34.459, "grad_time_ms": 4981.491, "update_time_ms": 7.84, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 756.2162475585938, "policy_loss": -0.012947012670338154, "vf_loss": 756.2291870117188, "vf_explained_var": 0.19532065093517303, "kl": 0.015937190502882004, "entropy": 29.39630889892578, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 763.223876953125, "policy_loss": 0.09202493727207184, "vf_loss": 763.130615234375, "vf_explained_var": 0.19285185635089874, "kl": 51.08145523071289, "entropy": 1.9529074430465698, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1900000, "episodes_total": 3808, "training_iteration": 95, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-53-49", "timestamp": 1567648429, "time_this_iter_s": 17.24156093597412, "time_total_s": 1703.4868166446686, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b8596a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1703.4868166446686, "timesteps_since_restore": 1900000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.348, "ram_util_percent": 14.36}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 301.1522343566692, "action_adversary": -301.1522343566692}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.635373397539408, "mean_processing_ms": 2.447549080694139, "mean_inference_ms": 0.9618989309474495}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1916928, "num_steps_sampled": 1920000, "sample_time_ms": 12484.351, "load_time_ms": 34.482, "grad_time_ms": 4981.128, "update_time_ms": 7.803, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 772.2349243164062, "policy_loss": -0.012721538543701172, "vf_loss": 772.2476196289062, "vf_explained_var": 0.17957550287246704, "kl": 0.016869796440005302, "entropy": 29.458282470703125, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 780.9824829101562, "policy_loss": 0.0004761925956699997, "vf_loss": 780.9819946289062, "vf_explained_var": 0.17513470351696014, "kl": 0.0246710404753685, "entropy": 1.7746388912200928, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1920000, "episodes_total": 3848, "training_iteration": 96, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-54-06", "timestamp": 1567648446, "time_this_iter_s": 17.617507219314575, "time_total_s": 1721.1043238639832, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6de840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1721.1043238639832, "timesteps_since_restore": 1920000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.112000000000002, "ram_util_percent": 14.364}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 302.3561422913684, "action_adversary": -302.3561422913684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.636054769926416, "mean_processing_ms": 2.447581627613591, "mean_inference_ms": 0.9616292838820238}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1936896, "num_steps_sampled": 1940000, "sample_time_ms": 12468.708, "load_time_ms": 34.181, "grad_time_ms": 4981.651, "update_time_ms": 7.841, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 774.8131713867188, "policy_loss": -0.011500846594572067, "vf_loss": 774.82470703125, "vf_explained_var": 0.18496035039424896, "kl": 0.014599228277802467, "entropy": 29.4155216217041, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 786.7920532226562, "policy_loss": 0.004305106587707996, "vf_loss": 786.7877807617188, "vf_explained_var": 0.17754778265953064, "kl": 0.034323859959840775, "entropy": 1.7743059396743774, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1940000, "episodes_total": 3888, "training_iteration": 97, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-54-24", "timestamp": 1567648464, "time_this_iter_s": 17.636515378952026, "time_total_s": 1738.7408392429352, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183a3158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1738.7408392429352, "timesteps_since_restore": 1940000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.52, "ram_util_percent": 14.427999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 307.40424791511765, "action_adversary": -307.40424791511765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.637789976521249, "mean_processing_ms": 2.44737114756885, "mean_inference_ms": 0.9619850606238459}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1956864, "num_steps_sampled": 1960000, "sample_time_ms": 12451.831, "load_time_ms": 34.168, "grad_time_ms": 4981.559, "update_time_ms": 7.954, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 783.9976196289062, "policy_loss": -0.013018171302974224, "vf_loss": 784.0105590820312, "vf_explained_var": 0.1808532029390335, "kl": 0.01767760142683983, "entropy": 29.348779678344727, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 792.9579467773438, "policy_loss": -0.0006435570539906621, "vf_loss": 792.9585571289062, "vf_explained_var": 0.1790439337491989, "kl": 0.022754188627004623, "entropy": 1.7870346307754517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1960000, "episodes_total": 3928, "training_iteration": 98, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-54-42", "timestamp": 1567648482, "time_this_iter_s": 17.7333402633667, "time_total_s": 1756.4741795063019, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ac2f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1756.4741795063019, "timesteps_since_restore": 1960000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.573076923076922, "ram_util_percent": 14.492307692307692}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 307.2373444726925, "action_adversary": -307.2373444726925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.63334905160948, "mean_processing_ms": 2.4474762285389007, "mean_inference_ms": 0.9613460005511311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1976832, "num_steps_sampled": 1980000, "sample_time_ms": 12426.438, "load_time_ms": 34.185, "grad_time_ms": 4982.678, "update_time_ms": 7.691, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 785.6641235351562, "policy_loss": -0.012121735140681267, "vf_loss": 785.67626953125, "vf_explained_var": 0.18208812177181244, "kl": 0.01773577556014061, "entropy": 29.35133171081543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 799.8882446289062, "policy_loss": 0.0006600136985071003, "vf_loss": 799.8876953125, "vf_explained_var": 0.17351077497005463, "kl": 0.03164249658584595, "entropy": 1.7554196119308472, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1980000, "episodes_total": 3968, "training_iteration": 99, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-54-59", "timestamp": 1567648499, "time_this_iter_s": 17.491549968719482, "time_total_s": 1773.9657294750214, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183acb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1773.9657294750214, "timesteps_since_restore": 1980000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.40833333333333, "ram_util_percent": 14.491666666666667}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 306.53886921419235, "action_adversary": -306.53886921419235}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.630248196771031, "mean_processing_ms": 2.447404755147828, "mean_inference_ms": 0.9612941456577044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1996800, "num_steps_sampled": 2000000, "sample_time_ms": 12447.922, "load_time_ms": 34.467, "grad_time_ms": 4981.392, "update_time_ms": 7.68, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 817.1268310546875, "policy_loss": -0.01258202362805605, "vf_loss": 817.139404296875, "vf_explained_var": 0.1727306991815567, "kl": 0.016652893275022507, "entropy": 29.34114646911621, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 3.662109520519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 825.0817260742188, "policy_loss": 0.026564618572592735, "vf_loss": 825.05517578125, "vf_explained_var": 0.17335955798625946, "kl": 0.4291516840457916, "entropy": 1.7764215469360352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2000000, "episodes_total": 4008, "training_iteration": 100, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-55-17", "timestamp": 1567648517, "time_this_iter_s": 17.61465859413147, "time_total_s": 1791.5803880691528, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51833ed08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1791.5803880691528, "timesteps_since_restore": 2000000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 29.930769230769233, "ram_util_percent": 14.38846153846154}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 307.0635126252652, "action_adversary": -307.0635126252652}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6352091881953266, "mean_processing_ms": 2.4474924311570563, "mean_inference_ms": 0.9614649449723154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2016768, "num_steps_sampled": 2020000, "sample_time_ms": 12486.943, "load_time_ms": 34.447, "grad_time_ms": 4983.807, "update_time_ms": 7.711, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 812.8357543945312, "policy_loss": -0.012165680527687073, "vf_loss": 812.847900390625, "vf_explained_var": 0.17804092168807983, "kl": 0.016550520434975624, "entropy": 29.244810104370117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 821.5556640625, "policy_loss": 0.00027082531596533954, "vf_loss": 821.5553588867188, "vf_explained_var": 0.17275211215019226, "kl": 0.023702125996351242, "entropy": 1.7774215936660767, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2020000, "episodes_total": 4048, "training_iteration": 101, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-55-35", "timestamp": 1567648535, "time_this_iter_s": 17.75186777114868, "time_total_s": 1809.3322558403015, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6de620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1809.3322558403015, "timesteps_since_restore": 2020000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 30.38, "ram_util_percent": 14.376}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 307.4156678999132, "action_adversary": -307.4156678999132}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6276292200177753, "mean_processing_ms": 2.4472384146584214, "mean_inference_ms": 0.9610108485106275}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2036736, "num_steps_sampled": 2040000, "sample_time_ms": 12502.215, "load_time_ms": 34.362, "grad_time_ms": 4984.343, "update_time_ms": 7.702, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 825.3890991210938, "policy_loss": -0.012437857687473297, "vf_loss": 825.4015502929688, "vf_explained_var": 0.18374861776828766, "kl": 0.017822140827775, "entropy": 29.159019470214844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 828.6123657226562, "policy_loss": 0.002667259657755494, "vf_loss": 828.6097412109375, "vf_explained_var": 0.1817801296710968, "kl": 0.03067275881767273, "entropy": 1.755432367324829, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2040000, "episodes_total": 4088, "training_iteration": 102, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-55-52", "timestamp": 1567648552, "time_this_iter_s": 17.578043222427368, "time_total_s": 1826.9102990627289, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518398b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1826.9102990627289, "timesteps_since_restore": 2040000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 30.592, "ram_util_percent": 14.495999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 306.04516064757996, "action_adversary": -306.04516064757996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.636859813472637, "mean_processing_ms": 2.4473618933954846, "mean_inference_ms": 0.9609192197609654}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2056704, "num_steps_sampled": 2060000, "sample_time_ms": 12530.31, "load_time_ms": 34.382, "grad_time_ms": 4984.276, "update_time_ms": 7.736, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 860.1712646484375, "policy_loss": -0.011740632355213165, "vf_loss": 860.1829833984375, "vf_explained_var": 0.17307129502296448, "kl": 0.01565050706267357, "entropy": 29.129287719726562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 860.6675415039062, "policy_loss": 0.0012955695856362581, "vf_loss": 860.6663818359375, "vf_explained_var": 0.17410331964492798, "kl": 0.03024384379386902, "entropy": 1.7589406967163086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2060000, "episodes_total": 4129, "training_iteration": 103, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-56-10", "timestamp": 1567648570, "time_this_iter_s": 17.605379819869995, "time_total_s": 1844.5156788825989, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518398598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1844.5156788825989, "timesteps_since_restore": 2060000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 30.964000000000002, "ram_util_percent": 14.495999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 305.9188777308758, "action_adversary": -305.9188777308758}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6300658004705086, "mean_processing_ms": 2.447328446517629, "mean_inference_ms": 0.9613566117506818}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076672, "num_steps_sampled": 2080000, "sample_time_ms": 12560.317, "load_time_ms": 34.372, "grad_time_ms": 4984.117, "update_time_ms": 7.767, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 839.7842407226562, "policy_loss": -0.01162309106439352, "vf_loss": 839.7958984375, "vf_explained_var": 0.18321463465690613, "kl": 0.016706308349967003, "entropy": 29.022499084472656, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 844.3657836914062, "policy_loss": 0.0016261102864518762, "vf_loss": 844.3641967773438, "vf_explained_var": 0.1848803460597992, "kl": 0.03132658824324608, "entropy": 1.7675859928131104, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2080000, "episodes_total": 4168, "training_iteration": 104, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-56-28", "timestamp": 1567648588, "time_this_iter_s": 17.755460023880005, "time_total_s": 1862.2711389064789, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b880158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1862.2711389064789, "timesteps_since_restore": 2080000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.969230769230766, "ram_util_percent": 14.400000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 307.89276985740804, "action_adversary": -307.89276985740804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6373462378559025, "mean_processing_ms": 2.447261777131036, "mean_inference_ms": 0.9611859350262989}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2096640, "num_steps_sampled": 2100000, "sample_time_ms": 12581.922, "load_time_ms": 34.35, "grad_time_ms": 4984.113, "update_time_ms": 7.805, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 853.5374755859375, "policy_loss": -0.012830476276576519, "vf_loss": 853.5503540039062, "vf_explained_var": 0.17485320568084717, "kl": 0.016125759109854698, "entropy": 29.02808952331543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 852.7694091796875, "policy_loss": 0.002069680020213127, "vf_loss": 852.7674560546875, "vf_explained_var": 0.17610855400562286, "kl": 0.03157200664281845, "entropy": 1.7240670919418335, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2100000, "episodes_total": 4208, "training_iteration": 105, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-56-45", "timestamp": 1567648605, "time_this_iter_s": 17.456714630126953, "time_total_s": 1879.7278535366058, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b8801e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1879.7278535366058, "timesteps_since_restore": 2100000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 32.00416666666666, "ram_util_percent": 14.470833333333331}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 310.1849502109841, "action_adversary": -310.1849502109841}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.630020532947071, "mean_processing_ms": 2.4472632008852178, "mean_inference_ms": 0.9614512941726077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2116608, "num_steps_sampled": 2120000, "sample_time_ms": 12582.563, "load_time_ms": 34.353, "grad_time_ms": 4984.756, "update_time_ms": 7.866, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 842.3196411132812, "policy_loss": -0.012095385231077671, "vf_loss": 842.3316040039062, "vf_explained_var": 0.17529815435409546, "kl": 0.017292479053139687, "entropy": 28.99625015258789, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 843.5082397460938, "policy_loss": 0.0034553699661046267, "vf_loss": 843.5046997070312, "vf_explained_var": 0.17596088349819183, "kl": 0.0351581871509552, "entropy": 1.7486462593078613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2120000, "episodes_total": 4247, "training_iteration": 106, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-57-03", "timestamp": 1567648623, "time_this_iter_s": 17.633191108703613, "time_total_s": 1897.3610446453094, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1897.3610446453094, "timesteps_since_restore": 2120000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 29.9576923076923, "ram_util_percent": 14.5}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 308.31867189259475, "action_adversary": -308.31867189259475}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.63063653648072, "mean_processing_ms": 2.447042029406111, "mean_inference_ms": 0.960823403222029}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2136576, "num_steps_sampled": 2140000, "sample_time_ms": 12578.357, "load_time_ms": 34.445, "grad_time_ms": 4985.517, "update_time_ms": 7.887, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 890.0648193359375, "policy_loss": -0.01187781523913145, "vf_loss": 890.0765991210938, "vf_explained_var": 0.17654162645339966, "kl": 0.017185941338539124, "entropy": 28.987974166870117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 888.5114135742188, "policy_loss": 0.0033330577425658703, "vf_loss": 888.5079956054688, "vf_explained_var": 0.17627742886543274, "kl": 0.037367552518844604, "entropy": 1.7177640199661255, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2140000, "episodes_total": 4288, "training_iteration": 107, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-57-20", "timestamp": 1567648640, "time_this_iter_s": 17.603996753692627, "time_total_s": 1914.965041399002, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183cc2f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1914.965041399002, "timesteps_since_restore": 2140000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 30.555999999999997, "ram_util_percent": 14.456}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 308.85187448620417, "action_adversary": -308.85187448620417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6298108758757586, "mean_processing_ms": 2.447097963948545, "mean_inference_ms": 0.960775655376255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2156544, "num_steps_sampled": 2160000, "sample_time_ms": 12558.154, "load_time_ms": 34.442, "grad_time_ms": 4986.212, "update_time_ms": 7.8, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 883.4593505859375, "policy_loss": -0.012362015433609486, "vf_loss": 883.4715576171875, "vf_explained_var": 0.17064495384693146, "kl": 0.01667129434645176, "entropy": 29.00626564025879, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 5.493163916980848e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 881.1925048828125, "policy_loss": 0.05439285188913345, "vf_loss": 881.1373901367188, "vf_explained_var": 0.17553220689296722, "kl": 12.115229606628418, "entropy": 1.7671557664871216, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2160000, "episodes_total": 4328, "training_iteration": 108, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-57-38", "timestamp": 1567648658, "time_this_iter_s": 17.53759503364563, "time_total_s": 1932.5026364326477, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184221e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1932.5026364326477, "timesteps_since_restore": 2160000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.083999999999996, "ram_util_percent": 14.484000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 308.3412504190484, "action_adversary": -308.3412504190484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6205799137298373, "mean_processing_ms": 2.4470648178115093, "mean_inference_ms": 0.9608326594094103}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2176512, "num_steps_sampled": 2180000, "sample_time_ms": 12564.848, "load_time_ms": 34.191, "grad_time_ms": 4987.871, "update_time_ms": 7.806, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 904.15625, "policy_loss": -0.013705498538911343, "vf_loss": 904.1698608398438, "vf_explained_var": 0.17482933402061462, "kl": 0.017239002510905266, "entropy": 29.010814666748047, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 902.3887939453125, "policy_loss": 0.0035907947458326817, "vf_loss": 902.3851318359375, "vf_explained_var": 0.1752461940050125, "kl": 0.038101691752672195, "entropy": 1.677870512008667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2180000, "episodes_total": 4368, "training_iteration": 109, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-57-56", "timestamp": 1567648676, "time_this_iter_s": 17.57316517829895, "time_total_s": 1950.0758016109467, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518463d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1950.0758016109467, "timesteps_since_restore": 2180000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 30.72, "ram_util_percent": 14.492}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 308.89988060934803, "action_adversary": -308.89988060934803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.628328825128522, "mean_processing_ms": 2.447164064886579, "mean_inference_ms": 0.9606687327647773}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196480, "num_steps_sampled": 2200000, "sample_time_ms": 12561.871, "load_time_ms": 34.161, "grad_time_ms": 4989.753, "update_time_ms": 7.826, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 895.9226684570312, "policy_loss": -0.013644139282405376, "vf_loss": 895.936279296875, "vf_explained_var": 0.16666777431964874, "kl": 0.016906606033444405, "entropy": 28.99349594116211, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 895.0079345703125, "policy_loss": 0.0033506392501294613, "vf_loss": 895.0045776367188, "vf_explained_var": 0.16709542274475098, "kl": 0.051345404237508774, "entropy": 1.6482510566711426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2200000, "episodes_total": 4408, "training_iteration": 110, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-58-13", "timestamp": 1567648693, "time_this_iter_s": 17.602980136871338, "time_total_s": 1967.678781747818, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518454598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1967.678781747818, "timesteps_since_restore": 2200000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 31.172000000000004, "ram_util_percent": 14.488000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 309.45155238565775, "action_adversary": -309.45155238565775}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.626158789076239, "mean_processing_ms": 2.447065609865761, "mean_inference_ms": 0.9611568216968418}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2216448, "num_steps_sampled": 2220000, "sample_time_ms": 12558.509, "load_time_ms": 34.156, "grad_time_ms": 4986.666, "update_time_ms": 7.743, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 887.9729614257812, "policy_loss": -0.011579000391066074, "vf_loss": 887.984375, "vf_explained_var": 0.1623896062374115, "kl": 0.017042292281985283, "entropy": 28.946727752685547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0001235961972270161, "cur_lr": 4.999999873689376e-05, "total_loss": 887.5342407226562, "policy_loss": 0.003863536287099123, "vf_loss": 887.5304565429688, "vf_explained_var": 0.16644908487796783, "kl": 0.05229715630412102, "entropy": 1.650415062904358, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2220000, "episodes_total": 4447, "training_iteration": 111, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-58-31", "timestamp": 1567648711, "time_this_iter_s": 17.68599772453308, "time_total_s": 1985.364779472351, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ea840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1985.364779472351, "timesteps_since_restore": 2220000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 31.011999999999997, "ram_util_percent": 14.536000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 310.9589750180657, "action_adversary": -310.9589750180657}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6272174542718236, "mean_processing_ms": 2.446829287411638, "mean_inference_ms": 0.9605034991448842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2236416, "num_steps_sampled": 2240000, "sample_time_ms": 12556.022, "load_time_ms": 34.202, "grad_time_ms": 4985.618, "update_time_ms": 7.855, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 934.7696533203125, "policy_loss": -0.012251081876456738, "vf_loss": 934.7818603515625, "vf_explained_var": 0.16338753700256348, "kl": 0.01709107682108879, "entropy": 28.95639991760254, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0001853942812886089, "cur_lr": 4.999999873689376e-05, "total_loss": 935.5336303710938, "policy_loss": 0.0027995652053505182, "vf_loss": 935.5308227539062, "vf_explained_var": 0.16341239213943481, "kl": 0.032179269939661026, "entropy": 1.6686217784881592, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2240000, "episodes_total": 4488, "training_iteration": 112, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-58-48", "timestamp": 1567648728, "time_this_iter_s": 17.54511570930481, "time_total_s": 2002.9098951816559, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7a4488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2002.9098951816559, "timesteps_since_restore": 2240000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.688, "ram_util_percent": 14.5}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 312.38917205792114, "action_adversary": -312.38917205792114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.626714994984565, "mean_processing_ms": 2.446853134877727, "mean_inference_ms": 0.9604169087007915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2256384, "num_steps_sampled": 2260000, "sample_time_ms": 12544.178, "load_time_ms": 34.184, "grad_time_ms": 4986.333, "update_time_ms": 7.841, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 928.3229370117188, "policy_loss": -0.013049773871898651, "vf_loss": 928.3360595703125, "vf_explained_var": 0.15837733447551727, "kl": 0.016577061265707016, "entropy": 28.891983032226562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0001853942812886089, "cur_lr": 4.999999873689376e-05, "total_loss": 929.48486328125, "policy_loss": 0.024022093042731285, "vf_loss": 929.4607543945312, "vf_explained_var": 0.15707537531852722, "kl": 0.23385998606681824, "entropy": 1.6668905019760132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2260000, "episodes_total": 4528, "training_iteration": 113, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-59-06", "timestamp": 1567648746, "time_this_iter_s": 17.49309778213501, "time_total_s": 2020.402992963791, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184161e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2020.402992963791, "timesteps_since_restore": 2260000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 31.212, "ram_util_percent": 14.456000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 312.97057066529493, "action_adversary": -312.97057066529493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6175653979059557, "mean_processing_ms": 2.4467867412653574, "mean_inference_ms": 0.9604967602135761}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2276352, "num_steps_sampled": 2280000, "sample_time_ms": 12526.843, "load_time_ms": 34.197, "grad_time_ms": 4986.18, "update_time_ms": 7.769, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 952.5776977539062, "policy_loss": -0.012685960158705711, "vf_loss": 952.5902709960938, "vf_explained_var": 0.16162624955177307, "kl": 0.0176702868193388, "entropy": 28.799510955810547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0002780914364848286, "cur_lr": 4.999999873689376e-05, "total_loss": 958.2179565429688, "policy_loss": 0.0021220941562205553, "vf_loss": 958.2157592773438, "vf_explained_var": 0.15853790938854218, "kl": 0.03303776681423187, "entropy": 1.6306072473526, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2280000, "episodes_total": 4568, "training_iteration": 114, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-59-24", "timestamp": 1567648764, "time_this_iter_s": 17.57919478416443, "time_total_s": 2037.9821877479553, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518381488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2037.9821877479553, "timesteps_since_restore": 2280000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 31.208000000000002, "ram_util_percent": 14.456000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 312.32252098655607, "action_adversary": -312.32252098655607}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6258245268063, "mean_processing_ms": 2.446919075145382, "mean_inference_ms": 0.9603879601770424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2296320, "num_steps_sampled": 2300000, "sample_time_ms": 12530.534, "load_time_ms": 34.223, "grad_time_ms": 4984.835, "update_time_ms": 7.744, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 942.0340576171875, "policy_loss": -0.012127142399549484, "vf_loss": 942.0462036132812, "vf_explained_var": 0.1623053252696991, "kl": 0.0161964762955904, "entropy": 28.786190032958984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0002780914364848286, "cur_lr": 4.999999873689376e-05, "total_loss": 944.4993896484375, "policy_loss": 0.023652367293834686, "vf_loss": 944.4755859375, "vf_explained_var": 0.16361191868782043, "kl": 0.6070939302444458, "entropy": 1.6445146799087524, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2300000, "episodes_total": 4608, "training_iteration": 115, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-59-41", "timestamp": 1567648781, "time_this_iter_s": 17.481401920318604, "time_total_s": 2055.463589668274, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184360d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2055.463589668274, "timesteps_since_restore": 2300000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 31.396, "ram_util_percent": 14.536000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 310.3653152878231, "action_adversary": -310.3653152878231}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6260759474760613, "mean_processing_ms": 2.4470048095627566, "mean_inference_ms": 0.9604962148446782}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2316288, "num_steps_sampled": 2320000, "sample_time_ms": 12604.839, "load_time_ms": 34.182, "grad_time_ms": 4983.945, "update_time_ms": 7.674, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 970.4603271484375, "policy_loss": -0.013965804129838943, "vf_loss": 970.474365234375, "vf_explained_var": 0.14305731654167175, "kl": 0.016646526753902435, "entropy": 29.086509704589844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00041713714017532766, "cur_lr": 4.999999873689376e-05, "total_loss": 975.7067260742188, "policy_loss": 0.0016537478659301996, "vf_loss": 975.7051391601562, "vf_explained_var": 0.1425338089466095, "kl": 0.033858127892017365, "entropy": 1.6290003061294556, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2320000, "episodes_total": 4649, "training_iteration": 116, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_01-59-59", "timestamp": 1567648799, "time_this_iter_s": 18.36356496810913, "time_total_s": 2073.827154636383, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b87cae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2073.827154636383, "timesteps_since_restore": 2320000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 31.36923076923077, "ram_util_percent": 14.453846153846156}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 309.91562564134534, "action_adversary": -309.91562564134534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6295196527441593, "mean_processing_ms": 2.447146940079523, "mean_inference_ms": 0.9603595025052353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2336256, "num_steps_sampled": 2340000, "sample_time_ms": 12658.644, "load_time_ms": 34.413, "grad_time_ms": 4983.586, "update_time_ms": 7.681, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 935.7536010742188, "policy_loss": -0.013919389806687832, "vf_loss": 935.7674560546875, "vf_explained_var": 0.1472557932138443, "kl": 0.017117083072662354, "entropy": 28.993247985839844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00041713714017532766, "cur_lr": 4.999999873689376e-05, "total_loss": 935.6932983398438, "policy_loss": 0.0047253635711967945, "vf_loss": 935.6885986328125, "vf_explained_var": 0.15091148018836975, "kl": 0.04760710522532463, "entropy": 1.6406139135360718, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2340000, "episodes_total": 4688, "training_iteration": 117, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-00-18", "timestamp": 1567648818, "time_this_iter_s": 18.139907836914062, "time_total_s": 2091.967062473297, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518371268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2091.967062473297, "timesteps_since_restore": 2340000, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.284615384615385, "ram_util_percent": 14.465384615384616}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 310.4289328264863, "action_adversary": -310.4289328264863}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.635465459173113, "mean_processing_ms": 2.447181974076284, "mean_inference_ms": 0.9608795754227692}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2356224, "num_steps_sampled": 2360000, "sample_time_ms": 12711.98, "load_time_ms": 34.429, "grad_time_ms": 4982.16, "update_time_ms": 7.923, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 964.58251953125, "policy_loss": -0.013856063596904278, "vf_loss": 964.5963745117188, "vf_explained_var": 0.14301158487796783, "kl": 0.01576753333210945, "entropy": 29.02391242980957, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 966.0180053710938, "policy_loss": 0.002054068958386779, "vf_loss": 966.0159301757812, "vf_explained_var": 0.1428080052137375, "kl": 0.03280027210712433, "entropy": 1.6331067085266113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2360000, "episodes_total": 4728, "training_iteration": 118, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-00-36", "timestamp": 1567648836, "time_this_iter_s": 18.057756185531616, "time_total_s": 2110.0248186588287, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518431840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2110.0248186588287, "timesteps_since_restore": 2360000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 31.123076923076926, "ram_util_percent": 14.461538461538462}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 312.1054248677454, "action_adversary": -312.1054248677454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6287852643332803, "mean_processing_ms": 2.446989364642753, "mean_inference_ms": 0.961390313826075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2376192, "num_steps_sampled": 2380000, "sample_time_ms": 12783.042, "load_time_ms": 34.812, "grad_time_ms": 4980.428, "update_time_ms": 7.89, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 964.9917602539062, "policy_loss": -0.014269678853452206, "vf_loss": 965.0059814453125, "vf_explained_var": 0.1431512087583542, "kl": 0.018072137609124184, "entropy": 28.918704986572266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 966.3339233398438, "policy_loss": 0.003038067603483796, "vf_loss": 966.3309326171875, "vf_explained_var": 0.14642684161663055, "kl": 0.036076780408620834, "entropy": 1.6193907260894775, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2380000, "episodes_total": 4767, "training_iteration": 119, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-00-54", "timestamp": 1567648854, "time_this_iter_s": 18.270771503448486, "time_total_s": 2128.295590162277, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c6158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2128.295590162277, "timesteps_since_restore": 2380000, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 31.323076923076922, "ram_util_percent": 14.457692307692309}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 310.6363240761813, "action_adversary": -310.6363240761813}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.632471536371576, "mean_processing_ms": 2.4468103612932786, "mean_inference_ms": 0.9606156689932273}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2396160, "num_steps_sampled": 2400000, "sample_time_ms": 12832.554, "load_time_ms": 34.863, "grad_time_ms": 4979.929, "update_time_ms": 7.86, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1010.7908935546875, "policy_loss": -0.013865545392036438, "vf_loss": 1010.8048095703125, "vf_explained_var": 0.13611045479774475, "kl": 0.016690287739038467, "entropy": 28.798877716064453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 1007.5318603515625, "policy_loss": 0.0004890599520877004, "vf_loss": 1007.5313720703125, "vf_explained_var": 0.13818085193634033, "kl": 0.027099939063191414, "entropy": 1.629002332687378, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2400000, "episodes_total": 4808, "training_iteration": 120, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-01-12", "timestamp": 1567648872, "time_this_iter_s": 18.09303379058838, "time_total_s": 2146.3886239528656, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c32f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2146.3886239528656, "timesteps_since_restore": 2400000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 30.12307692307693, "ram_util_percent": 14.457692307692309}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 310.7968207470671, "action_adversary": -310.7968207470671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.635876421746585, "mean_processing_ms": 2.4468656472584214, "mean_inference_ms": 0.9608390471806203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2416128, "num_steps_sampled": 2420000, "sample_time_ms": 12879.25, "load_time_ms": 34.898, "grad_time_ms": 4981.767, "update_time_ms": 7.861, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 989.6476440429688, "policy_loss": -0.012448184192180634, "vf_loss": 989.6600341796875, "vf_explained_var": 0.14055313169956207, "kl": 0.01675347611308098, "entropy": 28.808080673217773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0006257056957110763, "cur_lr": 4.999999873689376e-05, "total_loss": 988.4223022460938, "policy_loss": 0.0050407168455421925, "vf_loss": 988.4172973632812, "vf_explained_var": 0.14173118770122528, "kl": 0.0600430890917778, "entropy": 1.5764336585998535, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2420000, "episodes_total": 4848, "training_iteration": 121, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-01-30", "timestamp": 1567648890, "time_this_iter_s": 18.172778129577637, "time_total_s": 2164.5614020824432, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c3ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2164.5614020824432, "timesteps_since_restore": 2420000, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 31.142307692307693, "ram_util_percent": 14.465384615384616}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 310.49722094423646, "action_adversary": -310.49722094423646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.641170428545477, "mean_processing_ms": 2.446671847887595, "mean_inference_ms": 0.9610141952931965}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2436096, "num_steps_sampled": 2440000, "sample_time_ms": 12935.875, "load_time_ms": 34.913, "grad_time_ms": 4982.481, "update_time_ms": 7.76, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 972.1287841796875, "policy_loss": -0.013438038527965546, "vf_loss": 972.1422119140625, "vf_explained_var": 0.1429748386144638, "kl": 0.01716911420226097, "entropy": 28.756465911865234, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0009385586017742753, "cur_lr": 4.999999873689376e-05, "total_loss": 969.8899536132812, "policy_loss": 0.0012885668547824025, "vf_loss": 969.8886108398438, "vf_explained_var": 0.14093662798404694, "kl": 0.0313834473490715, "entropy": 1.584140419960022, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2440000, "episodes_total": 4887, "training_iteration": 122, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-01-48", "timestamp": 1567648908, "time_this_iter_s": 18.115750074386597, "time_total_s": 2182.67715215683, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183498c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2182.67715215683, "timesteps_since_restore": 2440000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.896153846153844, "ram_util_percent": 14.457692307692309}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 310.6641111520835, "action_adversary": -310.6641111520835}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.634813147897185, "mean_processing_ms": 2.446825556246859, "mean_inference_ms": 0.9604471880000658}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2456064, "num_steps_sampled": 2460000, "sample_time_ms": 12997.222, "load_time_ms": 34.902, "grad_time_ms": 4981.914, "update_time_ms": 7.811, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1022.8372192382812, "policy_loss": -0.012640702538192272, "vf_loss": 1022.849853515625, "vf_explained_var": 0.13956892490386963, "kl": 0.016693221405148506, "entropy": 28.709341049194336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0009385586017742753, "cur_lr": 4.999999873689376e-05, "total_loss": 1019.10498046875, "policy_loss": 0.0009409101330675185, "vf_loss": 1019.1039428710938, "vf_explained_var": 0.1421261578798294, "kl": 0.028781579807400703, "entropy": 1.5954300165176392, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2460000, "episodes_total": 4928, "training_iteration": 123, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-02-07", "timestamp": 1567648927, "time_this_iter_s": 18.102583169937134, "time_total_s": 2200.779735326767, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518353a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2200.779735326767, "timesteps_since_restore": 2460000, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.361538461538462, "ram_util_percent": 14.461538461538462}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 309.2663011714369, "action_adversary": -309.2663011714369}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6249663587214065, "mean_processing_ms": 2.446672893478582, "mean_inference_ms": 0.9603442091723811}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2476032, "num_steps_sampled": 2480000, "sample_time_ms": 13066.743, "load_time_ms": 34.889, "grad_time_ms": 4981.757, "update_time_ms": 7.811, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1028.70751953125, "policy_loss": -0.013414492830634117, "vf_loss": 1028.720947265625, "vf_explained_var": 0.13861873745918274, "kl": 0.016782494261860847, "entropy": 28.60801124572754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0009385586017742753, "cur_lr": 4.999999873689376e-05, "total_loss": 1025.05224609375, "policy_loss": 0.001496512209996581, "vf_loss": 1025.0506591796875, "vf_explained_var": 0.14137855172157288, "kl": 0.04403350502252579, "entropy": 1.605407953262329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2480000, "episodes_total": 4968, "training_iteration": 124, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-02-25", "timestamp": 1567648945, "time_this_iter_s": 18.2747540473938, "time_total_s": 2219.0544893741608, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c6048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2219.0544893741608, "timesteps_since_restore": 2480000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 30.930769230769233, "ram_util_percent": 14.465384615384616}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 309.3306588613973, "action_adversary": -309.3306588613973}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6385292739868134, "mean_processing_ms": 2.4466936493416567, "mean_inference_ms": 0.9605044456341222}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2496000, "num_steps_sampled": 2500000, "sample_time_ms": 13121.729, "load_time_ms": 34.643, "grad_time_ms": 4981.86, "update_time_ms": 7.757, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 992.58251953125, "policy_loss": -0.012398215010762215, "vf_loss": 992.594970703125, "vf_explained_var": 0.14288002252578735, "kl": 0.016864610835909843, "entropy": 28.597030639648438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.001407837844453752, "cur_lr": 4.999999873689376e-05, "total_loss": 989.377197265625, "policy_loss": 0.0014817439951002598, "vf_loss": 989.3756713867188, "vf_explained_var": 0.1413082778453827, "kl": 0.031123539432883263, "entropy": 1.5745360851287842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2500000, "episodes_total": 5007, "training_iteration": 125, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-02-43", "timestamp": 1567648963, "time_this_iter_s": 18.029751539230347, "time_total_s": 2237.084240913391, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183719d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2237.084240913391, "timesteps_since_restore": 2500000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 31.344, "ram_util_percent": 14.528000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 309.9987496874921, "action_adversary": -309.9987496874921}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6441128012862123, "mean_processing_ms": 2.446544350095662, "mean_inference_ms": 0.9606725882182262}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2515968, "num_steps_sampled": 2520000, "sample_time_ms": 13095.264, "load_time_ms": 34.684, "grad_time_ms": 4982.736, "update_time_ms": 7.814, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1045.030029296875, "policy_loss": -0.013255073688924313, "vf_loss": 1045.043212890625, "vf_explained_var": 0.13471783697605133, "kl": 0.017677301540970802, "entropy": 28.683074951171875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.001407837844453752, "cur_lr": 4.999999873689376e-05, "total_loss": 1043.6337890625, "policy_loss": 0.0024169934913516045, "vf_loss": 1043.6314697265625, "vf_explained_var": 0.13254337012767792, "kl": 0.036208439618349075, "entropy": 1.5580897331237793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2520000, "episodes_total": 5048, "training_iteration": 126, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-03-01", "timestamp": 1567648981, "time_this_iter_s": 18.110225200653076, "time_total_s": 2255.194466114044, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518436b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2255.194466114044, "timesteps_since_restore": 2520000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 30.830769230769228, "ram_util_percent": 14.473076923076924}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 312.37317599917634, "action_adversary": -312.37317599917634}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.633292365697567, "mean_processing_ms": 2.446582705246373, "mean_inference_ms": 0.9603634276111864}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2535936, "num_steps_sampled": 2540000, "sample_time_ms": 13053.717, "load_time_ms": 34.721, "grad_time_ms": 4982.876, "update_time_ms": 7.84, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 996.5398559570312, "policy_loss": -0.013463811948895454, "vf_loss": 996.553466796875, "vf_explained_var": 0.14944995939731598, "kl": 0.016194239258766174, "entropy": 28.433189392089844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.001407837844453752, "cur_lr": 4.999999873689376e-05, "total_loss": 997.8193359375, "policy_loss": 0.003794834716245532, "vf_loss": 997.8154907226562, "vf_explained_var": 0.14617474377155304, "kl": 0.042735014110803604, "entropy": 1.603745460510254, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2540000, "episodes_total": 5087, "training_iteration": 127, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-03-19", "timestamp": 1567648999, "time_this_iter_s": 17.72591471672058, "time_total_s": 2272.9203808307648, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183c36a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2272.9203808307648, "timesteps_since_restore": 2540000, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 30.657692307692304, "ram_util_percent": 14.48846153846154}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 312.92570834924356, "action_adversary": -312.92570834924356}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.633727423523374, "mean_processing_ms": 2.4466544186171437, "mean_inference_ms": 0.9602073361025809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2555904, "num_steps_sampled": 2560000, "sample_time_ms": 13041.293, "load_time_ms": 34.758, "grad_time_ms": 4983.627, "update_time_ms": 7.571, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1054.789306640625, "policy_loss": -0.013071057386696339, "vf_loss": 1054.80224609375, "vf_explained_var": 0.1469039022922516, "kl": 0.016390766948461533, "entropy": 28.40621566772461, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.002111756708472967, "cur_lr": 4.999999873689376e-05, "total_loss": 1058.8740234375, "policy_loss": 0.00011018515942851081, "vf_loss": 1058.8740234375, "vf_explained_var": 0.14654316008090973, "kl": 0.023208091035485268, "entropy": 1.6168853044509888, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2560000, "episodes_total": 5128, "training_iteration": 128, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-03-37", "timestamp": 1567649017, "time_this_iter_s": 17.938474893569946, "time_total_s": 2290.8588557243347, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518381268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2290.8588557243347, "timesteps_since_restore": 2560000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 31.304000000000002, "ram_util_percent": 14.475999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 314.619032509006, "action_adversary": -314.619032509006}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6257653340693996, "mean_processing_ms": 2.446599301751446, "mean_inference_ms": 0.9605629653929222}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2575872, "num_steps_sampled": 2580000, "sample_time_ms": 12978.321, "load_time_ms": 34.587, "grad_time_ms": 4982.749, "update_time_ms": 7.671, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1048.8077392578125, "policy_loss": -0.013603665865957737, "vf_loss": 1048.8211669921875, "vf_explained_var": 0.15076462924480438, "kl": 0.01617160066962242, "entropy": 28.369985580444336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.002111756708472967, "cur_lr": 4.999999873689376e-05, "total_loss": 1050.1588134765625, "policy_loss": 0.005269436631351709, "vf_loss": 1050.1533203125, "vf_explained_var": 0.15067097544670105, "kl": 0.05318649485707283, "entropy": 1.6093158721923828, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2580000, "episodes_total": 5168, "training_iteration": 129, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-03-54", "timestamp": 1567649034, "time_this_iter_s": 17.630436182022095, "time_total_s": 2308.489291906357, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518389620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2308.489291906357, "timesteps_since_restore": 2580000, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 32.007999999999996, "ram_util_percent": 14.492}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 314.98815863575396, "action_adversary": -314.98815863575396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6427951096886977, "mean_processing_ms": 2.4465696536036874, "mean_inference_ms": 0.9604414031587407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 2600000, "sample_time_ms": 12974.257, "load_time_ms": 34.517, "grad_time_ms": 4982.287, "update_time_ms": 7.673, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1040.74462890625, "policy_loss": -0.014566661790013313, "vf_loss": 1040.7591552734375, "vf_explained_var": 0.14502933621406555, "kl": 0.01829775609076023, "entropy": 28.41219711303711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031676352955400944, "cur_lr": 4.999999873689376e-05, "total_loss": 1045.153076171875, "policy_loss": 0.0012316000647842884, "vf_loss": 1045.151611328125, "vf_explained_var": 0.14162056148052216, "kl": 0.03726334497332573, "entropy": 1.5722167491912842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2600000, "episodes_total": 5208, "training_iteration": 130, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-04-12", "timestamp": 1567649052, "time_this_iter_s": 18.047319173812866, "time_total_s": 2326.5366110801697, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7a42f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2326.5366110801697, "timesteps_since_restore": 2600000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.111538461538462, "ram_util_percent": 14.550000000000002}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 314.7673935362283, "action_adversary": -314.7673935362283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6305355570180575, "mean_processing_ms": 2.446622598394624, "mean_inference_ms": 0.9609717294660376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2615808, "num_steps_sampled": 2620000, "sample_time_ms": 12933.322, "load_time_ms": 34.529, "grad_time_ms": 4980.293, "update_time_ms": 7.955, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1021.513916015625, "policy_loss": -0.011946361511945724, "vf_loss": 1021.5258178710938, "vf_explained_var": 0.15370559692382812, "kl": 0.017401723191142082, "entropy": 28.3792667388916, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031676352955400944, "cur_lr": 4.999999873689376e-05, "total_loss": 1024.64892578125, "policy_loss": 0.0024056006222963333, "vf_loss": 1024.6463623046875, "vf_explained_var": 0.14923956990242004, "kl": 0.04200369492173195, "entropy": 1.5811110734939575, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2620000, "episodes_total": 5247, "training_iteration": 131, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-04-30", "timestamp": 1567649070, "time_this_iter_s": 17.746419191360474, "time_total_s": 2344.28303027153, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b776f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2344.28303027153, "timesteps_since_restore": 2620000, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 31.143999999999995, "ram_util_percent": 14.6}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 312.37405524501304, "action_adversary": -312.37405524501304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.633697610164499, "mean_processing_ms": 2.446568884726168, "mean_inference_ms": 0.9602849046832693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2635776, "num_steps_sampled": 2640000, "sample_time_ms": 12871.353, "load_time_ms": 34.518, "grad_time_ms": 4980.569, "update_time_ms": 7.958, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1074.0064697265625, "policy_loss": -0.014031014405190945, "vf_loss": 1074.0203857421875, "vf_explained_var": 0.14854013919830322, "kl": 0.016607616096735, "entropy": 28.418285369873047, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.004751452710479498, "cur_lr": 4.999999873689376e-05, "total_loss": 1077.5015869140625, "policy_loss": 0.00040999328484758735, "vf_loss": 1077.5010986328125, "vf_explained_var": 0.1506873518228531, "kl": 0.03078710101544857, "entropy": 1.591808557510376, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2640000, "episodes_total": 5288, "training_iteration": 132, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-04-48", "timestamp": 1567649088, "time_this_iter_s": 17.499017000198364, "time_total_s": 2361.7820472717285, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518454510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2361.7820472717285, "timesteps_since_restore": 2640000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 31.296000000000003, "ram_util_percent": 14.564}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 312.946729613229, "action_adversary": -312.946729613229}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.616538451475049, "mean_processing_ms": 2.4467182009556, "mean_inference_ms": 0.9604053165412597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2655744, "num_steps_sampled": 2660000, "sample_time_ms": 12846.741, "load_time_ms": 34.512, "grad_time_ms": 4981.977, "update_time_ms": 8.002, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1053.2574462890625, "policy_loss": -0.014795288443565369, "vf_loss": 1053.272216796875, "vf_explained_var": 0.14938507974147797, "kl": 0.017748432233929634, "entropy": 28.42742156982422, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.004751452710479498, "cur_lr": 4.999999873689376e-05, "total_loss": 1051.7664794921875, "policy_loss": 0.002793598920106888, "vf_loss": 1051.7633056640625, "vf_explained_var": 0.1476098597049713, "kl": 0.045382060110569, "entropy": 1.5717953443527222, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2660000, "episodes_total": 5327, "training_iteration": 133, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-05-06", "timestamp": 1567649106, "time_this_iter_s": 17.871387481689453, "time_total_s": 2379.653434753418, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518454a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2379.653434753418, "timesteps_since_restore": 2660000, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 30.45384615384615, "ram_util_percent": 14.50769230769231}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 314.1782055063671, "action_adversary": -314.1782055063671}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6333982334626023, "mean_processing_ms": 2.4465159113747728, "mean_inference_ms": 0.9601777549109574}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2675712, "num_steps_sampled": 2680000, "sample_time_ms": 12779.718, "load_time_ms": 34.552, "grad_time_ms": 4983.101, "update_time_ms": 8.017, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1088.38623046875, "policy_loss": -0.012749052606523037, "vf_loss": 1088.39892578125, "vf_explained_var": 0.14748625457286835, "kl": 0.016290510073304176, "entropy": 28.38623046875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0071271792985498905, "cur_lr": 4.999999873689376e-05, "total_loss": 1092.927978515625, "policy_loss": -0.0009911790257319808, "vf_loss": 1092.9288330078125, "vf_explained_var": 0.14758019149303436, "kl": 0.023503687232732773, "entropy": 1.565576434135437, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2680000, "episodes_total": 5368, "training_iteration": 134, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-05-23", "timestamp": 1567649123, "time_this_iter_s": 17.6149160861969, "time_total_s": 2397.268350839615, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ee048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2397.268350839615, "timesteps_since_restore": 2680000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.78, "ram_util_percent": 14.504000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 315.1455606535053, "action_adversary": -315.1455606535053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6250941936866474, "mean_processing_ms": 2.446451364935567, "mean_inference_ms": 0.9603408878743064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2695680, "num_steps_sampled": 2700000, "sample_time_ms": 12733.998, "load_time_ms": 34.784, "grad_time_ms": 4983.361, "update_time_ms": 8.07, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1044.7550048828125, "policy_loss": -0.013138389214873314, "vf_loss": 1044.7681884765625, "vf_explained_var": 0.1483234465122223, "kl": 0.01676926575601101, "entropy": 28.356107711791992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0071271792985498905, "cur_lr": 4.999999873689376e-05, "total_loss": 1048.4151611328125, "policy_loss": 0.0013403838966041803, "vf_loss": 1048.4136962890625, "vf_explained_var": 0.15036572515964508, "kl": 0.02217414788901806, "entropy": 1.5428253412246704, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2700000, "episodes_total": 5407, "training_iteration": 135, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-05-41", "timestamp": 1567649141, "time_this_iter_s": 17.57835817337036, "time_total_s": 2414.8467090129852, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518422bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2414.8467090129852, "timesteps_since_restore": 2700000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 31.100000000000005, "ram_util_percent": 14.515999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 315.62339917303984, "action_adversary": -315.62339917303984}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.646763263454308, "mean_processing_ms": 2.446173774602139, "mean_inference_ms": 0.9604163074247856}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2715648, "num_steps_sampled": 2720000, "sample_time_ms": 12722.476, "load_time_ms": 34.778, "grad_time_ms": 4981.935, "update_time_ms": 8.06, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1073.285888671875, "policy_loss": -0.012723693624138832, "vf_loss": 1073.2987060546875, "vf_explained_var": 0.14398489892482758, "kl": 0.01657852716743946, "entropy": 28.36802101135254, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0071271792985498905, "cur_lr": 4.999999873689376e-05, "total_loss": 1077.8385009765625, "policy_loss": 0.00016047323879320174, "vf_loss": 1077.8382568359375, "vf_explained_var": 0.14746393263339996, "kl": 0.03341526910662651, "entropy": 1.5274057388305664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2720000, "episodes_total": 5447, "training_iteration": 136, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-05-59", "timestamp": 1567649159, "time_this_iter_s": 17.97956395149231, "time_total_s": 2432.8262729644775, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2432.8262729644775, "timesteps_since_restore": 2720000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 29.665384615384614, "ram_util_percent": 14.52692307692308}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 316.3157850870762, "action_adversary": -316.3157850870762}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.631106116889253, "mean_processing_ms": 2.4462051951578916, "mean_inference_ms": 0.9600392844060938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2735616, "num_steps_sampled": 2740000, "sample_time_ms": 12754.953, "load_time_ms": 34.741, "grad_time_ms": 4980.334, "update_time_ms": 7.974, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1090.3603515625, "policy_loss": -0.011720857582986355, "vf_loss": 1090.3719482421875, "vf_explained_var": 0.14231447875499725, "kl": 0.015557820908725262, "entropy": 28.44150733947754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0071271792985498905, "cur_lr": 4.999999873689376e-05, "total_loss": 1092.6978759765625, "policy_loss": 0.002336071338504553, "vf_loss": 1092.6951904296875, "vf_explained_var": 0.14551551640033722, "kl": 0.04983340948820114, "entropy": 1.4829829931259155, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2740000, "episodes_total": 5487, "training_iteration": 137, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-06-17", "timestamp": 1567649177, "time_this_iter_s": 18.033913135528564, "time_total_s": 2450.860186100006, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b84c8c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2450.860186100006, "timesteps_since_restore": 2740000, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 30.6, "ram_util_percent": 14.600000000000001}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 316.9183500262198, "action_adversary": -316.9183500262198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.637016835799177, "mean_processing_ms": 2.446296393412458, "mean_inference_ms": 0.959510523315269}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2755584, "num_steps_sampled": 2760000, "sample_time_ms": 12772.911, "load_time_ms": 34.736, "grad_time_ms": 4978.502, "update_time_ms": 7.943, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1109.66943359375, "policy_loss": -0.01476342510432005, "vf_loss": 1109.684326171875, "vf_explained_var": 0.13757659494876862, "kl": 0.016759034246206284, "entropy": 28.40632438659668, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1112.2525634765625, "policy_loss": -1.774713928170968e-05, "vf_loss": 1112.2523193359375, "vf_explained_var": 0.13735917210578918, "kl": 0.028893116861581802, "entropy": 1.4922772645950317, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2760000, "episodes_total": 5528, "training_iteration": 138, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-06-35", "timestamp": 1567649195, "time_this_iter_s": 18.101369380950928, "time_total_s": 2468.961555480957, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b880ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2468.961555480957, "timesteps_since_restore": 2760000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 14.628}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 317.76194938676747, "action_adversary": -317.76194938676747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.637118420202688, "mean_processing_ms": 2.446524842513972, "mean_inference_ms": 0.9593969473898002}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2775552, "num_steps_sampled": 2780000, "sample_time_ms": 12812.354, "load_time_ms": 34.787, "grad_time_ms": 4979.913, "update_time_ms": 7.952, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1089.862060546875, "policy_loss": -0.0148151321336627, "vf_loss": 1089.8768310546875, "vf_explained_var": 0.13700954616069794, "kl": 0.018969997763633728, "entropy": 28.45900535583496, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1091.132080078125, "policy_loss": -0.0012001418508589268, "vf_loss": 1091.133056640625, "vf_explained_var": 0.1407608687877655, "kl": 0.02143443375825882, "entropy": 1.4977065324783325, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2780000, "episodes_total": 5568, "training_iteration": 139, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-06-53", "timestamp": 1567649213, "time_this_iter_s": 18.039664030075073, "time_total_s": 2487.001219511032, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183bb488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2487.001219511032, "timesteps_since_restore": 2780000, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 30.31153846153846, "ram_util_percent": 14.534615384615389}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 317.24585432523907, "action_adversary": -317.24585432523907}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6451134486561223, "mean_processing_ms": 2.446360308851381, "mean_inference_ms": 0.9597770210435534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2795520, "num_steps_sampled": 2800000, "sample_time_ms": 12801.16, "load_time_ms": 34.547, "grad_time_ms": 4979.487, "update_time_ms": 7.985, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1066.0018310546875, "policy_loss": -0.013423197902739048, "vf_loss": 1066.0152587890625, "vf_explained_var": 0.13486596941947937, "kl": 0.01735060103237629, "entropy": 28.45415496826172, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1066.7799072265625, "policy_loss": 0.0011623648460954428, "vf_loss": 1066.7781982421875, "vf_explained_var": 0.1347803920507431, "kl": 0.036149341613054276, "entropy": 1.4834412336349487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2800000, "episodes_total": 5607, "training_iteration": 140, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-07-11", "timestamp": 1567649231, "time_this_iter_s": 17.929020166397095, "time_total_s": 2504.930239677429, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518398ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2504.930239677429, "timesteps_since_restore": 2800000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 30.676923076923078, "ram_util_percent": 14.607692307692306}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 316.3244658314787, "action_adversary": -316.3244658314787}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.640450147145892, "mean_processing_ms": 2.4463570059073403, "mean_inference_ms": 0.9594012137657564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2815488, "num_steps_sampled": 2820000, "sample_time_ms": 12839.459, "load_time_ms": 34.494, "grad_time_ms": 4979.675, "update_time_ms": 7.825, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1094.0172119140625, "policy_loss": -0.014466366730630398, "vf_loss": 1094.0316162109375, "vf_explained_var": 0.1393396109342575, "kl": 0.01830833964049816, "entropy": 28.390064239501953, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1095.917724609375, "policy_loss": 0.0006251310114748776, "vf_loss": 1095.9168701171875, "vf_explained_var": 0.13669441640377045, "kl": 0.020181329920887947, "entropy": 1.4867421388626099, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2820000, "episodes_total": 5647, "training_iteration": 141, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-07-29", "timestamp": 1567649249, "time_this_iter_s": 18.129046201705933, "time_total_s": 2523.059285879135, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b859b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2523.059285879135, "timesteps_since_restore": 2820000, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 30.384615384615383, "ram_util_percent": 14.626923076923076}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 316.3097369981377, "action_adversary": -316.3097369981377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.632403499196605, "mean_processing_ms": 2.446290889709498, "mean_inference_ms": 0.9593136488337554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2835456, "num_steps_sampled": 2840000, "sample_time_ms": 12904.819, "load_time_ms": 34.487, "grad_time_ms": 4978.577, "update_time_ms": 7.764, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1142.0107421875, "policy_loss": -0.012650043703615665, "vf_loss": 1142.0234375, "vf_explained_var": 0.1328909695148468, "kl": 0.01838158257305622, "entropy": 28.365327835083008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1145.6328125, "policy_loss": 0.00223123119212687, "vf_loss": 1145.6300048828125, "vf_explained_var": 0.1348833441734314, "kl": 0.03645898029208183, "entropy": 1.470367193222046, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2840000, "episodes_total": 5688, "training_iteration": 142, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-07-47", "timestamp": 1567649267, "time_this_iter_s": 18.14085030555725, "time_total_s": 2541.2001361846924, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6dee18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2541.2001361846924, "timesteps_since_restore": 2840000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 30.184615384615384, "ram_util_percent": 14.55769230769231}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 315.92820741238165, "action_adversary": -315.92820741238165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.643465305528777, "mean_processing_ms": 2.446430349714397, "mean_inference_ms": 0.9591194041535467}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2855424, "num_steps_sampled": 2860000, "sample_time_ms": 12939.737, "load_time_ms": 34.5, "grad_time_ms": 4978.292, "update_time_ms": 7.65, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1130.3177490234375, "policy_loss": -0.014277460053563118, "vf_loss": 1130.3319091796875, "vf_explained_var": 0.136408269405365, "kl": 0.018082046881318092, "entropy": 28.384477615356445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1133.090087890625, "policy_loss": 0.0007175199571065605, "vf_loss": 1133.0889892578125, "vf_explained_var": 0.13614250719547272, "kl": 0.0250136386603117, "entropy": 1.4825090169906616, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2860000, "episodes_total": 5729, "training_iteration": 143, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-08-06", "timestamp": 1567649286, "time_this_iter_s": 18.215699672698975, "time_total_s": 2559.4158358573914, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183ac0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2559.4158358573914, "timesteps_since_restore": 2860000, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.27692307692308, "ram_util_percent": 14.63076923076923}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 316.5970117023121, "action_adversary": -316.5970117023121}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.631470366905004, "mean_processing_ms": 2.4465861582094637, "mean_inference_ms": 0.9588065455969642}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2875392, "num_steps_sampled": 2880000, "sample_time_ms": 12985.278, "load_time_ms": 34.516, "grad_time_ms": 4977.182, "update_time_ms": 7.674, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1078.361083984375, "policy_loss": -0.01366664469242096, "vf_loss": 1078.3746337890625, "vf_explained_var": 0.14362168312072754, "kl": 0.017572756856679916, "entropy": 28.3853759765625, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.01069076918065548, "cur_lr": 4.999999873689376e-05, "total_loss": 1086.0203857421875, "policy_loss": 0.003549168584868312, "vf_loss": 1086.0164794921875, "vf_explained_var": 0.1436111479997635, "kl": 0.04892480745911598, "entropy": 1.4727814197540283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2880000, "episodes_total": 5768, "training_iteration": 144, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-08-24", "timestamp": 1567649304, "time_this_iter_s": 18.05922222137451, "time_total_s": 2577.475058078766, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518426a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2577.475058078766, "timesteps_since_restore": 2880000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 31.636, "ram_util_percent": 14.564}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 316.70518901437777, "action_adversary": -316.70518901437777}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6425839562145192, "mean_processing_ms": 2.446531297204586, "mean_inference_ms": 0.9587198289733786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2895360, "num_steps_sampled": 2900000, "sample_time_ms": 13026.699, "load_time_ms": 34.476, "grad_time_ms": 4978.274, "update_time_ms": 7.644, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1132.3602294921875, "policy_loss": -0.013278462924063206, "vf_loss": 1132.3734130859375, "vf_explained_var": 0.13600735366344452, "kl": 0.017787327989935875, "entropy": 28.33755874633789, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1137.3663330078125, "policy_loss": -0.000354928954038769, "vf_loss": 1137.3662109375, "vf_explained_var": 0.13512839376926422, "kl": 0.025150565430521965, "entropy": 1.4640451669692993, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2900000, "episodes_total": 5809, "training_iteration": 145, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-08-42", "timestamp": 1567649322, "time_this_iter_s": 18.002285957336426, "time_total_s": 2595.4773440361023, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518361378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2595.4773440361023, "timesteps_since_restore": 2900000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 30.638461538461538, "ram_util_percent": 14.557692307692308}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 317.0163327137165, "action_adversary": -317.0163327137165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.634341938087873, "mean_processing_ms": 2.446458990606389, "mean_inference_ms": 0.9590565017149624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2915328, "num_steps_sampled": 2920000, "sample_time_ms": 13041.369, "load_time_ms": 34.438, "grad_time_ms": 4977.601, "update_time_ms": 7.639, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1084.506591796875, "policy_loss": -0.013969100080430508, "vf_loss": 1084.5203857421875, "vf_explained_var": 0.13220711052417755, "kl": 0.018145332112908363, "entropy": 28.275394439697266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1088.25, "policy_loss": -0.0004750746302306652, "vf_loss": 1088.25, "vf_explained_var": 0.13205085694789886, "kl": 0.02515069767832756, "entropy": 1.4594037532806396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2920000, "episodes_total": 5847, "training_iteration": 146, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-09-00", "timestamp": 1567649340, "time_this_iter_s": 18.118273973464966, "time_total_s": 2613.5956180095673, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5182f0510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2613.5956180095673, "timesteps_since_restore": 2920000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 31.153846153846153, "ram_util_percent": 14.553846153846154}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 316.1259405700176, "action_adversary": -316.1259405700176}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.646098902951079, "mean_processing_ms": 2.44619911001211, "mean_inference_ms": 0.9589116183863851}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935296, "num_steps_sampled": 2940000, "sample_time_ms": 13033.622, "load_time_ms": 34.388, "grad_time_ms": 4978.337, "update_time_ms": 7.761, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1149.066162109375, "policy_loss": -0.014210915192961693, "vf_loss": 1149.08056640625, "vf_explained_var": 0.13508476316928864, "kl": 0.017983652651309967, "entropy": 28.285688400268555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1153.00634765625, "policy_loss": 0.00026643447927199304, "vf_loss": 1153.005615234375, "vf_explained_var": 0.13271455466747284, "kl": 0.0250710416585207, "entropy": 1.4386852979660034, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2940000, "episodes_total": 5888, "training_iteration": 147, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-09-18", "timestamp": 1567649358, "time_this_iter_s": 17.965489149093628, "time_total_s": 2631.561107158661, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5182f0d90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2631.561107158661, "timesteps_since_restore": 2940000, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 14.648}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 316.4920447333337, "action_adversary": -316.4920447333337}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.644140364191659, "mean_processing_ms": 2.446248533207184, "mean_inference_ms": 0.9586442762765104}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2955264, "num_steps_sampled": 2960000, "sample_time_ms": 13017.347, "load_time_ms": 34.122, "grad_time_ms": 4978.423, "update_time_ms": 7.863, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1147.1629638671875, "policy_loss": -0.013634147122502327, "vf_loss": 1147.1766357421875, "vf_explained_var": 0.13667842745780945, "kl": 0.01812659204006195, "entropy": 28.06123924255371, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1149.08837890625, "policy_loss": 0.0008139899582602084, "vf_loss": 1149.0869140625, "vf_explained_var": 0.1344730406999588, "kl": 0.030581792816519737, "entropy": 1.428848147392273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2960000, "episodes_total": 5929, "training_iteration": 148, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-09-36", "timestamp": 1567649376, "time_this_iter_s": 17.936989784240723, "time_total_s": 2649.4980969429016, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518301f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2649.4980969429016, "timesteps_since_restore": 2960000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.830769230769228, "ram_util_percent": 14.619230769230768}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 317.5230662510074, "action_adversary": -317.5230662510074}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.638575515879596, "mean_processing_ms": 2.446330467737466, "mean_inference_ms": 0.9587141921878128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2975232, "num_steps_sampled": 2980000, "sample_time_ms": 13001.512, "load_time_ms": 34.1, "grad_time_ms": 4978.68, "update_time_ms": 7.795, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1092.76953125, "policy_loss": -0.012190709821879864, "vf_loss": 1092.7816162109375, "vf_explained_var": 0.1437266618013382, "kl": 0.01654503121972084, "entropy": 27.800737380981445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1095.5296630859375, "policy_loss": 0.0022917836904525757, "vf_loss": 1095.52685546875, "vf_explained_var": 0.14516469836235046, "kl": 0.02915048971772194, "entropy": 1.4323757886886597, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2980000, "episodes_total": 5968, "training_iteration": 149, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-09-54", "timestamp": 1567649394, "time_this_iter_s": 17.884331941604614, "time_total_s": 2667.382428884506, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518426840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2667.382428884506, "timesteps_since_restore": 2980000, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 30.696153846153848, "ram_util_percent": 14.565384615384614}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 317.53084380539786, "action_adversary": -317.53084380539786}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.636186060997768, "mean_processing_ms": 2.446455977033213, "mean_inference_ms": 0.958658661984588}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2995200, "num_steps_sampled": 3000000, "sample_time_ms": 13010.759, "load_time_ms": 34.39, "grad_time_ms": 4979.999, "update_time_ms": 7.75, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1157.7918701171875, "policy_loss": -0.011057437397539616, "vf_loss": 1157.8028564453125, "vf_explained_var": 0.13743039965629578, "kl": 0.01618659496307373, "entropy": 27.736175537109375, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1160.186279296875, "policy_loss": -0.00033234423608519137, "vf_loss": 1160.186279296875, "vf_explained_var": 0.13740327954292297, "kl": 0.023790882900357246, "entropy": 1.444956660270691, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3000000, "episodes_total": 6009, "training_iteration": 150, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-10-12", "timestamp": 1567649412, "time_this_iter_s": 18.036653518676758, "time_total_s": 2685.419082403183, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6deae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2685.419082403183, "timesteps_since_restore": 3000000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 31.239999999999995, "ram_util_percent": 14.607999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 318.0726515606972, "action_adversary": -318.0726515606972}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6263558499060706, "mean_processing_ms": 2.4464110696506514, "mean_inference_ms": 0.9594851293922686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3015168, "num_steps_sampled": 3020000, "sample_time_ms": 12976.944, "load_time_ms": 34.383, "grad_time_ms": 4980.029, "update_time_ms": 7.73, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1095.958740234375, "policy_loss": -0.013902849517762661, "vf_loss": 1095.9725341796875, "vf_explained_var": 0.1390853226184845, "kl": 0.018454499542713165, "entropy": 27.66187858581543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1100.537109375, "policy_loss": 0.00035112485056743026, "vf_loss": 1100.5360107421875, "vf_explained_var": 0.14158476889133453, "kl": 0.036485884338617325, "entropy": 1.4416353702545166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3020000, "episodes_total": 6047, "training_iteration": 151, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-10-30", "timestamp": 1567649430, "time_this_iter_s": 17.790557146072388, "time_total_s": 2703.2096395492554, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b859d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2703.2096395492554, "timesteps_since_restore": 3020000, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 30.915384615384617, "ram_util_percent": 14.626923076923076}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 318.4088977276834, "action_adversary": -318.4088977276834}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.638532399670234, "mean_processing_ms": 2.446283078364088, "mean_inference_ms": 0.9588840739188363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3035136, "num_steps_sampled": 3040000, "sample_time_ms": 12965.341, "load_time_ms": 34.395, "grad_time_ms": 4979.606, "update_time_ms": 7.768, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1187.1275634765625, "policy_loss": -0.01327420212328434, "vf_loss": 1187.1409912109375, "vf_explained_var": 0.13339027762413025, "kl": 0.01699000783264637, "entropy": 27.63045883178711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1190.265869140625, "policy_loss": -0.0007894657901488245, "vf_loss": 1190.2662353515625, "vf_explained_var": 0.13586899638175964, "kl": 0.01825716905295849, "entropy": 1.4236910343170166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3040000, "episodes_total": 6089, "training_iteration": 152, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-10-48", "timestamp": 1567649448, "time_this_iter_s": 18.021307229995728, "time_total_s": 2721.230946779251, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5182f0048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2721.230946779251, "timesteps_since_restore": 3040000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 30.592000000000002, "ram_util_percent": 14.687999999999999}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 318.40567884397285, "action_adversary": -318.40567884397285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6254898957144968, "mean_processing_ms": 2.446343714674919, "mean_inference_ms": 0.9588342196602079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3055104, "num_steps_sampled": 3060000, "sample_time_ms": 12951.936, "load_time_ms": 34.411, "grad_time_ms": 4978.528, "update_time_ms": 7.813, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1141.2025146484375, "policy_loss": -0.013365311548113823, "vf_loss": 1141.2159423828125, "vf_explained_var": 0.13515838980674744, "kl": 0.015979422256350517, "entropy": 27.644569396972656, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1144.0560302734375, "policy_loss": 0.00038698469870723784, "vf_loss": 1144.0550537109375, "vf_explained_var": 0.14021416008472443, "kl": 0.03146456927061081, "entropy": 1.4030975103378296, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3060000, "episodes_total": 6129, "training_iteration": 153, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-11-06", "timestamp": 1567649466, "time_this_iter_s": 18.07133388519287, "time_total_s": 2739.302280664444, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518398bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2739.302280664444, "timesteps_since_restore": 3060000, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.165384615384617, "ram_util_percent": 14.626923076923076}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 318.5814713620458, "action_adversary": -318.5814713620458}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6475991311485796, "mean_processing_ms": 2.4463892896907673, "mean_inference_ms": 0.9592044736902136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3075072, "num_steps_sampled": 3080000, "sample_time_ms": 12950.27, "load_time_ms": 34.343, "grad_time_ms": 4977.243, "update_time_ms": 7.792, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1146.6024169921875, "policy_loss": -0.01320651825517416, "vf_loss": 1146.6156005859375, "vf_explained_var": 0.13064666092395782, "kl": 0.017144395038485527, "entropy": 27.594820022583008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1144.7430419921875, "policy_loss": 0.0012898424174636602, "vf_loss": 1144.7413330078125, "vf_explained_var": 0.13232247531414032, "kl": 0.03276652470231056, "entropy": 1.3770536184310913, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3080000, "episodes_total": 6169, "training_iteration": 154, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-11-24", "timestamp": 1567649484, "time_this_iter_s": 18.03052568435669, "time_total_s": 2757.3328063488007, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5183bbea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2757.3328063488007, "timesteps_since_restore": 3080000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 30.88461538461538, "ram_util_percent": 14.634615384615383}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 318.46369112834714, "action_adversary": -318.46369112834714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6444592161260307, "mean_processing_ms": 2.446352922342425, "mean_inference_ms": 0.9600080208298795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3095040, "num_steps_sampled": 3100000, "sample_time_ms": 12961.532, "load_time_ms": 34.373, "grad_time_ms": 4976.668, "update_time_ms": 8.061, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1140.61962890625, "policy_loss": -0.0136262197047472, "vf_loss": 1140.6331787109375, "vf_explained_var": 0.13270923495292664, "kl": 0.0174701064825058, "entropy": 27.54703712463379, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1141.8519287109375, "policy_loss": -0.000853087636642158, "vf_loss": 1141.8524169921875, "vf_explained_var": 0.13455380499362946, "kl": 0.023324936628341675, "entropy": 1.3745025396347046, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3100000, "episodes_total": 6208, "training_iteration": 155, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-11-42", "timestamp": 1567649502, "time_this_iter_s": 18.111533164978027, "time_total_s": 2775.4443395137787, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b84cbf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2775.4443395137787, "timesteps_since_restore": 3100000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 31.734615384615385, "ram_util_percent": 14.592307692307692}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 318.00769618103266, "action_adversary": -318.00769618103266}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.647861676240227, "mean_processing_ms": 2.446369327585962, "mean_inference_ms": 0.9595309154581464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3115008, "num_steps_sampled": 3120000, "sample_time_ms": 12943.09, "load_time_ms": 34.413, "grad_time_ms": 4976.53, "update_time_ms": 8.055, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1177.3385009765625, "policy_loss": -0.012818921357393265, "vf_loss": 1177.351318359375, "vf_explained_var": 0.12860102951526642, "kl": 0.017886366695165634, "entropy": 27.40561866760254, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1177.0849609375, "policy_loss": 0.001050541759468615, "vf_loss": 1177.0833740234375, "vf_explained_var": 0.1295318454504013, "kl": 0.028868265450000763, "entropy": 1.3861594200134277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3120000, "episodes_total": 6249, "training_iteration": 156, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-12-00", "timestamp": 1567649520, "time_this_iter_s": 17.934518814086914, "time_total_s": 2793.3788583278656, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b6ca840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2793.3788583278656, "timesteps_since_restore": 3120000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 31.124000000000002, "ram_util_percent": 14.588}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 318.28421628829494, "action_adversary": -318.28421628829494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6331854966167736, "mean_processing_ms": 2.446434799059808, "mean_inference_ms": 0.9599725428713775}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3134976, "num_steps_sampled": 3140000, "sample_time_ms": 12909.562, "load_time_ms": 34.449, "grad_time_ms": 4976.155, "update_time_ms": 8.247, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1100.75341796875, "policy_loss": -0.012327451258897781, "vf_loss": 1100.765625, "vf_explained_var": 0.13823002576828003, "kl": 0.015867026522755623, "entropy": 27.382164001464844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1099.1531982421875, "policy_loss": 0.001265226979739964, "vf_loss": 1099.1514892578125, "vf_explained_var": 0.1413298100233078, "kl": 0.03031395934522152, "entropy": 1.3857605457305908, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3140000, "episodes_total": 6287, "training_iteration": 157, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-12-17", "timestamp": 1567649537, "time_this_iter_s": 17.62850546836853, "time_total_s": 2811.007363796234, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe518422f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2811.007363796234, "timesteps_since_restore": 3140000, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 30.611538461538466, "ram_util_percent": 14.596153846153847}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 318.1952040766579, "action_adversary": -318.1952040766579}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6387882098232733, "mean_processing_ms": 2.4464785617156806, "mean_inference_ms": 0.9594697591935969}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3154944, "num_steps_sampled": 3160000, "sample_time_ms": 12896.487, "load_time_ms": 34.679, "grad_time_ms": 4976.326, "update_time_ms": 8.134, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1217.4053955078125, "policy_loss": -0.015328419394791126, "vf_loss": 1217.420654296875, "vf_explained_var": 0.13811653852462769, "kl": 0.01923113316297531, "entropy": 27.439760208129883, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1213.2703857421875, "policy_loss": -0.00040800267015583813, "vf_loss": 1213.2703857421875, "vf_explained_var": 0.13784895837306976, "kl": 0.02988000400364399, "entropy": 1.399656057357788, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3160000, "episodes_total": 6329, "training_iteration": 158, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-12-35", "timestamp": 1567649555, "time_this_iter_s": 17.809632301330566, "time_total_s": 2828.8169960975647, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184222f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2828.8169960975647, "timesteps_since_restore": 3160000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 31.016, "ram_util_percent": 14.699999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {"av": 317.80796202086606, "action_adversary": -317.80796202086606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.62404051775579, "mean_processing_ms": 2.4465139499302166, "mean_inference_ms": 0.9598685672594857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3174912, "num_steps_sampled": 3180000, "sample_time_ms": 12879.408, "load_time_ms": 34.652, "grad_time_ms": 4974.169, "update_time_ms": 8.12, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1125.015380859375, "policy_loss": -0.014735684730112553, "vf_loss": 1125.0301513671875, "vf_explained_var": 0.13909640908241272, "kl": 0.01976855657994747, "entropy": 27.542509078979492, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1122.7750244140625, "policy_loss": 8.140666614053771e-05, "vf_loss": 1122.7745361328125, "vf_explained_var": 0.14360985159873962, "kl": 0.02097504213452339, "entropy": 1.4432141780853271, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3180000, "episodes_total": 6367, "training_iteration": 159, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-12-53", "timestamp": 1567649573, "time_this_iter_s": 17.68962812423706, "time_total_s": 2846.5066242218018, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe51b7ccc80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2846.5066242218018, "timesteps_since_restore": 3180000, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 31.872000000000003, "ram_util_percent": 14.675999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 317.0579250961502, "action_adversary": -317.0579250961502}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6387092535288197, "mean_processing_ms": 2.446480582837766, "mean_inference_ms": 0.9595154595541985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3194880, "num_steps_sampled": 3200000, "sample_time_ms": 12878.543, "load_time_ms": 34.629, "grad_time_ms": 4972.872, "update_time_ms": 8.117, "learner": {"action_adversary": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1211.95068359375, "policy_loss": -0.012059006839990616, "vf_loss": 1211.9627685546875, "vf_explained_var": 0.13636748492717743, "kl": 0.01723264716565609, "entropy": 27.45085906982422, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.016036152839660645, "cur_lr": 4.999999873689376e-05, "total_loss": 1213.1575927734375, "policy_loss": 0.001027566846460104, "vf_loss": 1213.15625, "vf_explained_var": 0.1395033597946167, "kl": 0.024194607511162758, "entropy": 1.4496909379959106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": true, "timesteps_total": 3200000, "episodes_total": 6409, "training_iteration": 160, "experiment_id": "c99ae12b67bf418fb758b6c228ea23f7", "date": "2019-09-05_02-13-11", "timestamp": 1567649591, "time_this_iter_s": 18.01529598236084, "time_total_s": 2864.5219202041626, "pid": 17978, "hostname": "ip-172-31-27-58", "node_ip": "172.31.27.58", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0.1,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_78\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7fe5184540d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2864.5219202041626, "timesteps_since_restore": 3200000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 30.103846153846153, "ram_util_percent": 14.699999999999998}, "num_healthy_workers": 10, "trial_id": "ffca5c52"}
