{"episode_reward_max": 26.490522100138442, "episode_reward_min": -5131.973743282616, "episode_reward_mean": -1764.3260642258333, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.558524156147752, "mean_processing_ms": 2.2746560974071857, "mean_inference_ms": 0.7012454749489319}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19968, "num_steps_sampled": 20000, "sample_time_ms": 17676.888, "load_time_ms": 63.911, "grad_time_ms": 3110.649, "update_time_ms": 656.481, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 19617.595703125, "policy_loss": -0.005874586757272482, "vf_loss": 19617.599609375, "vf_explained_var": 2.4513174139428884e-05, "kl": 0.007373527158051729, "entropy": 2.841475486755371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 20000, "episodes_total": 39, "training_iteration": 1, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-45-01", "timestamp": 1567543501, "time_this_iter_s": 21.565500736236572, "time_total_s": 21.565500736236572, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21.565500736236572, "timesteps_since_restore": 20000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.0741935483871, "ram_util_percent": 12.26774193548387}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 26.490522100138442, "episode_reward_min": -5131.973743282616, "episode_reward_mean": -1244.330263434606, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.304497561829212, "mean_processing_ms": 2.2763153757987262, "mean_inference_ms": 0.6953429082856406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39936, "num_steps_sampled": 40000, "sample_time_ms": 15723.078, "load_time_ms": 39.746, "grad_time_ms": 2761.482, "update_time_ms": 330.854, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3941.744873046875, "policy_loss": -0.007008315529674292, "vf_loss": 3941.750732421875, "vf_explained_var": 1.8991338947671466e-05, "kl": 0.008492080494761467, "entropy": 2.834679126739502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 40000, "episodes_total": 78, "training_iteration": 2, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-45-17", "timestamp": 1567543517, "time_this_iter_s": 16.215625762939453, "time_total_s": 37.781126499176025, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37.781126499176025, "timesteps_since_restore": 40000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.11739130434784, "ram_util_percent": 12.47826086956522}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 85.9007862479783, "episode_reward_min": -5131.973743282616, "episode_reward_mean": -767.1121695341275, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.018439930756881, "mean_processing_ms": 2.2877656958426003, "mean_inference_ms": 0.688179807592632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59904, "num_steps_sampled": 60000, "sample_time_ms": 14800.132, "load_time_ms": 31.66, "grad_time_ms": 2643.587, "update_time_ms": 222.14, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 1579.0859375, "policy_loss": -0.008906794711947441, "vf_loss": 1579.09423828125, "vf_explained_var": 1.1959136827499606e-05, "kl": 0.01080257911235094, "entropy": 2.829256296157837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 60000, "episodes_total": 119, "training_iteration": 3, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-45-32", "timestamp": 1567543532, "time_this_iter_s": 15.39591360092163, "time_total_s": 53.177040100097656, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 53.177040100097656, "timesteps_since_restore": 60000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.23181818181818, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 135.03430592502528, "episode_reward_min": -3115.6267606428073, "episode_reward_mean": -290.23793053830985, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.725277561361767, "mean_processing_ms": 2.2989249709596713, "mean_inference_ms": 0.6843972379631612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79872, "num_steps_sampled": 80000, "sample_time_ms": 14204.27, "load_time_ms": 26.891, "grad_time_ms": 2583.17, "update_time_ms": 167.78, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 601.4129028320312, "policy_loss": -0.007645079866051674, "vf_loss": 601.4200439453125, "vf_explained_var": 1.0362037983213668e-06, "kl": 0.009780440479516983, "entropy": 2.798511505126953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 80000, "episodes_total": 158, "training_iteration": 4, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-45-47", "timestamp": 1567543547, "time_this_iter_s": 14.848067998886108, "time_total_s": 68.02510809898376, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 68.02510809898376, "timesteps_since_restore": 80000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.06818181818181, "ram_util_percent": 12.490909090909092}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 186.61480312258925, "episode_reward_min": -2394.5057542823506, "episode_reward_mean": -97.67693565017962, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.5406980427557904, "mean_processing_ms": 2.314845241336055, "mean_inference_ms": 0.6811036380379534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99840, "num_steps_sampled": 100000, "sample_time_ms": 13838.943, "load_time_ms": 24.035, "grad_time_ms": 2550.338, "update_time_ms": 135.24, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 230.81304931640625, "policy_loss": -0.006381701678037643, "vf_loss": 230.8192138671875, "vf_explained_var": -3.0071689252508804e-05, "kl": 0.008307529613375664, "entropy": 2.76271653175354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 100000, "episodes_total": 200, "training_iteration": 5, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-46-02", "timestamp": 1567543562, "time_this_iter_s": 14.827504873275757, "time_total_s": 82.85261297225952, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 82.85261297225952, "timesteps_since_restore": 100000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.15714285714286, "ram_util_percent": 12.504761904761907}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 208.12238715118102, "episode_reward_min": -1104.977550230997, "episode_reward_mean": 17.464774195081326, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.4279166768819005, "mean_processing_ms": 2.320551317590436, "mean_inference_ms": 0.6792628169886599}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119808, "num_steps_sampled": 120000, "sample_time_ms": 13625.647, "load_time_ms": 22.138, "grad_time_ms": 2526.155, "update_time_ms": 113.478, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 185.2986602783203, "policy_loss": -0.007479845080524683, "vf_loss": 185.30601501464844, "vf_explained_var": 0.09271363914012909, "kl": 0.009551051072776318, "entropy": 2.7312421798706055, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 120000, "episodes_total": 239, "training_iteration": 6, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-46-17", "timestamp": 1567543577, "time_this_iter_s": 14.994630336761475, "time_total_s": 97.847243309021, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 97.847243309021, "timesteps_since_restore": 120000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.471428571428575, "ram_util_percent": 12.485714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 208.36019255572745, "episode_reward_min": -399.9769622125602, "episode_reward_mean": 78.36711562047446, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3609217017372424, "mean_processing_ms": 2.3246588948724627, "mean_inference_ms": 0.6780080978354373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139776, "num_steps_sampled": 140000, "sample_time_ms": 13461.583, "load_time_ms": 20.748, "grad_time_ms": 2509.446, "update_time_ms": 97.907, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 131.14114379882812, "policy_loss": -0.008768419735133648, "vf_loss": 131.14984130859375, "vf_explained_var": 0.1305079311132431, "kl": 0.011424575001001358, "entropy": 2.7236809730529785, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 140000, "episodes_total": 279, "training_iteration": 7, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-46-32", "timestamp": 1567543592, "time_this_iter_s": 14.916127443313599, "time_total_s": 112.7633707523346, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 112.7633707523346, "timesteps_since_restore": 140000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.709523809523816, "ram_util_percent": 12.485714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 244.20514996432797, "episode_reward_min": -399.9769622125602, "episode_reward_mean": 114.4069568334839, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.284663186203892, "mean_processing_ms": 2.3224674513490067, "mean_inference_ms": 0.6775628102580038}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159744, "num_steps_sampled": 160000, "sample_time_ms": 13346.349, "load_time_ms": 19.715, "grad_time_ms": 2495.419, "update_time_ms": 86.359, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 174.68125915527344, "policy_loss": -0.008495737798511982, "vf_loss": 174.689697265625, "vf_explained_var": 0.18044617772102356, "kl": 0.010419399477541447, "entropy": 2.696735382080078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 160000, "episodes_total": 319, "training_iteration": 8, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-46-47", "timestamp": 1567543607, "time_this_iter_s": 14.967808485031128, "time_total_s": 127.73117923736572, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 127.73117923736572, "timesteps_since_restore": 160000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.86818181818182, "ram_util_percent": 12.490909090909092}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 244.20514996432797, "episode_reward_min": -258.1547456077722, "episode_reward_mean": 157.55034989933134, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.2498206364829456, "mean_processing_ms": 2.324091213511079, "mean_inference_ms": 0.6760593335305382}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 180000, "sample_time_ms": 13234.571, "load_time_ms": 18.918, "grad_time_ms": 2484.812, "update_time_ms": 77.297, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 140.12142944335938, "policy_loss": -0.008452658541500568, "vf_loss": 140.1298065185547, "vf_explained_var": 0.041191041469573975, "kl": 0.01163876336067915, "entropy": 2.653517007827759, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 180000, "episodes_total": 359, "training_iteration": 9, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-47-02", "timestamp": 1567543622, "time_this_iter_s": 14.772355318069458, "time_total_s": 142.50353455543518, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 142.50353455543518, "timesteps_since_restore": 180000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.88095238095238, "ram_util_percent": 12.49047619047619}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 265.8960670911867, "episode_reward_min": -258.1547456077722, "episode_reward_mean": 182.99272898409905, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.209991723218484, "mean_processing_ms": 2.326591619831053, "mean_inference_ms": 0.6744144733972048}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199680, "num_steps_sampled": 200000, "sample_time_ms": 13200.081, "load_time_ms": 18.637, "grad_time_ms": 2476.716, "update_time_ms": 70.009, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 168.7500457763672, "policy_loss": -0.007051079533994198, "vf_loss": 168.7570343017578, "vf_explained_var": 0.04737207666039467, "kl": 0.009249154478311539, "entropy": 2.61974835395813, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 200000, "episodes_total": 399, "training_iteration": 10, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-47-17", "timestamp": 1567543637, "time_this_iter_s": 15.327014923095703, "time_total_s": 157.83054947853088, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 157.83054947853088, "timesteps_since_restore": 200000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.27272727272727, "ram_util_percent": 12.5}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 280.0081213118675, "episode_reward_min": 25.44346925978987, "episode_reward_mean": 202.0165687260249, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1854247359192307, "mean_processing_ms": 2.3278510299447146, "mean_inference_ms": 0.6722848538599699}, "off_policy_estimator": {}, "info": {"num_steps_trained": 219648, "num_steps_sampled": 220000, "sample_time_ms": 12728.93, "load_time_ms": 13.499, "grad_time_ms": 2405.69, "update_time_ms": 4.867, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 185.6231689453125, "policy_loss": -0.009773681871592999, "vf_loss": 185.63291931152344, "vf_explained_var": 0.09072241187095642, "kl": 0.012990658171474934, "entropy": 2.585411548614502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 220000, "episodes_total": 438, "training_iteration": 11, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-47-32", "timestamp": 1567543652, "time_this_iter_s": 15.39618468284607, "time_total_s": 173.22673416137695, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 173.22673416137695, "timesteps_since_restore": 220000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.53181818181818, "ram_util_percent": 12.5}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 299.83488000307426, "episode_reward_min": 25.44346925978987, "episode_reward_mean": 216.33686246070522, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1738974862027294, "mean_processing_ms": 2.3276527918726466, "mean_inference_ms": 0.670994545900982}, "off_policy_estimator": {}, "info": {"num_steps_trained": 239616, "num_steps_sampled": 240000, "sample_time_ms": 12627.601, "load_time_ms": 13.202, "grad_time_ms": 2405.251, "update_time_ms": 4.886, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 184.4212188720703, "policy_loss": -0.0067380438558757305, "vf_loss": 184.4279327392578, "vf_explained_var": 0.0012438923586159945, "kl": 0.010161335580050945, "entropy": 2.546494483947754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 240000, "episodes_total": 478, "training_iteration": 12, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-47-48", "timestamp": 1567543668, "time_this_iter_s": 15.194868803024292, "time_total_s": 188.42160296440125, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 188.42160296440125, "timesteps_since_restore": 240000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.223809523809514, "ram_util_percent": 12.504761904761907}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 299.94617394973886, "episode_reward_min": 66.73287396096129, "episode_reward_mean": 238.67056533989816, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1666987063536793, "mean_processing_ms": 2.3288727329519916, "mean_inference_ms": 0.6706487023145862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259584, "num_steps_sampled": 260000, "sample_time_ms": 12613.192, "load_time_ms": 12.875, "grad_time_ms": 2405.237, "update_time_ms": 4.859, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 198.11422729492188, "policy_loss": -0.006564135197550058, "vf_loss": 198.12075805664062, "vf_explained_var": 0.0016944595845416188, "kl": 0.013509111478924751, "entropy": 2.4924848079681396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 260000, "episodes_total": 518, "training_iteration": 13, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-48-03", "timestamp": 1567543683, "time_this_iter_s": 15.247387886047363, "time_total_s": 203.6689908504486, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 203.6689908504486, "timesteps_since_restore": 260000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.777272727272724, "ram_util_percent": 12.495454545454548}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 314.91292219144685, "episode_reward_min": 154.0911940640865, "episode_reward_mean": 252.4592472911458, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1562351653886807, "mean_processing_ms": 2.3295363075686124, "mean_inference_ms": 0.6701872512550855}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279552, "num_steps_sampled": 280000, "sample_time_ms": 12631.072, "load_time_ms": 12.869, "grad_time_ms": 2405.432, "update_time_ms": 4.888, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 206.0426483154297, "policy_loss": -0.00976544339209795, "vf_loss": 206.05233764648438, "vf_explained_var": 0.00026801342028193176, "kl": 0.020799150690436363, "entropy": 2.4460489749908447, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 280000, "episodes_total": 558, "training_iteration": 14, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-48-18", "timestamp": 1567543698, "time_this_iter_s": 15.030431985855103, "time_total_s": 218.6994228363037, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 218.6994228363037, "timesteps_since_restore": 280000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.39545454545454, "ram_util_percent": 12.509090909090908}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 314.91292219144685, "episode_reward_min": 202.85692834173213, "episode_reward_mean": 265.6498271792887, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.154426053147749, "mean_processing_ms": 2.3308249996871235, "mean_inference_ms": 0.6701784983081533}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299520, "num_steps_sampled": 300000, "sample_time_ms": 12668.359, "load_time_ms": 12.878, "grad_time_ms": 2403.982, "update_time_ms": 4.861, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 219.72731018066406, "policy_loss": -0.009313320741057396, "vf_loss": 219.736572265625, "vf_explained_var": 6.667123670922592e-05, "kl": 0.02328171394765377, "entropy": 2.416278839111328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 300000, "episodes_total": 599, "training_iteration": 15, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-48-33", "timestamp": 1567543713, "time_this_iter_s": 15.185801982879639, "time_total_s": 233.88522481918335, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 233.88522481918335, "timesteps_since_restore": 300000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.46666666666666, "ram_util_percent": 12.5}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 326.3866399834095, "episode_reward_min": 202.85692834173213, "episode_reward_mean": 274.0880871850975, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1355357665838, "mean_processing_ms": 2.331627548734147, "mean_inference_ms": 0.6698779229488205}, "off_policy_estimator": {}, "info": {"num_steps_trained": 319488, "num_steps_sampled": 320000, "sample_time_ms": 12705.515, "load_time_ms": 12.864, "grad_time_ms": 2404.064, "update_time_ms": 4.87, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 224.68649291992188, "policy_loss": -0.0070594120770692825, "vf_loss": 224.6935577392578, "vf_explained_var": 2.1227277102298103e-05, "kl": 0.012931501492857933, "entropy": 2.3752963542938232, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 320000, "episodes_total": 638, "training_iteration": 16, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-48-49", "timestamp": 1567543729, "time_this_iter_s": 15.366904973983765, "time_total_s": 249.25212979316711, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 249.25212979316711, "timesteps_since_restore": 320000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.27272727272728, "ram_util_percent": 12.504545454545456}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 326.5392561227485, "episode_reward_min": 230.69195291885197, "episode_reward_mean": 279.16579361062605, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1248293218379435, "mean_processing_ms": 2.3303061483442518, "mean_inference_ms": 0.6699163942671337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 339456, "num_steps_sampled": 340000, "sample_time_ms": 12718.693, "load_time_ms": 12.911, "grad_time_ms": 2404.007, "update_time_ms": 4.904, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 231.34671020507812, "policy_loss": -0.00655379518866539, "vf_loss": 231.35321044921875, "vf_explained_var": 4.880397682427429e-05, "kl": 0.016882022842764854, "entropy": 2.359689235687256, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 340000, "episodes_total": 678, "training_iteration": 17, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-49-04", "timestamp": 1567543744, "time_this_iter_s": 15.048454284667969, "time_total_s": 264.3005840778351, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 264.3005840778351, "timesteps_since_restore": 340000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.71363636363636, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 329.0655594947591, "episode_reward_min": 230.69195291885197, "episode_reward_mean": 282.7421043314113, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1185741079366176, "mean_processing_ms": 2.330871441130631, "mean_inference_ms": 0.6696465429508237}, "off_policy_estimator": {}, "info": {"num_steps_trained": 359424, "num_steps_sampled": 360000, "sample_time_ms": 12727.015, "load_time_ms": 12.891, "grad_time_ms": 2404.46, "update_time_ms": 4.809, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 241.36402893066406, "policy_loss": -0.0071369134820997715, "vf_loss": 241.37109375, "vf_explained_var": 0.00014762084174435586, "kl": 0.017947392538189888, "entropy": 2.350379228591919, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 360000, "episodes_total": 718, "training_iteration": 18, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-49-19", "timestamp": 1567543759, "time_this_iter_s": 15.055039882659912, "time_total_s": 279.355623960495, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 279.355623960495, "timesteps_since_restore": 360000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 34.919047619047625, "ram_util_percent": 12.514285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 340.9510145176942, "episode_reward_min": 230.69195291885197, "episode_reward_mean": 286.1827234421231, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.105273171856735, "mean_processing_ms": 2.3321620278162056, "mean_inference_ms": 0.6689522688085386}, "off_policy_estimator": {}, "info": {"num_steps_trained": 379392, "num_steps_sampled": 380000, "sample_time_ms": 12787.759, "load_time_ms": 12.898, "grad_time_ms": 2404.56, "update_time_ms": 4.788, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 245.5605010986328, "policy_loss": -0.006118068937212229, "vf_loss": 245.56663513183594, "vf_explained_var": 8.46309558255598e-06, "kl": 0.007133211940526962, "entropy": 2.349973201751709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 380000, "episodes_total": 759, "training_iteration": 19, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-49-34", "timestamp": 1567543774, "time_this_iter_s": 15.37886667251587, "time_total_s": 294.73449063301086, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 294.73449063301086, "timesteps_since_restore": 380000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.25909090909091, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 340.9510145176942, "episode_reward_min": 236.63408401428262, "episode_reward_mean": 288.01953910326534, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1154704703052825, "mean_processing_ms": 2.333164347387532, "mean_inference_ms": 0.6690567619688872}, "off_policy_estimator": {}, "info": {"num_steps_trained": 399360, "num_steps_sampled": 400000, "sample_time_ms": 12811.241, "load_time_ms": 12.541, "grad_time_ms": 2405.267, "update_time_ms": 4.818, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 242.5547332763672, "policy_loss": -0.004827008582651615, "vf_loss": 242.55953979492188, "vf_explained_var": 9.2937398221693e-06, "kl": 0.008858722634613514, "entropy": 2.3304715156555176, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 400000, "episodes_total": 799, "training_iteration": 20, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-49-50", "timestamp": 1567543790, "time_this_iter_s": 15.565548419952393, "time_total_s": 310.30003905296326, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 310.30003905296326, "timesteps_since_restore": 400000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.768181818181816, "ram_util_percent": 12.52727272727273}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 355.40040915999793, "episode_reward_min": 223.8585003502388, "episode_reward_mean": 287.2354977099044, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1057571424086787, "mean_processing_ms": 2.3334876850553896, "mean_inference_ms": 0.6691816356313464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419328, "num_steps_sampled": 420000, "sample_time_ms": 12817.432, "load_time_ms": 12.519, "grad_time_ms": 2405.385, "update_time_ms": 4.802, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 244.67457580566406, "policy_loss": -0.007238660007715225, "vf_loss": 244.6818389892578, "vf_explained_var": 1.358412737317849e-05, "kl": 0.011500522494316101, "entropy": 2.3012919425964355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 420000, "episodes_total": 839, "training_iteration": 21, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-50-05", "timestamp": 1567543805, "time_this_iter_s": 15.458967447280884, "time_total_s": 325.75900650024414, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 325.75900650024414, "timesteps_since_restore": 420000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.20454545454545, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 357.3799090048698, "episode_reward_min": 108.35968364196643, "episode_reward_mean": 276.76888722846604, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1009265820291456, "mean_processing_ms": 2.3337518792061256, "mean_inference_ms": 0.6694338633034093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 439296, "num_steps_sampled": 440000, "sample_time_ms": 12837.672, "load_time_ms": 12.542, "grad_time_ms": 2405.435, "update_time_ms": 4.736, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 226.0787811279297, "policy_loss": -0.007830794900655746, "vf_loss": 226.0865936279297, "vf_explained_var": 5.754140488534176e-07, "kl": 0.02094193920493126, "entropy": 2.288215398788452, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 440000, "episodes_total": 879, "training_iteration": 22, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-50-21", "timestamp": 1567543821, "time_this_iter_s": 15.397355079650879, "time_total_s": 341.156361579895, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 341.156361579895, "timesteps_since_restore": 440000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 33.66363636363636, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 363.9816393342159, "episode_reward_min": 108.35968364196643, "episode_reward_mean": 270.80218923435274, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0975187927071435, "mean_processing_ms": 2.3339379186351463, "mean_inference_ms": 0.6695279774867311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459264, "num_steps_sampled": 460000, "sample_time_ms": 12840.298, "load_time_ms": 12.548, "grad_time_ms": 2404.797, "update_time_ms": 4.757, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 231.37246704101562, "policy_loss": -0.009452314116060734, "vf_loss": 231.3819122314453, "vf_explained_var": 5.23451035405742e-07, "kl": 0.0179238673299551, "entropy": 2.268950939178467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 460000, "episodes_total": 919, "training_iteration": 23, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-50-36", "timestamp": 1567543836, "time_this_iter_s": 15.267491340637207, "time_total_s": 356.4238529205322, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 356.4238529205322, "timesteps_since_restore": 460000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.68181818181819, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 366.68422751879854, "episode_reward_min": 106.5529230667177, "episode_reward_mean": 277.6880140431867, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0921334195380967, "mean_processing_ms": 2.3339492768168264, "mean_inference_ms": 0.6696814810963957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 479232, "num_steps_sampled": 480000, "sample_time_ms": 12861.786, "load_time_ms": 12.568, "grad_time_ms": 2404.673, "update_time_ms": 4.698, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 237.2121124267578, "policy_loss": -0.0060222395695745945, "vf_loss": 237.21815490722656, "vf_explained_var": 1.2455842579583987e-07, "kl": 0.008660037070512772, "entropy": 2.2521374225616455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 480000, "episodes_total": 959, "training_iteration": 24, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-50-51", "timestamp": 1567543851, "time_this_iter_s": 15.243858814239502, "time_total_s": 371.66771173477173, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 371.66771173477173, "timesteps_since_restore": 480000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.972727272727276, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 366.68422751879854, "episode_reward_min": 106.5529230667177, "episode_reward_mean": 279.28460755506495, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.078359558869641, "mean_processing_ms": 2.332908376685408, "mean_inference_ms": 0.6700402146233481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499200, "num_steps_sampled": 500000, "sample_time_ms": 12870.716, "load_time_ms": 12.529, "grad_time_ms": 2403.902, "update_time_ms": 4.721, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 239.7595672607422, "policy_loss": -0.005900655407458544, "vf_loss": 239.76547241210938, "vf_explained_var": 3.8972267191184073e-08, "kl": 0.014003345742821693, "entropy": 2.2205352783203125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 500000, "episodes_total": 998, "training_iteration": 25, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-51-06", "timestamp": 1567543866, "time_this_iter_s": 15.267207860946655, "time_total_s": 386.9349195957184, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 386.9349195957184, "timesteps_since_restore": 500000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 33.92727272727272, "ram_util_percent": 12.513636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 366.68422751879854, "episode_reward_min": 132.27667742224332, "episode_reward_mean": 281.386398998126, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0810058818219295, "mean_processing_ms": 2.3330036466050763, "mean_inference_ms": 0.6700946972891145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 519168, "num_steps_sampled": 520000, "sample_time_ms": 12841.664, "load_time_ms": 12.503, "grad_time_ms": 2404.076, "update_time_ms": 4.687, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 241.798828125, "policy_loss": -0.008422665297985077, "vf_loss": 241.80723571777344, "vf_explained_var": 2.0364921056170715e-06, "kl": 0.020497309044003487, "entropy": 2.229217529296875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 520000, "episodes_total": 1039, "training_iteration": 26, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-51-21", "timestamp": 1567543881, "time_this_iter_s": 15.077603816986084, "time_total_s": 402.01252341270447, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 402.01252341270447, "timesteps_since_restore": 520000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 34.30952380952381, "ram_util_percent": 12.514285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 364.50077009947165, "episode_reward_min": 132.27667742224332, "episode_reward_mean": 285.81119128415526, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0760535724372406, "mean_processing_ms": 2.333303668199258, "mean_inference_ms": 0.6701386985207606}, "off_policy_estimator": {}, "info": {"num_steps_trained": 539136, "num_steps_sampled": 540000, "sample_time_ms": 12864.775, "load_time_ms": 12.441, "grad_time_ms": 2403.57, "update_time_ms": 4.748, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 254.92332458496094, "policy_loss": -0.006621114909648895, "vf_loss": 254.929931640625, "vf_explained_var": 4.0786006138660014e-05, "kl": 0.010597897693514824, "entropy": 2.1933820247650146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 540000, "episodes_total": 1079, "training_iteration": 27, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-51-37", "timestamp": 1567543897, "time_this_iter_s": 15.275099277496338, "time_total_s": 417.2876226902008, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 417.2876226902008, "timesteps_since_restore": 540000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.96818181818182, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 375.64457922825903, "episode_reward_min": 157.4119627892536, "episode_reward_mean": 291.59742446269104, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0806226389922484, "mean_processing_ms": 2.3334074219724306, "mean_inference_ms": 0.6701642617064195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559104, "num_steps_sampled": 560000, "sample_time_ms": 12895.524, "load_time_ms": 12.472, "grad_time_ms": 2403.055, "update_time_ms": 4.783, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 262.45306396484375, "policy_loss": -0.00856592133641243, "vf_loss": 262.4616394042969, "vf_explained_var": 6.311597189778695e-06, "kl": 0.020940175279974937, "entropy": 2.213959217071533, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 560000, "episodes_total": 1119, "training_iteration": 28, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-51-52", "timestamp": 1567543912, "time_this_iter_s": 15.358604431152344, "time_total_s": 432.64622712135315, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 432.64622712135315, "timesteps_since_restore": 560000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.040909090909096, "ram_util_percent": 12.51818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 394.21475501686473, "episode_reward_min": 157.4119627892536, "episode_reward_mean": 297.72092153756944, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0781241858200885, "mean_processing_ms": 2.3336492736481795, "mean_inference_ms": 0.6701772090563236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 579072, "num_steps_sampled": 580000, "sample_time_ms": 12887.56, "load_time_ms": 12.43, "grad_time_ms": 2403.018, "update_time_ms": 4.862, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 275.76019287109375, "policy_loss": -0.006035313475877047, "vf_loss": 275.7662353515625, "vf_explained_var": 6.386484983522678e-06, "kl": 0.011683656834065914, "entropy": 2.1777641773223877, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 580000, "episodes_total": 1159, "training_iteration": 29, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-52-07", "timestamp": 1567543927, "time_this_iter_s": 15.300368070602417, "time_total_s": 447.94659519195557, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 447.94659519195557, "timesteps_since_restore": 580000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.354545454545445, "ram_util_percent": 12.536363636363637}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 396.4243365278404, "episode_reward_min": 182.95530410426693, "episode_reward_mean": 304.90149803260056, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076769881461794, "mean_processing_ms": 2.3338064111992383, "mean_inference_ms": 0.6701907426366486}, "off_policy_estimator": {}, "info": {"num_steps_trained": 599040, "num_steps_sampled": 600000, "sample_time_ms": 12869.988, "load_time_ms": 12.456, "grad_time_ms": 2401.982, "update_time_ms": 4.911, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 284.3492126464844, "policy_loss": -0.0073365927673876286, "vf_loss": 284.35650634765625, "vf_explained_var": 4.144815193285467e-06, "kl": 0.012925664894282818, "entropy": 2.1349780559539795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 600000, "episodes_total": 1199, "training_iteration": 30, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-52-23", "timestamp": 1567543943, "time_this_iter_s": 15.380234003067017, "time_total_s": 463.3268291950226, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 463.3268291950226, "timesteps_since_restore": 600000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.84285714285714, "ram_util_percent": 12.52857142857143}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 402.3847038103355, "episode_reward_min": 162.20621613683974, "episode_reward_mean": 297.81228318212163, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.076346615123565, "mean_processing_ms": 2.334024838341823, "mean_inference_ms": 0.6704174608000851}, "off_policy_estimator": {}, "info": {"num_steps_trained": 619008, "num_steps_sampled": 620000, "sample_time_ms": 12841.151, "load_time_ms": 12.483, "grad_time_ms": 2402.574, "update_time_ms": 4.864, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 266.50677490234375, "policy_loss": -0.007176938001066446, "vf_loss": 266.51397705078125, "vf_explained_var": 9.84267535386607e-05, "kl": 0.01857684552669525, "entropy": 2.1750190258026123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 620000, "episodes_total": 1239, "training_iteration": 31, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-52-38", "timestamp": 1567543958, "time_this_iter_s": 15.176435470581055, "time_total_s": 478.50326466560364, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 478.50326466560364, "timesteps_since_restore": 620000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.81818181818181, "ram_util_percent": 12.545454545454549}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 416.16415992586576, "episode_reward_min": 162.20621613683974, "episode_reward_mean": 292.880526760039, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.074990389473913, "mean_processing_ms": 2.334278584138387, "mean_inference_ms": 0.6705241071376379}, "off_policy_estimator": {}, "info": {"num_steps_trained": 638976, "num_steps_sampled": 640000, "sample_time_ms": 12821.769, "load_time_ms": 12.45, "grad_time_ms": 2401.585, "update_time_ms": 4.839, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 278.32720947265625, "policy_loss": -0.008377345278859138, "vf_loss": 278.3356018066406, "vf_explained_var": 1.2322496331762522e-05, "kl": 0.03171496093273163, "entropy": 2.1889872550964355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 640000, "episodes_total": 1279, "training_iteration": 32, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-52-53", "timestamp": 1567543973, "time_this_iter_s": 15.193126201629639, "time_total_s": 493.6963908672333, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 493.6963908672333, "timesteps_since_restore": 640000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.92727272727273, "ram_util_percent": 12.545454545454549}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 416.16415992586576, "episode_reward_min": 174.4800575018756, "episode_reward_mean": 295.4163398507003, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.065753314302218, "mean_processing_ms": 2.3335411240538653, "mean_inference_ms": 0.6701009052404646}, "off_policy_estimator": {}, "info": {"num_steps_trained": 658944, "num_steps_sampled": 660000, "sample_time_ms": 12800.997, "load_time_ms": 12.474, "grad_time_ms": 2402.686, "update_time_ms": 4.885, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 285.8058776855469, "policy_loss": -0.007379360496997833, "vf_loss": 285.8132629394531, "vf_explained_var": 7.448670203302754e-06, "kl": 0.024599820375442505, "entropy": 2.193166971206665, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 660000, "episodes_total": 1318, "training_iteration": 33, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-53-08", "timestamp": 1567543988, "time_this_iter_s": 15.071573972702026, "time_total_s": 508.7679648399353, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 508.7679648399353, "timesteps_since_restore": 660000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 34.766666666666666, "ram_util_percent": 12.557142857142857}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 403.117074703653, "episode_reward_min": 185.45179663928116, "episode_reward_mean": 294.6428323412621, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0704299291148187, "mean_processing_ms": 2.3334448535779857, "mean_inference_ms": 0.6699102499785031}, "off_policy_estimator": {}, "info": {"num_steps_trained": 678912, "num_steps_sampled": 680000, "sample_time_ms": 12779.825, "load_time_ms": 12.434, "grad_time_ms": 2402.792, "update_time_ms": 4.949, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 294.1404113769531, "policy_loss": -0.005762116983532906, "vf_loss": 294.1461486816406, "vf_explained_var": 9.843210136750713e-05, "kl": 0.013420379720628262, "entropy": 2.163896322250366, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 680000, "episodes_total": 1359, "training_iteration": 34, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-53-23", "timestamp": 1567544003, "time_this_iter_s": 15.03295636177063, "time_total_s": 523.8009212017059, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 523.8009212017059, "timesteps_since_restore": 680000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.295454545454554, "ram_util_percent": 12.540909090909093}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 403.117074703653, "episode_reward_min": 185.45179663928116, "episode_reward_mean": 296.97335171959344, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.066435192669207, "mean_processing_ms": 2.3340643399800896, "mean_inference_ms": 0.6699304565013128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 698880, "num_steps_sampled": 700000, "sample_time_ms": 12773.357, "load_time_ms": 12.423, "grad_time_ms": 2403.786, "update_time_ms": 4.945, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 299.8371276855469, "policy_loss": -0.006582553498446941, "vf_loss": 299.8437194824219, "vf_explained_var": 4.820716640097089e-06, "kl": 0.009662678465247154, "entropy": 2.1279053688049316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 700000, "episodes_total": 1399, "training_iteration": 35, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-53-38", "timestamp": 1567544018, "time_this_iter_s": 15.211978912353516, "time_total_s": 539.0129001140594, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 539.0129001140594, "timesteps_since_restore": 700000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.671428571428564, "ram_util_percent": 12.552380952380954}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 401.2393632439669, "episode_reward_min": 185.45179663928116, "episode_reward_mean": 299.46712475232994, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.062766975519629, "mean_processing_ms": 2.3340410283436297, "mean_inference_ms": 0.6700224578943578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 718848, "num_steps_sampled": 720000, "sample_time_ms": 12790.33, "load_time_ms": 12.513, "grad_time_ms": 2402.919, "update_time_ms": 5.022, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 306.00201416015625, "policy_loss": -0.00578199652954936, "vf_loss": 306.0078125, "vf_explained_var": 2.2516036551678553e-05, "kl": 0.011855029501020908, "entropy": 2.095231294631958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 720000, "episodes_total": 1439, "training_iteration": 36, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-53-54", "timestamp": 1567544034, "time_this_iter_s": 15.240365743637085, "time_total_s": 554.2532658576965, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 554.2532658576965, "timesteps_since_restore": 720000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.33636363636362, "ram_util_percent": 12.572727272727274}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 401.2393632439669, "episode_reward_min": 221.73613785991964, "episode_reward_mean": 301.7452952461361, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0603100403525536, "mean_processing_ms": 2.3335974663258408, "mean_inference_ms": 0.6701107475507766}, "off_policy_estimator": {}, "info": {"num_steps_trained": 738816, "num_steps_sampled": 740000, "sample_time_ms": 12769.319, "load_time_ms": 12.516, "grad_time_ms": 2402.448, "update_time_ms": 4.982, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 309.2838134765625, "policy_loss": -0.006915012840181589, "vf_loss": 309.29071044921875, "vf_explained_var": 1.994081003431347e-06, "kl": 0.012301310896873474, "entropy": 2.0552241802215576, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 740000, "episodes_total": 1478, "training_iteration": 37, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-54-09", "timestamp": 1567544049, "time_this_iter_s": 15.059213399887085, "time_total_s": 569.3124792575836, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 569.3124792575836, "timesteps_since_restore": 740000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 34.24090909090909, "ram_util_percent": 12.58181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 396.91870479595497, "episode_reward_min": 240.6372636485546, "episode_reward_mean": 300.8619799346598, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.057722845491501, "mean_processing_ms": 2.33306399475107, "mean_inference_ms": 0.6699290842858193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758784, "num_steps_sampled": 760000, "sample_time_ms": 12743.816, "load_time_ms": 12.476, "grad_time_ms": 2403.286, "update_time_ms": 4.956, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 312.4109191894531, "policy_loss": -0.007730436511337757, "vf_loss": 312.4186706542969, "vf_explained_var": 1.1150653335789684e-05, "kl": 0.016031917184591293, "entropy": 2.0375218391418457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 760000, "episodes_total": 1518, "training_iteration": 38, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-54-24", "timestamp": 1567544064, "time_this_iter_s": 15.11018419265747, "time_total_s": 584.4226634502411, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 584.4226634502411, "timesteps_since_restore": 760000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 34.78095238095237, "ram_util_percent": 12.58095238095238}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 407.61919186349496, "episode_reward_min": 214.547118728487, "episode_reward_mean": 300.5861012459211, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.056066995672745, "mean_processing_ms": 2.3336222402451376, "mean_inference_ms": 0.6695732563296724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 778752, "num_steps_sampled": 780000, "sample_time_ms": 12729.217, "load_time_ms": 12.478, "grad_time_ms": 2402.991, "update_time_ms": 4.851, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 319.43206787109375, "policy_loss": -0.008118197321891785, "vf_loss": 319.4402160644531, "vf_explained_var": 3.5889253922505304e-05, "kl": 0.02074590139091015, "entropy": 2.015268087387085, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 780000, "episodes_total": 1559, "training_iteration": 39, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-54-39", "timestamp": 1567544079, "time_this_iter_s": 15.149367332458496, "time_total_s": 599.5720307826996, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 599.5720307826996, "timesteps_since_restore": 780000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.845454545454544, "ram_util_percent": 12.586363636363636}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 407.61919186349496, "episode_reward_min": 213.90820290155273, "episode_reward_mean": 303.82657585513664, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.057450319640127, "mean_processing_ms": 2.3338098176711735, "mean_inference_ms": 0.6694588660531806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 798720, "num_steps_sampled": 800000, "sample_time_ms": 12726.52, "load_time_ms": 12.424, "grad_time_ms": 2403.138, "update_time_ms": 4.829, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 328.8329162597656, "policy_loss": -0.005640372168272734, "vf_loss": 328.8385314941406, "vf_explained_var": 5.7128759181068745e-06, "kl": 0.012118171900510788, "entropy": 1.974206805229187, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 800000, "episodes_total": 1598, "training_iteration": 40, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-54-54", "timestamp": 1567544094, "time_this_iter_s": 15.353773593902588, "time_total_s": 614.9258043766022, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 614.9258043766022, "timesteps_since_restore": 800000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.58636363636364, "ram_util_percent": 12.604545454545452}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.8718627667735, "episode_reward_min": 213.90820290155273, "episode_reward_mean": 316.3416787008611, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.050276736278114, "mean_processing_ms": 2.333629302968302, "mean_inference_ms": 0.6690755625631286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 818688, "num_steps_sampled": 820000, "sample_time_ms": 12726.539, "load_time_ms": 12.429, "grad_time_ms": 2402.817, "update_time_ms": 4.879, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 355.93072509765625, "policy_loss": -0.012092484161257744, "vf_loss": 355.94287109375, "vf_explained_var": 1.4553467053701752e-06, "kl": 0.03579055517911911, "entropy": 1.9817569255828857, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 820000, "episodes_total": 1638, "training_iteration": 41, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-55-10", "timestamp": 1567544110, "time_this_iter_s": 15.174504041671753, "time_total_s": 630.1003084182739, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 630.1003084182739, "timesteps_since_restore": 820000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.857142857142854, "ram_util_percent": 12.595238095238093}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.8718627667735, "episode_reward_min": 223.335187691237, "episode_reward_mean": 331.67572889833355, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.05292436092412, "mean_processing_ms": 2.3340519899213343, "mean_inference_ms": 0.6688968688880402}, "off_policy_estimator": {}, "info": {"num_steps_trained": 838656, "num_steps_sampled": 840000, "sample_time_ms": 12763.304, "load_time_ms": 12.445, "grad_time_ms": 2403.79, "update_time_ms": 4.94, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 372.06646728515625, "policy_loss": -0.007970691658556461, "vf_loss": 372.0744323730469, "vf_explained_var": 5.486684244715434e-07, "kl": 0.021131185814738274, "entropy": 1.9386075735092163, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 840000, "episodes_total": 1679, "training_iteration": 42, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-55-25", "timestamp": 1567544125, "time_this_iter_s": 15.571174621582031, "time_total_s": 645.671483039856, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 645.671483039856, "timesteps_since_restore": 840000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.239130434782616, "ram_util_percent": 12.59565217391304}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 399.5977671898504, "episode_reward_min": 205.7935647724271, "episode_reward_mean": 341.2735713916179, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0461802285936144, "mean_processing_ms": 2.333758026775007, "mean_inference_ms": 0.6688322050434573}, "off_policy_estimator": {}, "info": {"num_steps_trained": 858624, "num_steps_sampled": 860000, "sample_time_ms": 12812.84, "load_time_ms": 12.44, "grad_time_ms": 2403.597, "update_time_ms": 4.928, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 369.33465576171875, "policy_loss": -0.012097892351448536, "vf_loss": 369.34674072265625, "vf_explained_var": 0.00021743086108472198, "kl": 0.03965045139193535, "entropy": 1.9481686353683472, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 860000, "episodes_total": 1717, "training_iteration": 43, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-55-41", "timestamp": 1567544141, "time_this_iter_s": 15.564130306243896, "time_total_s": 661.2356133460999, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 661.2356133460999, "timesteps_since_restore": 860000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 35.29090909090908, "ram_util_percent": 12.595454545454544}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.38591854998543, "episode_reward_min": 192.9183957582636, "episode_reward_mean": 338.8824769585276, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0507698426951446, "mean_processing_ms": 2.3340592405210248, "mean_inference_ms": 0.6685981321850085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 878592, "num_steps_sampled": 880000, "sample_time_ms": 12850.166, "load_time_ms": 12.461, "grad_time_ms": 2401.803, "update_time_ms": 4.968, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 384.8707580566406, "policy_loss": -0.004276593681424856, "vf_loss": 384.87506103515625, "vf_explained_var": 8.779076779319439e-06, "kl": 0.011538452468812466, "entropy": 1.932281255722046, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 880000, "episodes_total": 1759, "training_iteration": 44, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-55-56", "timestamp": 1567544156, "time_this_iter_s": 15.38870358467102, "time_total_s": 676.6243169307709, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 676.6243169307709, "timesteps_since_restore": 880000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 12.62272727272727}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.38591854998543, "episode_reward_min": 192.9183957582636, "episode_reward_mean": 338.6153743375017, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0561683379066675, "mean_processing_ms": 2.3337846012649304, "mean_inference_ms": 0.6687305290962311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 898560, "num_steps_sampled": 900000, "sample_time_ms": 12878.857, "load_time_ms": 12.479, "grad_time_ms": 2401.13, "update_time_ms": 4.98, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 385.8151550292969, "policy_loss": -0.0059134466573596, "vf_loss": 385.8210754394531, "vf_explained_var": 2.102592134178849e-06, "kl": 0.01820521429181099, "entropy": 1.9338397979736328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 900000, "episodes_total": 1798, "training_iteration": 45, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-56-12", "timestamp": 1567544172, "time_this_iter_s": 15.492776870727539, "time_total_s": 692.1170938014984, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 692.1170938014984, "timesteps_since_restore": 900000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 35.4909090909091, "ram_util_percent": 12.609090909090906}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 399.2226851305661, "episode_reward_min": 192.9183957582636, "episode_reward_mean": 337.10320451959916, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.056809481118978, "mean_processing_ms": 2.3342276300233658, "mean_inference_ms": 0.6682170851022804}, "off_policy_estimator": {}, "info": {"num_steps_trained": 918528, "num_steps_sampled": 920000, "sample_time_ms": 12896.463, "load_time_ms": 12.414, "grad_time_ms": 2400.29, "update_time_ms": 4.935, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 389.2468566894531, "policy_loss": -0.0054381238296628, "vf_loss": 389.2522888183594, "vf_explained_var": 6.953875072213123e-06, "kl": 0.012066716328263283, "entropy": 1.9178627729415894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 920000, "episodes_total": 1838, "training_iteration": 46, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-56-27", "timestamp": 1567544187, "time_this_iter_s": 15.407001256942749, "time_total_s": 707.5240950584412, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 707.5240950584412, "timesteps_since_restore": 920000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 12.613636363636362}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 401.29624902838157, "episode_reward_min": 217.28171247093766, "episode_reward_mean": 339.84378385109613, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0569672149621714, "mean_processing_ms": 2.3340629638894814, "mean_inference_ms": 0.668184366532597}, "off_policy_estimator": {}, "info": {"num_steps_trained": 938496, "num_steps_sampled": 940000, "sample_time_ms": 12932.457, "load_time_ms": 12.452, "grad_time_ms": 2400.785, "update_time_ms": 4.944, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 399.2165222167969, "policy_loss": -0.00765422685071826, "vf_loss": 399.22418212890625, "vf_explained_var": 1.3101941476634238e-05, "kl": 0.01779482699930668, "entropy": 1.8984034061431885, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 940000, "episodes_total": 1879, "training_iteration": 47, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-56-43", "timestamp": 1567544203, "time_this_iter_s": 15.425477981567383, "time_total_s": 722.9495730400085, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 722.9495730400085, "timesteps_since_restore": 940000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.68636363636364, "ram_util_percent": 12.609090909090908}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 401.29624902838157, "episode_reward_min": 208.249681297127, "episode_reward_mean": 338.88123167204225, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.057883730223947, "mean_processing_ms": 2.3338801591923435, "mean_inference_ms": 0.6680041872350333}, "off_policy_estimator": {}, "info": {"num_steps_trained": 958464, "num_steps_sampled": 960000, "sample_time_ms": 12975.189, "load_time_ms": 12.458, "grad_time_ms": 2399.945, "update_time_ms": 4.94, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 394.99359130859375, "policy_loss": -0.005065722391009331, "vf_loss": 394.9986267089844, "vf_explained_var": 9.200932254316285e-05, "kl": 0.01429933775216341, "entropy": 1.8842629194259644, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 960000, "episodes_total": 1917, "training_iteration": 48, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-56-58", "timestamp": 1567544218, "time_this_iter_s": 15.530336380004883, "time_total_s": 738.4799094200134, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 738.4799094200134, "timesteps_since_restore": 960000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.09090909090909, "ram_util_percent": 12.609090909090908}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 399.3403881644978, "episode_reward_min": 162.6721983202165, "episode_reward_mean": 335.09929048986254, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.056338253198079, "mean_processing_ms": 2.334203313938022, "mean_inference_ms": 0.6677184412823891}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978432, "num_steps_sampled": 980000, "sample_time_ms": 13021.543, "load_time_ms": 12.462, "grad_time_ms": 2399.818, "update_time_ms": 4.97, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 413.47235107421875, "policy_loss": -0.0045137000270187855, "vf_loss": 413.476806640625, "vf_explained_var": 3.522710903780535e-05, "kl": 0.017181910574436188, "entropy": 1.8708926439285278, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 980000, "episodes_total": 1959, "training_iteration": 49, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-57-14", "timestamp": 1567544234, "time_this_iter_s": 15.612403154373169, "time_total_s": 754.0923125743866, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 754.0923125743866, "timesteps_since_restore": 980000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.22727272727272, "ram_util_percent": 12.613636363636362}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 382.2652624736926, "episode_reward_min": 162.6721983202165, "episode_reward_mean": 333.89146153555174, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.062566279892486, "mean_processing_ms": 2.334468711698765, "mean_inference_ms": 0.6676267658925302}, "off_policy_estimator": {}, "info": {"num_steps_trained": 998400, "num_steps_sampled": 1000000, "sample_time_ms": 13072.168, "load_time_ms": 12.523, "grad_time_ms": 2398.732, "update_time_ms": 5.001, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 411.75335693359375, "policy_loss": -0.004932821728289127, "vf_loss": 411.75830078125, "vf_explained_var": 1.5678695490350947e-05, "kl": 0.012250319123268127, "entropy": 1.8402615785598755, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1000000, "episodes_total": 1999, "training_iteration": 50, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-57-30", "timestamp": 1567544250, "time_this_iter_s": 15.850436210632324, "time_total_s": 769.9427487850189, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 769.9427487850189, "timesteps_since_restore": 1000000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.50000000000001, "ram_util_percent": 12.613043478260868}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 382.2652624736926, "episode_reward_min": 162.6721983202165, "episode_reward_mean": 330.48702016723996, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0648832502732946, "mean_processing_ms": 2.334916654745156, "mean_inference_ms": 0.6676542277377205}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018368, "num_steps_sampled": 1020000, "sample_time_ms": 13116.213, "load_time_ms": 12.512, "grad_time_ms": 2398.231, "update_time_ms": 5.014, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 414.71685791015625, "policy_loss": -0.00494945514947176, "vf_loss": 414.72174072265625, "vf_explained_var": 0.00012440291175153106, "kl": 0.0186365507543087, "entropy": 1.855987548828125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1020000, "episodes_total": 2038, "training_iteration": 51, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-57-45", "timestamp": 1567544265, "time_this_iter_s": 15.610163450241089, "time_total_s": 785.55291223526, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 785.55291223526, "timesteps_since_restore": 1020000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.095454545454544, "ram_util_percent": 12.609090909090908}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 378.9710625302248, "episode_reward_min": 230.71433467120912, "episode_reward_mean": 323.0743164275751, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.069102058667955, "mean_processing_ms": 2.3349264741394005, "mean_inference_ms": 0.667919538406596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1038336, "num_steps_sampled": 1040000, "sample_time_ms": 13131.005, "load_time_ms": 12.464, "grad_time_ms": 2397.323, "update_time_ms": 4.941, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 423.3523254394531, "policy_loss": -0.008126407861709595, "vf_loss": 423.36041259765625, "vf_explained_var": 0.00014920685498509556, "kl": 0.03226059675216675, "entropy": 1.876259207725525, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1040000, "episodes_total": 2079, "training_iteration": 52, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-58-01", "timestamp": 1567544281, "time_this_iter_s": 15.70886516571045, "time_total_s": 801.2617774009705, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 801.2617774009705, "timesteps_since_restore": 1040000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.23478260869565, "ram_util_percent": 12.617391304347823}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 373.9964387291397, "episode_reward_min": 230.71433467120912, "episode_reward_mean": 315.11090675458547, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0698009558004653, "mean_processing_ms": 2.335150305509397, "mean_inference_ms": 0.6678138027270916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1058304, "num_steps_sampled": 1060000, "sample_time_ms": 13132.539, "load_time_ms": 12.477, "grad_time_ms": 2395.393, "update_time_ms": 4.948, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 425.21710205078125, "policy_loss": -0.005223413463681936, "vf_loss": 425.22235107421875, "vf_explained_var": 0.00020089707686565816, "kl": 0.01899494044482708, "entropy": 1.9166070222854614, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1060000, "episodes_total": 2119, "training_iteration": 53, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-58-16", "timestamp": 1567544296, "time_this_iter_s": 15.562023401260376, "time_total_s": 816.8238008022308, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 816.8238008022308, "timesteps_since_restore": 1060000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.054545454545455, "ram_util_percent": 12.609090909090906}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 373.9964387291397, "episode_reward_min": 155.29726907660907, "episode_reward_mean": 312.27648789878674, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.069267795545518, "mean_processing_ms": 2.3349443032740695, "mean_inference_ms": 0.6672694955952582}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1078272, "num_steps_sampled": 1080000, "sample_time_ms": 13115.636, "load_time_ms": 12.453, "grad_time_ms": 2395.934, "update_time_ms": 4.847, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 436.61016845703125, "policy_loss": -0.005512572359293699, "vf_loss": 436.6156921386719, "vf_explained_var": 0.00011582367005757987, "kl": 0.023769065737724304, "entropy": 1.935202956199646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1080000, "episodes_total": 2158, "training_iteration": 54, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-58-32", "timestamp": 1567544312, "time_this_iter_s": 15.224004983901978, "time_total_s": 832.0478057861328, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 832.0478057861328, "timesteps_since_restore": 1080000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 34.16190476190476, "ram_util_percent": 12.614285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 379.8592551141089, "episode_reward_min": 155.29726907660907, "episode_reward_mean": 309.2301825917261, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0695158196720174, "mean_processing_ms": 2.334974758714111, "mean_inference_ms": 0.6671869600107604}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1098240, "num_steps_sampled": 1100000, "sample_time_ms": 13086.153, "load_time_ms": 12.446, "grad_time_ms": 2395.757, "update_time_ms": 4.875, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 454.05975341796875, "policy_loss": -0.008367732167243958, "vf_loss": 454.068115234375, "vf_explained_var": 0.00090340047609061, "kl": 0.0353989377617836, "entropy": 1.9576523303985596, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1100000, "episodes_total": 2199, "training_iteration": 55, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-58-47", "timestamp": 1567544327, "time_this_iter_s": 15.196442604064941, "time_total_s": 847.2442483901978, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 847.2442483901978, "timesteps_since_restore": 1100000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 33.336363636363636, "ram_util_percent": 12.613636363636362}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 379.8592551141089, "episode_reward_min": 232.926942797845, "episode_reward_mean": 310.74925345026827, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0648352359145927, "mean_processing_ms": 2.334593268035423, "mean_inference_ms": 0.6670096653426612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118208, "num_steps_sampled": 1120000, "sample_time_ms": 13061.076, "load_time_ms": 12.468, "grad_time_ms": 2396.134, "update_time_ms": 4.911, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 442.0533752441406, "policy_loss": -0.00547232897952199, "vf_loss": 442.058837890625, "vf_explained_var": 0.006343887187540531, "kl": 0.017147110775113106, "entropy": 1.946962833404541, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1120000, "episodes_total": 2237, "training_iteration": 56, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-59-02", "timestamp": 1567544342, "time_this_iter_s": 15.160709857940674, "time_total_s": 862.4049582481384, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 862.4049582481384, "timesteps_since_restore": 1120000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 33.87272727272727, "ram_util_percent": 12.613636363636362}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 372.88639951460414, "episode_reward_min": 228.57657759991918, "episode_reward_mean": 309.23821181035623, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.064722634412774, "mean_processing_ms": 2.334644533511887, "mean_inference_ms": 0.6666548425562344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1138176, "num_steps_sampled": 1140000, "sample_time_ms": 13017.953, "load_time_ms": 12.428, "grad_time_ms": 2395.276, "update_time_ms": 4.905, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 458.0225830078125, "policy_loss": -0.0157545804977417, "vf_loss": 458.0382995605469, "vf_explained_var": 0.09792418032884598, "kl": 0.06501579284667969, "entropy": 1.9793399572372437, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1140000, "episodes_total": 2279, "training_iteration": 57, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-59-17", "timestamp": 1567544357, "time_this_iter_s": 14.98509430885315, "time_total_s": 877.3900525569916, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 877.3900525569916, "timesteps_since_restore": 1140000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 34.22380952380953, "ram_util_percent": 12.614285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 374.641166979294, "episode_reward_min": 185.12309298341427, "episode_reward_mean": 307.5278551438513, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0595516463303034, "mean_processing_ms": 2.3347955250143086, "mean_inference_ms": 0.6664386021292443}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1158144, "num_steps_sampled": 1160000, "sample_time_ms": 12980.457, "load_time_ms": 12.479, "grad_time_ms": 2394.811, "update_time_ms": 4.876, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 421.81060791015625, "policy_loss": -0.0048300339840352535, "vf_loss": 421.8153991699219, "vf_explained_var": 0.14244399964809418, "kl": 0.015691356733441353, "entropy": 1.9574506282806396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1160000, "episodes_total": 2318, "training_iteration": 58, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-59-32", "timestamp": 1567544372, "time_this_iter_s": 15.149620294570923, "time_total_s": 892.5396728515625, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 892.5396728515625, "timesteps_since_restore": 1160000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 33.89090909090909, "ram_util_percent": 12.618181818181817}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 374.641166979294, "episode_reward_min": 68.21235112590068, "episode_reward_mean": 301.1746781343937, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0606257990462957, "mean_processing_ms": 2.3346756502298076, "mean_inference_ms": 0.6660982199185572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1178112, "num_steps_sampled": 1180000, "sample_time_ms": 12919.9, "load_time_ms": 12.513, "grad_time_ms": 2395.493, "update_time_ms": 4.916, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 433.16656494140625, "policy_loss": -0.005514759104698896, "vf_loss": 433.1720886230469, "vf_explained_var": 0.16313675045967102, "kl": 0.016408143565058708, "entropy": 1.963753342628479, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1180000, "episodes_total": 2358, "training_iteration": 59, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_20-59-47", "timestamp": 1567544387, "time_this_iter_s": 15.014090061187744, "time_total_s": 907.5537629127502, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 907.5537629127502, "timesteps_since_restore": 1180000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 34.48571428571428, "ram_util_percent": 12.614285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 372.8348588074015, "episode_reward_min": -282.0746921016518, "episode_reward_mean": 286.231661331269, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0565875266180296, "mean_processing_ms": 2.3348564409616146, "mean_inference_ms": 0.6661387353308891}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1198080, "num_steps_sampled": 1200000, "sample_time_ms": 12869.147, "load_time_ms": 12.535, "grad_time_ms": 2397.148, "update_time_ms": 4.901, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 453.2945251464844, "policy_loss": -0.005847825203090906, "vf_loss": 453.3003845214844, "vf_explained_var": 0.21311725676059723, "kl": 0.017809970304369926, "entropy": 1.999489188194275, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1200000, "episodes_total": 2399, "training_iteration": 60, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-00-03", "timestamp": 1567544403, "time_this_iter_s": 15.359628915786743, "time_total_s": 922.913391828537, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 922.913391828537, "timesteps_since_restore": 1200000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 33.90909090909091, "ram_util_percent": 12.622727272727273}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 368.08468154240234, "episode_reward_min": -282.0746921016518, "episode_reward_mean": 276.87274523075683, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0520696705539847, "mean_processing_ms": 2.3352503476630972, "mean_inference_ms": 0.6661429230626209}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1218048, "num_steps_sampled": 1220000, "sample_time_ms": 12795.078, "load_time_ms": 12.583, "grad_time_ms": 2398.004, "update_time_ms": 4.863, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 399.3724060058594, "policy_loss": -0.0050793420523405075, "vf_loss": 399.37750244140625, "vf_explained_var": 0.20310728251934052, "kl": 0.01779804565012455, "entropy": 2.0370383262634277, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1220000, "episodes_total": 2438, "training_iteration": 61, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-00-18", "timestamp": 1567544418, "time_this_iter_s": 14.877975225448608, "time_total_s": 937.7913670539856, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 937.7913670539856, "timesteps_since_restore": 1220000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 34.74285714285714, "ram_util_percent": 12.619047619047617}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 354.0393113970463, "episode_reward_min": 153.82553779549173, "episode_reward_mean": 273.5227565028258, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.050601089794165, "mean_processing_ms": 2.3351341067545097, "mean_inference_ms": 0.6661132769589915}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1238016, "num_steps_sampled": 1240000, "sample_time_ms": 12720.423, "load_time_ms": 12.604, "grad_time_ms": 2397.391, "update_time_ms": 4.932, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 427.30157470703125, "policy_loss": -0.003510718932375312, "vf_loss": 427.3050842285156, "vf_explained_var": 0.22016598284244537, "kl": 0.01819387450814247, "entropy": 2.0382096767425537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1240000, "episodes_total": 2479, "training_iteration": 62, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-00-32", "timestamp": 1567544432, "time_this_iter_s": 14.957137823104858, "time_total_s": 952.7485048770905, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 952.7485048770905, "timesteps_since_restore": 1240000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 33.059090909090905, "ram_util_percent": 12.62272727272727}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 316.5083325460359, "episode_reward_min": -97.44764964650686, "episode_reward_mean": 268.11948892723115, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0469356155646286, "mean_processing_ms": 2.3353110848003427, "mean_inference_ms": 0.6661872961730873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1257984, "num_steps_sampled": 1260000, "sample_time_ms": 12695.282, "load_time_ms": 12.602, "grad_time_ms": 2397.417, "update_time_ms": 4.92, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 434.5025634765625, "policy_loss": -0.0036644553765654564, "vf_loss": 434.5061950683594, "vf_explained_var": 0.22087742388248444, "kl": 0.018227797001600266, "entropy": 2.009965181350708, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1260000, "episodes_total": 2519, "training_iteration": 63, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-00-48", "timestamp": 1567544448, "time_this_iter_s": 15.309911251068115, "time_total_s": 968.0584161281586, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 968.0584161281586, "timesteps_since_restore": 1260000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 34.06818181818182, "ram_util_percent": 12.645454545454543}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 316.53899123170345, "episode_reward_min": -97.44764964650686, "episode_reward_mean": 267.62041002500433, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0447213245481595, "mean_processing_ms": 2.335544423519056, "mean_inference_ms": 0.6665519033002654}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277952, "num_steps_sampled": 1280000, "sample_time_ms": 12699.192, "load_time_ms": 12.6, "grad_time_ms": 2398.137, "update_time_ms": 4.979, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 452.96014404296875, "policy_loss": -0.0016948962584137917, "vf_loss": 452.9617919921875, "vf_explained_var": 0.2290765345096588, "kl": 0.020234838128089905, "entropy": 1.9928058385849, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1280000, "episodes_total": 2559, "training_iteration": 64, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-01-03", "timestamp": 1567544463, "time_this_iter_s": 15.270824909210205, "time_total_s": 983.3292410373688, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 983.3292410373688, "timesteps_since_restore": 1280000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.53809523809524, "ram_util_percent": 12.652380952380948}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 320.277833937738, "episode_reward_min": -92.14199264193037, "episode_reward_mean": 275.85979462012335, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0422322374434496, "mean_processing_ms": 2.335253836405772, "mean_inference_ms": 0.6672035076778917}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297920, "num_steps_sampled": 1300000, "sample_time_ms": 12672.872, "load_time_ms": 12.604, "grad_time_ms": 2398.752, "update_time_ms": 4.901, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 450.79400634765625, "policy_loss": -0.0037935394793748856, "vf_loss": 450.7978820800781, "vf_explained_var": 0.2315179854631424, "kl": 0.02132490649819374, "entropy": 1.9915961027145386, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1300000, "episodes_total": 2598, "training_iteration": 65, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-01-18", "timestamp": 1567544478, "time_this_iter_s": 14.939481258392334, "time_total_s": 998.2687222957611, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 998.2687222957611, "timesteps_since_restore": 1300000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 34.013636363636365, "ram_util_percent": 12.65454545454545}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 322.6092859884807, "episode_reward_min": -47.56741011403392, "episode_reward_mean": 277.59169226492855, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.041299139873863, "mean_processing_ms": 2.335262058245272, "mean_inference_ms": 0.667225507137718}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1317888, "num_steps_sampled": 1320000, "sample_time_ms": 12642.005, "load_time_ms": 12.597, "grad_time_ms": 2397.712, "update_time_ms": 4.855, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 473.89422607421875, "policy_loss": -0.004339409992098808, "vf_loss": 473.8985290527344, "vf_explained_var": 0.24420680105686188, "kl": 0.01877240464091301, "entropy": 1.973974347114563, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1320000, "episodes_total": 2639, "training_iteration": 66, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-01-33", "timestamp": 1567544493, "time_this_iter_s": 14.841922760009766, "time_total_s": 1013.1106450557709, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1013.1106450557709, "timesteps_since_restore": 1320000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 34.24761904761905, "ram_util_percent": 12.647619047619045}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 322.6092859884807, "episode_reward_min": -20.775870852124893, "episode_reward_mean": 278.08483271166284, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0386983604089464, "mean_processing_ms": 2.3354161531422193, "mean_inference_ms": 0.6672690162455203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1337856, "num_steps_sampled": 1340000, "sample_time_ms": 12628.951, "load_time_ms": 12.604, "grad_time_ms": 2397.4, "update_time_ms": 4.795, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 480.8619689941406, "policy_loss": -0.002671841299161315, "vf_loss": 480.86468505859375, "vf_explained_var": 0.27191123366355896, "kl": 0.022168492898344994, "entropy": 1.9661611318588257, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1340000, "episodes_total": 2679, "training_iteration": 67, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-01-48", "timestamp": 1567544508, "time_this_iter_s": 14.849965572357178, "time_total_s": 1027.960610628128, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1027.960610628128, "timesteps_since_restore": 1340000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 35.48571428571429, "ram_util_percent": 12.652380952380948}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 326.36692900762864, "episode_reward_min": -49.61763934680631, "episode_reward_mean": 275.1793827304246, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.036610530645271, "mean_processing_ms": 2.3352895095832853, "mean_inference_ms": 0.6675008641810797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1357824, "num_steps_sampled": 1360000, "sample_time_ms": 12605.069, "load_time_ms": 12.595, "grad_time_ms": 2398.076, "update_time_ms": 4.847, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 503.5615539550781, "policy_loss": -0.002034885110333562, "vf_loss": 503.5635070800781, "vf_explained_var": 0.2973790168762207, "kl": 0.021409181877970695, "entropy": 1.9513534307479858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1360000, "episodes_total": 2718, "training_iteration": 68, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-02-03", "timestamp": 1567544523, "time_this_iter_s": 14.918277978897095, "time_total_s": 1042.8788886070251, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1042.8788886070251, "timesteps_since_restore": 1360000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.280952380952385, "ram_util_percent": 12.657142857142855}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 326.36692900762864, "episode_reward_min": -49.61763934680631, "episode_reward_mean": 281.0178781760811, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0347432046587306, "mean_processing_ms": 2.335278522335889, "mean_inference_ms": 0.6677957073727276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377792, "num_steps_sampled": 1380000, "sample_time_ms": 12592.98, "load_time_ms": 12.563, "grad_time_ms": 2397.691, "update_time_ms": 4.755, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 484.3180236816406, "policy_loss": -0.0030421416740864515, "vf_loss": 484.3210144042969, "vf_explained_var": 0.20039160549640656, "kl": 0.023795880377292633, "entropy": 1.9395318031311035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1380000, "episodes_total": 2759, "training_iteration": 69, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-02-18", "timestamp": 1567544538, "time_this_iter_s": 14.889029264450073, "time_total_s": 1057.7679178714752, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1057.7679178714752, "timesteps_since_restore": 1380000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 34.128571428571426, "ram_util_percent": 12.661904761904758}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 356.58628018323174, "episode_reward_min": 205.71430361372117, "episode_reward_mean": 291.33836739287847, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0326242424154963, "mean_processing_ms": 2.335358351676578, "mean_inference_ms": 0.6678914092731378}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1397760, "num_steps_sampled": 1400000, "sample_time_ms": 12579.097, "load_time_ms": 12.537, "grad_time_ms": 2397.909, "update_time_ms": 4.683, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 513.8796997070312, "policy_loss": -0.0035872268490493298, "vf_loss": 513.8832397460938, "vf_explained_var": 0.253766804933548, "kl": 0.019480381160974503, "entropy": 1.909168004989624, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1400000, "episodes_total": 2798, "training_iteration": 70, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-02-33", "timestamp": 1567544553, "time_this_iter_s": 15.221949577331543, "time_total_s": 1072.9898674488068, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1072.9898674488068, "timesteps_since_restore": 1400000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.077272727272735, "ram_util_percent": 12.663636363636359}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 356.58628018323174, "episode_reward_min": -26.070441894598293, "episode_reward_mean": 290.81490189579296, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.028556994692983, "mean_processing_ms": 2.335228066362167, "mean_inference_ms": 0.6677496834109258}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1417728, "num_steps_sampled": 1420000, "sample_time_ms": 12618.333, "load_time_ms": 12.482, "grad_time_ms": 2395.549, "update_time_ms": 4.72, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 505.71624755859375, "policy_loss": -0.000770599814131856, "vf_loss": 505.7169494628906, "vf_explained_var": 0.18357335031032562, "kl": 0.025062164291739464, "entropy": 1.875591516494751, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1420000, "episodes_total": 2838, "training_iteration": 71, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-02-48", "timestamp": 1567544568, "time_this_iter_s": 15.246582269668579, "time_total_s": 1088.2364497184753, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1088.2364497184753, "timesteps_since_restore": 1420000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 32.57727272727273, "ram_util_percent": 12.69090909090909}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 356.58628018323174, "episode_reward_min": -26.070441894598293, "episode_reward_mean": 290.7066294912589, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.029639032863187, "mean_processing_ms": 2.335486874312731, "mean_inference_ms": 0.6673863268853514}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1437696, "num_steps_sampled": 1440000, "sample_time_ms": 12671.046, "load_time_ms": 12.473, "grad_time_ms": 2395.389, "update_time_ms": 4.707, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 526.9124755859375, "policy_loss": -0.0038486910052597523, "vf_loss": 526.916259765625, "vf_explained_var": 0.1686994582414627, "kl": 0.02639925107359886, "entropy": 1.791543960571289, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1440000, "episodes_total": 2879, "training_iteration": 72, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-03-04", "timestamp": 1567544584, "time_this_iter_s": 15.484101295471191, "time_total_s": 1103.7205510139465, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1103.7205510139465, "timesteps_since_restore": 1440000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.900000000000006, "ram_util_percent": 12.68181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 355.1546291595215, "episode_reward_min": -53.290080102014784, "episode_reward_mean": 288.18615008183764, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.028535982416311, "mean_processing_ms": 2.33535528150416, "mean_inference_ms": 0.6672496752757044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1457664, "num_steps_sampled": 1460000, "sample_time_ms": 12685.799, "load_time_ms": 12.465, "grad_time_ms": 2395.432, "update_time_ms": 4.681, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 536.20751953125, "policy_loss": -0.0029691606760025024, "vf_loss": 536.21044921875, "vf_explained_var": 0.21163104474544525, "kl": 0.019969645887613297, "entropy": 1.7775745391845703, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1460000, "episodes_total": 2918, "training_iteration": 73, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-03-19", "timestamp": 1567544599, "time_this_iter_s": 15.458127498626709, "time_total_s": 1119.1786785125732, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1119.1786785125732, "timesteps_since_restore": 1460000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 12.686363636363636}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 357.59229327110484, "episode_reward_min": -53.290080102014784, "episode_reward_mean": 279.9712537090517, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.029685400704384, "mean_processing_ms": 2.3354717241432077, "mean_inference_ms": 0.6673725419830308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477632, "num_steps_sampled": 1480000, "sample_time_ms": 12704.041, "load_time_ms": 12.499, "grad_time_ms": 2394.823, "update_time_ms": 4.755, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 560.7601318359375, "policy_loss": -0.003087475895881653, "vf_loss": 560.7632446289062, "vf_explained_var": 0.16600479185581207, "kl": 0.023140940815210342, "entropy": 1.7583667039871216, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1480000, "episodes_total": 2959, "training_iteration": 74, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-03-34", "timestamp": 1567544614, "time_this_iter_s": 15.448497533798218, "time_total_s": 1134.6271760463715, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1134.6271760463715, "timesteps_since_restore": 1480000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 33.81363636363636, "ram_util_percent": 12.69090909090909}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 357.59229327110484, "episode_reward_min": 117.50363411394198, "episode_reward_mean": 283.36292851834895, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.030773475229518, "mean_processing_ms": 2.335460360448485, "mean_inference_ms": 0.6673929546863477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1497600, "num_steps_sampled": 1500000, "sample_time_ms": 12773.833, "load_time_ms": 12.548, "grad_time_ms": 2394.771, "update_time_ms": 4.832, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 538.0126953125, "policy_loss": -0.0028405177872627974, "vf_loss": 538.0155029296875, "vf_explained_var": 0.16488689184188843, "kl": 0.019962504506111145, "entropy": 1.7262749671936035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1500000, "episodes_total": 2999, "training_iteration": 75, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-03-50", "timestamp": 1567544630, "time_this_iter_s": 15.636814832687378, "time_total_s": 1150.2639908790588, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1150.2639908790588, "timesteps_since_restore": 1500000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.58636363636364, "ram_util_percent": 12.7}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 357.59229327110484, "episode_reward_min": 32.550364172433824, "episode_reward_mean": 284.70664563745936, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0316529574093622, "mean_processing_ms": 2.3354118545407867, "mean_inference_ms": 0.6674360382802318}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1517568, "num_steps_sampled": 1520000, "sample_time_ms": 12838.031, "load_time_ms": 12.513, "grad_time_ms": 2395.748, "update_time_ms": 4.849, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 545.9832763671875, "policy_loss": -0.0009601323399692774, "vf_loss": 545.9841918945312, "vf_explained_var": 0.17262618243694305, "kl": 0.024334799498319626, "entropy": 1.725663423538208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1520000, "episodes_total": 3038, "training_iteration": 76, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-04-06", "timestamp": 1567544646, "time_this_iter_s": 15.494231939315796, "time_total_s": 1165.7582228183746, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1165.7582228183746, "timesteps_since_restore": 1520000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 33.19565217391305, "ram_util_percent": 12.695652173913041}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 361.97655440484624, "episode_reward_min": 32.550364172433824, "episode_reward_mean": 287.1069500986091, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0325469270507224, "mean_processing_ms": 2.335388390091661, "mean_inference_ms": 0.6674439151433802}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1537536, "num_steps_sampled": 1540000, "sample_time_ms": 12887.521, "load_time_ms": 12.502, "grad_time_ms": 2396.85, "update_time_ms": 4.903, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 575.4146118164062, "policy_loss": -0.001906854216940701, "vf_loss": 575.4164428710938, "vf_explained_var": 0.16729240119457245, "kl": 0.02956114150583744, "entropy": 1.692615270614624, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1540000, "episodes_total": 3079, "training_iteration": 77, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-04-21", "timestamp": 1567544661, "time_this_iter_s": 15.356539249420166, "time_total_s": 1181.1147620677948, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1181.1147620677948, "timesteps_since_restore": 1540000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.27142857142857, "ram_util_percent": 12.69047619047619}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 363.30239640777114, "episode_reward_min": -10.25351457027928, "episode_reward_mean": 289.06030877062994, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0311114778730293, "mean_processing_ms": 2.335161397865653, "mean_inference_ms": 0.667430298874811}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1557504, "num_steps_sampled": 1560000, "sample_time_ms": 12952.363, "load_time_ms": 12.459, "grad_time_ms": 2397.515, "update_time_ms": 4.919, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 569.3743286132812, "policy_loss": -0.0033582861069589853, "vf_loss": 569.3776245117188, "vf_explained_var": 0.2011001706123352, "kl": 0.028989052399992943, "entropy": 1.696913480758667, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1560000, "episodes_total": 3118, "training_iteration": 78, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-04-37", "timestamp": 1567544677, "time_this_iter_s": 15.57298493385315, "time_total_s": 1196.687747001648, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1196.687747001648, "timesteps_since_restore": 1560000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.69565217391305, "ram_util_percent": 12.708695652173914}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 363.30239640777114, "episode_reward_min": -10.25351457027928, "episode_reward_mean": 292.33791068389246, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0347547200348646, "mean_processing_ms": 2.335121293686488, "mean_inference_ms": 0.667462411988916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1577472, "num_steps_sampled": 1580000, "sample_time_ms": 13016.689, "load_time_ms": 12.452, "grad_time_ms": 2397.503, "update_time_ms": 4.973, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 580.660888671875, "policy_loss": -0.003310387022793293, "vf_loss": 580.6641845703125, "vf_explained_var": 0.15867599844932556, "kl": 0.02910700812935829, "entropy": 1.6692419052124023, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1580000, "episodes_total": 3158, "training_iteration": 79, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-04-52", "timestamp": 1567544692, "time_this_iter_s": 15.531850099563599, "time_total_s": 1212.2195971012115, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1212.2195971012115, "timesteps_since_restore": 1580000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 34.24545454545455, "ram_util_percent": 12.70909090909091}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 354.9988849253505, "episode_reward_min": -10.25351457027928, "episode_reward_mean": 287.53380215152856, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.033021915364427, "mean_processing_ms": 2.3347668148600103, "mean_inference_ms": 0.6673405400506935}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1597440, "num_steps_sampled": 1600000, "sample_time_ms": 13063.304, "load_time_ms": 12.415, "grad_time_ms": 2396.138, "update_time_ms": 5.037, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 586.7899780273438, "policy_loss": -8.631784112367313e-06, "vf_loss": 586.7899780273438, "vf_explained_var": 0.1640879064798355, "kl": 0.028896871954202652, "entropy": 1.6666927337646484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1600000, "episodes_total": 3197, "training_iteration": 80, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-05-08", "timestamp": 1567544708, "time_this_iter_s": 15.674885272979736, "time_total_s": 1227.8944823741913, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1227.8944823741913, "timesteps_since_restore": 1600000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 34.52272727272727, "ram_util_percent": 12.72272727272727}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 354.9988849253505, "episode_reward_min": -146.5688097229053, "episode_reward_mean": 271.4830826991192, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0371014216877064, "mean_processing_ms": 2.3348361622302423, "mean_inference_ms": 0.667332392520315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1617408, "num_steps_sampled": 1620000, "sample_time_ms": 13070.932, "load_time_ms": 12.4, "grad_time_ms": 2397.366, "update_time_ms": 5.025, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 675.66064453125, "policy_loss": -0.003329614410176873, "vf_loss": 675.6639404296875, "vf_explained_var": 0.2031649649143219, "kl": 0.02735494263470173, "entropy": 1.669744610786438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1620000, "episodes_total": 3238, "training_iteration": 81, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-05-23", "timestamp": 1567544723, "time_this_iter_s": 15.334792137145996, "time_total_s": 1243.2292745113373, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1243.2292745113373, "timesteps_since_restore": 1620000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 34.54090909090909, "ram_util_percent": 12.709090909090907}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 353.3781127942811, "episode_reward_min": -146.5688097229053, "episode_reward_mean": 269.37822819708254, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0351928999482687, "mean_processing_ms": 2.335274694814994, "mean_inference_ms": 0.6671532217877129}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1637376, "num_steps_sampled": 1640000, "sample_time_ms": 13052.587, "load_time_ms": 12.408, "grad_time_ms": 2399.18, "update_time_ms": 4.975, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 596.1572265625, "policy_loss": -0.000991786946542561, "vf_loss": 596.1581420898438, "vf_explained_var": 0.17095515131950378, "kl": 0.024376243352890015, "entropy": 1.6691232919692993, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1640000, "episodes_total": 3278, "training_iteration": 82, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-05-38", "timestamp": 1567544738, "time_this_iter_s": 15.316490650177002, "time_total_s": 1258.5457651615143, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1258.5457651615143, "timesteps_since_restore": 1640000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.92272727272728, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 342.6079311608625, "episode_reward_min": -146.5688097229053, "episode_reward_mean": 279.1342597673357, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.040714896722284, "mean_processing_ms": 2.334925917497838, "mean_inference_ms": 0.6669523733971157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657344, "num_steps_sampled": 1660000, "sample_time_ms": 13036.738, "load_time_ms": 12.416, "grad_time_ms": 2399.656, "update_time_ms": 5.019, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 606.1099853515625, "policy_loss": 0.0011298343306407332, "vf_loss": 606.10888671875, "vf_explained_var": 0.18610651791095734, "kl": 0.03375937417149544, "entropy": 1.6618921756744385, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1660000, "episodes_total": 3317, "training_iteration": 83, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-05-54", "timestamp": 1567544754, "time_this_iter_s": 15.303902387619019, "time_total_s": 1273.8496675491333, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1273.8496675491333, "timesteps_since_restore": 1660000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 33.199999999999996, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 342.6079311608625, "episode_reward_min": 22.42373612868735, "episode_reward_mean": 285.8579714533267, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.040310150095213, "mean_processing_ms": 2.3346251387904102, "mean_inference_ms": 0.6666839338505548}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1677312, "num_steps_sampled": 1680000, "sample_time_ms": 13001.303, "load_time_ms": 12.407, "grad_time_ms": 2401.692, "update_time_ms": 4.91, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 641.5637817382812, "policy_loss": -0.002202029339969158, "vf_loss": 641.5659790039062, "vf_explained_var": 0.20475929975509644, "kl": 0.030475730076432228, "entropy": 1.6740578413009644, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1680000, "episodes_total": 3357, "training_iteration": 84, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-06-09", "timestamp": 1567544769, "time_this_iter_s": 15.11356258392334, "time_total_s": 1288.9632301330566, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1288.9632301330566, "timesteps_since_restore": 1680000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 34.44761904761905, "ram_util_percent": 12.714285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 339.2282504508505, "episode_reward_min": 22.42373612868735, "episode_reward_mean": 287.2028871041116, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.039224387276806, "mean_processing_ms": 2.33462815069279, "mean_inference_ms": 0.6665088592864857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1697280, "num_steps_sampled": 1700000, "sample_time_ms": 12966.977, "load_time_ms": 12.412, "grad_time_ms": 2401.655, "update_time_ms": 4.817, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 630.4927978515625, "policy_loss": 0.00113547348883003, "vf_loss": 630.4916381835938, "vf_explained_var": 0.1880197823047638, "kl": 0.039277926087379456, "entropy": 1.6742565631866455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1700000, "episodes_total": 3397, "training_iteration": 85, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-06-24", "timestamp": 1567544784, "time_this_iter_s": 15.292386054992676, "time_total_s": 1304.2556161880493, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1304.2556161880493, "timesteps_since_restore": 1700000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 33.09090909090909, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.72403583423437, "episode_reward_min": 160.50135476558137, "episode_reward_mean": 288.119744715175, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.035549497860675, "mean_processing_ms": 2.3348655105936627, "mean_inference_ms": 0.6661032955572991}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1717248, "num_steps_sampled": 1720000, "sample_time_ms": 12946.031, "load_time_ms": 12.44, "grad_time_ms": 2401.93, "update_time_ms": 4.79, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 647.2173461914062, "policy_loss": 0.0007566878339275718, "vf_loss": 647.216552734375, "vf_explained_var": 0.17322009801864624, "kl": 0.035281989723443985, "entropy": 1.6679757833480835, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1720000, "episodes_total": 3438, "training_iteration": 86, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-06-39", "timestamp": 1567544799, "time_this_iter_s": 15.287423849105835, "time_total_s": 1319.5430400371552, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1319.5430400371552, "timesteps_since_restore": 1720000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 32.836363636363636, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.72403583423437, "episode_reward_min": 160.50135476558137, "episode_reward_mean": 288.8156534790275, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.034392775067646, "mean_processing_ms": 2.3350884204127436, "mean_inference_ms": 0.6658181541113093}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1737216, "num_steps_sampled": 1740000, "sample_time_ms": 12932.931, "load_time_ms": 12.464, "grad_time_ms": 2401.314, "update_time_ms": 4.743, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 654.89404296875, "policy_loss": -0.0014302541967481375, "vf_loss": 654.8955078125, "vf_explained_var": 0.17753760516643524, "kl": 0.02839166298508644, "entropy": 1.670562982559204, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1740000, "episodes_total": 3478, "training_iteration": 87, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-06-55", "timestamp": 1567544815, "time_this_iter_s": 15.220483541488647, "time_total_s": 1334.7635235786438, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1334.7635235786438, "timesteps_since_restore": 1740000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.19090909090909, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 340.4406497142329, "episode_reward_min": 164.04610631491008, "episode_reward_mean": 286.156136502913, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0303978122570587, "mean_processing_ms": 2.3355121437050372, "mean_inference_ms": 0.6655935285088286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1757184, "num_steps_sampled": 1760000, "sample_time_ms": 12923.264, "load_time_ms": 12.482, "grad_time_ms": 2400.32, "update_time_ms": 4.768, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 671.6351928710938, "policy_loss": -0.00018016196554526687, "vf_loss": 671.6353149414062, "vf_explained_var": 0.17493435740470886, "kl": 0.03534551337361336, "entropy": 1.659061312675476, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1760000, "episodes_total": 3519, "training_iteration": 88, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-07-10", "timestamp": 1567544830, "time_this_iter_s": 15.46772289276123, "time_total_s": 1350.231246471405, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1350.231246471405, "timesteps_since_restore": 1760000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.57727272727273, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 340.4406497142329, "episode_reward_min": 168.91903749282721, "episode_reward_mean": 286.18757866874165, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.035689671357228, "mean_processing_ms": 2.3354716713001804, "mean_inference_ms": 0.6656559647507234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1777152, "num_steps_sampled": 1780000, "sample_time_ms": 12882.681, "load_time_ms": 12.531, "grad_time_ms": 2400.081, "update_time_ms": 4.74, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 655.36767578125, "policy_loss": -0.0016650030156597495, "vf_loss": 655.369384765625, "vf_explained_var": 0.17457057535648346, "kl": 0.02833130769431591, "entropy": 1.6471569538116455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1780000, "episodes_total": 3558, "training_iteration": 89, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-07-25", "timestamp": 1567544845, "time_this_iter_s": 15.123780727386475, "time_total_s": 1365.3550271987915, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1365.3550271987915, "timesteps_since_restore": 1780000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 36.31904761904762, "ram_util_percent": 12.714285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.1113941945761, "episode_reward_min": 162.13197599348743, "episode_reward_mean": 285.24627811328105, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.036044240036172, "mean_processing_ms": 2.3354496482987694, "mean_inference_ms": 0.6657128065882324}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1797120, "num_steps_sampled": 1800000, "sample_time_ms": 12856.206, "load_time_ms": 12.508, "grad_time_ms": 2400.395, "update_time_ms": 4.696, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 670.3896484375, "policy_loss": -0.0008633371908217669, "vf_loss": 670.3904418945312, "vf_explained_var": 0.16224220395088196, "kl": 0.031666431576013565, "entropy": 1.601332426071167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1800000, "episodes_total": 3598, "training_iteration": 90, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-07-41", "timestamp": 1567544861, "time_this_iter_s": 15.413365602493286, "time_total_s": 1380.7683928012848, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1380.7683928012848, "timesteps_since_restore": 1800000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 34.295454545454554, "ram_util_percent": 12.713636363636363}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.1113941945761, "episode_reward_min": -13.322516490892548, "episode_reward_mean": 279.5995376818252, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0377698877095303, "mean_processing_ms": 2.335469221536595, "mean_inference_ms": 0.665697734568126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1817088, "num_steps_sampled": 1820000, "sample_time_ms": 12845.806, "load_time_ms": 12.501, "grad_time_ms": 2400.467, "update_time_ms": 4.691, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 704.4747314453125, "policy_loss": 0.0017253706464543939, "vf_loss": 704.4729614257812, "vf_explained_var": 0.2023557424545288, "kl": 0.03937189280986786, "entropy": 1.6559759378433228, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1820000, "episodes_total": 3638, "training_iteration": 91, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-07-56", "timestamp": 1567544876, "time_this_iter_s": 15.231669902801514, "time_total_s": 1396.0000627040863, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1396.0000627040863, "timesteps_since_restore": 1820000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 33.81363636363636, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.1113941945761, "episode_reward_min": -13.322516490892548, "episode_reward_mean": 279.9167971795766, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.037609101677781, "mean_processing_ms": 2.3354929773740274, "mean_inference_ms": 0.6655881908869549}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837056, "num_steps_sampled": 1840000, "sample_time_ms": 12830.242, "load_time_ms": 12.509, "grad_time_ms": 2398.417, "update_time_ms": 4.72, "learner": {"default_policy": {"cur_kl_coeff": 0.0002929687616415322, "cur_lr": 4.999999873689376e-05, "total_loss": 676.8905029296875, "policy_loss": 0.05229327455163002, "vf_loss": 676.8365478515625, "vf_explained_var": 0.17778384685516357, "kl": 5.8825531005859375, "entropy": 1.7182668447494507, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1840000, "episodes_total": 3678, "training_iteration": 92, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-08-11", "timestamp": 1567544891, "time_this_iter_s": 15.14111590385437, "time_total_s": 1411.1411786079407, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1411.1411786079407, "timesteps_since_restore": 1840000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 32.96363636363637, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 339.9784482564598, "episode_reward_min": -13.322516490892548, "episode_reward_mean": 271.13307773795566, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.036247347245202, "mean_processing_ms": 2.335309928423011, "mean_inference_ms": 0.6655429143155992}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1857024, "num_steps_sampled": 1860000, "sample_time_ms": 12812.803, "load_time_ms": 12.522, "grad_time_ms": 2398.159, "update_time_ms": 4.677, "learner": {"default_policy": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 4.999999873689376e-05, "total_loss": 705.3578491210938, "policy_loss": -0.0036021017003804445, "vf_loss": 705.3614501953125, "vf_explained_var": 0.22345905005931854, "kl": 0.02846885286271572, "entropy": 1.767810344696045, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1860000, "episodes_total": 3717, "training_iteration": 93, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-08-26", "timestamp": 1567544906, "time_this_iter_s": 15.126972436904907, "time_total_s": 1426.2681510448456, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1426.2681510448456, "timesteps_since_restore": 1860000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.580952380952375, "ram_util_percent": 12.714285714285714}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 339.9784482564598, "episode_reward_min": 0.3875080593523812, "episode_reward_mean": 271.8252308039779, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.034905592566424, "mean_processing_ms": 2.335293195010304, "mean_inference_ms": 0.6651734697845083}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1876992, "num_steps_sampled": 1880000, "sample_time_ms": 12816.995, "load_time_ms": 12.517, "grad_time_ms": 2396.743, "update_time_ms": 4.664, "learner": {"default_policy": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 4.999999873689376e-05, "total_loss": 723.5559692382812, "policy_loss": -0.0019879553001374006, "vf_loss": 723.5579223632812, "vf_explained_var": 0.20479269325733185, "kl": 0.027952099218964577, "entropy": 1.7249008417129517, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1880000, "episodes_total": 3758, "training_iteration": 94, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-08-41", "timestamp": 1567544921, "time_this_iter_s": 15.141134023666382, "time_total_s": 1441.409285068512, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1441.409285068512, "timesteps_since_restore": 1880000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 32.309090909090905, "ram_util_percent": 12.718181818181819}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 336.8756024591392, "episode_reward_min": 0.3875080593523812, "episode_reward_mean": 271.8815971998093, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.033593458366472, "mean_processing_ms": 2.3351353508292276, "mean_inference_ms": 0.6651949499669755}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1896960, "num_steps_sampled": 1900000, "sample_time_ms": 12792.077, "load_time_ms": 12.487, "grad_time_ms": 2397.006, "update_time_ms": 4.685, "learner": {"default_policy": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 4.999999873689376e-05, "total_loss": 686.9033203125, "policy_loss": -0.0020261246245354414, "vf_loss": 686.9054565429688, "vf_explained_var": 0.21066239476203918, "kl": 0.04148601368069649, "entropy": 1.7158408164978027, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1900000, "episodes_total": 3797, "training_iteration": 95, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-08-56", "timestamp": 1567544936, "time_this_iter_s": 15.045974493026733, "time_total_s": 1456.4552595615387, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1456.4552595615387, "timesteps_since_restore": 1900000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 33.657142857142865, "ram_util_percent": 12.719047619047618}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 337.8921556229495, "episode_reward_min": 0.3875080593523812, "episode_reward_mean": 274.79184798265453, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0304395818542678, "mean_processing_ms": 2.33530285238449, "mean_inference_ms": 0.6646913595869133}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1916928, "num_steps_sampled": 1920000, "sample_time_ms": 12770.773, "load_time_ms": 12.468, "grad_time_ms": 2396.478, "update_time_ms": 4.748, "learner": {"default_policy": {"cur_kl_coeff": 0.0006591796991415322, "cur_lr": 4.999999873689376e-05, "total_loss": 723.6185913085938, "policy_loss": 0.0065957047045230865, "vf_loss": 723.6119995117188, "vf_explained_var": 0.2064896672964096, "kl": 0.08336971700191498, "entropy": 1.7430264949798584, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1920000, "episodes_total": 3838, "training_iteration": 96, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-09-12", "timestamp": 1567544952, "time_this_iter_s": 15.068122386932373, "time_total_s": 1471.523381948471, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1471.523381948471, "timesteps_since_restore": 1920000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 32.23636363636364, "ram_util_percent": 12.740909090909092}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 337.8921556229495, "episode_reward_min": 22.723493382916597, "episode_reward_mean": 276.5382714943735, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.029869359351715, "mean_processing_ms": 2.3353382923107247, "mean_inference_ms": 0.6646333268074507}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1936896, "num_steps_sampled": 1940000, "sample_time_ms": 12760.919, "load_time_ms": 12.457, "grad_time_ms": 2396.186, "update_time_ms": 4.757, "learner": {"default_policy": {"cur_kl_coeff": 0.0009887695778161287, "cur_lr": 4.999999873689376e-05, "total_loss": 714.0996704101562, "policy_loss": -0.0022240113466978073, "vf_loss": 714.1018676757812, "vf_explained_var": 0.1810484081506729, "kl": 0.027388108894228935, "entropy": 1.7355422973632812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1940000, "episodes_total": 3879, "training_iteration": 97, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-09-27", "timestamp": 1567544967, "time_this_iter_s": 15.117811441421509, "time_total_s": 1486.6411933898926, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1486.6411933898926, "timesteps_since_restore": 1940000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.36666666666666, "ram_util_percent": 12.742857142857144}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.15615494998923, "episode_reward_min": 22.723493382916597, "episode_reward_mean": 277.40941752112093, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.025065084205915, "mean_processing_ms": 2.335735866196948, "mean_inference_ms": 0.6643628577870068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1956864, "num_steps_sampled": 1960000, "sample_time_ms": 12731.753, "load_time_ms": 12.449, "grad_time_ms": 2395.731, "update_time_ms": 4.751, "learner": {"default_policy": {"cur_kl_coeff": 0.0009887695778161287, "cur_lr": 4.999999873689376e-05, "total_loss": 716.2619018554688, "policy_loss": -0.0008574235253036022, "vf_loss": 716.2626953125, "vf_explained_var": 0.20605918765068054, "kl": 0.03873186185956001, "entropy": 1.710524320602417, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1960000, "episodes_total": 3919, "training_iteration": 98, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-09-42", "timestamp": 1567544982, "time_this_iter_s": 15.170568943023682, "time_total_s": 1501.8117623329163, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1501.8117623329163, "timesteps_since_restore": 1960000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 32.96363636363637, "ram_util_percent": 12.736363636363636}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.15615494998923, "episode_reward_min": 150.56220147951095, "episode_reward_mean": 282.8032737889407, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.026367703650277, "mean_processing_ms": 2.3357164246107494, "mean_inference_ms": 0.6646557044008513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1976832, "num_steps_sampled": 1980000, "sample_time_ms": 12734.605, "load_time_ms": 12.435, "grad_time_ms": 2396.647, "update_time_ms": 4.829, "learner": {"default_policy": {"cur_kl_coeff": 0.0009887695778161287, "cur_lr": 4.999999873689376e-05, "total_loss": 699.5262451171875, "policy_loss": 0.06306418031454086, "vf_loss": 699.46142578125, "vf_explained_var": 0.19315080344676971, "kl": 1.7538537979125977, "entropy": 1.7739657163619995, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1980000, "episodes_total": 3958, "training_iteration": 99, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-09-57", "timestamp": 1567544997, "time_this_iter_s": 15.161726236343384, "time_total_s": 1516.9734885692596, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1516.9734885692596, "timesteps_since_restore": 1980000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 32.763636363636365, "ram_util_percent": 12.786363636363633}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.6480958004772, "episode_reward_min": 150.56220147951095, "episode_reward_mean": 285.05132340716904, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.024535887790662, "mean_processing_ms": 2.3356330641186345, "mean_inference_ms": 0.6646289328074879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1996800, "num_steps_sampled": 2000000, "sample_time_ms": 12693.861, "load_time_ms": 12.48, "grad_time_ms": 2396.652, "update_time_ms": 4.812, "learner": {"default_policy": {"cur_kl_coeff": 0.0014831542503088713, "cur_lr": 4.999999873689376e-05, "total_loss": 738.2194213867188, "policy_loss": -0.0028654057532548904, "vf_loss": 738.2222290039062, "vf_explained_var": 0.19585078954696655, "kl": 0.0232126135379076, "entropy": 1.8346201181411743, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2000000, "episodes_total": 3999, "training_iteration": 100, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-10-12", "timestamp": 1567545012, "time_this_iter_s": 15.00551724433899, "time_total_s": 1531.9790058135986, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1531.9790058135986, "timesteps_since_restore": 2000000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.50952380952381, "ram_util_percent": 12.766666666666667}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.6480958004772, "episode_reward_min": 170.81523972567157, "episode_reward_mean": 287.8645529830281, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0227399832974458, "mean_processing_ms": 2.335543822412471, "mean_inference_ms": 0.6646517424731296}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2016768, "num_steps_sampled": 2020000, "sample_time_ms": 12662.357, "load_time_ms": 12.476, "grad_time_ms": 2397.051, "update_time_ms": 4.763, "learner": {"default_policy": {"cur_kl_coeff": 0.0014831542503088713, "cur_lr": 4.999999873689376e-05, "total_loss": 724.6783447265625, "policy_loss": -0.0028511027339845896, "vf_loss": 724.6810913085938, "vf_explained_var": 0.1954473853111267, "kl": 0.026688333600759506, "entropy": 1.8784030675888062, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2020000, "episodes_total": 4038, "training_iteration": 101, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-10-27", "timestamp": 1567545027, "time_this_iter_s": 14.91920804977417, "time_total_s": 1546.8982138633728, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1546.8982138633728, "timesteps_since_restore": 2020000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 33.98571428571428, "ram_util_percent": 12.78095238095238}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 338.6480958004772, "episode_reward_min": 203.34585240156906, "episode_reward_mean": 293.4081010405456, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.021783741019151, "mean_processing_ms": 2.3355574101834966, "mean_inference_ms": 0.6645119317535212}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2036736, "num_steps_sampled": 2040000, "sample_time_ms": 12638.319, "load_time_ms": 12.484, "grad_time_ms": 2397.519, "update_time_ms": 4.792, "learner": {"default_policy": {"cur_kl_coeff": 0.0014831542503088713, "cur_lr": 4.999999873689376e-05, "total_loss": 752.3240356445312, "policy_loss": -0.0011926026782020926, "vf_loss": 752.3251342773438, "vf_explained_var": 0.1773545742034912, "kl": 0.03106936439871788, "entropy": 1.830221176147461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2040000, "episodes_total": 4078, "training_iteration": 102, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-10-42", "timestamp": 1567545042, "time_this_iter_s": 14.906379461288452, "time_total_s": 1561.8045933246613, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1561.8045933246613, "timesteps_since_restore": 2040000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 33.163636363636364, "ram_util_percent": 12.77727272727273}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 343.1556377237328, "episode_reward_min": 24.079304180827595, "episode_reward_mean": 294.8492369306277, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0212096876038426, "mean_processing_ms": 2.3354800350890166, "mean_inference_ms": 0.6645548437288733}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2056704, "num_steps_sampled": 2060000, "sample_time_ms": 12627.91, "load_time_ms": 12.457, "grad_time_ms": 2398.325, "update_time_ms": 4.749, "learner": {"default_policy": {"cur_kl_coeff": 0.0014831542503088713, "cur_lr": 4.999999873689376e-05, "total_loss": 776.1599731445312, "policy_loss": 0.002516450360417366, "vf_loss": 776.1573486328125, "vf_explained_var": 0.19364891946315765, "kl": 0.042064368724823, "entropy": 1.808522343635559, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2060000, "episodes_total": 4118, "training_iteration": 103, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-10-57", "timestamp": 1567545057, "time_this_iter_s": 15.03022289276123, "time_total_s": 1576.8348162174225, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1576.8348162174225, "timesteps_since_restore": 2060000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 34.48095238095238, "ram_util_percent": 12.785714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 343.1556377237328, "episode_reward_min": 24.079304180827595, "episode_reward_mean": 297.0054564947068, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.019965778234629, "mean_processing_ms": 2.3354826737664185, "mean_inference_ms": 0.6644598711815202}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076672, "num_steps_sampled": 2080000, "sample_time_ms": 12612.528, "load_time_ms": 12.468, "grad_time_ms": 2397.688, "update_time_ms": 4.76, "learner": {"default_policy": {"cur_kl_coeff": 0.0022247314918786287, "cur_lr": 4.999999873689376e-05, "total_loss": 770.5381469726562, "policy_loss": -0.0023755175061523914, "vf_loss": 770.5404663085938, "vf_explained_var": 0.17789316177368164, "kl": 0.030491014942526817, "entropy": 1.7931725978851318, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2080000, "episodes_total": 4158, "training_iteration": 104, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-11-12", "timestamp": 1567545072, "time_this_iter_s": 14.981282472610474, "time_total_s": 1591.816098690033, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1591.816098690033, "timesteps_since_restore": 2080000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 33.804761904761904, "ram_util_percent": 12.785714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 343.1556377237328, "episode_reward_min": 47.331438174792254, "episode_reward_mean": 298.6920334897721, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.01820044122644, "mean_processing_ms": 2.3354950799752188, "mean_inference_ms": 0.6644947676581836}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2096640, "num_steps_sampled": 2100000, "sample_time_ms": 12605.79, "load_time_ms": 12.44, "grad_time_ms": 2396.768, "update_time_ms": 4.721, "learner": {"default_policy": {"cur_kl_coeff": 0.0022247314918786287, "cur_lr": 4.999999873689376e-05, "total_loss": 794.9144287109375, "policy_loss": -0.0021586394868791103, "vf_loss": 794.9165649414062, "vf_explained_var": 0.20330804586410522, "kl": 0.0252335574477911, "entropy": 1.7923904657363892, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2100000, "episodes_total": 4198, "training_iteration": 105, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-11-27", "timestamp": 1567545087, "time_this_iter_s": 14.96891736984253, "time_total_s": 1606.7850160598755, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1606.7850160598755, "timesteps_since_restore": 2100000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 33.66363636363636, "ram_util_percent": 12.79090909090909}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.50055884361257, "episode_reward_min": 47.331438174792254, "episode_reward_mean": 299.4047869670927, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.017243468239109, "mean_processing_ms": 2.3355177389601183, "mean_inference_ms": 0.6643115741260808}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2116608, "num_steps_sampled": 2120000, "sample_time_ms": 12600.934, "load_time_ms": 12.437, "grad_time_ms": 2397.16, "update_time_ms": 4.636, "learner": {"default_policy": {"cur_kl_coeff": 0.0022247314918786287, "cur_lr": 4.999999873689376e-05, "total_loss": 791.907470703125, "policy_loss": -0.0001637507666600868, "vf_loss": 791.907470703125, "vf_explained_var": 0.17617769539356232, "kl": 0.03891008347272873, "entropy": 1.7920349836349487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2120000, "episodes_total": 4238, "training_iteration": 106, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-11-42", "timestamp": 1567545102, "time_this_iter_s": 15.024095296859741, "time_total_s": 1621.8091113567352, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1621.8091113567352, "timesteps_since_restore": 2120000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.142857142857146, "ram_util_percent": 12.785714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.50055884361257, "episode_reward_min": 221.23000504167996, "episode_reward_mean": 300.17684474885334, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.016064739271168, "mean_processing_ms": 2.335535535724132, "mean_inference_ms": 0.6642307022713587}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2136576, "num_steps_sampled": 2140000, "sample_time_ms": 12580.125, "load_time_ms": 12.431, "grad_time_ms": 2396.663, "update_time_ms": 4.61, "learner": {"default_policy": {"cur_kl_coeff": 0.0022247314918786287, "cur_lr": 4.999999873689376e-05, "total_loss": 795.8616943359375, "policy_loss": 0.002092337002977729, "vf_loss": 795.8594970703125, "vf_explained_var": 0.17181473970413208, "kl": 0.04546811431646347, "entropy": 1.7887276411056519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2140000, "episodes_total": 4278, "training_iteration": 107, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-11-57", "timestamp": 1567545117, "time_this_iter_s": 14.904207944869995, "time_total_s": 1636.7133193016052, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1636.7133193016052, "timesteps_since_restore": 2140000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 34.22380952380953, "ram_util_percent": 12.785714285714286}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 346.50055884361257, "episode_reward_min": -19.399501025160948, "episode_reward_mean": 298.3545454970555, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.014611477943234, "mean_processing_ms": 2.3355393857824005, "mean_inference_ms": 0.6641183956475316}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2156544, "num_steps_sampled": 2160000, "sample_time_ms": 12555.007, "load_time_ms": 12.526, "grad_time_ms": 2396.68, "update_time_ms": 4.562, "learner": {"default_policy": {"cur_kl_coeff": 0.0033370971214026213, "cur_lr": 4.999999873689376e-05, "total_loss": 812.9669189453125, "policy_loss": 0.0013455396983772516, "vf_loss": 812.9654541015625, "vf_explained_var": 0.19412674009799957, "kl": 0.04266510158777237, "entropy": 1.778012990951538, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2160000, "episodes_total": 4318, "training_iteration": 108, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-12-12", "timestamp": 1567545132, "time_this_iter_s": 14.91979193687439, "time_total_s": 1651.6331112384796, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1651.6331112384796, "timesteps_since_restore": 2160000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 32.99090909090909, "ram_util_percent": 12.795454545454545}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 342.40598983755734, "episode_reward_min": -19.399501025160948, "episode_reward_mean": 299.4383098620756, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0133119151158723, "mean_processing_ms": 2.3355523437666315, "mean_inference_ms": 0.6639796834188957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2176512, "num_steps_sampled": 2180000, "sample_time_ms": 12528.395, "load_time_ms": 12.508, "grad_time_ms": 2395.684, "update_time_ms": 4.586, "learner": {"default_policy": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 802.8658447265625, "policy_loss": -0.002078389050439, "vf_loss": 802.8677368164062, "vf_explained_var": 0.17318297922611237, "kl": 0.02387014403939247, "entropy": 1.7714110612869263, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2180000, "episodes_total": 4358, "training_iteration": 109, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-12-27", "timestamp": 1567545147, "time_this_iter_s": 14.88679027557373, "time_total_s": 1666.5199015140533, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1666.5199015140533, "timesteps_since_restore": 2180000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 33.609523809523814, "ram_util_percent": 12.80952380952381}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 351.9265768500317, "episode_reward_min": 256.6823999079199, "episode_reward_mean": 303.7842771041151, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.012359393839881, "mean_processing_ms": 2.3355435843546593, "mean_inference_ms": 0.6639652427542599}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196480, "num_steps_sampled": 2200000, "sample_time_ms": 12525.101, "load_time_ms": 12.49, "grad_time_ms": 2394.527, "update_time_ms": 4.644, "learner": {"default_policy": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 810.5900268554688, "policy_loss": -0.002020508050918579, "vf_loss": 810.5919189453125, "vf_explained_var": 0.171039879322052, "kl": 0.03751428425312042, "entropy": 1.702191710472107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2200000, "episodes_total": 4398, "training_iteration": 110, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-12-42", "timestamp": 1567545162, "time_this_iter_s": 14.962455987930298, "time_total_s": 1681.4823575019836, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1681.4823575019836, "timesteps_since_restore": 2200000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 34.4952380952381, "ram_util_percent": 12.804761904761907}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 358.31459971381327, "episode_reward_min": 212.88359261405589, "episode_reward_mean": 305.7852277076419, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0116418092250865, "mean_processing_ms": 2.3355843755253654, "mean_inference_ms": 0.6638338005475481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2216448, "num_steps_sampled": 2220000, "sample_time_ms": 12554.277, "load_time_ms": 12.529, "grad_time_ms": 2394.108, "update_time_ms": 4.654, "learner": {"default_policy": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 823.9924926757812, "policy_loss": -0.0022268195170909166, "vf_loss": 823.9945678710938, "vf_explained_var": 0.16943801939487457, "kl": 0.02416299842298031, "entropy": 1.6937618255615234, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2220000, "episodes_total": 4438, "training_iteration": 111, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-12-57", "timestamp": 1567545177, "time_this_iter_s": 15.20807933807373, "time_total_s": 1696.6904368400574, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1696.6904368400574, "timesteps_since_restore": 2220000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 33.27727272727273, "ram_util_percent": 12.80909090909091}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 358.31459971381327, "episode_reward_min": 190.17697447699598, "episode_reward_mean": 301.8005601079677, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.010723736229818, "mean_processing_ms": 2.3356386298394223, "mean_inference_ms": 0.6637191692710199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2236416, "num_steps_sampled": 2240000, "sample_time_ms": 12551.454, "load_time_ms": 12.594, "grad_time_ms": 2393.862, "update_time_ms": 4.643, "learner": {"default_policy": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 825.7490234375, "policy_loss": -0.0028142782393842936, "vf_loss": 825.7515869140625, "vf_explained_var": 0.19487984478473663, "kl": 0.027743740007281303, "entropy": 1.7621023654937744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2240000, "episodes_total": 4478, "training_iteration": 112, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-13-12", "timestamp": 1567545192, "time_this_iter_s": 14.876204252243042, "time_total_s": 1711.5666410923004, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1711.5666410923004, "timesteps_since_restore": 2240000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 33.81904761904762, "ram_util_percent": 12.804761904761907}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 357.13620837154815, "episode_reward_min": 177.494085629521, "episode_reward_mean": 298.262845554838, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0092636401149626, "mean_processing_ms": 2.3356564289461956, "mean_inference_ms": 0.6635837641218341}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2256384, "num_steps_sampled": 2260000, "sample_time_ms": 12542.638, "load_time_ms": 12.598, "grad_time_ms": 2392.371, "update_time_ms": 4.742, "learner": {"default_policy": {"cur_kl_coeff": 0.00500564556568861, "cur_lr": 4.999999873689376e-05, "total_loss": 824.189208984375, "policy_loss": 0.0022620921954512596, "vf_loss": 824.1867065429688, "vf_explained_var": 0.20408086478710175, "kl": 0.04329485073685646, "entropy": 1.7618560791015625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2260000, "episodes_total": 4518, "training_iteration": 113, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-13-27", "timestamp": 1567545207, "time_this_iter_s": 14.928036451339722, "time_total_s": 1726.4946775436401, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1726.4946775436401, "timesteps_since_restore": 2260000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 33.333333333333336, "ram_util_percent": 12.814285714285715}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 368.72810055307133, "episode_reward_min": 177.494085629521, "episode_reward_mean": 297.33956164775486, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0076280507820297, "mean_processing_ms": 2.33564121345894, "mean_inference_ms": 0.6634369984948146}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2276352, "num_steps_sampled": 2280000, "sample_time_ms": 12531.481, "load_time_ms": 12.658, "grad_time_ms": 2393.528, "update_time_ms": 4.727, "learner": {"default_policy": {"cur_kl_coeff": 0.007508468814194202, "cur_lr": 4.999999873689376e-05, "total_loss": 828.2610473632812, "policy_loss": 0.0005676476866938174, "vf_loss": 828.2601318359375, "vf_explained_var": 0.21006931364536285, "kl": 0.034614380449056625, "entropy": 1.773775577545166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2280000, "episodes_total": 4558, "training_iteration": 114, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-13-42", "timestamp": 1567545222, "time_this_iter_s": 14.881054878234863, "time_total_s": 1741.375732421875, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1741.375732421875, "timesteps_since_restore": 2280000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 32.43636363636363, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 368.72810055307133, "episode_reward_min": 188.4752903796864, "episode_reward_mean": 297.3454142872727, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0037203242932686, "mean_processing_ms": 2.335852268119631, "mean_inference_ms": 0.6630434934177749}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2296320, "num_steps_sampled": 2300000, "sample_time_ms": 12522.704, "load_time_ms": 12.661, "grad_time_ms": 2394.91, "update_time_ms": 4.76, "learner": {"default_policy": {"cur_kl_coeff": 0.007508468814194202, "cur_lr": 4.999999873689376e-05, "total_loss": 851.30908203125, "policy_loss": 0.08232881128787994, "vf_loss": 851.1928100585938, "vf_explained_var": 0.21225978434085846, "kl": 4.519601821899414, "entropy": 1.7939887046813965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2300000, "episodes_total": 4599, "training_iteration": 115, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-13-56", "timestamp": 1567545236, "time_this_iter_s": 14.894972085952759, "time_total_s": 1756.2707045078278, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1756.2707045078278, "timesteps_since_restore": 2300000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 33.44761904761905, "ram_util_percent": 12.819047619047618}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 372.73795884690986, "episode_reward_min": 188.4752903796864, "episode_reward_mean": 298.01032966334174, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.002374363891417, "mean_processing_ms": 2.336030316275354, "mean_inference_ms": 0.6630124976830571}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2316288, "num_steps_sampled": 2320000, "sample_time_ms": 12513.216, "load_time_ms": 12.674, "grad_time_ms": 2394.344, "update_time_ms": 4.854, "learner": {"default_policy": {"cur_kl_coeff": 0.011262702755630016, "cur_lr": 4.999999873689376e-05, "total_loss": 835.5601806640625, "policy_loss": -0.0031612536404281855, "vf_loss": 835.563232421875, "vf_explained_var": 0.21980999410152435, "kl": 0.009148617275059223, "entropy": 1.7813159227371216, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2320000, "episodes_total": 4639, "training_iteration": 116, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-14-11", "timestamp": 1567545251, "time_this_iter_s": 14.922948122024536, "time_total_s": 1771.1936526298523, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1771.1936526298523, "timesteps_since_restore": 2320000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 35.05714285714286, "ram_util_percent": 12.8}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 372.73795884690986, "episode_reward_min": 148.24151945329714, "episode_reward_mean": 297.819838714772, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.001324555428349, "mean_processing_ms": 2.3361235680331016, "mean_inference_ms": 0.6631344909766247}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2336256, "num_steps_sampled": 2340000, "sample_time_ms": 12528.385, "load_time_ms": 12.68, "grad_time_ms": 2394.345, "update_time_ms": 4.885, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 839.8027954101562, "policy_loss": -0.0026043998077511787, "vf_loss": 839.8052978515625, "vf_explained_var": 0.2365517020225525, "kl": 0.010733050294220448, "entropy": 1.7826412916183472, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2340000, "episodes_total": 4679, "training_iteration": 117, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-14-26", "timestamp": 1567545266, "time_this_iter_s": 15.056518316268921, "time_total_s": 1786.2501709461212, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1786.2501709461212, "timesteps_since_restore": 2340000, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 33.699999999999996, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 363.01627919878894, "episode_reward_min": 148.24151945329714, "episode_reward_mean": 296.8527602579885, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0025641737716104, "mean_processing_ms": 2.3360764368311795, "mean_inference_ms": 0.6635690281175806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2356224, "num_steps_sampled": 2360000, "sample_time_ms": 12540.191, "load_time_ms": 12.608, "grad_time_ms": 2394.077, "update_time_ms": 4.89, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 842.0198364257812, "policy_loss": -0.0027381484396755695, "vf_loss": 842.0224609375, "vf_explained_var": 0.24464572966098785, "kl": 0.01486471388489008, "entropy": 1.7629461288452148, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2360000, "episodes_total": 4719, "training_iteration": 118, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-14-42", "timestamp": 1567545282, "time_this_iter_s": 15.0359468460083, "time_total_s": 1801.2861177921295, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1801.2861177921295, "timesteps_since_restore": 2360000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 35.257142857142846, "ram_util_percent": 12.814285714285715}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 365.79470423427074, "episode_reward_min": 151.11554298512527, "episode_reward_mean": 296.87748208754493, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0016526212261097, "mean_processing_ms": 2.3361051172989264, "mean_inference_ms": 0.6637523428666722}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2376192, "num_steps_sampled": 2380000, "sample_time_ms": 12557.592, "load_time_ms": 12.602, "grad_time_ms": 2393.252, "update_time_ms": 4.79, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 839.2821655273438, "policy_loss": -0.003432195633649826, "vf_loss": 839.285400390625, "vf_explained_var": 0.2514447867870331, "kl": 0.022626642137765884, "entropy": 1.7404613494873047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2380000, "episodes_total": 4759, "training_iteration": 119, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-14-57", "timestamp": 1567545297, "time_this_iter_s": 15.050658464431763, "time_total_s": 1816.3367762565613, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1816.3367762565613, "timesteps_since_restore": 2380000, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 33.66363636363636, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 365.79470423427074, "episode_reward_min": 164.18828752863993, "episode_reward_mean": 294.3927276404945, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0007226458442333, "mean_processing_ms": 2.336165879923536, "mean_inference_ms": 0.6638803115747036}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2396160, "num_steps_sampled": 2400000, "sample_time_ms": 12554.211, "load_time_ms": 12.586, "grad_time_ms": 2393.161, "update_time_ms": 4.752, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 835.2164916992188, "policy_loss": -0.003376310458406806, "vf_loss": 835.2197265625, "vf_explained_var": 0.2505967915058136, "kl": 0.029384108260273933, "entropy": 1.7586498260498047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2400000, "episodes_total": 4799, "training_iteration": 120, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-15-12", "timestamp": 1567545312, "time_this_iter_s": 14.926668167114258, "time_total_s": 1831.2634444236755, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1831.2634444236755, "timesteps_since_restore": 2400000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 34.60952380952381, "ram_util_percent": 12.819047619047618}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 370.4874830928277, "episode_reward_min": 175.7983146779211, "episode_reward_mean": 292.2506139818051, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9999330669323387, "mean_processing_ms": 2.336250102978697, "mean_inference_ms": 0.6640043615259842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2416128, "num_steps_sampled": 2420000, "sample_time_ms": 12537.611, "load_time_ms": 12.597, "grad_time_ms": 2393.206, "update_time_ms": 4.761, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 837.32861328125, "policy_loss": -0.0026724468916654587, "vf_loss": 837.3310546875, "vf_explained_var": 0.2605723738670349, "kl": 0.03302571550011635, "entropy": 1.725724220275879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2420000, "episodes_total": 4839, "training_iteration": 121, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-15-27", "timestamp": 1567545327, "time_this_iter_s": 15.042890787124634, "time_total_s": 1846.3063352108002, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1846.3063352108002, "timesteps_since_restore": 2420000, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 35.819047619047616, "ram_util_percent": 12.828571428571431}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 371.2242678758774, "episode_reward_min": 175.7983146779211, "episode_reward_mean": 294.25381101926774, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.999256937395038, "mean_processing_ms": 2.336295763514453, "mean_inference_ms": 0.6641138893624031}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2436096, "num_steps_sampled": 2440000, "sample_time_ms": 12550.195, "load_time_ms": 12.518, "grad_time_ms": 2393.29, "update_time_ms": 4.733, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 857.8453369140625, "policy_loss": -0.0014282548800110817, "vf_loss": 857.8466796875, "vf_explained_var": 0.19402983784675598, "kl": 0.03402106091380119, "entropy": 1.733417272567749, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2440000, "episodes_total": 4879, "training_iteration": 122, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-15-42", "timestamp": 1567545342, "time_this_iter_s": 15.002225637435913, "time_total_s": 1861.308560848236, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1861.308560848236, "timesteps_since_restore": 2440000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 33.586363636363636, "ram_util_percent": 12.818181818181818}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 371.2242678758774, "episode_reward_min": 232.51476147611882, "episode_reward_mean": 299.8163706393748, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.99884874927132, "mean_processing_ms": 2.3363090180218538, "mean_inference_ms": 0.6642150298443316}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2456064, "num_steps_sampled": 2460000, "sample_time_ms": 12574.355, "load_time_ms": 12.524, "grad_time_ms": 2394.546, "update_time_ms": 4.701, "learner": {"default_policy": {"cur_kl_coeff": 0.005631351377815008, "cur_lr": 4.999999873689376e-05, "total_loss": 858.0465698242188, "policy_loss": 0.0009465701878070831, "vf_loss": 858.0453491210938, "vf_explained_var": 0.19697101414203644, "kl": 0.04569532349705696, "entropy": 1.7466638088226318, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2460000, "episodes_total": 4919, "training_iteration": 123, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-15-57", "timestamp": 1567545357, "time_this_iter_s": 15.182860374450684, "time_total_s": 1876.4914212226868, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1876.4914212226868, "timesteps_since_restore": 2460000, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 35.061904761904756, "ram_util_percent": 12.814285714285715}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 371.2242678758774, "episode_reward_min": 210.8932861208089, "episode_reward_mean": 297.6402227244646, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9985313835708274, "mean_processing_ms": 2.336280196269801, "mean_inference_ms": 0.6642784502689899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2476032, "num_steps_sampled": 2480000, "sample_time_ms": 12588.802, "load_time_ms": 12.498, "grad_time_ms": 2395.043, "update_time_ms": 4.749, "learner": {"default_policy": {"cur_kl_coeff": 0.008447026833891869, "cur_lr": 4.999999873689376e-05, "total_loss": 859.3936157226562, "policy_loss": 0.004022387322038412, "vf_loss": 859.3890380859375, "vf_explained_var": 0.1975550800561905, "kl": 0.06834139674901962, "entropy": 1.724642276763916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2480000, "episodes_total": 4959, "training_iteration": 124, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-16-12", "timestamp": 1567545372, "time_this_iter_s": 15.03064513206482, "time_total_s": 1891.5220663547516, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1891.5220663547516, "timesteps_since_restore": 2480000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 33.47727272727273, "ram_util_percent": 12.827272727272726}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 367.77147495483604, "episode_reward_min": 210.8932861208089, "episode_reward_mean": 297.8226368637445, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9982114491357277, "mean_processing_ms": 2.3362485483390962, "mean_inference_ms": 0.664341922640332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2496000, "num_steps_sampled": 2500000, "sample_time_ms": 12603.112, "load_time_ms": 12.491, "grad_time_ms": 2394.06, "update_time_ms": 4.724, "learner": {"default_policy": {"cur_kl_coeff": 0.012670541182160378, "cur_lr": 4.999999873689376e-05, "total_loss": 858.7420654296875, "policy_loss": -0.0019073453731834888, "vf_loss": 858.7435913085938, "vf_explained_var": 0.20166774094104767, "kl": 0.031432610005140305, "entropy": 1.7327845096588135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2500000, "episodes_total": 4999, "training_iteration": 125, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-16-27", "timestamp": 1567545387, "time_this_iter_s": 15.028637170791626, "time_total_s": 1906.5507035255432, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1906.5507035255432, "timesteps_since_restore": 2500000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 34.866666666666674, "ram_util_percent": 12.828571428571431}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.6407267951049, "episode_reward_min": 153.84853800248757, "episode_reward_mean": 295.837893791732, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.997655726822367, "mean_processing_ms": 2.3360840999691552, "mean_inference_ms": 0.6645455933958558}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2515968, "num_steps_sampled": 2520000, "sample_time_ms": 12605.939, "load_time_ms": 12.461, "grad_time_ms": 2395.105, "update_time_ms": 4.664, "learner": {"default_policy": {"cur_kl_coeff": 0.012670541182160378, "cur_lr": 4.999999873689376e-05, "total_loss": 847.2133178710938, "policy_loss": -0.0019607001449912786, "vf_loss": 847.21484375, "vf_explained_var": 0.21036803722381592, "kl": 0.041035376489162445, "entropy": 1.733845591545105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2520000, "episodes_total": 5038, "training_iteration": 126, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-16-42", "timestamp": 1567545402, "time_this_iter_s": 14.96187424659729, "time_total_s": 1921.5125777721405, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1921.5125777721405, "timesteps_since_restore": 2520000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 33.29545454545454, "ram_util_percent": 12.836363636363636}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.6407267951049, "episode_reward_min": -105.99565655867481, "episode_reward_mean": 290.4673394469317, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9971716944664606, "mean_processing_ms": 2.3358829794833347, "mean_inference_ms": 0.6645173408440193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2535936, "num_steps_sampled": 2540000, "sample_time_ms": 12602.946, "load_time_ms": 12.475, "grad_time_ms": 2396.01, "update_time_ms": 4.686, "learner": {"default_policy": {"cur_kl_coeff": 0.01900581084191799, "cur_lr": 4.999999873689376e-05, "total_loss": 930.6465454101562, "policy_loss": -0.004237444140017033, "vf_loss": 930.6503295898438, "vf_explained_var": 0.22354717552661896, "kl": 0.02664455957710743, "entropy": 1.7639822959899902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2540000, "episodes_total": 5078, "training_iteration": 127, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-16-57", "timestamp": 1567545417, "time_this_iter_s": 15.035943269729614, "time_total_s": 1936.5485210418701, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1936.5485210418701, "timesteps_since_restore": 2540000, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 34.171428571428564, "ram_util_percent": 12.828571428571427}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.6407267951049, "episode_reward_min": -105.99565655867481, "episode_reward_mean": 288.46162713759827, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.996198446490431, "mean_processing_ms": 2.335890665047972, "mean_inference_ms": 0.6645502616648429}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2555904, "num_steps_sampled": 2560000, "sample_time_ms": 12597.748, "load_time_ms": 12.457, "grad_time_ms": 2396.313, "update_time_ms": 4.674, "learner": {"default_policy": {"cur_kl_coeff": 0.01900581084191799, "cur_lr": 4.999999873689376e-05, "total_loss": 889.9683227539062, "policy_loss": -0.0015325854765251279, "vf_loss": 889.9693603515625, "vf_explained_var": 0.20875705778598785, "kl": 0.03426118940114975, "entropy": 1.7567768096923828, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2560000, "episodes_total": 5119, "training_iteration": 128, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-17-12", "timestamp": 1567545432, "time_this_iter_s": 14.986326217651367, "time_total_s": 1951.5348472595215, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1951.5348472595215, "timesteps_since_restore": 2560000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 34.195238095238096, "ram_util_percent": 12.842857142857145}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.4253152799738, "episode_reward_min": -105.99565655867481, "episode_reward_mean": 293.76182056020787, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9949669252429145, "mean_processing_ms": 2.3360865291087554, "mean_inference_ms": 0.6643388099859437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2575872, "num_steps_sampled": 2580000, "sample_time_ms": 12592.369, "load_time_ms": 12.457, "grad_time_ms": 2396.926, "update_time_ms": 4.819, "learner": {"default_policy": {"cur_kl_coeff": 0.01900581084191799, "cur_lr": 4.999999873689376e-05, "total_loss": 883.2933959960938, "policy_loss": -0.0008381849620491266, "vf_loss": 883.2933959960938, "vf_explained_var": 0.20179198682308197, "kl": 0.0437091663479805, "entropy": 1.7581787109375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2580000, "episodes_total": 5159, "training_iteration": 129, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-17-27", "timestamp": 1567545447, "time_this_iter_s": 15.00498104095459, "time_total_s": 1966.539828300476, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1966.539828300476, "timesteps_since_restore": 2580000, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 33.00909090909091, "ram_util_percent": 12.845454545454546}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.4253152799738, "episode_reward_min": 123.5815656139999, "episode_reward_mean": 302.801023763286, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9953433989746063, "mean_processing_ms": 2.3361745088011157, "mean_inference_ms": 0.6642087642691394}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 2600000, "sample_time_ms": 12571.916, "load_time_ms": 12.451, "grad_time_ms": 2397.52, "update_time_ms": 4.811, "learner": {"default_policy": {"cur_kl_coeff": 0.028508717194199562, "cur_lr": 4.999999873689376e-05, "total_loss": 904.2662353515625, "policy_loss": -0.0027896719984710217, "vf_loss": 904.2681274414062, "vf_explained_var": 0.2019433081150055, "kl": 0.032038915902376175, "entropy": 1.760711669921875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2600000, "episodes_total": 5199, "training_iteration": 130, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-17-42", "timestamp": 1567545462, "time_this_iter_s": 14.727154016494751, "time_total_s": 1981.2669823169708, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1981.2669823169708, "timesteps_since_restore": 2600000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 34.214285714285715, "ram_util_percent": 12.852380952380951}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 375.5642235992481, "episode_reward_min": 201.69155177101874, "episode_reward_mean": 307.53182728389254, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9951102805515846, "mean_processing_ms": 2.3360578406256938, "mean_inference_ms": 0.6643678638213691}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2615808, "num_steps_sampled": 2620000, "sample_time_ms": 12579.705, "load_time_ms": 12.442, "grad_time_ms": 2396.736, "update_time_ms": 4.882, "learner": {"default_policy": {"cur_kl_coeff": 0.028508717194199562, "cur_lr": 4.999999873689376e-05, "total_loss": 905.7232666015625, "policy_loss": -2.2764770619687624e-05, "vf_loss": 905.7223510742188, "vf_explained_var": 0.19739672541618347, "kl": 0.03534281626343727, "entropy": 1.7129254341125488, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2620000, "episodes_total": 5238, "training_iteration": 131, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-17-57", "timestamp": 1567545477, "time_this_iter_s": 15.113390445709229, "time_total_s": 1996.38037276268, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1996.38037276268, "timesteps_since_restore": 2620000, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 34.55238095238095, "ram_util_percent": 12.861904761904762}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 389.88286074874907, "episode_reward_min": -102.14554506838964, "episode_reward_mean": 304.00716584631493, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9943566093110148, "mean_processing_ms": 2.3359832678132437, "mean_inference_ms": 0.664282404420198}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2635776, "num_steps_sampled": 2640000, "sample_time_ms": 12632.959, "load_time_ms": 12.459, "grad_time_ms": 2397.929, "update_time_ms": 4.853, "learner": {"default_policy": {"cur_kl_coeff": 0.028508717194199562, "cur_lr": 4.999999873689376e-05, "total_loss": 976.9143676757812, "policy_loss": -0.0004022606590297073, "vf_loss": 976.9138793945312, "vf_explained_var": 0.19901204109191895, "kl": 0.03427959233522415, "entropy": 1.5997812747955322, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2640000, "episodes_total": 5278, "training_iteration": 132, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-18-12", "timestamp": 1567545492, "time_this_iter_s": 15.545738220214844, "time_total_s": 2011.926110982895, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2011.926110982895, "timesteps_since_restore": 2640000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 33.20434782608696, "ram_util_percent": 12.873913043478263}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 397.20990511813045, "episode_reward_min": -102.14554506838964, "episode_reward_mean": 302.06803132770887, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9937792100564447, "mean_processing_ms": 2.335844629984615, "mean_inference_ms": 0.6641997583951305}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2655744, "num_steps_sampled": 2660000, "sample_time_ms": 12647.387, "load_time_ms": 12.476, "grad_time_ms": 2398.06, "update_time_ms": 4.858, "learner": {"default_policy": {"cur_kl_coeff": 0.028508717194199562, "cur_lr": 4.999999873689376e-05, "total_loss": 946.5900268554688, "policy_loss": -0.0024016716051846743, "vf_loss": 946.5911254882812, "vf_explained_var": 0.20163801312446594, "kl": 0.041511133313179016, "entropy": 1.5978747606277466, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2660000, "episodes_total": 5317, "training_iteration": 133, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-18-28", "timestamp": 1567545508, "time_this_iter_s": 15.327966928482056, "time_total_s": 2027.254077911377, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2027.254077911377, "timesteps_since_restore": 2660000, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 35.60952380952381, "ram_util_percent": 12.866666666666665}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 397.20990511813045, "episode_reward_min": -41.56519656267087, "episode_reward_mean": 305.1278697861559, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9930804320311997, "mean_processing_ms": 2.335677302077151, "mean_inference_ms": 0.6640367361365811}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2675712, "num_steps_sampled": 2680000, "sample_time_ms": 12691.337, "load_time_ms": 12.442, "grad_time_ms": 2396.334, "update_time_ms": 4.911, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 963.8992309570312, "policy_loss": -0.0016908907564356923, "vf_loss": 963.8997192382812, "vf_explained_var": 0.21571648120880127, "kl": 0.030723657459020615, "entropy": 1.6061683893203735, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2680000, "episodes_total": 5357, "training_iteration": 134, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-18-43", "timestamp": 1567545523, "time_this_iter_s": 15.45337462425232, "time_total_s": 2042.7074525356293, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2042.7074525356293, "timesteps_since_restore": 2680000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 32.721739130434784, "ram_util_percent": 12.891304347826088}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 397.20990511813045, "episode_reward_min": -87.60682964518891, "episode_reward_mean": 300.34538311938434, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9901745471824337, "mean_processing_ms": 2.3359447926238928, "mean_inference_ms": 0.6637176223637146}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2695680, "num_steps_sampled": 2700000, "sample_time_ms": 12759.309, "load_time_ms": 12.441, "grad_time_ms": 2395.669, "update_time_ms": 4.91, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 1000.0501098632812, "policy_loss": -0.0028767611365765333, "vf_loss": 1000.052001953125, "vf_explained_var": 0.2094203233718872, "kl": 0.023439891636371613, "entropy": 1.5937108993530273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2700000, "episodes_total": 5399, "training_iteration": 135, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-18-59", "timestamp": 1567545539, "time_this_iter_s": 15.70122742652893, "time_total_s": 2058.408679962158, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2058.408679962158, "timesteps_since_restore": 2700000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 33.98181818181817, "ram_util_percent": 12.881818181818183}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 387.4115931155618, "episode_reward_min": -87.60682964518891, "episode_reward_mean": 304.75593143164207, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9912169748125343, "mean_processing_ms": 2.3360758306429337, "mean_inference_ms": 0.6639765197718098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2715648, "num_steps_sampled": 2720000, "sample_time_ms": 12797.122, "load_time_ms": 12.457, "grad_time_ms": 2394.765, "update_time_ms": 4.896, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 920.8926391601562, "policy_loss": -0.002010936150327325, "vf_loss": 920.8934326171875, "vf_explained_var": 0.21535125374794006, "kl": 0.029050026088953018, "entropy": 1.5930118560791016, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2720000, "episodes_total": 5438, "training_iteration": 136, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-19-14", "timestamp": 1567545554, "time_this_iter_s": 15.330120325088501, "time_total_s": 2073.7388002872467, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2073.7388002872467, "timesteps_since_restore": 2720000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 34.65909090909091, "ram_util_percent": 12.904545454545454}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 389.63506064874633, "episode_reward_min": -87.60682964518891, "episode_reward_mean": 307.11431199757993, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9931108113966722, "mean_processing_ms": 2.3360515270660356, "mean_inference_ms": 0.6639912715723849}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2735616, "num_steps_sampled": 2740000, "sample_time_ms": 12845.921, "load_time_ms": 12.471, "grad_time_ms": 2394.384, "update_time_ms": 4.878, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 941.7033081054688, "policy_loss": -0.0007663217838853598, "vf_loss": 941.7025146484375, "vf_explained_var": 0.22988437116146088, "kl": 0.03769732639193535, "entropy": 1.5499576330184937, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2740000, "episodes_total": 5478, "training_iteration": 137, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-19-30", "timestamp": 1567545570, "time_this_iter_s": 15.520493268966675, "time_total_s": 2089.2592935562134, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2089.2592935562134, "timesteps_since_restore": 2740000, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 34.10454545454545, "ram_util_percent": 12.890909090909092}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.1280024491527, "episode_reward_min": 93.97197860490161, "episode_reward_mean": 314.02615538812677, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.993953516587727, "mean_processing_ms": 2.335952545832857, "mean_inference_ms": 0.6637642471569815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2755584, "num_steps_sampled": 2760000, "sample_time_ms": 12909.818, "load_time_ms": 12.496, "grad_time_ms": 2394.621, "update_time_ms": 4.866, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 942.1113891601562, "policy_loss": -0.0011047824518755078, "vf_loss": 942.1112060546875, "vf_explained_var": 0.2399798482656479, "kl": 0.02892465516924858, "entropy": 1.487172245979309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2760000, "episodes_total": 5518, "training_iteration": 138, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-19-45", "timestamp": 1567545585, "time_this_iter_s": 15.627639770507812, "time_total_s": 2104.886933326721, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2104.886933326721, "timesteps_since_restore": 2760000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 34.49999999999999, "ram_util_percent": 12.895454545454548}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 406.1280024491527, "episode_reward_min": 140.61379361733376, "episode_reward_mean": 317.06490030825904, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.994192846680925, "mean_processing_ms": 2.336040938881346, "mean_inference_ms": 0.6635750225932447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2775552, "num_steps_sampled": 2780000, "sample_time_ms": 12967.461, "load_time_ms": 12.491, "grad_time_ms": 2394.57, "update_time_ms": 4.741, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 970.8745727539062, "policy_loss": 0.0005100342677906156, "vf_loss": 970.872802734375, "vf_explained_var": 0.24129001796245575, "kl": 0.03194691985845566, "entropy": 1.4865753650665283, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2780000, "episodes_total": 5559, "training_iteration": 139, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-20-01", "timestamp": 1567545601, "time_this_iter_s": 15.58122444152832, "time_total_s": 2120.4681577682495, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2120.4681577682495, "timesteps_since_restore": 2780000, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 35.65, "ram_util_percent": 12.895454545454548}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 411.17485618958, "episode_reward_min": -20.07370341809196, "episode_reward_mean": 319.2484483225837, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9954918453364767, "mean_processing_ms": 2.3360548762403512, "mean_inference_ms": 0.6637974293961981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2795520, "num_steps_sampled": 2800000, "sample_time_ms": 13067.75, "load_time_ms": 12.513, "grad_time_ms": 2393.926, "update_time_ms": 4.807, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 946.7371826171875, "policy_loss": -0.0014776978641748428, "vf_loss": 946.7373657226562, "vf_explained_var": 0.2616192400455475, "kl": 0.028954120352864265, "entropy": 1.4923784732818604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2800000, "episodes_total": 5597, "training_iteration": 140, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-20-17", "timestamp": 1567545617, "time_this_iter_s": 15.72432541847229, "time_total_s": 2136.192483186722, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2136.192483186722, "timesteps_since_restore": 2800000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 34.77391304347827, "ram_util_percent": 12.900000000000002}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 411.17485618958, "episode_reward_min": -20.07370341809196, "episode_reward_mean": 313.7155880568978, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.998074110749135, "mean_processing_ms": 2.335895363197426, "mean_inference_ms": 0.6639761553448453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2815488, "num_steps_sampled": 2820000, "sample_time_ms": 13084.879, "load_time_ms": 12.52, "grad_time_ms": 2393.979, "update_time_ms": 4.782, "learner": {"default_policy": {"cur_kl_coeff": 0.04276307672262192, "cur_lr": 4.999999873689376e-05, "total_loss": 934.8882446289062, "policy_loss": 0.001925879972986877, "vf_loss": 934.8843994140625, "vf_explained_var": 0.27704450488090515, "kl": 0.04439346492290497, "entropy": 1.5487627983093262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2820000, "episodes_total": 5637, "training_iteration": 141, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-20-32", "timestamp": 1567545632, "time_this_iter_s": 15.285128116607666, "time_total_s": 2151.4776113033295, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2151.4776113033295, "timesteps_since_restore": 2820000, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 34.98636363636364, "ram_util_percent": 12.92727272727273}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 411.17485618958, "episode_reward_min": 114.06924230058307, "episode_reward_mean": 307.91501894026163, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9984066438741017, "mean_processing_ms": 2.3359497288207858, "mean_inference_ms": 0.6639593303657411}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2835456, "num_steps_sampled": 2840000, "sample_time_ms": 13069.621, "load_time_ms": 12.525, "grad_time_ms": 2392.683, "update_time_ms": 4.807, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 952.5631103515625, "policy_loss": -0.0015229469863697886, "vf_loss": 952.5629272460938, "vf_explained_var": 0.28479599952697754, "kl": 0.02628849633038044, "entropy": 1.6539114713668823, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2840000, "episodes_total": 5678, "training_iteration": 142, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-20-47", "timestamp": 1567545647, "time_this_iter_s": 15.38116192817688, "time_total_s": 2166.8587732315063, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2166.8587732315063, "timesteps_since_restore": 2840000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 32.981818181818184, "ram_util_percent": 12.91818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 410.05093848681736, "episode_reward_min": 98.34451301689751, "episode_reward_mean": 311.0928830834023, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9978381287019755, "mean_processing_ms": 2.335980786149337, "mean_inference_ms": 0.663729269339167}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2855424, "num_steps_sampled": 2860000, "sample_time_ms": 13032.988, "load_time_ms": 12.49, "grad_time_ms": 2392.512, "update_time_ms": 4.811, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 944.7401123046875, "policy_loss": -0.0032759446185082197, "vf_loss": 944.7413940429688, "vf_explained_var": 0.32254448533058167, "kl": 0.028333425521850586, "entropy": 1.6253039836883545, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2860000, "episodes_total": 5717, "training_iteration": 143, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-21-02", "timestamp": 1567545662, "time_this_iter_s": 14.96044135093689, "time_total_s": 2181.8192145824432, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2181.8192145824432, "timesteps_since_restore": 2860000, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 33.976190476190474, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 410.05093848681736, "episode_reward_min": 98.34451301689751, "episode_reward_mean": 321.8455319456693, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9970710960531375, "mean_processing_ms": 2.335924078301774, "mean_inference_ms": 0.6636029740908387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2875392, "num_steps_sampled": 2880000, "sample_time_ms": 12982.135, "load_time_ms": 12.507, "grad_time_ms": 2392.858, "update_time_ms": 4.725, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 964.219970703125, "policy_loss": -0.003699440974742174, "vf_loss": 964.2219848632812, "vf_explained_var": 0.3059372901916504, "kl": 0.02362263947725296, "entropy": 1.631184458732605, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2880000, "episodes_total": 5757, "training_iteration": 144, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-21-17", "timestamp": 1567545677, "time_this_iter_s": 14.947307586669922, "time_total_s": 2196.766522169113, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2196.766522169113, "timesteps_since_restore": 2880000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 33.66190476190476, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 410.85674304206975, "episode_reward_min": 202.116263883685, "episode_reward_mean": 324.4011251630457, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.997684570963115, "mean_processing_ms": 2.335991218269308, "mean_inference_ms": 0.6635902502322168}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2895360, "num_steps_sampled": 2900000, "sample_time_ms": 12915.412, "load_time_ms": 12.575, "grad_time_ms": 2393.406, "update_time_ms": 4.751, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 990.1578369140625, "policy_loss": 0.0006068272632546723, "vf_loss": 990.1548461914062, "vf_explained_var": 0.3054609000682831, "kl": 0.03718653693795204, "entropy": 1.6289714574813843, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2900000, "episodes_total": 5798, "training_iteration": 145, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-21-32", "timestamp": 1567545692, "time_this_iter_s": 15.040397644042969, "time_total_s": 2211.806919813156, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2211.806919813156, "timesteps_since_restore": 2900000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 32.777272727272724, "ram_util_percent": 12.91818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 410.85674304206975, "episode_reward_min": 202.116263883685, "episode_reward_mean": 322.4200745039706, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9969587946027696, "mean_processing_ms": 2.3361679975510032, "mean_inference_ms": 0.6634773558761453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2915328, "num_steps_sampled": 2920000, "sample_time_ms": 12901.767, "load_time_ms": 12.621, "grad_time_ms": 2393.327, "update_time_ms": 4.746, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 975.7158203125, "policy_loss": -0.002619457896798849, "vf_loss": 975.716552734375, "vf_explained_var": 0.3128841519355774, "kl": 0.030741281807422638, "entropy": 1.6179639101028442, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2920000, "episodes_total": 5838, "training_iteration": 146, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-21-48", "timestamp": 1567545708, "time_this_iter_s": 15.193091630935669, "time_total_s": 2227.000011444092, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2227.000011444092, "timesteps_since_restore": 2920000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 33.66190476190476, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 413.2197920247305, "episode_reward_min": 214.21886073395027, "episode_reward_mean": 324.59511018390435, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9968469933438877, "mean_processing_ms": 2.3361775947905397, "mean_inference_ms": 0.6633501089559853}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935296, "num_steps_sampled": 2940000, "sample_time_ms": 12869.802, "load_time_ms": 12.583, "grad_time_ms": 2393.93, "update_time_ms": 4.813, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 980.900634765625, "policy_loss": -0.0033148527145385742, "vf_loss": 980.9024658203125, "vf_explained_var": 0.3148459494113922, "kl": 0.02591291442513466, "entropy": 1.5870672464370728, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2940000, "episodes_total": 5878, "training_iteration": 147, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-22-03", "timestamp": 1567545723, "time_this_iter_s": 15.207417726516724, "time_total_s": 2242.2074291706085, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2242.2074291706085, "timesteps_since_restore": 2940000, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 32.93181818181819, "ram_util_percent": 12.913636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 417.55453747158606, "episode_reward_min": 230.83318926811177, "episode_reward_mean": 322.6523270986699, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.996222367757034, "mean_processing_ms": 2.336167960463203, "mean_inference_ms": 0.6632481440130197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2955264, "num_steps_sampled": 2960000, "sample_time_ms": 12825.926, "load_time_ms": 12.571, "grad_time_ms": 2394.222, "update_time_ms": 4.805, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 961.7484130859375, "policy_loss": -0.0008642413886263967, "vf_loss": 961.747314453125, "vf_explained_var": 0.33673954010009766, "kl": 0.031715404242277145, "entropy": 1.6005579233169556, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2960000, "episodes_total": 5918, "training_iteration": 148, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-22-18", "timestamp": 1567545738, "time_this_iter_s": 15.191585063934326, "time_total_s": 2257.399014234543, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2257.399014234543, "timesteps_since_restore": 2960000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 32.57727272727273, "ram_util_percent": 12.91818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 417.55453747158606, "episode_reward_min": 236.37472930542063, "episode_reward_mean": 321.38978083999564, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9953329844429497, "mean_processing_ms": 2.3360488594463846, "mean_inference_ms": 0.6631779653819911}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2975232, "num_steps_sampled": 2980000, "sample_time_ms": 12771.737, "load_time_ms": 12.655, "grad_time_ms": 2394.726, "update_time_ms": 4.788, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 939.2664184570312, "policy_loss": -0.0027565360069274902, "vf_loss": 939.2674560546875, "vf_explained_var": 0.3687094449996948, "kl": 0.02706858515739441, "entropy": 1.596023678779602, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2980000, "episodes_total": 5957, "training_iteration": 149, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-22-33", "timestamp": 1567545753, "time_this_iter_s": 15.043416261672974, "time_total_s": 2272.442430496216, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2272.442430496216, "timesteps_since_restore": 2980000, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 33.65714285714286, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 412.2756356441304, "episode_reward_min": 236.37472930542063, "episode_reward_mean": 318.2469019557786, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.993998938355016, "mean_processing_ms": 2.3360547616351925, "mean_inference_ms": 0.6630735142964415}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2995200, "num_steps_sampled": 3000000, "sample_time_ms": 12685.958, "load_time_ms": 12.655, "grad_time_ms": 2394.347, "update_time_ms": 4.709, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 990.9998779296875, "policy_loss": 0.0002847930882126093, "vf_loss": 990.9973754882812, "vf_explained_var": 0.3539871871471405, "kl": 0.034714944660663605, "entropy": 1.593687891960144, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3000000, "episodes_total": 5998, "training_iteration": 150, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-22-48", "timestamp": 1567545768, "time_this_iter_s": 14.862901449203491, "time_total_s": 2287.3053319454193, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2287.3053319454193, "timesteps_since_restore": 3000000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 33.87619047619048, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 412.2756356441304, "episode_reward_min": 214.21201630218354, "episode_reward_mean": 319.86675595935446, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.993642695172886, "mean_processing_ms": 2.3361393064994616, "mean_inference_ms": 0.6630111270871079}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3015168, "num_steps_sampled": 3020000, "sample_time_ms": 12687.181, "load_time_ms": 12.662, "grad_time_ms": 2394.118, "update_time_ms": 4.631, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 978.7125244140625, "policy_loss": -0.002857340732589364, "vf_loss": 978.7138671875, "vf_explained_var": 0.3434024751186371, "kl": 0.025580810382962227, "entropy": 1.523093342781067, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3020000, "episodes_total": 6038, "training_iteration": 151, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-23-03", "timestamp": 1567545783, "time_this_iter_s": 15.293601751327515, "time_total_s": 2302.598933696747, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2302.598933696747, "timesteps_since_restore": 3020000, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 34.10909090909091, "ram_util_percent": 12.913636363636364}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 412.2756356441304, "episode_reward_min": 214.21201630218354, "episode_reward_mean": 325.0883737281862, "episode_len_mean": 500.0, "episodes_this_iter": 38, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9962477999283634, "mean_processing_ms": 2.3359709876683756, "mean_inference_ms": 0.663045124690306}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3035136, "num_steps_sampled": 3040000, "sample_time_ms": 12658.932, "load_time_ms": 12.71, "grad_time_ms": 2394.204, "update_time_ms": 4.673, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 967.7301635742188, "policy_loss": -0.002567979274317622, "vf_loss": 967.7310791015625, "vf_explained_var": 0.3114197254180908, "kl": 0.025485295802354813, "entropy": 1.518924593925476, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3040000, "episodes_total": 6076, "training_iteration": 152, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-23-18", "timestamp": 1567545798, "time_this_iter_s": 15.099509239196777, "time_total_s": 2317.6984429359436, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2317.6984429359436, "timesteps_since_restore": 3040000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 34.059090909090905, "ram_util_percent": 12.91818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 410.7725411346194, "episode_reward_min": 188.04286102274023, "episode_reward_mean": 318.45937418581167, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9956501485247045, "mean_processing_ms": 2.3358519068672114, "mean_inference_ms": 0.662832944770232}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3055104, "num_steps_sampled": 3060000, "sample_time_ms": 12664.163, "load_time_ms": 12.699, "grad_time_ms": 2394.435, "update_time_ms": 4.603, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 995.2203369140625, "policy_loss": -0.0018689078278839588, "vf_loss": 995.2207641601562, "vf_explained_var": 0.285835862159729, "kl": 0.022318819537758827, "entropy": 1.626332402229309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3060000, "episodes_total": 6117, "training_iteration": 153, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-23-33", "timestamp": 1567545813, "time_this_iter_s": 15.013344049453735, "time_total_s": 2332.7117869853973, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2332.7117869853973, "timesteps_since_restore": 3060000, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 33.74761904761905, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 384.7443413560167, "episode_reward_min": 188.04286102274023, "episode_reward_mean": 308.22782871550396, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.994045018051187, "mean_processing_ms": 2.335848450238177, "mean_inference_ms": 0.6628246145420198}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3075072, "num_steps_sampled": 3080000, "sample_time_ms": 12673.757, "load_time_ms": 12.69, "grad_time_ms": 2394.73, "update_time_ms": 4.662, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 982.1332397460938, "policy_loss": -0.0022622139658778906, "vf_loss": 982.1340942382812, "vf_explained_var": 0.2822808623313904, "kl": 0.022004498168826103, "entropy": 1.6183329820632935, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3080000, "episodes_total": 6157, "training_iteration": 154, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-23-48", "timestamp": 1567545828, "time_this_iter_s": 15.046458005905151, "time_total_s": 2347.7582449913025, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2347.7582449913025, "timesteps_since_restore": 3080000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 33.095454545454544, "ram_util_percent": 12.922727272727274}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 369.028595493326, "episode_reward_min": 221.5402338403504, "episode_reward_mean": 306.55039673930133, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.993590495116196, "mean_processing_ms": 2.3358798635979015, "mean_inference_ms": 0.6624598256430508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3095040, "num_steps_sampled": 3100000, "sample_time_ms": 12683.996, "load_time_ms": 12.664, "grad_time_ms": 2394.331, "update_time_ms": 4.644, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 979.5193481445312, "policy_loss": -0.004279923625290394, "vf_loss": 979.522216796875, "vf_explained_var": 0.28272131085395813, "kl": 0.021030502393841743, "entropy": 1.6208007335662842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3100000, "episodes_total": 6197, "training_iteration": 155, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-24-03", "timestamp": 1567545843, "time_this_iter_s": 15.13904094696045, "time_total_s": 2362.897285938263, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2362.897285938263, "timesteps_since_restore": 3100000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 33.91904761904762, "ram_util_percent": 12.914285714285716}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 366.91554296462624, "episode_reward_min": 219.65272270627827, "episode_reward_mean": 306.0148328828686, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.993445397662342, "mean_processing_ms": 2.3357714113482615, "mean_inference_ms": 0.6625100373534738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3115008, "num_steps_sampled": 3120000, "sample_time_ms": 12667.41, "load_time_ms": 12.603, "grad_time_ms": 2394.282, "update_time_ms": 4.702, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 957.8004760742188, "policy_loss": -0.003894255729392171, "vf_loss": 957.8031005859375, "vf_explained_var": 0.29067742824554443, "kl": 0.021865960210561752, "entropy": 1.622638463973999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3120000, "episodes_total": 6236, "training_iteration": 156, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-24-19", "timestamp": 1567545859, "time_this_iter_s": 15.027413368225098, "time_total_s": 2377.924699306488, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2377.924699306488, "timesteps_since_restore": 3120000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 32.89090909090909, "ram_util_percent": 12.922727272727274}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 368.18784804318534, "episode_reward_min": 184.445812661338, "episode_reward_mean": 305.8435287230778, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9917608181250976, "mean_processing_ms": 2.335620165132101, "mean_inference_ms": 0.6625185856149405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3134976, "num_steps_sampled": 3140000, "sample_time_ms": 12649.91, "load_time_ms": 12.639, "grad_time_ms": 2393.686, "update_time_ms": 4.655, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 984.556884765625, "policy_loss": -0.0026170359924435616, "vf_loss": 984.5578002929688, "vf_explained_var": 0.29316240549087524, "kl": 0.026798725128173828, "entropy": 1.6285779476165771, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3140000, "episodes_total": 6276, "training_iteration": 157, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-24-34", "timestamp": 1567545874, "time_this_iter_s": 15.025341272354126, "time_total_s": 2392.950040578842, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2392.950040578842, "timesteps_since_restore": 3140000, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 33.72380952380953, "ram_util_percent": 12.923809523809522}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 368.18784804318534, "episode_reward_min": 184.445812661338, "episode_reward_mean": 305.0905958370528, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.99004736358522, "mean_processing_ms": 2.335668952521001, "mean_inference_ms": 0.6623244245527679}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3154944, "num_steps_sampled": 3160000, "sample_time_ms": 12662.522, "load_time_ms": 12.643, "grad_time_ms": 2393.173, "update_time_ms": 4.711, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 1021.0675048828125, "policy_loss": -0.0012192910071462393, "vf_loss": 1021.0662841796875, "vf_explained_var": 0.2555077373981476, "kl": 0.035434115678071976, "entropy": 1.6506304740905762, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3160000, "episodes_total": 6317, "training_iteration": 158, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-24-49", "timestamp": 1567545889, "time_this_iter_s": 15.313210487365723, "time_total_s": 2408.263251066208, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2408.263251066208, "timesteps_since_restore": 3160000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 33.46818181818182, "ram_util_percent": 12.945454545454545}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 377.19064718863194, "episode_reward_min": 190.50727922093287, "episode_reward_mean": 304.5596847660456, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.9901682452254654, "mean_processing_ms": 2.3356495157324892, "mean_inference_ms": 0.6621528699003179}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3174912, "num_steps_sampled": 3180000, "sample_time_ms": 12676.085, "load_time_ms": 12.584, "grad_time_ms": 2392.916, "update_time_ms": 4.762, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 981.2369995117188, "policy_loss": -0.0031785471364855766, "vf_loss": 981.2385864257812, "vf_explained_var": 0.2441575974225998, "kl": 0.02488301508128643, "entropy": 1.6583672761917114, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3180000, "episodes_total": 6356, "training_iteration": 159, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-25-04", "timestamp": 1567545904, "time_this_iter_s": 15.175644397735596, "time_total_s": 2423.4388954639435, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2423.4388954639435, "timesteps_since_restore": 3180000, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 32.74090909090909, "ram_util_percent": 12.931818181818182}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
{"episode_reward_max": 387.2034153143907, "episode_reward_min": 190.50727922093287, "episode_reward_mean": 304.9769386070543, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.988761659014963, "mean_processing_ms": 2.335948947028722, "mean_inference_ms": 0.6619254609876157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3194880, "num_steps_sampled": 3200000, "sample_time_ms": 12700.16, "load_time_ms": 12.562, "grad_time_ms": 2394.196, "update_time_ms": 4.851, "learner": {"default_policy": {"cur_kl_coeff": 0.06414461135864258, "cur_lr": 4.999999873689376e-05, "total_loss": 1042.123291015625, "policy_loss": -0.0031433384865522385, "vf_loss": 1042.124755859375, "vf_explained_var": 0.24100974202156067, "kl": 0.02500339411199093, "entropy": 1.6544455289840698, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": true, "timesteps_total": 3200000, "episodes_total": 6398, "training_iteration": 160, "experiment_id": "3077cd23261845c2b4a3bb84b847a870", "date": "2019-09-03_21-25-19", "timestamp": 1567545919, "time_this_iter_s": 15.117005109786987, "time_total_s": 2438.5559005737305, "pid": 17968, "hostname": "ip-172-31-28-55", "node_ip": "172.31.28.55", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"merge_norm_noise\": 0.05,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"no_inflow_noise\": true,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"scenario_length_noise\": 0.02,\n            \"state_noise\": 0.1,\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"UDSSCMergeEnvReset\",\n    \"exp_tag\": \"icra_65\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "UDSSCMergeEnvReset-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2438.5559005737305, "timesteps_since_restore": 3200000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 34.25238095238095, "ram_util_percent": 12.942857142857143}, "num_healthy_workers": 10, "trial_id": "a034ed16"}
