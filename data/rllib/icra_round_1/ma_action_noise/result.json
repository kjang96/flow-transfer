{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 467.53846153846155, "episodes_this_iter": 39, "policy_reward_mean": {"av": -1834.6571890823031, "action_adversary": 1834.6571890823031}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 4.288658643819192, "mean_processing_ms": 2.4035623415958773, "mean_inference_ms": 1.0436094108491039}, "off_policy_estimator": {}, "info": {"num_steps_trained": 19968, "num_steps_sampled": 20000, "sample_time_ms": 16468.333, "load_time_ms": 201.863, "grad_time_ms": 6077.61, "update_time_ms": 2486.049, "learner": {"action_adversary": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 27338.404296875, "policy_loss": -0.009629596956074238, "vf_loss": 27338.41015625, "vf_explained_var": 0.0001148195588029921, "kl": 0.003962530288845301, "entropy": 31.19613265991211, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 27357.71875, "policy_loss": -0.006339280400425196, "vf_loss": 27357.724609375, "vf_explained_var": 0.00012078499275958166, "kl": 0.007516101468354464, "entropy": 2.8416030406951904, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 20000, "episodes_total": 39, "training_iteration": 1, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-23-04", "timestamp": 1567646584, "time_this_iter_s": 25.396498918533325, "time_total_s": 25.396498918533325, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805c3c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25.396498918533325, "timesteps_since_restore": 20000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.05405405405406, "ram_util_percent": 13.775675675675677}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 468.7283950617284, "episodes_this_iter": 42, "policy_reward_mean": {"av": -1301.3455153929463, "action_adversary": 1301.3455153929463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.9962721292232812, "mean_processing_ms": 2.436981252698974, "mean_inference_ms": 1.0170537427479136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 39936, "num_steps_sampled": 40000, "sample_time_ms": 15519.117, "load_time_ms": 118.165, "grad_time_ms": 5550.473, "update_time_ms": 1246.7, "learner": {"action_adversary": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 5787.99658203125, "policy_loss": -0.01154396589845419, "vf_loss": 5788.0078125, "vf_explained_var": 5.6476164900232106e-05, "kl": 0.00612947391346097, "entropy": 31.186416625976562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 5793.5869140625, "policy_loss": -0.009156563319265842, "vf_loss": 5793.59521484375, "vf_explained_var": 5.878584488527849e-05, "kl": 0.010346177034080029, "entropy": 2.839622735977173, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 40000, "episodes_total": 81, "training_iteration": 2, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-23-24", "timestamp": 1567646604, "time_this_iter_s": 19.651026010513306, "time_total_s": 45.04752492904663, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880612488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 45.04752492904663, "timesteps_since_restore": 40000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.846428571428568, "ram_util_percent": 14.049999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 470.78, "episodes_this_iter": 41, "policy_reward_mean": {"av": -767.3205375741205, "action_adversary": 767.3205375741205}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.7069358109260997, "mean_processing_ms": 2.464197684688668, "mean_inference_ms": 0.9930448953469255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59904, "num_steps_sampled": 60000, "sample_time_ms": 14834.583, "load_time_ms": 86.697, "grad_time_ms": 5375.593, "update_time_ms": 833.663, "learner": {"action_adversary": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 1131.247802734375, "policy_loss": -0.013517899438738823, "vf_loss": 1131.2608642578125, "vf_explained_var": 2.7044079615734518e-05, "kl": 0.009174719452857971, "entropy": 31.166791915893555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 1131.0777587890625, "policy_loss": -0.009681821800768375, "vf_loss": 1131.0863037109375, "vf_explained_var": 2.903051790781319e-05, "kl": 0.010365369729697704, "entropy": 2.8340301513671875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 60000, "episodes_total": 122, "training_iteration": 3, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-23-43", "timestamp": 1567646623, "time_this_iter_s": 18.538773775100708, "time_total_s": 63.58629870414734, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805dd9d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 63.58629870414734, "timesteps_since_restore": 60000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.403846153846153, "ram_util_percent": 14.100000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 480.8, "episodes_this_iter": 41, "policy_reward_mean": {"av": -268.97364107514926, "action_adversary": 268.97364107514926}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.3883137255210762, "mean_processing_ms": 2.473734567565498, "mean_inference_ms": 0.9676244887681912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79872, "num_steps_sampled": 80000, "sample_time_ms": 14335.833, "load_time_ms": 75.128, "grad_time_ms": 5284.838, "update_time_ms": 627.223, "learner": {"action_adversary": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 325.8463439941406, "policy_loss": -0.0117701580747962, "vf_loss": 325.8578796386719, "vf_explained_var": -4.3422365706646815e-05, "kl": 0.008838153444230556, "entropy": 31.110214233398438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 326.215087890625, "policy_loss": -0.007177341263741255, "vf_loss": 326.2214050292969, "vf_explained_var": -4.441654164111242e-05, "kl": 0.008390062488615513, "entropy": 2.8145768642425537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 80000, "episodes_total": 163, "training_iteration": 4, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-24-01", "timestamp": 1567646641, "time_this_iter_s": 17.917283535003662, "time_total_s": 81.503582239151, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805efb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 81.503582239151, "timesteps_since_restore": 80000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.21923076923077, "ram_util_percent": 14.057692307692308}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 492.23, "episodes_this_iter": 41, "policy_reward_mean": {"av": -23.44334908362568, "action_adversary": 23.44334908362568}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.1742534883576963, "mean_processing_ms": 2.4707412011410126, "mean_inference_ms": 0.9542343405270648}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99840, "num_steps_sampled": 100000, "sample_time_ms": 14039.741, "load_time_ms": 67.043, "grad_time_ms": 5228.567, "update_time_ms": 503.277, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 257.3800964355469, "policy_loss": -0.01208108477294445, "vf_loss": 257.3920593261719, "vf_explained_var": -0.00012037310807500035, "kl": 0.01075680460780859, "entropy": 31.065977096557617, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 257.54388427734375, "policy_loss": -0.006953980773687363, "vf_loss": 257.5503845214844, "vf_explained_var": -0.0001448484545107931, "kl": 0.008126537315547466, "entropy": 2.784881591796875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 100000, "episodes_total": 204, "training_iteration": 5, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-24-18", "timestamp": 1567646658, "time_this_iter_s": 17.917608976364136, "time_total_s": 99.42119121551514, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805efd90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 99.42119121551514, "timesteps_since_restore": 100000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.176923076923075, "ram_util_percent": 14.13076923076923}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 490.37, "episodes_this_iter": 40, "policy_reward_mean": {"av": 83.77880108067771, "action_adversary": -83.77880108067771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 3.0296505472066793, "mean_processing_ms": 2.4718144512098505, "mean_inference_ms": 0.9472182227136097}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119808, "num_steps_sampled": 120000, "sample_time_ms": 13755.895, "load_time_ms": 61.639, "grad_time_ms": 5194.892, "update_time_ms": 420.652, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 204.9186248779297, "policy_loss": -0.011961198411881924, "vf_loss": 204.9304962158203, "vf_explained_var": 0.020937491208314896, "kl": 0.01040164940059185, "entropy": 31.038057327270508, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 184.65061950683594, "policy_loss": -0.008574401028454304, "vf_loss": 184.65890502929688, "vf_explained_var": 0.07949139177799225, "kl": 0.011818469502031803, "entropy": 2.750521183013916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 120000, "episodes_total": 244, "training_iteration": 6, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-24-36", "timestamp": 1567646676, "time_this_iter_s": 17.422608613967896, "time_total_s": 116.84379982948303, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806bff28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 116.84379982948303, "timesteps_since_restore": 120000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.858333333333334, "ram_util_percent": 14.174999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 489.77, "episodes_this_iter": 42, "policy_reward_mean": {"av": 126.70801003143228, "action_adversary": -126.70801003143228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.934822688307769, "mean_processing_ms": 2.4786560614453106, "mean_inference_ms": 0.943608798686062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139776, "num_steps_sampled": 140000, "sample_time_ms": 13654.974, "load_time_ms": 57.81, "grad_time_ms": 5170.379, "update_time_ms": 361.687, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 204.31727600097656, "policy_loss": -0.013199358247220516, "vf_loss": 204.33033752441406, "vf_explained_var": 0.10607431083917618, "kl": 0.010259315371513367, "entropy": 31.02903938293457, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 197.8711700439453, "policy_loss": -0.008841519244015217, "vf_loss": 197.8797149658203, "vf_explained_var": 0.13948959112167358, "kl": 0.0123150534927845, "entropy": 2.710369110107422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 140000, "episodes_total": 286, "training_iteration": 7, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-24-54", "timestamp": 1567646694, "time_this_iter_s": 18.132623434066772, "time_total_s": 134.9764232635498, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806cb840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 134.9764232635498, "timesteps_since_restore": 140000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.684615384615388, "ram_util_percent": 14.188461538461537}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 490.46, "episodes_this_iter": 40, "policy_reward_mean": {"av": 144.85300142817044, "action_adversary": -144.85300142817044}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.8745070463682496, "mean_processing_ms": 2.4792412550342884, "mean_inference_ms": 0.9418299306215999}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159744, "num_steps_sampled": 160000, "sample_time_ms": 13545.543, "load_time_ms": 54.903, "grad_time_ms": 5151.743, "update_time_ms": 317.476, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 331.0925598144531, "policy_loss": -0.012706982903182507, "vf_loss": 331.1051330566406, "vf_explained_var": 0.2029428780078888, "kl": 0.011691576801240444, "entropy": 31.034404754638672, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 329.1754455566406, "policy_loss": -0.00879944209009409, "vf_loss": 329.1838684082031, "vf_explained_var": 0.22935345768928528, "kl": 0.013998832553625107, "entropy": 2.6806416511535645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 160000, "episodes_total": 326, "training_iteration": 8, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-25-12", "timestamp": 1567646712, "time_this_iter_s": 17.859928131103516, "time_total_s": 152.83635139465332, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d89d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 152.83635139465332, "timesteps_since_restore": 160000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.915384615384617, "ram_util_percent": 14.069230769230767}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 496.29, "episodes_this_iter": 40, "policy_reward_mean": {"av": 182.7258738037873, "action_adversary": -182.7258738037873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.832571956280375, "mean_processing_ms": 2.477288895315035, "mean_inference_ms": 0.9420224533873184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 180000, "sample_time_ms": 13458.273, "load_time_ms": 52.676, "grad_time_ms": 5134.879, "update_time_ms": 283.022, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 256.0846252441406, "policy_loss": -0.01459584478288889, "vf_loss": 256.09906005859375, "vf_explained_var": 0.3176806569099426, "kl": 0.01400939654558897, "entropy": 31.086694717407227, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 255.09046936035156, "policy_loss": -0.004648934584110975, "vf_loss": 255.0949249267578, "vf_explained_var": 0.34503915905952454, "kl": 0.0070883892476558685, "entropy": 2.6567254066467285, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 180000, "episodes_total": 366, "training_iteration": 9, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-25-30", "timestamp": 1567646730, "time_this_iter_s": 17.817492723464966, "time_total_s": 170.6538441181183, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806e92f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 170.6538441181183, "timesteps_since_restore": 180000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.444000000000003, "ram_util_percent": 14.064}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 217.98350324213283, "action_adversary": -217.98350324213283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7901516679610783, "mean_processing_ms": 2.4716513925908736, "mean_inference_ms": 0.9415577640611216}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199680, "num_steps_sampled": 200000, "sample_time_ms": 13364.363, "load_time_ms": 50.94, "grad_time_ms": 5121.387, "update_time_ms": 255.527, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 211.3934326171875, "policy_loss": -0.014495928771793842, "vf_loss": 211.40773010253906, "vf_explained_var": 0.37476372718811035, "kl": 0.01438118051737547, "entropy": 31.106098175048828, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 210.95742797851562, "policy_loss": -0.005420754197984934, "vf_loss": 210.96273803710938, "vf_explained_var": 0.40679267048835754, "kl": 0.009015030227601528, "entropy": 2.643700122833252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 200000, "episodes_total": 406, "training_iteration": 10, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-25-47", "timestamp": 1567646747, "time_this_iter_s": 17.578826904296875, "time_total_s": 188.23267102241516, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880535488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 188.23267102241516, "timesteps_since_restore": 200000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.984, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 232.03584217648574, "action_adversary": -232.03584217648574}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.75592440016786, "mean_processing_ms": 2.4686296642143386, "mean_inference_ms": 0.9400400872678037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 219648, "num_steps_sampled": 220000, "sample_time_ms": 12981.034, "load_time_ms": 34.222, "grad_time_ms": 5013.407, "update_time_ms": 7.645, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 242.80116271972656, "policy_loss": -0.014648987911641598, "vf_loss": 242.8155975341797, "vf_explained_var": 0.43070363998413086, "kl": 0.01396267395466566, "entropy": 31.120010375976562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 242.3059844970703, "policy_loss": -0.005604687612503767, "vf_loss": 242.3115234375, "vf_explained_var": 0.45591315627098083, "kl": 0.009788570925593376, "entropy": 2.614196300506592, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 220000, "episodes_total": 446, "training_iteration": 11, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-26-05", "timestamp": 1567646765, "time_this_iter_s": 17.690473318099976, "time_total_s": 205.92314434051514, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880535d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 205.92314434051514, "timesteps_since_restore": 220000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.923076923076923, "ram_util_percent": 14.076923076923077}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 239.52394211673396, "action_adversary": -239.52394211673396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.7283954838834172, "mean_processing_ms": 2.4660075653055755, "mean_inference_ms": 0.938257372489424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 239616, "num_steps_sampled": 240000, "sample_time_ms": 12784.209, "load_time_ms": 34.235, "grad_time_ms": 5012.301, "update_time_ms": 7.687, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 250.54957580566406, "policy_loss": -0.011541282758116722, "vf_loss": 250.56094360351562, "vf_explained_var": 0.49537551403045654, "kl": 0.012346413917839527, "entropy": 31.099796295166016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 249.5655517578125, "policy_loss": -0.0066083320416510105, "vf_loss": 249.57211303710938, "vf_explained_var": 0.5183224678039551, "kl": 0.01845690608024597, "entropy": 2.5543153285980225, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 240000, "episodes_total": 486, "training_iteration": 12, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-26-23", "timestamp": 1567646783, "time_this_iter_s": 17.672182083129883, "time_total_s": 223.59532642364502, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880546ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 223.59532642364502, "timesteps_since_restore": 240000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.984, "ram_util_percent": 14.08}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 253.5505805937658, "action_adversary": -253.5505805937658}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.705575764031731, "mean_processing_ms": 2.4635514948143835, "mean_inference_ms": 0.9368682992223901}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259584, "num_steps_sampled": 260000, "sample_time_ms": 12678.154, "load_time_ms": 35.308, "grad_time_ms": 5008.515, "update_time_ms": 7.746, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 259.2137451171875, "policy_loss": -0.01556017342954874, "vf_loss": 259.2291259765625, "vf_explained_var": 0.5321148037910461, "kl": 0.017885930836200714, "entropy": 31.140932083129883, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 258.7857971191406, "policy_loss": -0.003355238353833556, "vf_loss": 258.7891540527344, "vf_explained_var": 0.549025297164917, "kl": 0.00971167255192995, "entropy": 2.541248321533203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 260000, "episodes_total": 526, "training_iteration": 13, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-26-40", "timestamp": 1567646800, "time_this_iter_s": 17.45157790184021, "time_total_s": 241.04690432548523, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805507b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 241.04690432548523, "timesteps_since_restore": 260000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.028, "ram_util_percent": 14.088}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 258.9838471483241, "action_adversary": -258.9838471483241}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.684292699786631, "mean_processing_ms": 2.4613230851814962, "mean_inference_ms": 0.9358411437461632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279552, "num_steps_sampled": 280000, "sample_time_ms": 12622.01, "load_time_ms": 34.742, "grad_time_ms": 5005.043, "update_time_ms": 7.687, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 271.5910339355469, "policy_loss": -0.014476935379207134, "vf_loss": 271.6053771972656, "vf_explained_var": 0.5333656668663025, "kl": 0.014608766883611679, "entropy": 31.16640281677246, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 271.2417297363281, "policy_loss": -0.005730294622480869, "vf_loss": 271.2474365234375, "vf_explained_var": 0.5482004284858704, "kl": 0.015384607017040253, "entropy": 2.5171451568603516, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 280000, "episodes_total": 566, "training_iteration": 14, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-26-58", "timestamp": 1567646818, "time_this_iter_s": 17.31306767463684, "time_total_s": 258.35997200012207, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288055b950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 258.35997200012207, "timesteps_since_restore": 280000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.445833333333336, "ram_util_percent": 14.129166666666668}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 264.43040242146145, "action_adversary": -264.43040242146145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6643904799222513, "mean_processing_ms": 2.4595249204529783, "mean_inference_ms": 0.9352334308273959}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299520, "num_steps_sampled": 300000, "sample_time_ms": 12563.608, "load_time_ms": 34.757, "grad_time_ms": 5006.124, "update_time_ms": 7.732, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 240.44381713867188, "policy_loss": -0.015715526416897774, "vf_loss": 240.45933532714844, "vf_explained_var": 0.5505169630050659, "kl": 0.016446193680167198, "entropy": 31.212984085083008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 240.78823852539062, "policy_loss": -0.006996578071266413, "vf_loss": 240.79519653320312, "vf_explained_var": 0.5714308023452759, "kl": 0.01758403331041336, "entropy": 2.493779182434082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 300000, "episodes_total": 606, "training_iteration": 15, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-27-15", "timestamp": 1567646835, "time_this_iter_s": 17.34523320198059, "time_total_s": 275.70520520210266, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288056f268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 275.70520520210266, "timesteps_since_restore": 300000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.78, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 266.5488173755343, "action_adversary": -266.5488173755343}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6455212889366084, "mean_processing_ms": 2.4580794834760598, "mean_inference_ms": 0.9346488963266111}, "off_policy_estimator": {}, "info": {"num_steps_trained": 319488, "num_steps_sampled": 320000, "sample_time_ms": 12557.662, "load_time_ms": 34.749, "grad_time_ms": 5003.144, "update_time_ms": 7.77, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 238.6591033935547, "policy_loss": -0.015619519166648388, "vf_loss": 238.67449951171875, "vf_explained_var": 0.5291099548339844, "kl": 0.017435921356081963, "entropy": 31.223934173583984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 238.97616577148438, "policy_loss": -0.004960658960044384, "vf_loss": 238.9811248779297, "vf_explained_var": 0.5578478574752808, "kl": 0.014218087308108807, "entropy": 2.5026745796203613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 320000, "episodes_total": 646, "training_iteration": 16, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-27-32", "timestamp": 1567646852, "time_this_iter_s": 17.333513498306274, "time_total_s": 293.03871870040894, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a2400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 293.03871870040894, "timesteps_since_restore": 320000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.240000000000006, "ram_util_percent": 14.156}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 266.4412498077182, "action_adversary": -266.4412498077182}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.627529678714588, "mean_processing_ms": 2.4568727472278384, "mean_inference_ms": 0.9340070986116155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 339456, "num_steps_sampled": 340000, "sample_time_ms": 12479.688, "load_time_ms": 34.51, "grad_time_ms": 5000.764, "update_time_ms": 7.787, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 258.4931945800781, "policy_loss": -0.015914112329483032, "vf_loss": 258.5089111328125, "vf_explained_var": 0.5272578001022339, "kl": 0.016002465039491653, "entropy": 31.17717170715332, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 258.7861022949219, "policy_loss": -0.004062287509441376, "vf_loss": 258.7901611328125, "vf_explained_var": 0.5534399747848511, "kl": 0.008710954338312149, "entropy": 2.473560094833374, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 340000, "episodes_total": 686, "training_iteration": 17, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-27-50", "timestamp": 1567646870, "time_this_iter_s": 17.32540726661682, "time_total_s": 310.36412596702576, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a2c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 310.36412596702576, "timesteps_since_restore": 340000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.668000000000003, "ram_util_percent": 14.136}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 268.00485849505077, "action_adversary": -268.00485849505077}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.6110636040506177, "mean_processing_ms": 2.455860358306522, "mean_inference_ms": 0.9333387129266686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 359424, "num_steps_sampled": 360000, "sample_time_ms": 12428.877, "load_time_ms": 34.567, "grad_time_ms": 4996.904, "update_time_ms": 7.743, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 257.9546813964844, "policy_loss": -0.01506109070032835, "vf_loss": 257.9695129394531, "vf_explained_var": 0.5345539450645447, "kl": 0.018425174057483673, "entropy": 31.119951248168945, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 258.0804748535156, "policy_loss": -0.004524307791143656, "vf_loss": 258.08502197265625, "vf_explained_var": 0.5687060356140137, "kl": 0.013265850022435188, "entropy": 2.4426069259643555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 360000, "episodes_total": 726, "training_iteration": 18, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-28-07", "timestamp": 1567646887, "time_this_iter_s": 17.31246304512024, "time_total_s": 327.676589012146, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2b4e18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 327.676589012146, "timesteps_since_restore": 360000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.25, "ram_util_percent": 14.183333333333332}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 276.1301662631637, "action_adversary": -276.1301662631637}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5958188053715214, "mean_processing_ms": 2.454973580459598, "mean_inference_ms": 0.9326165583003452}, "off_policy_estimator": {}, "info": {"num_steps_trained": 379392, "num_steps_sampled": 380000, "sample_time_ms": 12376.373, "load_time_ms": 34.608, "grad_time_ms": 4997.395, "update_time_ms": 7.773, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 253.52793884277344, "policy_loss": -0.015430965460836887, "vf_loss": 253.5431671142578, "vf_explained_var": 0.48908400535583496, "kl": 0.017923470586538315, "entropy": 31.051485061645508, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 253.42613220214844, "policy_loss": -0.003885874291881919, "vf_loss": 253.43008422851562, "vf_explained_var": 0.5304776430130005, "kl": 0.009601876139640808, "entropy": 2.4119091033935547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 380000, "episodes_total": 766, "training_iteration": 19, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-28-24", "timestamp": 1567646904, "time_this_iter_s": 17.299493312835693, "time_total_s": 344.9760823249817, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c3730>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 344.9760823249817, "timesteps_since_restore": 380000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.392, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 277.9277630125439, "action_adversary": -277.9277630125439}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5826149045936826, "mean_processing_ms": 2.4541075302208157, "mean_inference_ms": 0.9320446441253251}, "off_policy_estimator": {}, "info": {"num_steps_trained": 399360, "num_steps_sampled": 400000, "sample_time_ms": 12364.495, "load_time_ms": 34.537, "grad_time_ms": 4997.634, "update_time_ms": 7.801, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 276.2256164550781, "policy_loss": -0.014630467630922794, "vf_loss": 276.2400207519531, "vf_explained_var": 0.5057127475738525, "kl": 0.018036607652902603, "entropy": 31.11710548400879, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 276.35797119140625, "policy_loss": -0.005804466549307108, "vf_loss": 276.36376953125, "vf_explained_var": 0.5453307032585144, "kl": 0.010645519010722637, "entropy": 2.4107425212860107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 400000, "episodes_total": 806, "training_iteration": 20, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-28-42", "timestamp": 1567646922, "time_this_iter_s": 17.461472749710083, "time_total_s": 362.4375550746918, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c98c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 362.4375550746918, "timesteps_since_restore": 400000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.28, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 278.8335461361879, "action_adversary": -278.8335461361879}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.571117109366249, "mean_processing_ms": 2.4532838072357595, "mean_inference_ms": 0.9315442778934616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419328, "num_steps_sampled": 420000, "sample_time_ms": 12317.596, "load_time_ms": 34.552, "grad_time_ms": 4997.238, "update_time_ms": 7.847, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 264.8263244628906, "policy_loss": -0.015337754972279072, "vf_loss": 264.8414611816406, "vf_explained_var": 0.5173918008804321, "kl": 0.01769222877919674, "entropy": 31.120723724365234, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 265.2434387207031, "policy_loss": -0.0037510378751903772, "vf_loss": 265.2471618652344, "vf_explained_var": 0.5440357327461243, "kl": 0.009393187239766121, "entropy": 2.391192674636841, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 420000, "episodes_total": 846, "training_iteration": 21, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-28-59", "timestamp": 1567646939, "time_this_iter_s": 17.220617532730103, "time_total_s": 379.6581726074219, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c9f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 379.6581726074219, "timesteps_since_restore": 420000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.44, "ram_util_percent": 14.199999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 279.53050008042453, "action_adversary": -279.53050008042453}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.561128801832827, "mean_processing_ms": 2.4525263028428195, "mean_inference_ms": 0.931251800765678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 439296, "num_steps_sampled": 440000, "sample_time_ms": 12288.376, "load_time_ms": 34.539, "grad_time_ms": 4993.729, "update_time_ms": 7.888, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 282.5174865722656, "policy_loss": -0.012291578575968742, "vf_loss": 282.5296325683594, "vf_explained_var": 0.547967791557312, "kl": 0.014139309525489807, "entropy": 31.06467628479004, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 282.5596923828125, "policy_loss": -0.006343644578009844, "vf_loss": 282.5660095214844, "vf_explained_var": 0.5690415501594543, "kl": 0.010167347267270088, "entropy": 2.376795768737793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 440000, "episodes_total": 886, "training_iteration": 22, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-29-16", "timestamp": 1567646956, "time_this_iter_s": 17.344624996185303, "time_total_s": 397.0027976036072, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d260f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 397.0027976036072, "timesteps_since_restore": 440000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.29583333333333, "ram_util_percent": 14.225}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 280.2079058246411, "action_adversary": -280.2079058246411}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5519546282073087, "mean_processing_ms": 2.4518938334966274, "mean_inference_ms": 0.9309817924138635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459264, "num_steps_sampled": 460000, "sample_time_ms": 12264.05, "load_time_ms": 34.569, "grad_time_ms": 4994.725, "update_time_ms": 7.908, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 266.0987548828125, "policy_loss": -0.01566779986023903, "vf_loss": 266.1141357421875, "vf_explained_var": 0.5291039943695068, "kl": 0.021760739386081696, "entropy": 31.098295211791992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 266.653076171875, "policy_loss": -0.005089558660984039, "vf_loss": 266.65814208984375, "vf_explained_var": 0.5502446293830872, "kl": 0.011952721513807774, "entropy": 2.343134641647339, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 460000, "episodes_total": 926, "training_iteration": 23, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-29-34", "timestamp": 1567646974, "time_this_iter_s": 17.220171689987183, "time_total_s": 414.22296929359436, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 414.22296929359436, "timesteps_since_restore": 460000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.308000000000003, "ram_util_percent": 14.232000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 282.99878774400236, "action_adversary": -282.99878774400236}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.543173933896542, "mean_processing_ms": 2.45123966759444, "mean_inference_ms": 0.9305783283410207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 479232, "num_steps_sampled": 480000, "sample_time_ms": 12252.009, "load_time_ms": 34.637, "grad_time_ms": 4995.82, "update_time_ms": 8.206, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 261.9291687011719, "policy_loss": -0.01380967628210783, "vf_loss": 261.9427490234375, "vf_explained_var": 0.5125041604042053, "kl": 0.014714119955897331, "entropy": 31.07967758178711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 262.6248474121094, "policy_loss": -0.008102239109575748, "vf_loss": 262.6329040527344, "vf_explained_var": 0.5370288491249084, "kl": 0.027506418526172638, "entropy": 2.352717399597168, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 480000, "episodes_total": 966, "training_iteration": 24, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-29-51", "timestamp": 1567646991, "time_this_iter_s": 17.207584142684937, "time_total_s": 431.4305534362793, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c36a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 431.4305534362793, "timesteps_since_restore": 480000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.054166666666664, "ram_util_percent": 14.229166666666666}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 284.14198050012305, "action_adversary": -284.14198050012305}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.53524609272892, "mean_processing_ms": 2.450596269590473, "mean_inference_ms": 0.9302011229280468}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499200, "num_steps_sampled": 500000, "sample_time_ms": 12242.393, "load_time_ms": 34.617, "grad_time_ms": 4993.474, "update_time_ms": 8.176, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 272.7224426269531, "policy_loss": -0.0156449843198061, "vf_loss": 272.73779296875, "vf_explained_var": 0.5025303363800049, "kl": 0.02288725972175598, "entropy": 31.064208984375, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 273.37646484375, "policy_loss": -0.003967749420553446, "vf_loss": 273.38043212890625, "vf_explained_var": 0.5236150026321411, "kl": 0.014197158627212048, "entropy": 2.297945976257324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 500000, "episodes_total": 1006, "training_iteration": 25, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-30-08", "timestamp": 1567647008, "time_this_iter_s": 17.224635124206543, "time_total_s": 448.65518856048584, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805ddc80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 448.65518856048584, "timesteps_since_restore": 500000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.516000000000005, "ram_util_percent": 14.240000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.38480662722566, "action_adversary": -287.38480662722566}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5276258323234173, "mean_processing_ms": 2.449997948372023, "mean_inference_ms": 0.9297372154861612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 519168, "num_steps_sampled": 520000, "sample_time_ms": 12235.398, "load_time_ms": 35.213, "grad_time_ms": 4993.327, "update_time_ms": 8.139, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 277.666015625, "policy_loss": -0.014122082851827145, "vf_loss": 277.6799011230469, "vf_explained_var": 0.48934927582740784, "kl": 0.01837855949997902, "entropy": 31.08329200744629, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 278.6183166503906, "policy_loss": -0.003073252271860838, "vf_loss": 278.62139892578125, "vf_explained_var": 0.5054211020469666, "kl": 0.00823987927287817, "entropy": 2.273549795150757, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 520000, "episodes_total": 1046, "training_iteration": 26, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-30-25", "timestamp": 1567647025, "time_this_iter_s": 17.268547534942627, "time_total_s": 465.92373609542847, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288063ce18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 465.92373609542847, "timesteps_since_restore": 520000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.092, "ram_util_percent": 14.236}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 289.02942202369184, "action_adversary": -289.02942202369184}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5203324111081553, "mean_processing_ms": 2.449470658298592, "mean_inference_ms": 0.9293403530220189}, "off_policy_estimator": {}, "info": {"num_steps_trained": 539136, "num_steps_sampled": 540000, "sample_time_ms": 12227.195, "load_time_ms": 35.208, "grad_time_ms": 4992.974, "update_time_ms": 8.133, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 286.7821044921875, "policy_loss": -0.013936970382928848, "vf_loss": 286.7957458496094, "vf_explained_var": 0.485749751329422, "kl": 0.02029958926141262, "entropy": 31.073368072509766, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 287.634521484375, "policy_loss": -0.00825194176286459, "vf_loss": 287.6427917480469, "vf_explained_var": 0.5066369771957397, "kl": 0.037244394421577454, "entropy": 2.3069300651550293, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 540000, "episodes_total": 1086, "training_iteration": 27, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-30-43", "timestamp": 1567647043, "time_this_iter_s": 17.23949933052063, "time_total_s": 483.1632354259491, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c9e18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 483.1632354259491, "timesteps_since_restore": 540000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.191666666666666, "ram_util_percent": 14.229166666666666}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.56032399903864, "action_adversary": -288.56032399903864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5136309001514845, "mean_processing_ms": 2.449031111985324, "mean_inference_ms": 0.9290386814478666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 559104, "num_steps_sampled": 560000, "sample_time_ms": 12230.247, "load_time_ms": 35.198, "grad_time_ms": 4994.278, "update_time_ms": 8.174, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 284.8424072265625, "policy_loss": -0.012969858944416046, "vf_loss": 284.85516357421875, "vf_explained_var": 0.47082793712615967, "kl": 0.017776846885681152, "entropy": 31.059999465942383, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 285.9364013671875, "policy_loss": -0.0051637208089232445, "vf_loss": 285.9415588378906, "vf_explained_var": 0.49586084485054016, "kl": 0.01330866850912571, "entropy": 2.257110118865967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 560000, "episodes_total": 1126, "training_iteration": 28, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-31-00", "timestamp": 1567647060, "time_this_iter_s": 17.35697889328003, "time_total_s": 500.5202143192291, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d7b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 500.5202143192291, "timesteps_since_restore": 560000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.328000000000003, "ram_util_percent": 14.244000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 289.7925457454183, "action_adversary": -289.7925457454183}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5074079276052252, "mean_processing_ms": 2.4486780087886486, "mean_inference_ms": 0.9287789281416649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 579072, "num_steps_sampled": 580000, "sample_time_ms": 12226.44, "load_time_ms": 35.175, "grad_time_ms": 4992.992, "update_time_ms": 8.184, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 290.9813232421875, "policy_loss": -0.014136078767478466, "vf_loss": 290.9952392578125, "vf_explained_var": 0.5054426193237305, "kl": 0.018418073654174805, "entropy": 31.053403854370117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 291.73883056640625, "policy_loss": -0.002959191333502531, "vf_loss": 291.7417907714844, "vf_explained_var": 0.5114980936050415, "kl": 0.008510308340191841, "entropy": 2.236116886138916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 580000, "episodes_total": 1166, "training_iteration": 29, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-31-17", "timestamp": 1567647077, "time_this_iter_s": 17.247617959976196, "time_total_s": 517.7678322792053, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805f30d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 517.7678322792053, "timesteps_since_restore": 580000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.296, "ram_util_percent": 14.228}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 294.45345056088024, "action_adversary": -294.45345056088024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.5022275105170424, "mean_processing_ms": 2.4491809219427405, "mean_inference_ms": 0.9282768657763938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 599040, "num_steps_sampled": 600000, "sample_time_ms": 12261.38, "load_time_ms": 35.183, "grad_time_ms": 4992.369, "update_time_ms": 8.137, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 296.57122802734375, "policy_loss": -0.014084994792938232, "vf_loss": 296.5850524902344, "vf_explained_var": 0.45790305733680725, "kl": 0.020456520840525627, "entropy": 31.095565795898438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 297.75946044921875, "policy_loss": -0.0048374151811003685, "vf_loss": 297.7643127441406, "vf_explained_var": 0.47614431381225586, "kl": 0.016071034595370293, "entropy": 2.2086589336395264, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 600000, "episodes_total": 1207, "training_iteration": 30, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-31-35", "timestamp": 1567647095, "time_this_iter_s": 17.805150270462036, "time_total_s": 535.5729825496674, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2bb268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 535.5729825496674, "timesteps_since_restore": 600000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.283999999999995, "ram_util_percent": 14.260000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 297.8833728566195, "action_adversary": -297.8833728566195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4981763419859857, "mean_processing_ms": 2.4496549994536565, "mean_inference_ms": 0.92814012877805}, "off_policy_estimator": {}, "info": {"num_steps_trained": 619008, "num_steps_sampled": 620000, "sample_time_ms": 12327.69, "load_time_ms": 35.182, "grad_time_ms": 4992.43, "update_time_ms": 8.12, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 302.0797424316406, "policy_loss": -0.012740073725581169, "vf_loss": 302.0922546386719, "vf_explained_var": 0.4778542220592499, "kl": 0.018211906775832176, "entropy": 31.19375991821289, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 303.22479248046875, "policy_loss": -0.003410584758967161, "vf_loss": 303.2281799316406, "vf_explained_var": 0.49955183267593384, "kl": 0.012073871679604053, "entropy": 2.17230486869812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 620000, "episodes_total": 1247, "training_iteration": 31, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-31-53", "timestamp": 1567647113, "time_this_iter_s": 17.881393671035767, "time_total_s": 553.4543762207031, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2bbae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 553.4543762207031, "timesteps_since_restore": 620000, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.003846153846155, "ram_util_percent": 14.265384615384619}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 298.0222966078873, "action_adversary": -298.0222966078873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4944896062084503, "mean_processing_ms": 2.4496498605558283, "mean_inference_ms": 0.9280454952819254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 638976, "num_steps_sampled": 640000, "sample_time_ms": 12317.332, "load_time_ms": 35.29, "grad_time_ms": 4993.236, "update_time_ms": 8.127, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 302.4904479980469, "policy_loss": -0.014410624280571938, "vf_loss": 302.504638671875, "vf_explained_var": 0.4940676689147949, "kl": 0.018677707761526108, "entropy": 31.192920684814453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 303.66162109375, "policy_loss": -0.008322310633957386, "vf_loss": 303.6698913574219, "vf_explained_var": 0.5114431977272034, "kl": 0.042205773293972015, "entropy": 2.2213332653045654, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 640000, "episodes_total": 1286, "training_iteration": 32, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-32-10", "timestamp": 1567647130, "time_this_iter_s": 17.25112557411194, "time_total_s": 570.7055017948151, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a0c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 570.7055017948151, "timesteps_since_restore": 640000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 30.916666666666668, "ram_util_percent": 14.166666666666666}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 42, "policy_reward_mean": {"av": 295.11620663190615, "action_adversary": -295.11620663190615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4932093756468094, "mean_processing_ms": 2.4497583021638256, "mean_inference_ms": 0.9282394007626145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 658944, "num_steps_sampled": 660000, "sample_time_ms": 12394.069, "load_time_ms": 35.027, "grad_time_ms": 4991.477, "update_time_ms": 8.018, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 322.36822509765625, "policy_loss": -0.015467191115021706, "vf_loss": 322.38336181640625, "vf_explained_var": 0.5372839570045471, "kl": 0.02229987643659115, "entropy": 31.221284866333008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 323.7348937988281, "policy_loss": -0.006073892116546631, "vf_loss": 323.7409973144531, "vf_explained_var": 0.5470816493034363, "kl": 0.01660335436463356, "entropy": 2.1802821159362793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 660000, "episodes_total": 1328, "training_iteration": 33, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-32-28", "timestamp": 1567647148, "time_this_iter_s": 17.965262413024902, "time_total_s": 588.67076420784, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a2598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 588.67076420784, "timesteps_since_restore": 660000, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.66153846153846, "ram_util_percent": 14.226923076923079}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.40298573589985, "action_adversary": -292.40298573589985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4915260403882167, "mean_processing_ms": 2.450101915444362, "mean_inference_ms": 0.9283885634993916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 678912, "num_steps_sampled": 680000, "sample_time_ms": 12455.375, "load_time_ms": 34.952, "grad_time_ms": 4991.011, "update_time_ms": 7.75, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 317.6100769042969, "policy_loss": -0.013063397258520126, "vf_loss": 317.6229248046875, "vf_explained_var": 0.575333297252655, "kl": 0.017431754618883133, "entropy": 31.21160125732422, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 319.01678466796875, "policy_loss": -0.004341069608926773, "vf_loss": 319.0211181640625, "vf_explained_var": 0.5861021876335144, "kl": 0.012350399047136307, "entropy": 2.139268159866333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 680000, "episodes_total": 1368, "training_iteration": 34, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-32-46", "timestamp": 1567647166, "time_this_iter_s": 17.812615394592285, "time_total_s": 606.4833796024323, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28a730>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 606.4833796024323, "timesteps_since_restore": 680000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.031999999999996, "ram_util_percent": 14.276000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 296.72146755707786, "action_adversary": -296.72146755707786}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.488019881175571, "mean_processing_ms": 2.449932071201867, "mean_inference_ms": 0.9287979346262294}, "off_policy_estimator": {}, "info": {"num_steps_trained": 698880, "num_steps_sampled": 700000, "sample_time_ms": 12471.874, "load_time_ms": 34.962, "grad_time_ms": 4992.003, "update_time_ms": 7.762, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 313.4932861328125, "policy_loss": -0.013300932012498379, "vf_loss": 313.5063171386719, "vf_explained_var": 0.5907920002937317, "kl": 0.023339828476309776, "entropy": 31.207612991333008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 314.7359313964844, "policy_loss": -0.00335211050696671, "vf_loss": 314.73931884765625, "vf_explained_var": 0.5922731757164001, "kl": 0.013530080206692219, "entropy": 2.0976197719573975, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 700000, "episodes_total": 1407, "training_iteration": 35, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-33-04", "timestamp": 1567647184, "time_this_iter_s": 17.39927649497986, "time_total_s": 623.8826560974121, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d292048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 623.8826560974121, "timesteps_since_restore": 700000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.420000000000005, "ram_util_percent": 14.284000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 299.87816457435486, "action_adversary": -299.87816457435486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.487344616248891, "mean_processing_ms": 2.449416490044405, "mean_inference_ms": 0.9292163210965819}, "off_policy_estimator": {}, "info": {"num_steps_trained": 718848, "num_steps_sampled": 720000, "sample_time_ms": 12518.962, "load_time_ms": 34.407, "grad_time_ms": 4991.27, "update_time_ms": 7.787, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 319.6440734863281, "policy_loss": -0.013040435500442982, "vf_loss": 319.6568908691406, "vf_explained_var": 0.5962280035018921, "kl": 0.019310997799038887, "entropy": 31.218467712402344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 320.468505859375, "policy_loss": -0.0024577355943620205, "vf_loss": 320.4709167480469, "vf_explained_var": 0.6041447520256042, "kl": 0.010681894607841969, "entropy": 2.079921245574951, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 720000, "episodes_total": 1448, "training_iteration": 36, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-33-21", "timestamp": 1567647201, "time_this_iter_s": 17.72594928741455, "time_total_s": 641.6086053848267, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2991e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 641.6086053848267, "timesteps_since_restore": 720000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.991999999999997, "ram_util_percent": 14.292}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 301.4660183640354, "action_adversary": -301.4660183640354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4857504777707846, "mean_processing_ms": 2.4494993803739824, "mean_inference_ms": 0.9295668040859981}, "off_policy_estimator": {}, "info": {"num_steps_trained": 738816, "num_steps_sampled": 740000, "sample_time_ms": 12560.821, "load_time_ms": 34.446, "grad_time_ms": 4991.292, "update_time_ms": 7.777, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 317.90869140625, "policy_loss": -0.012535884976387024, "vf_loss": 317.92095947265625, "vf_explained_var": 0.5812854766845703, "kl": 0.018747171387076378, "entropy": 31.31954574584961, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 318.9328918457031, "policy_loss": -0.0036496627144515514, "vf_loss": 318.9365539550781, "vf_explained_var": 0.5872374176979065, "kl": 0.013288760557770729, "entropy": 2.0576727390289307, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 740000, "episodes_total": 1488, "training_iteration": 37, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-33-39", "timestamp": 1567647219, "time_this_iter_s": 17.6583309173584, "time_total_s": 659.2669363021851, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d299a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 659.2669363021851, "timesteps_since_restore": 740000, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.496153846153845, "ram_util_percent": 14.226923076923079}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 303.2279529879373, "action_adversary": -303.2279529879373}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4857848738027144, "mean_processing_ms": 2.449408343835164, "mean_inference_ms": 0.9304676832635227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758784, "num_steps_sampled": 760000, "sample_time_ms": 12561.744, "load_time_ms": 34.435, "grad_time_ms": 4991.237, "update_time_ms": 7.737, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 327.09381103515625, "policy_loss": -0.014073674567043781, "vf_loss": 327.107666015625, "vf_explained_var": 0.5800918936729431, "kl": 0.019599279388785362, "entropy": 31.266645431518555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 328.9527893066406, "policy_loss": -0.0039042471908032894, "vf_loss": 328.9566955566406, "vf_explained_var": 0.5898171663284302, "kl": 0.01836305484175682, "entropy": 2.051624298095703, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 760000, "episodes_total": 1528, "training_iteration": 38, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-33-56", "timestamp": 1567647236, "time_this_iter_s": 17.366015911102295, "time_total_s": 676.6329522132874, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288055ebf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 676.6329522132874, "timesteps_since_restore": 760000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.895833333333332, "ram_util_percent": 14.279166666666669}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 301.3306371546957, "action_adversary": -301.3306371546957}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.484000495204589, "mean_processing_ms": 2.449652943600106, "mean_inference_ms": 0.9312885611129025}, "off_policy_estimator": {}, "info": {"num_steps_trained": 778752, "num_steps_sampled": 780000, "sample_time_ms": 12606.807, "load_time_ms": 34.478, "grad_time_ms": 4992.004, "update_time_ms": 7.724, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 334.1294250488281, "policy_loss": -0.013001341372728348, "vf_loss": 334.1422119140625, "vf_explained_var": 0.5774414539337158, "kl": 0.017567463219165802, "entropy": 31.263484954833984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 336.10943603515625, "policy_loss": -0.003821813501417637, "vf_loss": 336.11322021484375, "vf_explained_var": 0.5874009728431702, "kl": 0.013997985981404781, "entropy": 2.054938554763794, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 780000, "episodes_total": 1569, "training_iteration": 39, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-34-14", "timestamp": 1567647254, "time_this_iter_s": 17.70583987236023, "time_total_s": 694.3387920856476, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 694.3387920856476, "timesteps_since_restore": 780000, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.746153846153845, "ram_util_percent": 14.234615384615385}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.14287421875076, "action_adversary": -300.14287421875076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4856930718295014, "mean_processing_ms": 2.4498664791001947, "mean_inference_ms": 0.9323799532630633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 798720, "num_steps_sampled": 800000, "sample_time_ms": 12606.504, "load_time_ms": 34.51, "grad_time_ms": 4992.302, "update_time_ms": 7.679, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 335.00787353515625, "policy_loss": -0.012462983839213848, "vf_loss": 335.0201416015625, "vf_explained_var": 0.6121273040771484, "kl": 0.016874097287654877, "entropy": 31.245380401611328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 337.0579833984375, "policy_loss": -0.005833871196955442, "vf_loss": 337.0638427734375, "vf_explained_var": 0.613003671169281, "kl": 0.038059625774621964, "entropy": 2.0993268489837646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 800000, "episodes_total": 1609, "training_iteration": 40, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-34-32", "timestamp": 1567647272, "time_this_iter_s": 17.806097269058228, "time_total_s": 712.1448893547058, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805536a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 712.1448893547058, "timesteps_since_restore": 800000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.068, "ram_util_percent": 14.292}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 289.18101929800304, "action_adversary": -289.18101929800304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4858655685821653, "mean_processing_ms": 2.4503068442335785, "mean_inference_ms": 0.9334214483356316}, "off_policy_estimator": {}, "info": {"num_steps_trained": 818688, "num_steps_sampled": 820000, "sample_time_ms": 12615.187, "load_time_ms": 34.555, "grad_time_ms": 4993.117, "update_time_ms": 7.641, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 337.1322326660156, "policy_loss": -0.013530373573303223, "vf_loss": 337.1455383300781, "vf_explained_var": 0.6472421288490295, "kl": 0.019424958154559135, "entropy": 31.173770904541016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 339.24566650390625, "policy_loss": -0.0025221884716302156, "vf_loss": 339.2481689453125, "vf_explained_var": 0.6534438729286194, "kl": 0.010548386722803116, "entropy": 2.0950963497161865, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 820000, "episodes_total": 1649, "training_iteration": 41, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-34-50", "timestamp": 1567647290, "time_this_iter_s": 17.977826595306396, "time_total_s": 730.1227159500122, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880553ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 730.1227159500122, "timesteps_since_restore": 820000, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.042307692307695, "ram_util_percent": 14.200000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 273.17507276943223, "action_adversary": -273.17507276943223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.485934891257739, "mean_processing_ms": 2.449997716913353, "mean_inference_ms": 0.934831423784681}, "off_policy_estimator": {}, "info": {"num_steps_trained": 838656, "num_steps_sampled": 840000, "sample_time_ms": 12696.516, "load_time_ms": 34.491, "grad_time_ms": 4993.246, "update_time_ms": 7.605, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 330.8446960449219, "policy_loss": -0.012915561906993389, "vf_loss": 330.85736083984375, "vf_explained_var": 0.6887485980987549, "kl": 0.017964230850338936, "entropy": 31.12412452697754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 331.3302917480469, "policy_loss": -0.002874378813430667, "vf_loss": 331.33319091796875, "vf_explained_var": 0.6909943222999573, "kl": 0.011763719841837883, "entropy": 2.0846662521362305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 840000, "episodes_total": 1689, "training_iteration": 42, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-35-08", "timestamp": 1567647308, "time_this_iter_s": 18.0642192363739, "time_total_s": 748.1869351863861, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b8158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 748.1869351863861, "timesteps_since_restore": 840000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.065384615384612, "ram_util_percent": 14.265384615384619}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 258.3248686468845, "action_adversary": -258.3248686468845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4863602111381975, "mean_processing_ms": 2.449784152304366, "mean_inference_ms": 0.9358780084893078}, "off_policy_estimator": {}, "info": {"num_steps_trained": 858624, "num_steps_sampled": 860000, "sample_time_ms": 12685.138, "load_time_ms": 34.812, "grad_time_ms": 4995.836, "update_time_ms": 7.644, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 337.29833984375, "policy_loss": -0.012212518602609634, "vf_loss": 337.310302734375, "vf_explained_var": 0.7079785466194153, "kl": 0.01613110490143299, "entropy": 31.09498405456543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 338.4395446777344, "policy_loss": -0.0042234924621880054, "vf_loss": 338.44378662109375, "vf_explained_var": 0.7141721844673157, "kl": 0.01182336825877428, "entropy": 2.059025287628174, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 860000, "episodes_total": 1729, "training_iteration": 43, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-35-26", "timestamp": 1567647326, "time_this_iter_s": 17.881730794906616, "time_total_s": 766.0686659812927, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b89d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 766.0686659812927, "timesteps_since_restore": 860000, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.548000000000002, "ram_util_percent": 14.296000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 256.4873334553939, "action_adversary": -256.4873334553939}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4866513690801697, "mean_processing_ms": 2.4495854137171036, "mean_inference_ms": 0.9368656152751533}, "off_policy_estimator": {}, "info": {"num_steps_trained": 878592, "num_steps_sampled": 880000, "sample_time_ms": 12706.332, "load_time_ms": 34.795, "grad_time_ms": 4996.612, "update_time_ms": 7.639, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 318.36016845703125, "policy_loss": -0.013254891149699688, "vf_loss": 318.3731994628906, "vf_explained_var": 0.7138845324516296, "kl": 0.016165433451533318, "entropy": 31.062314987182617, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 319.3533020019531, "policy_loss": -0.0029705739580094814, "vf_loss": 319.35626220703125, "vf_explained_var": 0.7168429493904114, "kl": 0.013675836846232414, "entropy": 2.0062291622161865, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 880000, "episodes_total": 1769, "training_iteration": 44, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-35-44", "timestamp": 1567647344, "time_this_iter_s": 18.03303098678589, "time_total_s": 784.1016969680786, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d21fb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 784.1016969680786, "timesteps_since_restore": 880000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 29.988461538461536, "ram_util_percent": 14.203846153846156}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 265.4612957633724, "action_adversary": -265.4612957633724}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.485065087224393, "mean_processing_ms": 2.4491367326414006, "mean_inference_ms": 0.9377144990736701}, "off_policy_estimator": {}, "info": {"num_steps_trained": 898560, "num_steps_sampled": 900000, "sample_time_ms": 12721.902, "load_time_ms": 34.81, "grad_time_ms": 4996.863, "update_time_ms": 7.603, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 316.4417419433594, "policy_loss": -0.014297125861048698, "vf_loss": 316.4558410644531, "vf_explained_var": 0.7153397798538208, "kl": 0.017906326800584793, "entropy": 31.110557556152344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 317.5401916503906, "policy_loss": -0.0023648273199796677, "vf_loss": 317.5425109863281, "vf_explained_var": 0.714878499507904, "kl": 0.016184119507670403, "entropy": 2.0122947692871094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 900000, "episodes_total": 1808, "training_iteration": 45, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-36-02", "timestamp": 1567647362, "time_this_iter_s": 17.55844736099243, "time_total_s": 801.660144329071, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d230488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 801.660144329071, "timesteps_since_restore": 900000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.748, "ram_util_percent": 14.300000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 262.6795022741428, "action_adversary": -262.6795022741428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4845197297516695, "mean_processing_ms": 2.448952060988436, "mean_inference_ms": 0.9386612655764007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 918528, "num_steps_sampled": 920000, "sample_time_ms": 12715.411, "load_time_ms": 34.509, "grad_time_ms": 4997.719, "update_time_ms": 7.577, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 347.7386169433594, "policy_loss": -0.013652928173542023, "vf_loss": 347.7521057128906, "vf_explained_var": 0.7340004444122314, "kl": 0.015328723937273026, "entropy": 31.071407318115234, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 349.72467041015625, "policy_loss": -0.004000769928097725, "vf_loss": 349.7286682128906, "vf_explained_var": 0.7329292297363281, "kl": 0.014057527296245098, "entropy": 2.005382537841797, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 920000, "episodes_total": 1849, "training_iteration": 46, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-36-19", "timestamp": 1567647379, "time_this_iter_s": 17.665416717529297, "time_total_s": 819.3255610466003, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d239620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 819.3255610466003, "timesteps_since_restore": 920000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.951999999999998, "ram_util_percent": 14.240000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 256.52615516734886, "action_adversary": -256.52615516734886}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4853833867209145, "mean_processing_ms": 2.44900292543809, "mean_inference_ms": 0.9397335675117031}, "off_policy_estimator": {}, "info": {"num_steps_trained": 938496, "num_steps_sampled": 940000, "sample_time_ms": 12770.486, "load_time_ms": 34.45, "grad_time_ms": 4997.256, "update_time_ms": 7.551, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 372.7337341308594, "policy_loss": -0.014749438501894474, "vf_loss": 372.7482604980469, "vf_explained_var": 0.7572017312049866, "kl": 0.01837013103067875, "entropy": 31.101806640625, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 374.4550476074219, "policy_loss": -0.0032985107973217964, "vf_loss": 374.4583435058594, "vf_explained_var": 0.7503337264060974, "kl": 0.010407843627035618, "entropy": 1.9832763671875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 940000, "episodes_total": 1889, "training_iteration": 47, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-36-37", "timestamp": 1567647397, "time_this_iter_s": 18.20547842979431, "time_total_s": 837.5310394763947, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d239ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 837.5310394763947, "timesteps_since_restore": 940000, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.73076923076923, "ram_util_percent": 14.261538461538462}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 256.3752340340569, "action_adversary": -256.3752340340569}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.489251829396827, "mean_processing_ms": 2.4489227965230254, "mean_inference_ms": 0.9410183308148676}, "off_policy_estimator": {}, "info": {"num_steps_trained": 958464, "num_steps_sampled": 960000, "sample_time_ms": 12863.262, "load_time_ms": 34.445, "grad_time_ms": 4997.445, "update_time_ms": 7.807, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 364.78021240234375, "policy_loss": -0.01336404588073492, "vf_loss": 364.7933654785156, "vf_explained_var": 0.7711390256881714, "kl": 0.017099419608712196, "entropy": 30.990449905395508, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 366.9075012207031, "policy_loss": -0.0028476305305957794, "vf_loss": 366.9103698730469, "vf_explained_var": 0.7789098024368286, "kl": 0.012270706705749035, "entropy": 1.9500824213027954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 960000, "episodes_total": 1929, "training_iteration": 48, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-36-56", "timestamp": 1567647416, "time_this_iter_s": 18.297499418258667, "time_total_s": 855.8285388946533, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2550d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 855.8285388946533, "timesteps_since_restore": 960000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.45384615384615, "ram_util_percent": 14.215384615384616}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 265.0725781244399, "action_adversary": -265.0725781244399}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4879572545076725, "mean_processing_ms": 2.4485698082221807, "mean_inference_ms": 0.9421472220688617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978432, "num_steps_sampled": 980000, "sample_time_ms": 12861.242, "load_time_ms": 34.094, "grad_time_ms": 4997.92, "update_time_ms": 7.818, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 345.1796875, "policy_loss": -0.013314208947122097, "vf_loss": 345.19281005859375, "vf_explained_var": 0.779394268989563, "kl": 0.01614530012011528, "entropy": 30.93416976928711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 347.4840393066406, "policy_loss": -0.0029141558334231377, "vf_loss": 347.4869689941406, "vf_explained_var": 0.7856114506721497, "kl": 0.014760365709662437, "entropy": 1.9184362888336182, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 980000, "episodes_total": 1968, "training_iteration": 49, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-37-13", "timestamp": 1567647433, "time_this_iter_s": 17.686999797821045, "time_total_s": 873.5155386924744, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d21f950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 873.5155386924744, "timesteps_since_restore": 980000, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 31.331999999999997, "ram_util_percent": 14.267999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 270.8843339489672, "action_adversary": -270.8843339489672}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.488100092911823, "mean_processing_ms": 2.448524931757185, "mean_inference_ms": 0.9429559654157762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 998400, "num_steps_sampled": 1000000, "sample_time_ms": 12852.235, "load_time_ms": 34.076, "grad_time_ms": 4996.673, "update_time_ms": 7.818, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 358.9892272949219, "policy_loss": -0.01403854601085186, "vf_loss": 359.0030517578125, "vf_explained_var": 0.7732730507850647, "kl": 0.01811402104794979, "entropy": 30.987110137939453, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 361.02911376953125, "policy_loss": -0.0047157262451946735, "vf_loss": 361.0338439941406, "vf_explained_var": 0.7743015885353088, "kl": 0.031027628108859062, "entropy": 1.9433209896087646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1000000, "episodes_total": 2009, "training_iteration": 50, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-37-31", "timestamp": 1567647451, "time_this_iter_s": 17.70313334465027, "time_total_s": 891.2186720371246, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b8268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 891.2186720371246, "timesteps_since_restore": 1000000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.523076923076925, "ram_util_percent": 14.303846153846157}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 273.85639259747046, "action_adversary": -273.85639259747046}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4886245364484725, "mean_processing_ms": 2.448676451286441, "mean_inference_ms": 0.9440207479263872}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1018368, "num_steps_sampled": 1020000, "sample_time_ms": 12821.39, "load_time_ms": 34.08, "grad_time_ms": 4997.343, "update_time_ms": 7.885, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 354.8111267089844, "policy_loss": -0.01363573782145977, "vf_loss": 354.8245544433594, "vf_explained_var": 0.7750267386436462, "kl": 0.016842080280184746, "entropy": 30.96011734008789, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 357.22052001953125, "policy_loss": -0.0005647259531542659, "vf_loss": 357.2210388183594, "vf_explained_var": 0.7787719964981079, "kl": 0.015197863802313805, "entropy": 1.9332910776138306, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1020000, "episodes_total": 2049, "training_iteration": 51, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-37-49", "timestamp": 1567647469, "time_this_iter_s": 17.67616367340088, "time_total_s": 908.8948357105255, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 908.8948357105255, "timesteps_since_restore": 1020000, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 32.248000000000005, "ram_util_percent": 14.276000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 277.61986847978847, "action_adversary": -277.61986847978847}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4909882351124013, "mean_processing_ms": 2.4486028051726607, "mean_inference_ms": 0.9452786758919842}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1038336, "num_steps_sampled": 1040000, "sample_time_ms": 12769.694, "load_time_ms": 34.115, "grad_time_ms": 4999.494, "update_time_ms": 7.809, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 526.7774658203125, "policy_loss": -0.012975912541151047, "vf_loss": 526.7901611328125, "vf_explained_var": 0.6987136602401733, "kl": 0.01792794093489647, "entropy": 30.818466186523438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 538.0850219726562, "policy_loss": -0.0029456440825015306, "vf_loss": 538.0879516601562, "vf_explained_var": 0.7054141163825989, "kl": 0.016076182946562767, "entropy": 1.9585903882980347, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1040000, "episodes_total": 2089, "training_iteration": 52, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-38-06", "timestamp": 1567647486, "time_this_iter_s": 17.569333791732788, "time_total_s": 926.4641695022583, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2391e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 926.4641695022583, "timesteps_since_restore": 1040000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.104000000000006, "ram_util_percent": 14.315999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 274.9962650316195, "action_adversary": -274.9962650316195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.490292449798689, "mean_processing_ms": 2.4487715590824304, "mean_inference_ms": 0.9464215306955742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1058304, "num_steps_sampled": 1060000, "sample_time_ms": 12738.505, "load_time_ms": 34.099, "grad_time_ms": 4998.44, "update_time_ms": 7.818, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 509.8369445800781, "policy_loss": -0.013120623305439949, "vf_loss": 509.849853515625, "vf_explained_var": 0.7262426018714905, "kl": 0.01638529635965824, "entropy": 30.77823829650879, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 517.855224609375, "policy_loss": -0.0015521473251283169, "vf_loss": 517.8567504882812, "vf_explained_var": 0.7243912816047668, "kl": 0.014761731028556824, "entropy": 1.9584161043167114, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1060000, "episodes_total": 2129, "training_iteration": 53, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-38-24", "timestamp": 1567647504, "time_this_iter_s": 17.55838656425476, "time_total_s": 944.0225560665131, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d9d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 944.0225560665131, "timesteps_since_restore": 1060000, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.844, "ram_util_percent": 14.220000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 271.78327448203765, "action_adversary": -271.78327448203765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4888850217645326, "mean_processing_ms": 2.4486806456844805, "mean_inference_ms": 0.9474412018871416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1078272, "num_steps_sampled": 1080000, "sample_time_ms": 12685.694, "load_time_ms": 34.248, "grad_time_ms": 5001.438, "update_time_ms": 7.814, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 502.2718200683594, "policy_loss": -0.011688735336065292, "vf_loss": 502.2833557128906, "vf_explained_var": 0.7433031797409058, "kl": 0.014584438875317574, "entropy": 30.785306930541992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 511.3996276855469, "policy_loss": -0.0013681543059647083, "vf_loss": 511.4010314941406, "vf_explained_var": 0.7401604056358337, "kl": 0.012700913473963737, "entropy": 1.937355637550354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1080000, "episodes_total": 2169, "training_iteration": 54, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-38-42", "timestamp": 1567647522, "time_this_iter_s": 17.536335945129395, "time_total_s": 961.5588920116425, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d27e158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 961.5588920116425, "timesteps_since_restore": 1080000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.984, "ram_util_percent": 14.34}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 271.54542980420746, "action_adversary": -271.54542980420746}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4875014072008117, "mean_processing_ms": 2.448580581478235, "mean_inference_ms": 0.9483665067835484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1098240, "num_steps_sampled": 1100000, "sample_time_ms": 12677.333, "load_time_ms": 34.222, "grad_time_ms": 4999.669, "update_time_ms": 7.835, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 480.2891540527344, "policy_loss": -0.010582780465483665, "vf_loss": 480.2995910644531, "vf_explained_var": 0.7470259070396423, "kl": 0.01480460911989212, "entropy": 30.78559112548828, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 490.81170654296875, "policy_loss": -0.00042849263991229236, "vf_loss": 490.8121032714844, "vf_explained_var": 0.7454931735992432, "kl": 0.015488081611692905, "entropy": 1.9105466604232788, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1100000, "episodes_total": 2209, "training_iteration": 55, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-38-59", "timestamp": 1567647539, "time_this_iter_s": 17.45538091659546, "time_total_s": 979.0142729282379, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805ff7b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 979.0142729282379, "timesteps_since_restore": 1100000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 30.712, "ram_util_percent": 14.247999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 276.9601392776769, "action_adversary": -276.9601392776769}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48604076127347, "mean_processing_ms": 2.448512241782949, "mean_inference_ms": 0.949212785494438}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118208, "num_steps_sampled": 1120000, "sample_time_ms": 12668.481, "load_time_ms": 34.569, "grad_time_ms": 4997.838, "update_time_ms": 7.892, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 478.3594665527344, "policy_loss": -0.011738426052033901, "vf_loss": 478.3708801269531, "vf_explained_var": 0.7364094853401184, "kl": 0.017618676647543907, "entropy": 30.761117935180664, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 487.5299377441406, "policy_loss": -0.00039070486673153937, "vf_loss": 487.5303039550781, "vf_explained_var": 0.7332772016525269, "kl": 0.013824188150465488, "entropy": 1.9124603271484375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1120000, "episodes_total": 2249, "training_iteration": 56, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-39-17", "timestamp": 1567647557, "time_this_iter_s": 17.562385082244873, "time_total_s": 996.5766580104828, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805ddea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 996.5766580104828, "timesteps_since_restore": 1120000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.783999999999995, "ram_util_percent": 14.356}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 278.4067786931486, "action_adversary": -278.4067786931486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4805053234734045, "mean_processing_ms": 2.448234405829295, "mean_inference_ms": 0.9500287161788242}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1138176, "num_steps_sampled": 1140000, "sample_time_ms": 12599.846, "load_time_ms": 34.543, "grad_time_ms": 4997.761, "update_time_ms": 7.906, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 455.9660339355469, "policy_loss": -0.011598406359553337, "vf_loss": 455.97747802734375, "vf_explained_var": 0.7266572713851929, "kl": 0.016848064959049225, "entropy": 30.735708236694336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 467.2984924316406, "policy_loss": -0.0005879971431568265, "vf_loss": 467.2990417480469, "vf_explained_var": 0.7243326306343079, "kl": 0.014209895394742489, "entropy": 1.8935065269470215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1140000, "episodes_total": 2288, "training_iteration": 57, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-39-34", "timestamp": 1567647574, "time_this_iter_s": 17.518033504486084, "time_total_s": 1014.0946915149689, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805c3f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1014.0946915149689, "timesteps_since_restore": 1140000, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 30.827999999999996, "ram_util_percent": 14.292}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 278.53423871569373, "action_adversary": -278.53423871569373}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.478674481945303, "mean_processing_ms": 2.447818082997264, "mean_inference_ms": 0.9506036412282401}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1158144, "num_steps_sampled": 1160000, "sample_time_ms": 12514.61, "load_time_ms": 34.603, "grad_time_ms": 4998.777, "update_time_ms": 7.644, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 461.2555236816406, "policy_loss": -0.010826820507645607, "vf_loss": 461.26611328125, "vf_explained_var": 0.7058744430541992, "kl": 0.017981354147195816, "entropy": 30.69190788269043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 472.6977233886719, "policy_loss": 0.00038840630440972745, "vf_loss": 472.69732666015625, "vf_explained_var": 0.7041440010070801, "kl": 0.011474519036710262, "entropy": 1.860443115234375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1160000, "episodes_total": 2328, "training_iteration": 58, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-39-52", "timestamp": 1567647592, "time_this_iter_s": 17.453896284103394, "time_total_s": 1031.5485877990723, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c3378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1031.5485877990723, "timesteps_since_restore": 1160000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.128, "ram_util_percent": 14.296}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 280.24288442071776, "action_adversary": -280.24288442071776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4808673599844635, "mean_processing_ms": 2.447948350041471, "mean_inference_ms": 0.9507558650347322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1178112, "num_steps_sampled": 1180000, "sample_time_ms": 12510.17, "load_time_ms": 34.904, "grad_time_ms": 4998.489, "update_time_ms": 7.619, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 465.3447570800781, "policy_loss": -0.013675205409526825, "vf_loss": 465.3582763671875, "vf_explained_var": 0.6916748285293579, "kl": 0.017519578337669373, "entropy": 30.662006378173828, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 475.9229736328125, "policy_loss": -0.000996666494756937, "vf_loss": 475.9239807128906, "vf_explained_var": 0.688177764415741, "kl": 0.018388837575912476, "entropy": 1.829669713973999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1180000, "episodes_total": 2369, "training_iteration": 59, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-40-09", "timestamp": 1567647609, "time_this_iter_s": 17.64423966407776, "time_total_s": 1049.19282746315, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d255ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1049.19282746315, "timesteps_since_restore": 1180000, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 30.04, "ram_util_percent": 14.328}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 280.3022689360047, "action_adversary": -280.3022689360047}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.479099262096942, "mean_processing_ms": 2.4483146142234467, "mean_inference_ms": 0.9511425170430594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1198080, "num_steps_sampled": 1200000, "sample_time_ms": 12492.775, "load_time_ms": 34.924, "grad_time_ms": 4999.837, "update_time_ms": 7.693, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 459.2442932128906, "policy_loss": -0.012396465986967087, "vf_loss": 459.25640869140625, "vf_explained_var": 0.6776838302612305, "kl": 0.016513636335730553, "entropy": 30.744604110717773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 470.2986145019531, "policy_loss": 9.45311039686203e-05, "vf_loss": 470.29852294921875, "vf_explained_var": 0.683521568775177, "kl": 0.01573849655687809, "entropy": 1.826138973236084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1200000, "episodes_total": 2409, "training_iteration": 60, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-40-27", "timestamp": 1567647627, "time_this_iter_s": 17.542246103286743, "time_total_s": 1066.7350735664368, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288055e7b8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1066.7350735664368, "timesteps_since_restore": 1200000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.848000000000003, "ram_util_percent": 14.372}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 279.29324714563523, "action_adversary": -279.29324714563523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.477633415033237, "mean_processing_ms": 2.448382294352229, "mean_inference_ms": 0.9520329853830557}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1218048, "num_steps_sampled": 1220000, "sample_time_ms": 12471.349, "load_time_ms": 34.593, "grad_time_ms": 4998.644, "update_time_ms": 7.673, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 457.26220703125, "policy_loss": -0.011227123439311981, "vf_loss": 457.2732238769531, "vf_explained_var": 0.6720873713493347, "kl": 0.01647796668112278, "entropy": 30.68787956237793, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 467.60076904296875, "policy_loss": 0.0022337567061185837, "vf_loss": 467.59857177734375, "vf_explained_var": 0.6820265054702759, "kl": 0.02105456218123436, "entropy": 1.825577974319458, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1220000, "episodes_total": 2449, "training_iteration": 61, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-40-44", "timestamp": 1567647644, "time_this_iter_s": 17.44688129425049, "time_total_s": 1084.1819548606873, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805f38c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1084.1819548606873, "timesteps_since_restore": 1220000, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.124000000000002, "ram_util_percent": 14.312000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 271.53811021645345, "action_adversary": -271.53811021645345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4769440363967634, "mean_processing_ms": 2.448310854698656, "mean_inference_ms": 0.952748053072516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1238016, "num_steps_sampled": 1240000, "sample_time_ms": 12484.144, "load_time_ms": 34.58, "grad_time_ms": 4997.032, "update_time_ms": 7.705, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 435.9447021484375, "policy_loss": -0.012634225189685822, "vf_loss": 435.9571228027344, "vf_explained_var": 0.6683314442634583, "kl": 0.016027066856622696, "entropy": 30.77692985534668, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 439.0588073730469, "policy_loss": 0.004038420971482992, "vf_loss": 439.0546875, "vf_explained_var": 0.6822627782821655, "kl": 0.023228049278259277, "entropy": 1.7956061363220215, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1240000, "episodes_total": 2489, "training_iteration": 62, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-41-02", "timestamp": 1567647662, "time_this_iter_s": 17.680213451385498, "time_total_s": 1101.8621683120728, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805f3c80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1101.8621683120728, "timesteps_since_restore": 1240000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 30.787999999999997, "ram_util_percent": 14.303999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 267.6847441323217, "action_adversary": -267.6847441323217}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4732430710375435, "mean_processing_ms": 2.448320547204079, "mean_inference_ms": 0.953144528659455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1257984, "num_steps_sampled": 1260000, "sample_time_ms": 12488.772, "load_time_ms": 34.493, "grad_time_ms": 4996.422, "update_time_ms": 7.7, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 431.67657470703125, "policy_loss": -0.012932169251143932, "vf_loss": 431.6893005371094, "vf_explained_var": 0.6849510073661804, "kl": 0.017019696533679962, "entropy": 30.747846603393555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 433.6466369628906, "policy_loss": 0.0015743175754323602, "vf_loss": 433.6451416015625, "vf_explained_var": 0.6966777443885803, "kl": 0.02095966413617134, "entropy": 1.759397029876709, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1260000, "episodes_total": 2529, "training_iteration": 63, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-41-20", "timestamp": 1567647680, "time_this_iter_s": 17.596840858459473, "time_total_s": 1119.4590091705322, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2b4f28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1119.4590091705322, "timesteps_since_restore": 1260000, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.04, "ram_util_percent": 14.371999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 257.04177081216477, "action_adversary": -257.04177081216477}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473600390944859, "mean_processing_ms": 2.4482411177537355, "mean_inference_ms": 0.953781987544252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1277952, "num_steps_sampled": 1280000, "sample_time_ms": 12499.63, "load_time_ms": 34.391, "grad_time_ms": 4993.715, "update_time_ms": 7.748, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 440.19219970703125, "policy_loss": -0.012818084098398685, "vf_loss": 440.2047424316406, "vf_explained_var": 0.7055612802505493, "kl": 0.018853221088647842, "entropy": 30.727432250976562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 441.49859619140625, "policy_loss": 0.0011270296527072787, "vf_loss": 441.49755859375, "vf_explained_var": 0.7148997187614441, "kl": 0.021357102319598198, "entropy": 1.7498126029968262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1280000, "episodes_total": 2569, "training_iteration": 64, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-41-37", "timestamp": 1567647697, "time_this_iter_s": 17.618001699447632, "time_total_s": 1137.0770108699799, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d290158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1137.0770108699799, "timesteps_since_restore": 1280000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.776, "ram_util_percent": 14.267999999999997}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 39, "policy_reward_mean": {"av": 255.60696700582736, "action_adversary": -255.60696700582736}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4731080836897603, "mean_processing_ms": 2.447847212752493, "mean_inference_ms": 0.9544442210313381}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1297920, "num_steps_sampled": 1300000, "sample_time_ms": 12512.465, "load_time_ms": 34.386, "grad_time_ms": 4994.457, "update_time_ms": 7.756, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 443.7470397949219, "policy_loss": -0.011899900622665882, "vf_loss": 443.7588195800781, "vf_explained_var": 0.7276067733764648, "kl": 0.016966339200735092, "entropy": 30.69514274597168, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 446.0899963378906, "policy_loss": 0.002975812181830406, "vf_loss": 446.0870361328125, "vf_explained_var": 0.7412106394767761, "kl": 0.02863764762878418, "entropy": 1.7322112321853638, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1300000, "episodes_total": 2608, "training_iteration": 65, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-41-55", "timestamp": 1567647715, "time_this_iter_s": 17.59302306175232, "time_total_s": 1154.6700339317322, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2909d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1154.6700339317322, "timesteps_since_restore": 1300000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.111538461538455, "ram_util_percent": 14.33076923076923}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 253.75590485015783, "action_adversary": -253.75590485015783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473745640922275, "mean_processing_ms": 2.4476358004159025, "mean_inference_ms": 0.9549877209099016}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1317888, "num_steps_sampled": 1320000, "sample_time_ms": 12519.433, "load_time_ms": 34.365, "grad_time_ms": 4996.58, "update_time_ms": 7.741, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 470.6371154785156, "policy_loss": -0.011995396576821804, "vf_loss": 470.64892578125, "vf_explained_var": 0.7385745644569397, "kl": 0.015603875741362572, "entropy": 30.701297760009766, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 473.5099792480469, "policy_loss": 0.002141915261745453, "vf_loss": 473.5078125, "vf_explained_var": 0.7485655546188354, "kl": 0.01902102306485176, "entropy": 1.7262835502624512, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1320000, "episodes_total": 2649, "training_iteration": 66, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-42-13", "timestamp": 1567647733, "time_this_iter_s": 17.653443336486816, "time_total_s": 1172.323477268219, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a2b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1172.323477268219, "timesteps_since_restore": 1320000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.752000000000002, "ram_util_percent": 14.38}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 498.76, "episodes_this_iter": 40, "policy_reward_mean": {"av": 251.29461442745404, "action_adversary": -251.29461442745404}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473941750488631, "mean_processing_ms": 2.447644857390427, "mean_inference_ms": 0.95546371446456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1337856, "num_steps_sampled": 1340000, "sample_time_ms": 12526.012, "load_time_ms": 34.616, "grad_time_ms": 4997.591, "update_time_ms": 7.69, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 475.3231201171875, "policy_loss": -0.012109728530049324, "vf_loss": 475.3349304199219, "vf_explained_var": 0.7690801024436951, "kl": 0.01706848479807377, "entropy": 30.693941116333008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 478.43017578125, "policy_loss": -8.687300578458235e-05, "vf_loss": 478.43023681640625, "vf_explained_var": 0.7735453248023987, "kl": 0.026117892935872078, "entropy": 1.6931653022766113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1340000, "episodes_total": 2689, "training_iteration": 67, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-42-30", "timestamp": 1567647750, "time_this_iter_s": 17.59593963623047, "time_total_s": 1189.9194169044495, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806e9488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1189.9194169044495, "timesteps_since_restore": 1340000, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 31.744, "ram_util_percent": 14.335999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 498.76, "episodes_this_iter": 39, "policy_reward_mean": {"av": 256.27118055249355, "action_adversary": -256.27118055249355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4738360047110435, "mean_processing_ms": 2.4475980368547985, "mean_inference_ms": 0.9558115143908283}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1357824, "num_steps_sampled": 1360000, "sample_time_ms": 12528.765, "load_time_ms": 34.576, "grad_time_ms": 4996.301, "update_time_ms": 7.67, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 451.3229675292969, "policy_loss": -0.012499289587140083, "vf_loss": 451.3352355957031, "vf_explained_var": 0.7780398726463318, "kl": 0.01631169207394123, "entropy": 30.65181541442871, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 454.3884582519531, "policy_loss": 0.0055339583195745945, "vf_loss": 454.3829040527344, "vf_explained_var": 0.7818203568458557, "kl": 0.028441062197089195, "entropy": 1.6710474491119385, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1360000, "episodes_total": 2728, "training_iteration": 68, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-42-48", "timestamp": 1567647768, "time_this_iter_s": 17.467251539230347, "time_total_s": 1207.3866684436798, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d4620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1207.3866684436798, "timesteps_since_restore": 1360000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.412000000000003, "ram_util_percent": 14.311999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 261.3213265350052, "action_adversary": -261.3213265350052}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4739467241201614, "mean_processing_ms": 2.4476130508011664, "mean_inference_ms": 0.9558923092805978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377792, "num_steps_sampled": 1380000, "sample_time_ms": 12532.812, "load_time_ms": 34.555, "grad_time_ms": 4995.879, "update_time_ms": 7.677, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 486.0366516113281, "policy_loss": -0.010483630001544952, "vf_loss": 486.0469665527344, "vf_explained_var": 0.7709298729896545, "kl": 0.014055897481739521, "entropy": 30.617515563964844, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 489.43548583984375, "policy_loss": 0.0024446863681077957, "vf_loss": 489.43310546875, "vf_explained_var": 0.7783090472221375, "kl": 0.02728940360248089, "entropy": 1.6902035474777222, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1380000, "episodes_total": 2769, "training_iteration": 69, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-43-05", "timestamp": 1567647785, "time_this_iter_s": 17.680503606796265, "time_total_s": 1225.067172050476, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d4ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1225.067172050476, "timesteps_since_restore": 1380000, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.572, "ram_util_percent": 14.392000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 497.45, "episodes_this_iter": 40, "policy_reward_mean": {"av": 256.07841719332436, "action_adversary": -256.07841719332436}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4740398334056435, "mean_processing_ms": 2.447727801599841, "mean_inference_ms": 0.9562005109900876}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1397760, "num_steps_sampled": 1400000, "sample_time_ms": 12586.899, "load_time_ms": 34.608, "grad_time_ms": 4995.137, "update_time_ms": 7.68, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 487.3869323730469, "policy_loss": -0.01039031706750393, "vf_loss": 487.3971252441406, "vf_explained_var": 0.7762323021888733, "kl": 0.015044502913951874, "entropy": 30.617115020751953, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 492.7577209472656, "policy_loss": 0.0038072573952376842, "vf_loss": 492.75384521484375, "vf_explained_var": 0.7835760116577148, "kl": 0.026893015950918198, "entropy": 1.659783959388733, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1400000, "episodes_total": 2809, "training_iteration": 70, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-43-23", "timestamp": 1567647803, "time_this_iter_s": 18.077502965927124, "time_total_s": 1243.1446750164032, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d25c0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1243.1446750164032, "timesteps_since_restore": 1400000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 30.78076923076923, "ram_util_percent": 14.288461538461537}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 497.45, "episodes_this_iter": 40, "policy_reward_mean": {"av": 257.02125267760783, "action_adversary": -257.02125267760783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473948984858575, "mean_processing_ms": 2.447870650893944, "mean_inference_ms": 0.9564857060409162}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1417728, "num_steps_sampled": 1420000, "sample_time_ms": 12606.505, "load_time_ms": 34.895, "grad_time_ms": 4995.767, "update_time_ms": 7.659, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 483.7200012207031, "policy_loss": -0.012066046707332134, "vf_loss": 483.7318115234375, "vf_explained_var": 0.7920878529548645, "kl": 0.017027417197823524, "entropy": 30.54360008239746, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 489.177490234375, "policy_loss": 0.003313668305054307, "vf_loss": 489.174072265625, "vf_explained_var": 0.7964239120483398, "kl": 0.022868743166327477, "entropy": 1.6718703508377075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1420000, "episodes_total": 2849, "training_iteration": 71, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-43-41", "timestamp": 1567647821, "time_this_iter_s": 17.650667190551758, "time_total_s": 1260.795342206955, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d25c950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1260.795342206955, "timesteps_since_restore": 1420000, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 14.283999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 260.20226662031996, "action_adversary": -260.20226662031996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.474021143814149, "mean_processing_ms": 2.447827196961079, "mean_inference_ms": 0.956750763256956}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1437696, "num_steps_sampled": 1440000, "sample_time_ms": 12583.019, "load_time_ms": 34.872, "grad_time_ms": 4996.7, "update_time_ms": 7.723, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 485.5866394042969, "policy_loss": -0.010846099816262722, "vf_loss": 485.5972595214844, "vf_explained_var": 0.7959604859352112, "kl": 0.016334664076566696, "entropy": 30.5100154876709, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 7.324219041038305e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 491.3435363769531, "policy_loss": 0.013278231024742126, "vf_loss": 491.330322265625, "vf_explained_var": 0.8016001582145691, "kl": 0.06034677475690842, "entropy": 1.635315179824829, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1440000, "episodes_total": 2889, "training_iteration": 72, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-43-59", "timestamp": 1567647839, "time_this_iter_s": 17.457365036010742, "time_total_s": 1278.2527072429657, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1e8ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1278.2527072429657, "timesteps_since_restore": 1440000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 31.092000000000002, "ram_util_percent": 14.392000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 41, "policy_reward_mean": {"av": 260.41499819346285, "action_adversary": -260.41499819346285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4738770088838122, "mean_processing_ms": 2.4479619255788476, "mean_inference_ms": 0.9571476273503197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1457664, "num_steps_sampled": 1460000, "sample_time_ms": 12577.59, "load_time_ms": 34.924, "grad_time_ms": 4996.304, "update_time_ms": 7.828, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 511.59661865234375, "policy_loss": -0.010770994238555431, "vf_loss": 511.607177734375, "vf_explained_var": 0.7987443208694458, "kl": 0.014588560909032822, "entropy": 30.455171585083008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00010986327833961695, "cur_lr": 4.999999873689376e-05, "total_loss": 517.3784790039062, "policy_loss": 0.005606601480394602, "vf_loss": 517.3729248046875, "vf_explained_var": 0.7982431650161743, "kl": 0.04020212963223457, "entropy": 1.6249605417251587, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1460000, "episodes_total": 2930, "training_iteration": 73, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-44-16", "timestamp": 1567647856, "time_this_iter_s": 17.540445566177368, "time_total_s": 1295.793152809143, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1f8400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1295.793152809143, "timesteps_since_restore": 1460000, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.1, "ram_util_percent": 14.324000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 256.0215726874758, "action_adversary": -256.0215726874758}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4779844588560547, "mean_processing_ms": 2.4481331671443036, "mean_inference_ms": 0.9574370164462944}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477632, "num_steps_sampled": 1480000, "sample_time_ms": 12597.281, "load_time_ms": 34.921, "grad_time_ms": 4996.447, "update_time_ms": 8.043, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 514.0171508789062, "policy_loss": -0.010182180441915989, "vf_loss": 514.0271606445312, "vf_explained_var": 0.8067072629928589, "kl": 0.014749078080058098, "entropy": 30.409273147583008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 4.999999873689376e-05, "total_loss": 523.0701293945312, "policy_loss": 0.003036071779206395, "vf_loss": 523.0670166015625, "vf_explained_var": 0.805881679058075, "kl": 0.03469984233379364, "entropy": 1.60286545753479, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1480000, "episodes_total": 2970, "training_iteration": 74, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-44-34", "timestamp": 1567647874, "time_this_iter_s": 17.817928791046143, "time_total_s": 1313.6110816001892, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d202598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1313.6110816001892, "timesteps_since_restore": 1480000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 31.412000000000003, "ram_util_percent": 14.303999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 255.44392584290793, "action_adversary": -255.44392584290793}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.478302086212632, "mean_processing_ms": 2.448372376285653, "mean_inference_ms": 0.9579593415784547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1497600, "num_steps_sampled": 1500000, "sample_time_ms": 12608.035, "load_time_ms": 34.927, "grad_time_ms": 4997.331, "update_time_ms": 8.053, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 528.0361938476562, "policy_loss": -0.010700898244976997, "vf_loss": 528.0467529296875, "vf_explained_var": 0.8014201521873474, "kl": 0.014263613149523735, "entropy": 30.395771026611328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 4.999999873689376e-05, "total_loss": 534.3839721679688, "policy_loss": 0.005604995414614677, "vf_loss": 534.3782958984375, "vf_explained_var": 0.804437518119812, "kl": 0.03217921033501625, "entropy": 1.5866016149520874, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1500000, "episodes_total": 3010, "training_iteration": 75, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-44-52", "timestamp": 1567647892, "time_this_iter_s": 17.708755016326904, "time_total_s": 1331.319836616516, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d25cb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1331.319836616516, "timesteps_since_restore": 1500000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 30.492307692307694, "ram_util_percent": 14.396153846153844}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 258.2023561582227, "action_adversary": -258.2023561582227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.47877868908075, "mean_processing_ms": 2.448339969820818, "mean_inference_ms": 0.9585869571180193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1517568, "num_steps_sampled": 1520000, "sample_time_ms": 12636.478, "load_time_ms": 34.9, "grad_time_ms": 4995.725, "update_time_ms": 7.994, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 531.666748046875, "policy_loss": -0.010279729962348938, "vf_loss": 531.6768798828125, "vf_explained_var": 0.8025882244110107, "kl": 0.014598219655454159, "entropy": 30.34642219543457, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 4.999999873689376e-05, "total_loss": 535.923095703125, "policy_loss": 0.006469274405390024, "vf_loss": 535.9165649414062, "vf_explained_var": 0.8066641688346863, "kl": 0.04564427584409714, "entropy": 1.565364122390747, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1520000, "episodes_total": 3050, "training_iteration": 76, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-45-10", "timestamp": 1567647910, "time_this_iter_s": 17.920875787734985, "time_total_s": 1349.240712404251, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d230bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1349.240712404251, "timesteps_since_restore": 1520000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.496, "ram_util_percent": 14.395999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 258.451599077384, "action_adversary": -258.451599077384}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4792216047449513, "mean_processing_ms": 2.4483042249477145, "mean_inference_ms": 0.9591837721547383}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1537536, "num_steps_sampled": 1540000, "sample_time_ms": 12647.873, "load_time_ms": 34.987, "grad_time_ms": 4994.725, "update_time_ms": 7.987, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 539.1375122070312, "policy_loss": -0.012884795665740967, "vf_loss": 539.1502075195312, "vf_explained_var": 0.8052632212638855, "kl": 0.015916578471660614, "entropy": 30.29542350769043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0002471923944540322, "cur_lr": 4.999999873689376e-05, "total_loss": 541.5487670898438, "policy_loss": 0.004492003004997969, "vf_loss": 541.5442504882812, "vf_explained_var": 0.8059658408164978, "kl": 0.02948625199496746, "entropy": 1.5463322401046753, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1540000, "episodes_total": 3090, "training_iteration": 77, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-45-27", "timestamp": 1567647927, "time_this_iter_s": 17.701048374176025, "time_total_s": 1366.9417607784271, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d40d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1366.9417607784271, "timesteps_since_restore": 1540000, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 31.232, "ram_util_percent": 14.4}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 261.10369022587304, "action_adversary": -261.10369022587304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4794278163650048, "mean_processing_ms": 2.4482366075795596, "mean_inference_ms": 0.9596439974070994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1557504, "num_steps_sampled": 1560000, "sample_time_ms": 12671.166, "load_time_ms": 34.988, "grad_time_ms": 4994.67, "update_time_ms": 8.048, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 537.7857666015625, "policy_loss": -0.010808194987475872, "vf_loss": 537.79638671875, "vf_explained_var": 0.8056244850158691, "kl": 0.014629790559411049, "entropy": 30.258394241333008, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0002471923944540322, "cur_lr": 4.999999873689376e-05, "total_loss": 542.8902587890625, "policy_loss": 0.0081308139488101, "vf_loss": 542.8821411132812, "vf_explained_var": 0.7984199523925781, "kl": 0.033326663076877594, "entropy": 1.539294958114624, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1560000, "episodes_total": 3130, "training_iteration": 78, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-45-45", "timestamp": 1567647945, "time_this_iter_s": 17.700746059417725, "time_total_s": 1384.6425068378448, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1e86a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1384.6425068378448, "timesteps_since_restore": 1560000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.31923076923077, "ram_util_percent": 14.399999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 259.7645682436712, "action_adversary": -259.7645682436712}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4795788415715148, "mean_processing_ms": 2.4481892365753732, "mean_inference_ms": 0.9600476355746064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1577472, "num_steps_sampled": 1580000, "sample_time_ms": 12682.949, "load_time_ms": 34.978, "grad_time_ms": 4994.861, "update_time_ms": 8.022, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 567.4172973632812, "policy_loss": -0.014551186934113503, "vf_loss": 567.431640625, "vf_explained_var": 0.8043310642242432, "kl": 0.01643768884241581, "entropy": 30.216739654541016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0002471923944540322, "cur_lr": 4.999999873689376e-05, "total_loss": 571.0839233398438, "policy_loss": 0.1172589510679245, "vf_loss": 570.9635620117188, "vf_explained_var": 0.8018398284912109, "kl": 12.617233276367188, "entropy": 1.5693745613098145, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1580000, "episodes_total": 3170, "training_iteration": 79, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-46-03", "timestamp": 1567647963, "time_this_iter_s": 17.799579620361328, "time_total_s": 1402.4420864582062, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288055ec80>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1402.4420864582062, "timesteps_since_restore": 1580000, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 31.144000000000002, "ram_util_percent": 14.4}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 263.9994334117651, "action_adversary": -263.9994334117651}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.479947395260372, "mean_processing_ms": 2.448127682937506, "mean_inference_ms": 0.9604341660119019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1597440, "num_steps_sampled": 1600000, "sample_time_ms": 12654.717, "load_time_ms": 34.907, "grad_time_ms": 4995.155, "update_time_ms": 8.218, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 551.4077758789062, "policy_loss": -0.010545429773628712, "vf_loss": 551.4180908203125, "vf_explained_var": 0.812045156955719, "kl": 0.01606033369898796, "entropy": 30.255277633666992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003707885625772178, "cur_lr": 4.999999873689376e-05, "total_loss": 552.205078125, "policy_loss": 0.0059061660431325436, "vf_loss": 552.1990966796875, "vf_explained_var": 0.8072028756141663, "kl": 0.036335986107587814, "entropy": 1.524463415145874, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1600000, "episodes_total": 3210, "training_iteration": 80, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-46-21", "timestamp": 1567647981, "time_this_iter_s": 17.798321962356567, "time_total_s": 1420.2404084205627, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d255b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1420.2404084205627, "timesteps_since_restore": 1600000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.58461538461539, "ram_util_percent": 14.376923076923076}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 268.57160711126846, "action_adversary": -268.57160711126846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48065377628957, "mean_processing_ms": 2.44806991279579, "mean_inference_ms": 0.960920643398386}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1617408, "num_steps_sampled": 1620000, "sample_time_ms": 12672.782, "load_time_ms": 34.923, "grad_time_ms": 4994.564, "update_time_ms": 8.193, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 561.3028564453125, "policy_loss": -0.011293213814496994, "vf_loss": 561.3140258789062, "vf_explained_var": 0.8162088394165039, "kl": 0.016124943271279335, "entropy": 30.30268669128418, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003707885625772178, "cur_lr": 4.999999873689376e-05, "total_loss": 564.9073486328125, "policy_loss": 0.005314865615218878, "vf_loss": 564.9020385742188, "vf_explained_var": 0.8130336999893188, "kl": 0.03748922422528267, "entropy": 1.4979770183563232, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1620000, "episodes_total": 3250, "training_iteration": 81, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-46-39", "timestamp": 1567647999, "time_this_iter_s": 17.82629108428955, "time_total_s": 1438.0666995048523, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c38c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1438.0666995048523, "timesteps_since_restore": 1620000, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 31.904, "ram_util_percent": 14.315999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 278.59569257313046, "action_adversary": -278.59569257313046}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.481377777754987, "mean_processing_ms": 2.448032946305799, "mean_inference_ms": 0.9614198647072848}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1637376, "num_steps_sampled": 1640000, "sample_time_ms": 12711.535, "load_time_ms": 34.899, "grad_time_ms": 4993.493, "update_time_ms": 8.116, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 573.7348022460938, "policy_loss": -0.011422256007790565, "vf_loss": 573.7460327148438, "vf_explained_var": 0.8178648948669434, "kl": 0.016032584011554718, "entropy": 30.28036117553711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003707885625772178, "cur_lr": 4.999999873689376e-05, "total_loss": 578.0007934570312, "policy_loss": 0.0040836636908352375, "vf_loss": 577.9967041015625, "vf_explained_var": 0.813008189201355, "kl": 0.02699512057006359, "entropy": 1.5126683712005615, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1640000, "episodes_total": 3290, "training_iteration": 82, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-46-56", "timestamp": 1567648016, "time_this_iter_s": 17.832650661468506, "time_total_s": 1455.8993501663208, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d27e0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1455.8993501663208, "timesteps_since_restore": 1640000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 31.364, "ram_util_percent": 14.427999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 280.5379878028181, "action_adversary": -280.5379878028181}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.481735146767183, "mean_processing_ms": 2.448011502715719, "mean_inference_ms": 0.9619527100346202}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657344, "num_steps_sampled": 1660000, "sample_time_ms": 12734.378, "load_time_ms": 34.897, "grad_time_ms": 4993.363, "update_time_ms": 8.023, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 582.5596923828125, "policy_loss": -0.01042977161705494, "vf_loss": 582.5698852539062, "vf_explained_var": 0.8211494088172913, "kl": 0.015250754542648792, "entropy": 30.27570915222168, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0003707885625772178, "cur_lr": 4.999999873689376e-05, "total_loss": 586.43701171875, "policy_loss": 0.036760080605745316, "vf_loss": 586.4000854492188, "vf_explained_var": 0.8141441941261292, "kl": 0.39197373390197754, "entropy": 1.4784923791885376, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1660000, "episodes_total": 3330, "training_iteration": 83, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-47-14", "timestamp": 1567648034, "time_this_iter_s": 17.76758646965027, "time_total_s": 1473.666936635971, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805dd950>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1473.666936635971, "timesteps_since_restore": 1660000, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.61923076923077, "ram_util_percent": 14.350000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 282.12012052929686, "action_adversary": -282.12012052929686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.481734622134015, "mean_processing_ms": 2.4480307289889733, "mean_inference_ms": 0.9624456833210135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1677312, "num_steps_sampled": 1680000, "sample_time_ms": 12721.688, "load_time_ms": 34.892, "grad_time_ms": 4992.523, "update_time_ms": 7.735, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 586.7693481445312, "policy_loss": -0.010906529612839222, "vf_loss": 586.780029296875, "vf_explained_var": 0.8134514689445496, "kl": 0.015078199096024036, "entropy": 30.22584342956543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0005561828729696572, "cur_lr": 4.999999873689376e-05, "total_loss": 590.1845092773438, "policy_loss": 0.006975501775741577, "vf_loss": 590.177490234375, "vf_explained_var": 0.8083871603012085, "kl": 0.04037410020828247, "entropy": 1.4446913003921509, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1680000, "episodes_total": 3370, "training_iteration": 84, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-47-32", "timestamp": 1567648052, "time_this_iter_s": 17.6811306476593, "time_total_s": 1491.3480672836304, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c99d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1491.3480672836304, "timesteps_since_restore": 1680000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.132, "ram_util_percent": 14.46}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 284.92644342877026, "action_adversary": -284.92644342877026}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4814574002958723, "mean_processing_ms": 2.448050107405813, "mean_inference_ms": 0.962953373891211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1697280, "num_steps_sampled": 1700000, "sample_time_ms": 12718.019, "load_time_ms": 34.657, "grad_time_ms": 4991.668, "update_time_ms": 7.981, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 599.2653198242188, "policy_loss": -0.01045811828225851, "vf_loss": 599.275634765625, "vf_explained_var": 0.8126305341720581, "kl": 0.015563066117465496, "entropy": 30.18556022644043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0008342742803506553, "cur_lr": 4.999999873689376e-05, "total_loss": 603.2557983398438, "policy_loss": 0.005095708649605513, "vf_loss": 603.2506713867188, "vf_explained_var": 0.8045551776885986, "kl": 0.04216201603412628, "entropy": 1.4073787927627563, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1700000, "episodes_total": 3410, "training_iteration": 85, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-47-50", "timestamp": 1567648070, "time_this_iter_s": 17.663107872009277, "time_total_s": 1509.0111751556396, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1509.0111751556396, "timesteps_since_restore": 1700000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.092, "ram_util_percent": 14.404000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.7319351916269, "action_adversary": -287.7319351916269}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48118846649393, "mean_processing_ms": 2.4480572180816673, "mean_inference_ms": 0.9634091353907266}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1717248, "num_steps_sampled": 1720000, "sample_time_ms": 12687.156, "load_time_ms": 34.64, "grad_time_ms": 4993.709, "update_time_ms": 7.995, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 605.2615966796875, "policy_loss": -0.010543798096477985, "vf_loss": 605.2719116210938, "vf_explained_var": 0.8025811314582825, "kl": 0.015186639502644539, "entropy": 30.194639205932617, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0012514113914221525, "cur_lr": 4.999999873689376e-05, "total_loss": 609.5601806640625, "policy_loss": 0.005611784756183624, "vf_loss": 609.5545654296875, "vf_explained_var": 0.7925801277160645, "kl": 0.03149561583995819, "entropy": 1.406001329421997, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1720000, "episodes_total": 3450, "training_iteration": 86, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-48-07", "timestamp": 1567648087, "time_this_iter_s": 17.633582592010498, "time_total_s": 1526.6447577476501, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d239400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1526.6447577476501, "timesteps_since_restore": 1720000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 31.344, "ram_util_percent": 14.424000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 290.20353713296134, "action_adversary": -290.20353713296134}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4811860396806393, "mean_processing_ms": 2.4480943444522127, "mean_inference_ms": 0.9640091215734763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1737216, "num_steps_sampled": 1740000, "sample_time_ms": 12703.686, "load_time_ms": 34.619, "grad_time_ms": 4996.061, "update_time_ms": 8.032, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 614.9938354492188, "policy_loss": -0.010894658043980598, "vf_loss": 615.0045166015625, "vf_explained_var": 0.7990710735321045, "kl": 0.015565171837806702, "entropy": 30.187074661254883, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0012514113914221525, "cur_lr": 4.999999873689376e-05, "total_loss": 618.5967407226562, "policy_loss": 0.008863622322678566, "vf_loss": 618.5877685546875, "vf_explained_var": 0.789141833782196, "kl": 0.0582396425306797, "entropy": 1.3896667957305908, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1740000, "episodes_total": 3490, "training_iteration": 87, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-48-25", "timestamp": 1567648105, "time_this_iter_s": 17.88857936859131, "time_total_s": 1544.5333371162415, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1544.5333371162415, "timesteps_since_restore": 1740000, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 31.28076923076923, "ram_util_percent": 14.36923076923077}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 289.2903224469096, "action_adversary": -289.2903224469096}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4812442883689036, "mean_processing_ms": 2.448127220265731, "mean_inference_ms": 0.9646208126432478}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1757184, "num_steps_sampled": 1760000, "sample_time_ms": 12701.358, "load_time_ms": 34.613, "grad_time_ms": 4997.441, "update_time_ms": 8.11, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 625.0994873046875, "policy_loss": -0.011833669617772102, "vf_loss": 625.1112060546875, "vf_explained_var": 0.7872152924537659, "kl": 0.015466101467609406, "entropy": 30.127792358398438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0018771172035485506, "cur_lr": 4.999999873689376e-05, "total_loss": 627.467041015625, "policy_loss": 0.019413212314248085, "vf_loss": 627.4473876953125, "vf_explained_var": 0.7813787460327148, "kl": 0.15116900205612183, "entropy": 1.4040367603302002, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1760000, "episodes_total": 3530, "training_iteration": 88, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-48-43", "timestamp": 1567648123, "time_this_iter_s": 17.692715167999268, "time_total_s": 1562.2260522842407, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b8378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1562.2260522842407, "timesteps_since_restore": 1760000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.288, "ram_util_percent": 14.468}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.689911923458, "action_adversary": -288.689911923458}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4811681400242205, "mean_processing_ms": 2.4481477944279657, "mean_inference_ms": 0.9651273740484312}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1777152, "num_steps_sampled": 1780000, "sample_time_ms": 12691.581, "load_time_ms": 34.667, "grad_time_ms": 4996.968, "update_time_ms": 8.193, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 642.8361206054688, "policy_loss": -0.011694963090121746, "vf_loss": 642.84765625, "vf_explained_var": 0.7780327796936035, "kl": 0.017156176269054413, "entropy": 30.106292724609375, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.002815675688907504, "cur_lr": 4.999999873689376e-05, "total_loss": 645.5615844726562, "policy_loss": 0.007356740068644285, "vf_loss": 645.55419921875, "vf_explained_var": 0.7749970555305481, "kl": 0.03719735145568848, "entropy": 1.3795244693756104, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1780000, "episodes_total": 3570, "training_iteration": 89, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-49-01", "timestamp": 1567648141, "time_this_iter_s": 17.697807788848877, "time_total_s": 1579.9238600730896, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d21fea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1579.9238600730896, "timesteps_since_restore": 1780000, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.24, "ram_util_percent": 14.424000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.9210259661328, "action_adversary": -288.9210259661328}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4809730531415233, "mean_processing_ms": 2.448127991610144, "mean_inference_ms": 0.9655742347054178}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1797120, "num_steps_sampled": 1800000, "sample_time_ms": 12681.595, "load_time_ms": 34.38, "grad_time_ms": 4996.581, "update_time_ms": 7.998, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 646.60498046875, "policy_loss": -0.010963717475533485, "vf_loss": 646.61572265625, "vf_explained_var": 0.7726052403450012, "kl": 0.015757689252495766, "entropy": 30.07754898071289, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.002815675688907504, "cur_lr": 4.999999873689376e-05, "total_loss": 650.6564331054688, "policy_loss": 0.028940409421920776, "vf_loss": 650.6268920898438, "vf_explained_var": 0.7688283920288086, "kl": 0.21296001970767975, "entropy": 1.4416744709014893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1800000, "episodes_total": 3610, "training_iteration": 90, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-49-18", "timestamp": 1567648158, "time_this_iter_s": 17.689451694488525, "time_total_s": 1597.6133117675781, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2028c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1597.6133117675781, "timesteps_since_restore": 1800000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.369230769230764, "ram_util_percent": 14.403846153846153}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.6157698463833, "action_adversary": -288.6157698463833}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.480773031326954, "mean_processing_ms": 2.4481150935336884, "mean_inference_ms": 0.9660231824245045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1817088, "num_steps_sampled": 1820000, "sample_time_ms": 12665.58, "load_time_ms": 34.37, "grad_time_ms": 4996.758, "update_time_ms": 8.006, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 659.3690795898438, "policy_loss": -0.009471039287745953, "vf_loss": 659.3782958984375, "vf_explained_var": 0.7712814211845398, "kl": 0.014931688085198402, "entropy": 30.02491569519043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.004223513416945934, "cur_lr": 4.999999873689376e-05, "total_loss": 663.8004760742188, "policy_loss": 0.004938747268170118, "vf_loss": 663.7953491210938, "vf_explained_var": 0.7650638222694397, "kl": 0.026603208854794502, "entropy": 1.4443209171295166, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1820000, "episodes_total": 3650, "training_iteration": 91, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-49-36", "timestamp": 1567648176, "time_this_iter_s": 17.668803691864014, "time_total_s": 1615.2821154594421, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2571e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1615.2821154594421, "timesteps_since_restore": 1820000, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.296000000000003, "ram_util_percent": 14.427999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.11432219839304, "action_adversary": -288.11432219839304}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.480689256579321, "mean_processing_ms": 2.448120383606135, "mean_inference_ms": 0.966488611629337}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837056, "num_steps_sampled": 1840000, "sample_time_ms": 12662.746, "load_time_ms": 34.401, "grad_time_ms": 4997.124, "update_time_ms": 8.064, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 669.3082885742188, "policy_loss": -0.009976601228117943, "vf_loss": 669.318115234375, "vf_explained_var": 0.7616215348243713, "kl": 0.014887714758515358, "entropy": 30.00418472290039, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.004223513416945934, "cur_lr": 4.999999873689376e-05, "total_loss": 672.8452758789062, "policy_loss": 0.008296382613480091, "vf_loss": 672.8368530273438, "vf_explained_var": 0.7575985789299011, "kl": 0.04981999471783638, "entropy": 1.4609531164169312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1840000, "episodes_total": 3690, "training_iteration": 92, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-49-54", "timestamp": 1567648194, "time_this_iter_s": 17.808624505996704, "time_total_s": 1633.0907399654388, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806cf378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1633.0907399654388, "timesteps_since_restore": 1840000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 31.404, "ram_util_percent": 14.36}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.7814909115129, "action_adversary": -287.7814909115129}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.480743909717659, "mean_processing_ms": 2.448125550674242, "mean_inference_ms": 0.9668516792182732}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1857024, "num_steps_sampled": 1860000, "sample_time_ms": 12663.818, "load_time_ms": 34.43, "grad_time_ms": 4997.587, "update_time_ms": 7.964, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 675.6826171875, "policy_loss": -0.010586142539978027, "vf_loss": 675.6929931640625, "vf_explained_var": 0.7616245150566101, "kl": 0.015094690024852753, "entropy": 29.864471435546875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.006335270591080189, "cur_lr": 4.999999873689376e-05, "total_loss": 678.8258056640625, "policy_loss": 0.004546002484858036, "vf_loss": 678.8209838867188, "vf_explained_var": 0.7582879662513733, "kl": 0.03311265632510185, "entropy": 1.492859125137329, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1860000, "episodes_total": 3730, "training_iteration": 93, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-50-12", "timestamp": 1567648212, "time_this_iter_s": 17.7826189994812, "time_total_s": 1650.87335896492, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806cfbf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1650.87335896492, "timesteps_since_restore": 1860000, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 30.27307692307693, "ram_util_percent": 14.357692307692307}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.59047373778174, "action_adversary": -287.59047373778174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.480977144193703, "mean_processing_ms": 2.448107598929842, "mean_inference_ms": 0.9671508992557812}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1876992, "num_steps_sampled": 1880000, "sample_time_ms": 12680.316, "load_time_ms": 34.138, "grad_time_ms": 4997.19, "update_time_ms": 8.245, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 687.7830810546875, "policy_loss": -0.010258732363581657, "vf_loss": 687.7931518554688, "vf_explained_var": 0.7547334432601929, "kl": 0.015391814522445202, "entropy": 29.82469367980957, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.006335270591080189, "cur_lr": 4.999999873689376e-05, "total_loss": 689.3486328125, "policy_loss": 0.006213936023414135, "vf_loss": 689.3422241210938, "vf_explained_var": 0.7526180148124695, "kl": 0.04073253646492958, "entropy": 1.4878017902374268, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1880000, "episodes_total": 3770, "training_iteration": 94, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-50-30", "timestamp": 1567648230, "time_this_iter_s": 17.840269327163696, "time_total_s": 1668.7136282920837, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806e9d90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1668.7136282920837, "timesteps_since_restore": 1880000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.324, "ram_util_percent": 14.412}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 285.8856028057218, "action_adversary": -285.8856028057218}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4814235067447474, "mean_processing_ms": 2.4480538801929663, "mean_inference_ms": 0.9673964662298294}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1896960, "num_steps_sampled": 1900000, "sample_time_ms": 12699.212, "load_time_ms": 34.389, "grad_time_ms": 4997.913, "update_time_ms": 8.094, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 696.0963745117188, "policy_loss": -0.010129351168870926, "vf_loss": 696.1062622070312, "vf_explained_var": 0.7559794783592224, "kl": 0.014808609150350094, "entropy": 29.824779510498047, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 699.5419921875, "policy_loss": 0.0025315056554973125, "vf_loss": 699.5391845703125, "vf_explained_var": 0.7535659670829773, "kl": 0.030023885890841484, "entropy": 1.4741638898849487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1900000, "episodes_total": 3810, "training_iteration": 95, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-50-47", "timestamp": 1567648247, "time_this_iter_s": 17.861680269241333, "time_total_s": 1686.575308561325, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d29c6a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1686.575308561325, "timesteps_since_restore": 1900000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.288461538461533, "ram_util_percent": 14.373076923076924}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 285.9433470544084, "action_adversary": -285.9433470544084}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48176687963774, "mean_processing_ms": 2.4479984875714624, "mean_inference_ms": 0.9675754619202445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1916928, "num_steps_sampled": 1920000, "sample_time_ms": 12712.139, "load_time_ms": 34.389, "grad_time_ms": 4996.675, "update_time_ms": 8.057, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 711.197998046875, "policy_loss": -0.010658453218638897, "vf_loss": 711.20849609375, "vf_explained_var": 0.7536367774009705, "kl": 0.016523459926247597, "entropy": 29.78126335144043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 713.0814819335938, "policy_loss": 0.0046237497590482235, "vf_loss": 713.0764770507812, "vf_explained_var": 0.7550445199012756, "kl": 0.03627290576696396, "entropy": 1.4446637630462646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1920000, "episodes_total": 3850, "training_iteration": 96, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-51-05", "timestamp": 1567648265, "time_this_iter_s": 17.7489333152771, "time_total_s": 1704.3242418766022, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a0840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1704.3242418766022, "timesteps_since_restore": 1920000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.036000000000005, "ram_util_percent": 14.427999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.755298963525, "action_adversary": -287.755298963525}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48201869881806, "mean_processing_ms": 2.4479474526005096, "mean_inference_ms": 0.9677207627836327}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1936896, "num_steps_sampled": 1940000, "sample_time_ms": 12712.97, "load_time_ms": 34.344, "grad_time_ms": 4995.05, "update_time_ms": 8.06, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 720.0191650390625, "policy_loss": -0.012297996319830418, "vf_loss": 720.03125, "vf_explained_var": 0.7489228844642639, "kl": 0.017163794487714767, "entropy": 29.77645492553711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 719.5540161132812, "policy_loss": 0.0044584753923118114, "vf_loss": 719.5491943359375, "vf_explained_var": 0.742325484752655, "kl": 0.036740493029356, "entropy": 1.4420623779296875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1940000, "episodes_total": 3890, "training_iteration": 97, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-51-23", "timestamp": 1567648283, "time_this_iter_s": 17.881070613861084, "time_total_s": 1722.2053124904633, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d20c158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1722.2053124904633, "timesteps_since_restore": 1940000, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.219230769230766, "ram_util_percent": 14.438461538461537}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.89284290753335, "action_adversary": -288.89284290753335}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4822733506140997, "mean_processing_ms": 2.44788366772514, "mean_inference_ms": 0.9679019616099089}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1956864, "num_steps_sampled": 1960000, "sample_time_ms": 12736.889, "load_time_ms": 34.322, "grad_time_ms": 4994.046, "update_time_ms": 7.956, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 726.1246337890625, "policy_loss": -0.011165195144712925, "vf_loss": 726.1356201171875, "vf_explained_var": 0.7447642683982849, "kl": 0.015994682908058167, "entropy": 29.744110107421875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.009502905420958996, "cur_lr": 4.999999873689376e-05, "total_loss": 723.3433837890625, "policy_loss": 0.021330876275897026, "vf_loss": 723.3207397460938, "vf_explained_var": 0.7386362552642822, "kl": 0.13312183320522308, "entropy": 1.4397222995758057, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1960000, "episodes_total": 3930, "training_iteration": 98, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-51-41", "timestamp": 1567648301, "time_this_iter_s": 17.919549703598022, "time_total_s": 1740.1248621940613, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2192f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1740.1248621940613, "timesteps_since_restore": 1960000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.191999999999997, "ram_util_percent": 14.431999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.4870429653698, "action_adversary": -287.4870429653698}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.482559810559782, "mean_processing_ms": 2.4478127150110502, "mean_inference_ms": 0.9681300358591278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1976832, "num_steps_sampled": 1980000, "sample_time_ms": 12741.541, "load_time_ms": 34.249, "grad_time_ms": 4994.206, "update_time_ms": 7.881, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 739.17626953125, "policy_loss": -0.011936978437006474, "vf_loss": 739.18798828125, "vf_explained_var": 0.7378473281860352, "kl": 0.017729682847857475, "entropy": 29.68147087097168, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 732.90625, "policy_loss": 0.0014122625580057502, "vf_loss": 732.904541015625, "vf_explained_var": 0.7363143563270569, "kl": 0.022781534120440483, "entropy": 1.4234448671340942, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 1980000, "episodes_total": 3970, "training_iteration": 99, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-51-59", "timestamp": 1567648319, "time_this_iter_s": 17.745094299316406, "time_total_s": 1757.8699564933777, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d219b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1757.8699564933777, "timesteps_since_restore": 1980000, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.303999999999995, "ram_util_percent": 14.484000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.27408357626547, "action_adversary": -287.27408357626547}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.482960385374856, "mean_processing_ms": 2.4477559415535253, "mean_inference_ms": 0.9684359363003833}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1996800, "num_steps_sampled": 2000000, "sample_time_ms": 12760.477, "load_time_ms": 34.563, "grad_time_ms": 4994.276, "update_time_ms": 7.938, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 751.001708984375, "policy_loss": -0.010887829586863518, "vf_loss": 751.0123901367188, "vf_explained_var": 0.7318204045295715, "kl": 0.014775228686630726, "entropy": 29.684438705444336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.014254358597099781, "cur_lr": 4.999999873689376e-05, "total_loss": 743.0271606445312, "policy_loss": 0.010626954957842827, "vf_loss": 743.0154418945312, "vf_explained_var": 0.7300190329551697, "kl": 0.0775313451886177, "entropy": 1.4478116035461426, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2000000, "episodes_total": 4010, "training_iteration": 100, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-52-17", "timestamp": 1567648337, "time_this_iter_s": 17.884421348571777, "time_total_s": 1775.7543778419495, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1a6d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1775.7543778419495, "timesteps_since_restore": 2000000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 30.680769230769233, "ram_util_percent": 14.39615384615385}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.6861757068354, "action_adversary": -286.6861757068354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4834480552601756, "mean_processing_ms": 2.447734430961887, "mean_inference_ms": 0.9687594867159849}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2016768, "num_steps_sampled": 2020000, "sample_time_ms": 12774.728, "load_time_ms": 34.592, "grad_time_ms": 4993.397, "update_time_ms": 8.042, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 758.1614990234375, "policy_loss": -0.010743298567831516, "vf_loss": 758.1720581054688, "vf_explained_var": 0.7325312495231628, "kl": 0.014754324220120907, "entropy": 29.695268630981445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.02138153836131096, "cur_lr": 4.999999873689376e-05, "total_loss": 748.3446044921875, "policy_loss": 0.009799599647521973, "vf_loss": 748.3328247070312, "vf_explained_var": 0.725658118724823, "kl": 0.09332791715860367, "entropy": 1.4405088424682617, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2020000, "episodes_total": 4050, "training_iteration": 101, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-52-35", "timestamp": 1567648355, "time_this_iter_s": 17.803542375564575, "time_total_s": 1793.557920217514, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a0620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1793.557920217514, "timesteps_since_restore": 2020000, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 31.47200000000001, "ram_util_percent": 14.484000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 289.64049657084803, "action_adversary": -289.64049657084803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4839655090067225, "mean_processing_ms": 2.447717194698919, "mean_inference_ms": 0.9690139935456421}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2036736, "num_steps_sampled": 2040000, "sample_time_ms": 12787.415, "load_time_ms": 34.599, "grad_time_ms": 4992.926, "update_time_ms": 8.057, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 765.2620239257812, "policy_loss": -0.010189010761678219, "vf_loss": 765.2719116210938, "vf_explained_var": 0.7277825474739075, "kl": 0.015824170783162117, "entropy": 29.69438362121582, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 758.8629760742188, "policy_loss": 0.004630313254892826, "vf_loss": 758.8573608398438, "vf_explained_var": 0.719304621219635, "kl": 0.031970713287591934, "entropy": 1.4522039890289307, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2040000, "episodes_total": 4090, "training_iteration": 102, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-52-52", "timestamp": 1567648372, "time_this_iter_s": 17.931350469589233, "time_total_s": 1811.4892706871033, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d202b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1811.4892706871033, "timesteps_since_restore": 2040000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 30.342307692307692, "ram_util_percent": 14.457692307692307}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 290.06330511398744, "action_adversary": -290.06330511398744}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4841501523121594, "mean_processing_ms": 2.4476990318969296, "mean_inference_ms": 0.9692264597845832}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2056704, "num_steps_sampled": 2060000, "sample_time_ms": 12761.922, "load_time_ms": 34.539, "grad_time_ms": 4993.152, "update_time_ms": 8.115, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 932.3607788085938, "policy_loss": -0.010997808538377285, "vf_loss": 932.37158203125, "vf_explained_var": 0.6762664914131165, "kl": 0.016347086057066917, "entropy": 29.473358154296875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.03207230567932129, "cur_lr": 4.999999873689376e-05, "total_loss": 929.1820068359375, "policy_loss": 0.007457639090716839, "vf_loss": 929.1720581054688, "vf_explained_var": 0.6680792570114136, "kl": 0.07781911641359329, "entropy": 1.4818669557571411, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2060000, "episodes_total": 4130, "training_iteration": 103, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-53-10", "timestamp": 1567648390, "time_this_iter_s": 17.530357122421265, "time_total_s": 1829.0196278095245, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d202598>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1829.0196278095245, "timesteps_since_restore": 2060000, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 31.247999999999998, "ram_util_percent": 14.42}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.8269632061514, "action_adversary": -287.8269632061514}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4841513164905464, "mean_processing_ms": 2.4476915168209477, "mean_inference_ms": 0.9694934507445154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076672, "num_steps_sampled": 2080000, "sample_time_ms": 12749.931, "load_time_ms": 34.849, "grad_time_ms": 4992.607, "update_time_ms": 7.847, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 879.8980102539062, "policy_loss": -0.011302031576633453, "vf_loss": 879.9092407226562, "vf_explained_var": 0.6894764304161072, "kl": 0.015133826993405819, "entropy": 29.48453712463379, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.048108458518981934, "cur_lr": 4.999999873689376e-05, "total_loss": 879.1089477539062, "policy_loss": 0.0020473238546401262, "vf_loss": 879.1057739257812, "vf_explained_var": 0.6781260967254639, "kl": 0.02498309127986431, "entropy": 1.4937822818756104, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2080000, "episodes_total": 4170, "training_iteration": 104, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-53-28", "timestamp": 1567648408, "time_this_iter_s": 17.715561628341675, "time_total_s": 1846.7351894378662, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b8158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1846.7351894378662, "timesteps_since_restore": 2080000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 31.728, "ram_util_percent": 14.471999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.7869669590727, "action_adversary": -286.7869669590727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4839643424089, "mean_processing_ms": 2.4476719821814314, "mean_inference_ms": 0.96978716824861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2096640, "num_steps_sampled": 2100000, "sample_time_ms": 12735.499, "load_time_ms": 34.878, "grad_time_ms": 4990.571, "update_time_ms": 7.773, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 851.2782592773438, "policy_loss": -0.01129914540797472, "vf_loss": 851.2892456054688, "vf_explained_var": 0.694811224937439, "kl": 0.014230430126190186, "entropy": 29.40596580505371, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.048108458518981934, "cur_lr": 4.999999873689376e-05, "total_loss": 848.6815185546875, "policy_loss": 0.006649096962064505, "vf_loss": 848.6715698242188, "vf_explained_var": 0.6898990869522095, "kl": 0.06368298083543777, "entropy": 1.5541268587112427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2100000, "episodes_total": 4210, "training_iteration": 105, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-53-45", "timestamp": 1567648425, "time_this_iter_s": 17.69491982460022, "time_total_s": 1864.4301092624664, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b81e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1864.4301092624664, "timesteps_since_restore": 2100000, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 14.423076923076923}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.67915527614093, "action_adversary": -286.67915527614093}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4837682958180167, "mean_processing_ms": 2.4476661922818583, "mean_inference_ms": 0.9700296435126827}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2116608, "num_steps_sampled": 2120000, "sample_time_ms": 12734.922, "load_time_ms": 34.942, "grad_time_ms": 4991.572, "update_time_ms": 7.805, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 834.6508178710938, "policy_loss": -0.00965698342770338, "vf_loss": 834.6602172851562, "vf_explained_var": 0.7002953886985779, "kl": 0.014297589659690857, "entropy": 29.37733268737793, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 827.803955078125, "policy_loss": -0.0013652484631165862, "vf_loss": 827.8045043945312, "vf_explained_var": 0.6975341439247131, "kl": 0.012224633246660233, "entropy": 1.5290004014968872, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2120000, "episodes_total": 4250, "training_iteration": 106, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-54-03", "timestamp": 1567648443, "time_this_iter_s": 17.754571199417114, "time_total_s": 1882.1846804618835, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1882.1846804618835, "timesteps_since_restore": 2120000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 31.244, "ram_util_percent": 14.404000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.26978009449783, "action_adversary": -287.26978009449783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483574923417037, "mean_processing_ms": 2.44764017708085, "mean_inference_ms": 0.9702618428342332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2136576, "num_steps_sampled": 2140000, "sample_time_ms": 12707.996, "load_time_ms": 34.937, "grad_time_ms": 4990.115, "update_time_ms": 7.816, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 813.2848510742188, "policy_loss": -0.012147731147706509, "vf_loss": 813.2968139648438, "vf_explained_var": 0.6972062587738037, "kl": 0.016939301043748856, "entropy": 29.387470245361328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 805.0003051757812, "policy_loss": -0.00043609211570583284, "vf_loss": 804.999755859375, "vf_explained_var": 0.7004021406173706, "kl": 0.013662469573318958, "entropy": 1.5292028188705444, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2140000, "episodes_total": 4290, "training_iteration": 107, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-54-21", "timestamp": 1567648461, "time_this_iter_s": 17.598369121551514, "time_total_s": 1899.783049583435, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2392f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1899.783049583435, "timesteps_since_restore": 2140000, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 31.191999999999997, "ram_util_percent": 14.471999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.57465561376966, "action_adversary": -286.57465561376966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.48342153470501, "mean_processing_ms": 2.4475913857905494, "mean_inference_ms": 0.9704962088848244}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2156544, "num_steps_sampled": 2160000, "sample_time_ms": 12684.216, "load_time_ms": 34.683, "grad_time_ms": 4989.055, "update_time_ms": 7.801, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 796.3885498046875, "policy_loss": -0.011392755433917046, "vf_loss": 796.3997192382812, "vf_explained_var": 0.7033290266990662, "kl": 0.016324147582054138, "entropy": 29.389375686645508, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 786.9186401367188, "policy_loss": 0.00093314319383353, "vf_loss": 786.9164428710938, "vf_explained_var": 0.708658754825592, "kl": 0.01813572272658348, "entropy": 1.5322672128677368, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2160000, "episodes_total": 4330, "training_iteration": 108, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-54-39", "timestamp": 1567648479, "time_this_iter_s": 17.668190479278564, "time_total_s": 1917.4512400627136, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1917.4512400627136, "timesteps_since_restore": 2160000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.191999999999997, "ram_util_percent": 14.463999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.06341579716286, "action_adversary": -286.06341579716286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4833738815134354, "mean_processing_ms": 2.447541947567148, "mean_inference_ms": 0.9708018786653159}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2176512, "num_steps_sampled": 2180000, "sample_time_ms": 12677.011, "load_time_ms": 34.611, "grad_time_ms": 4987.122, "update_time_ms": 7.806, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 791.041259765625, "policy_loss": -0.010238218121230602, "vf_loss": 791.05126953125, "vf_explained_var": 0.6950074434280396, "kl": 0.014375035651028156, "entropy": 29.36768913269043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 784.0332641601562, "policy_loss": 0.0009283007821068168, "vf_loss": 784.0308837890625, "vf_explained_var": 0.7054354548454285, "kl": 0.02016519196331501, "entropy": 1.5293338298797607, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2180000, "episodes_total": 4370, "training_iteration": 109, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-54-56", "timestamp": 1567648496, "time_this_iter_s": 17.652501821517944, "time_total_s": 1935.1037418842316, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c9d08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1935.1037418842316, "timesteps_since_restore": 2180000, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 31.528000000000002, "ram_util_percent": 14.471999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 286.94210355868324, "action_adversary": -286.94210355868324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4834384009239687, "mean_processing_ms": 2.4475480441398982, "mean_inference_ms": 0.9711955746751272}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196480, "num_steps_sampled": 2200000, "sample_time_ms": 12660.028, "load_time_ms": 34.587, "grad_time_ms": 4984.955, "update_time_ms": 7.698, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 793.3079223632812, "policy_loss": -0.008641289547085762, "vf_loss": 793.3162841796875, "vf_explained_var": 0.692561149597168, "kl": 0.013456500135362148, "entropy": 29.320518493652344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 787.2697143554688, "policy_loss": 0.0019639362581074238, "vf_loss": 787.2662963867188, "vf_explained_var": 0.703436553478241, "kl": 0.020687680691480637, "entropy": 1.5270726680755615, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2200000, "episodes_total": 4410, "training_iteration": 110, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-55-14", "timestamp": 1567648514, "time_this_iter_s": 17.690884351730347, "time_total_s": 1952.794626235962, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c31e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1952.794626235962, "timesteps_since_restore": 2200000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 30.980769230769234, "ram_util_percent": 14.5}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 285.30186814146595, "action_adversary": -285.30186814146595}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4834930492081213, "mean_processing_ms": 2.4475769977593016, "mean_inference_ms": 0.9715575442096679}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2216448, "num_steps_sampled": 2220000, "sample_time_ms": 12645.937, "load_time_ms": 34.551, "grad_time_ms": 4983.339, "update_time_ms": 7.616, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 797.4304809570312, "policy_loss": -0.01157977432012558, "vf_loss": 797.4418334960938, "vf_explained_var": 0.6897903084754944, "kl": 0.01547829620540142, "entropy": 29.29523468017578, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 791.6630249023438, "policy_loss": -0.0007524280226789415, "vf_loss": 791.6625366210938, "vf_explained_var": 0.696295440196991, "kl": 0.017078397795557976, "entropy": 1.5494667291641235, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2220000, "episodes_total": 4450, "training_iteration": 111, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-55-32", "timestamp": 1567648532, "time_this_iter_s": 17.645458459854126, "time_total_s": 1970.440084695816, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d255a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1970.440084695816, "timesteps_since_restore": 2220000, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 31.407999999999998, "ram_util_percent": 14.508}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 287.6928083854546, "action_adversary": -287.6928083854546}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4835826165602084, "mean_processing_ms": 2.4476131056489034, "mean_inference_ms": 0.9718995066449257}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2236416, "num_steps_sampled": 2240000, "sample_time_ms": 12618.795, "load_time_ms": 34.52, "grad_time_ms": 4982.841, "update_time_ms": 7.553, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 803.2252807617188, "policy_loss": -0.010941109620034695, "vf_loss": 803.236083984375, "vf_explained_var": 0.6787771582603455, "kl": 0.015558636747300625, "entropy": 29.284366607666016, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 801.4092407226562, "policy_loss": 0.002681061392650008, "vf_loss": 801.4051513671875, "vf_explained_var": 0.6898216009140015, "kl": 0.020146379247307777, "entropy": 1.5423442125320435, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2240000, "episodes_total": 4490, "training_iteration": 112, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-55-49", "timestamp": 1567648549, "time_this_iter_s": 17.653589010238647, "time_total_s": 1988.0936737060547, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880612488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1988.0936737060547, "timesteps_since_restore": 2240000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 31.544, "ram_util_percent": 14.475999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.6915445070834, "action_adversary": -288.6915445070834}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4835837505162353, "mean_processing_ms": 2.4476420777221777, "mean_inference_ms": 0.9721569032519668}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2256384, "num_steps_sampled": 2260000, "sample_time_ms": 12632.292, "load_time_ms": 34.553, "grad_time_ms": 4981.965, "update_time_ms": 7.572, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 835.3995361328125, "policy_loss": -0.00976194441318512, "vf_loss": 835.4092407226562, "vf_explained_var": 0.6714814305305481, "kl": 0.014763093553483486, "entropy": 29.45802116394043, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 842.3088989257812, "policy_loss": 0.003328869352117181, "vf_loss": 842.303466796875, "vf_explained_var": 0.6769315004348755, "kl": 0.029667433351278305, "entropy": 1.4955530166625977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2260000, "episodes_total": 4530, "training_iteration": 113, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-56-07", "timestamp": 1567648567, "time_this_iter_s": 17.65812611579895, "time_total_s": 2005.7517998218536, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d27e1e0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2005.7517998218536, "timesteps_since_restore": 2260000, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 31.139999999999997, "ram_util_percent": 14.48}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 288.2581104597872, "action_adversary": -288.2581104597872}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4835752992215516, "mean_processing_ms": 2.447651629525412, "mean_inference_ms": 0.9723846157706721}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2276352, "num_steps_sampled": 2280000, "sample_time_ms": 12625.671, "load_time_ms": 34.523, "grad_time_ms": 4982.93, "update_time_ms": 7.845, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 847.1690673828125, "policy_loss": -0.010180645622313023, "vf_loss": 847.1790771484375, "vf_explained_var": 0.6739467978477478, "kl": 0.016217518597841263, "entropy": 29.48249626159668, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 853.6954956054688, "policy_loss": 0.0010466963285580277, "vf_loss": 853.693115234375, "vf_explained_var": 0.683520495891571, "kl": 0.020597923547029495, "entropy": 1.5100066661834717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2280000, "episodes_total": 4570, "training_iteration": 114, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-56-25", "timestamp": 1567648585, "time_this_iter_s": 17.661710739135742, "time_total_s": 2023.4135105609894, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1e8488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2023.4135105609894, "timesteps_since_restore": 2280000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 31.408, "ram_util_percent": 14.452}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 291.1971004395143, "action_adversary": -291.1971004395143}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483555581440221, "mean_processing_ms": 2.4476572435677175, "mean_inference_ms": 0.9726086699423152}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2296320, "num_steps_sampled": 2300000, "sample_time_ms": 12625.476, "load_time_ms": 34.502, "grad_time_ms": 4982.99, "update_time_ms": 7.808, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 850.572509765625, "policy_loss": -0.009385748766362667, "vf_loss": 850.5817260742188, "vf_explained_var": 0.6705288887023926, "kl": 0.013879265636205673, "entropy": 29.403852462768555, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 858.2003173828125, "policy_loss": 0.0007371543324552476, "vf_loss": 858.1983032226562, "vf_explained_var": 0.6863054037094116, "kl": 0.018208812922239304, "entropy": 1.5170528888702393, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2300000, "episodes_total": 4610, "training_iteration": 115, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-56-42", "timestamp": 1567648602, "time_this_iter_s": 17.694775342941284, "time_total_s": 2041.1082859039307, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d40d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2041.1082859039307, "timesteps_since_restore": 2300000, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 30.284615384615385, "ram_util_percent": 14.550000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.6180424207823, "action_adversary": -292.6180424207823}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483488599074049, "mean_processing_ms": 2.4476776913417893, "mean_inference_ms": 0.9728115528258457}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2316288, "num_steps_sampled": 2320000, "sample_time_ms": 12614.07, "load_time_ms": 34.463, "grad_time_ms": 4981.465, "update_time_ms": 7.802, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 861.9615478515625, "policy_loss": -0.009836805053055286, "vf_loss": 861.9711303710938, "vf_explained_var": 0.6642406582832336, "kl": 0.014499966986477375, "entropy": 29.367637634277344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 869.34326171875, "policy_loss": 0.0016617068322375417, "vf_loss": 869.34033203125, "vf_explained_var": 0.6757310032844543, "kl": 0.017990414053201675, "entropy": 1.5338308811187744, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2320000, "episodes_total": 4650, "training_iteration": 116, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-57-00", "timestamp": 1567648620, "time_this_iter_s": 17.6254460811615, "time_total_s": 2058.733731985092, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d230ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2058.733731985092, "timesteps_since_restore": 2320000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 31.352000000000004, "ram_util_percent": 14.448000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 290.774356526777, "action_adversary": -290.774356526777}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483538352521144, "mean_processing_ms": 2.447700171168009, "mean_inference_ms": 0.9730739269532459}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2336256, "num_steps_sampled": 2340000, "sample_time_ms": 12626.761, "load_time_ms": 34.478, "grad_time_ms": 4981.636, "update_time_ms": 7.773, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 873.2970581054688, "policy_loss": -0.010075419209897518, "vf_loss": 873.3070068359375, "vf_explained_var": 0.6736103892326355, "kl": 0.013630492612719536, "entropy": 29.352460861206055, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 878.8626098632812, "policy_loss": 0.0007966425619088113, "vf_loss": 878.8603515625, "vf_explained_var": 0.6848770380020142, "kl": 0.019533196464180946, "entropy": 1.5363975763320923, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2340000, "episodes_total": 4690, "training_iteration": 117, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-57-18", "timestamp": 1567648638, "time_this_iter_s": 17.72563672065735, "time_total_s": 2076.4593687057495, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d25c268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2076.4593687057495, "timesteps_since_restore": 2340000, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.491999999999997, "ram_util_percent": 14.492}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 291.308606360448, "action_adversary": -291.308606360448}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483557727732097, "mean_processing_ms": 2.4476999425343, "mean_inference_ms": 0.9732911617682638}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2356224, "num_steps_sampled": 2360000, "sample_time_ms": 12637.484, "load_time_ms": 34.729, "grad_time_ms": 4980.241, "update_time_ms": 7.813, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 876.8125, "policy_loss": -0.009037408977746964, "vf_loss": 876.8214111328125, "vf_explained_var": 0.6616601943969727, "kl": 0.014263761229813099, "entropy": 29.31838035583496, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 879.7342529296875, "policy_loss": 0.002153694164007902, "vf_loss": 879.7303466796875, "vf_explained_var": 0.6746287941932678, "kl": 0.024608250707387924, "entropy": 1.5164122581481934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2360000, "episodes_total": 4730, "training_iteration": 118, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-57-36", "timestamp": 1567648656, "time_this_iter_s": 17.764726161956787, "time_total_s": 2094.2240948677063, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d294840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2094.2240948677063, "timesteps_since_restore": 2360000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 31.092000000000002, "ram_util_percent": 14.452}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.15147239994616, "action_adversary": -292.15147239994616}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483471622723316, "mean_processing_ms": 2.44769006649045, "mean_inference_ms": 0.9734513137114547}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2376192, "num_steps_sampled": 2380000, "sample_time_ms": 12632.536, "load_time_ms": 34.809, "grad_time_ms": 4981.049, "update_time_ms": 7.79, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 882.02001953125, "policy_loss": -0.011103776283562183, "vf_loss": 882.0308227539062, "vf_explained_var": 0.6641519069671631, "kl": 0.01603061333298683, "entropy": 29.29061508178711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 884.4467163085938, "policy_loss": 0.0021680050995200872, "vf_loss": 884.442626953125, "vf_explained_var": 0.6753875613212585, "kl": 0.025479456409811974, "entropy": 1.5217407941818237, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2380000, "episodes_total": 4770, "training_iteration": 119, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-57-53", "timestamp": 1567648673, "time_this_iter_s": 17.61212706565857, "time_total_s": 2111.836221933365, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d291158>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2111.836221933365, "timesteps_since_restore": 2380000, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 30.342307692307692, "ram_util_percent": 14.52692307692308}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 290.5277823247142, "action_adversary": -290.5277823247142}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4833627908214755, "mean_processing_ms": 2.44767229941431, "mean_inference_ms": 0.9736265853586954}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2396160, "num_steps_sampled": 2400000, "sample_time_ms": 12622.773, "load_time_ms": 34.503, "grad_time_ms": 4981.578, "update_time_ms": 7.764, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 891.3463745117188, "policy_loss": -0.01141486968845129, "vf_loss": 891.3575439453125, "vf_explained_var": 0.6695786714553833, "kl": 0.016819600015878677, "entropy": 29.15519905090332, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 892.5430908203125, "policy_loss": 0.001732445671223104, "vf_loss": 892.5396728515625, "vf_explained_var": 0.6797084212303162, "kl": 0.022687453776597977, "entropy": 1.5096818208694458, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2400000, "episodes_total": 4810, "training_iteration": 120, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-58-11", "timestamp": 1567648691, "time_this_iter_s": 17.594361782073975, "time_total_s": 2129.430583715439, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806ed2f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2129.430583715439, "timesteps_since_restore": 2400000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 31.188, "ram_util_percent": 14.504000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.0092181765331, "action_adversary": -292.0092181765331}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483230424292169, "mean_processing_ms": 2.4476405450133516, "mean_inference_ms": 0.9738114651981203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2416128, "num_steps_sampled": 2420000, "sample_time_ms": 12628.633, "load_time_ms": 34.535, "grad_time_ms": 4983.085, "update_time_ms": 7.79, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 896.9942626953125, "policy_loss": -0.009958695620298386, "vf_loss": 897.0040893554688, "vf_explained_var": 0.6627803444862366, "kl": 0.01400730200111866, "entropy": 29.102651596069336, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 897.0790405273438, "policy_loss": 0.0009678739588707685, "vf_loss": 897.0771484375, "vf_explained_var": 0.6776072382926941, "kl": 0.013433961197733879, "entropy": 1.4847795963287354, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2420000, "episodes_total": 4850, "training_iteration": 121, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-58-29", "timestamp": 1567648709, "time_this_iter_s": 17.719065189361572, "time_total_s": 2147.1496489048004, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806edae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2147.1496489048004, "timesteps_since_restore": 2420000, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 31.46, "ram_util_percent": 14.58}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.6925185188448, "action_adversary": -292.6925185188448}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.483157388976871, "mean_processing_ms": 2.447612321250149, "mean_inference_ms": 0.9739841440342286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2436096, "num_steps_sampled": 2440000, "sample_time_ms": 12626.899, "load_time_ms": 34.524, "grad_time_ms": 4982.918, "update_time_ms": 7.839, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 902.3585815429688, "policy_loss": -0.01161098200827837, "vf_loss": 902.3699951171875, "vf_explained_var": 0.6639599800109863, "kl": 0.016439566388726234, "entropy": 29.073558807373047, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 904.63232421875, "policy_loss": -7.21663236618042e-05, "vf_loss": 904.6312866210938, "vf_explained_var": 0.6749667525291443, "kl": 0.01633109152317047, "entropy": 1.483203411102295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2440000, "episodes_total": 4890, "training_iteration": 122, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-58-46", "timestamp": 1567648726, "time_this_iter_s": 17.634894847869873, "time_total_s": 2164.7845437526703, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1bc8c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2164.7845437526703, "timesteps_since_restore": 2440000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 31.188, "ram_util_percent": 14.464}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.4426598593843, "action_adversary": -292.4426598593843}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4830620807182897, "mean_processing_ms": 2.4475941453381806, "mean_inference_ms": 0.9741679099343961}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2456064, "num_steps_sampled": 2460000, "sample_time_ms": 12621.994, "load_time_ms": 34.524, "grad_time_ms": 4983.222, "update_time_ms": 7.808, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 914.9267578125, "policy_loss": -0.010160696692764759, "vf_loss": 914.9367065429688, "vf_explained_var": 0.6657931804656982, "kl": 0.015486550517380238, "entropy": 29.076810836791992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.0721626877784729, "cur_lr": 4.999999873689376e-05, "total_loss": 916.963134765625, "policy_loss": 0.00385328964330256, "vf_loss": 916.955810546875, "vf_explained_var": 0.6763410568237305, "kl": 0.047402895987033844, "entropy": 1.4628487825393677, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2460000, "episodes_total": 4930, "training_iteration": 123, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-59-04", "timestamp": 1567648744, "time_this_iter_s": 17.609532833099365, "time_total_s": 2182.3940765857697, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1b2a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2182.3940765857697, "timesteps_since_restore": 2460000, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 31.011999999999997, "ram_util_percent": 14.528000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.3605593883037, "action_adversary": -292.3605593883037}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4829341186363685, "mean_processing_ms": 2.4475849391786277, "mean_inference_ms": 0.9743908582246354}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2476032, "num_steps_sampled": 2480000, "sample_time_ms": 12625.065, "load_time_ms": 34.532, "grad_time_ms": 4982.425, "update_time_ms": 7.541, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 919.6416015625, "policy_loss": -0.01118342112749815, "vf_loss": 919.6525268554688, "vf_explained_var": 0.6606075763702393, "kl": 0.01633792743086815, "entropy": 29.053661346435547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 918.7251586914062, "policy_loss": -0.00015929073560982943, "vf_loss": 918.7225341796875, "vf_explained_var": 0.672976553440094, "kl": 0.025100933387875557, "entropy": 1.456339716911316, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2480000, "episodes_total": 4970, "training_iteration": 124, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-59-21", "timestamp": 1567648761, "time_this_iter_s": 17.68120265007019, "time_total_s": 2200.07527923584, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d291048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2200.07527923584, "timesteps_since_restore": 2480000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 30.546153846153842, "ram_util_percent": 14.530769230769234}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 294.33575079807923, "action_adversary": -294.33575079807923}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4827228767778866, "mean_processing_ms": 2.447582931148253, "mean_inference_ms": 0.9746434676120365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2496000, "num_steps_sampled": 2500000, "sample_time_ms": 12622.16, "load_time_ms": 34.277, "grad_time_ms": 4982.663, "update_time_ms": 7.575, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 924.048095703125, "policy_loss": -0.010879886336624622, "vf_loss": 924.0587768554688, "vf_explained_var": 0.656539797782898, "kl": 0.0154289985075593, "entropy": 29.057636260986328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 925.1490478515625, "policy_loss": 0.0006301601533778012, "vf_loss": 925.1463623046875, "vf_explained_var": 0.6693474054336548, "kl": 0.01866278052330017, "entropy": 1.465653657913208, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2500000, "episodes_total": 5010, "training_iteration": 125, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-59-39", "timestamp": 1567648779, "time_this_iter_s": 17.66604471206665, "time_total_s": 2217.7413239479065, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d25c9d8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2217.7413239479065, "timesteps_since_restore": 2500000, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 31.156, "ram_util_percent": 14.52}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 296.44038662193924, "action_adversary": -296.44038662193924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.482477352004068, "mean_processing_ms": 2.4475692375540716, "mean_inference_ms": 0.9748737632841081}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2515968, "num_steps_sampled": 2520000, "sample_time_ms": 12617.191, "load_time_ms": 34.257, "grad_time_ms": 4982.903, "update_time_ms": 7.586, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 927.5488891601562, "policy_loss": -0.010071090422570705, "vf_loss": 927.5587768554688, "vf_explained_var": 0.6580867767333984, "kl": 0.016034843400120735, "entropy": 28.98643684387207, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 929.6766967773438, "policy_loss": 0.001059918780811131, "vf_loss": 929.6734619140625, "vf_explained_var": 0.6688950657844543, "kl": 0.020041953772306442, "entropy": 1.474688172340393, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2520000, "episodes_total": 5050, "training_iteration": 126, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_01-59-57", "timestamp": 1567648797, "time_this_iter_s": 17.57704997062683, "time_total_s": 2235.3183739185333, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806d4b70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2235.3183739185333, "timesteps_since_restore": 2520000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 31.020000000000003, "ram_util_percent": 14.512000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 296.56233468188174, "action_adversary": -296.56233468188174}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4822431325523255, "mean_processing_ms": 2.4475589660348165, "mean_inference_ms": 0.9751004674107481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2535936, "num_steps_sampled": 2540000, "sample_time_ms": 12608.219, "load_time_ms": 34.237, "grad_time_ms": 4982.799, "update_time_ms": 7.556, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 934.220947265625, "policy_loss": -0.011260125786066055, "vf_loss": 934.2319946289062, "vf_explained_var": 0.6533538699150085, "kl": 0.015427231788635254, "entropy": 28.949779510498047, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 939.2514038085938, "policy_loss": 0.000376003299606964, "vf_loss": 939.248779296875, "vf_explained_var": 0.6546024680137634, "kl": 0.021593565121293068, "entropy": 1.477092981338501, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2540000, "episodes_total": 5090, "training_iteration": 127, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-00-14", "timestamp": 1567648814, "time_this_iter_s": 17.635014057159424, "time_total_s": 2252.9533879756927, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806ed6a8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2252.9533879756927, "timesteps_since_restore": 2540000, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 31.452, "ram_util_percent": 14.508000000000003}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 295.4295187454772, "action_adversary": -295.4295187454772}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4819843130396695, "mean_processing_ms": 2.447553231830117, "mean_inference_ms": 0.9753121779484508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2555904, "num_steps_sampled": 2560000, "sample_time_ms": 12594.948, "load_time_ms": 33.949, "grad_time_ms": 4983.821, "update_time_ms": 7.568, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 941.66357421875, "policy_loss": -0.010038268752396107, "vf_loss": 941.6734008789062, "vf_explained_var": 0.6573939323425293, "kl": 0.016907287761569023, "entropy": 28.824399948120117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 941.5739135742188, "policy_loss": 0.000244130875216797, "vf_loss": 941.5717163085938, "vf_explained_var": 0.6588831543922424, "kl": 0.019173514097929, "entropy": 1.4843499660491943, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2560000, "episodes_total": 5130, "training_iteration": 128, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-00-32", "timestamp": 1567648832, "time_this_iter_s": 17.63830804824829, "time_total_s": 2270.591696023941, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1e8268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2270.591696023941, "timesteps_since_restore": 2560000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 31.152, "ram_util_percent": 14.528000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.4392900833331, "action_adversary": -293.4392900833331}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4817986985475473, "mean_processing_ms": 2.4475670313654585, "mean_inference_ms": 0.9755802742652228}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2575872, "num_steps_sampled": 2580000, "sample_time_ms": 12604.78, "load_time_ms": 34.032, "grad_time_ms": 4984.373, "update_time_ms": 7.869, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 948.4957885742188, "policy_loss": -0.008883378468453884, "vf_loss": 948.5045166015625, "vf_explained_var": 0.6545140147209167, "kl": 0.01508115790784359, "entropy": 28.814228057861328, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 951.9359130859375, "policy_loss": -3.7078720197314397e-05, "vf_loss": 951.9342041015625, "vf_explained_var": 0.6581549048423767, "kl": 0.015676317736506462, "entropy": 1.467810034751892, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2580000, "episodes_total": 5170, "training_iteration": 129, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-00-50", "timestamp": 1567648850, "time_this_iter_s": 17.71941637992859, "time_total_s": 2288.3111124038696, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1f8620>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2288.3111124038696, "timesteps_since_restore": 2580000, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 31.671999999999997, "ram_util_percent": 14.588000000000001}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.55257891637956, "action_adversary": -292.55257891637956}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4816217440394723, "mean_processing_ms": 2.447584109123663, "mean_inference_ms": 0.9758451274597877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2595840, "num_steps_sampled": 2600000, "sample_time_ms": 12608.553, "load_time_ms": 34.44, "grad_time_ms": 4984.933, "update_time_ms": 7.864, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 954.5865478515625, "policy_loss": -0.01155519112944603, "vf_loss": 954.5979614257812, "vf_explained_var": 0.6616531610488892, "kl": 0.01595734804868698, "entropy": 28.80604362487793, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 956.139404296875, "policy_loss": 0.00027811870677396655, "vf_loss": 956.1378173828125, "vf_explained_var": 0.6634076237678528, "kl": 0.013159639202058315, "entropy": 1.4624987840652466, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2600000, "episodes_total": 5210, "training_iteration": 130, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-01-07", "timestamp": 1567648867, "time_this_iter_s": 17.643502473831177, "time_total_s": 2305.954614877701, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806122f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2305.954614877701, "timesteps_since_restore": 2600000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 30.211538461538467, "ram_util_percent": 14.503846153846155}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.4043670975063, "action_adversary": -293.4043670975063}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4813693036138904, "mean_processing_ms": 2.4475885656676497, "mean_inference_ms": 0.9760771061788998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2615808, "num_steps_sampled": 2620000, "sample_time_ms": 12608.19, "load_time_ms": 34.456, "grad_time_ms": 4984.734, "update_time_ms": 7.933, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 955.6651611328125, "policy_loss": -0.010591905564069748, "vf_loss": 955.6754760742188, "vf_explained_var": 0.662206768989563, "kl": 0.015316929668188095, "entropy": 28.83277702331543, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 955.7654418945312, "policy_loss": 0.0010494169546291232, "vf_loss": 955.7621459960938, "vf_explained_var": 0.6590504050254822, "kl": 0.021368371322751045, "entropy": 1.4544010162353516, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2620000, "episodes_total": 5250, "training_iteration": 131, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-01-25", "timestamp": 1567648885, "time_this_iter_s": 17.713279485702515, "time_total_s": 2323.6678943634033, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805dde18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2323.6678943634033, "timesteps_since_restore": 2620000, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 31.004, "ram_util_percent": 14.512000000000002}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 296.1779382008851, "action_adversary": -296.1779382008851}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4811565073063915, "mean_processing_ms": 2.4475788417389195, "mean_inference_ms": 0.9762832733513611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2635776, "num_steps_sampled": 2640000, "sample_time_ms": 12605.045, "load_time_ms": 34.472, "grad_time_ms": 4984.122, "update_time_ms": 7.946, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 961.87451171875, "policy_loss": -0.010800921358168125, "vf_loss": 961.885009765625, "vf_explained_var": 0.6556286811828613, "kl": 0.015750588849186897, "entropy": 28.835342407226562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 963.2674560546875, "policy_loss": 0.0007269303896464407, "vf_loss": 963.2648315429688, "vf_explained_var": 0.654395580291748, "kl": 0.017309535294771194, "entropy": 1.4560565948486328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2640000, "episodes_total": 5290, "training_iteration": 132, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-01-43", "timestamp": 1567648903, "time_this_iter_s": 17.596960306167603, "time_total_s": 2341.264854669571, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c3378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2341.264854669571, "timesteps_since_restore": 2640000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 31.328000000000003, "ram_util_percent": 14.592}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 294.69072155123763, "action_adversary": -294.69072155123763}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4808806170114206, "mean_processing_ms": 2.4475603749309713, "mean_inference_ms": 0.976528883883349}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2655744, "num_steps_sampled": 2660000, "sample_time_ms": 12602.766, "load_time_ms": 34.511, "grad_time_ms": 4984.359, "update_time_ms": 8.001, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 958.3836059570312, "policy_loss": -0.01128198392689228, "vf_loss": 958.3947143554688, "vf_explained_var": 0.6566733121871948, "kl": 0.016403842717409134, "entropy": 28.78476905822754, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 1059.4835205078125, "policy_loss": -0.00036865301080979407, "vf_loss": 1059.482177734375, "vf_explained_var": 0.6205930709838867, "kl": 0.016688872128725052, "entropy": 1.4623934030532837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2660000, "episodes_total": 5330, "training_iteration": 133, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-02-00", "timestamp": 1567648920, "time_this_iter_s": 17.590270042419434, "time_total_s": 2358.8551247119904, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c3400>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2358.8551247119904, "timesteps_since_restore": 2660000, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 31.08, "ram_util_percent": 14.508000000000003}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.08173040596046, "action_adversary": -292.08173040596046}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4804659873176784, "mean_processing_ms": 2.447561824787808, "mean_inference_ms": 0.9768041455505713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2675712, "num_steps_sampled": 2680000, "sample_time_ms": 12585.14, "load_time_ms": 34.509, "grad_time_ms": 4984.485, "update_time_ms": 8.001, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 972.0388793945312, "policy_loss": -0.011223409324884415, "vf_loss": 972.0498657226562, "vf_explained_var": 0.6610078811645508, "kl": 0.016061123460531235, "entropy": 28.718481063842773, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 1025.298828125, "policy_loss": 0.0012134897988289595, "vf_loss": 1025.2960205078125, "vf_explained_var": 0.6322384476661682, "kl": 0.014984235167503357, "entropy": 1.4775502681732178, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2680000, "episodes_total": 5370, "training_iteration": 134, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-02-18", "timestamp": 1567648938, "time_this_iter_s": 17.507598876953125, "time_total_s": 2376.3627235889435, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d260048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2376.3627235889435, "timesteps_since_restore": 2680000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 31.248, "ram_util_percent": 14.595999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 291.6761009755576, "action_adversary": -291.6761009755576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.479842456130207, "mean_processing_ms": 2.4475578284390003, "mean_inference_ms": 0.9770584891622616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2695680, "num_steps_sampled": 2700000, "sample_time_ms": 12567.793, "load_time_ms": 34.743, "grad_time_ms": 4983.455, "update_time_ms": 7.974, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 971.2648315429688, "policy_loss": -0.009920977987349033, "vf_loss": 971.274658203125, "vf_explained_var": 0.6608067750930786, "kl": 0.014367233030498028, "entropy": 28.695938110351562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.10824403166770935, "cur_lr": 4.999999873689376e-05, "total_loss": 1005.2479858398438, "policy_loss": 0.004151048604398966, "vf_loss": 1005.23876953125, "vf_explained_var": 0.6441543698310852, "kl": 0.04580427333712578, "entropy": 1.45554780960083, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2700000, "episodes_total": 5410, "training_iteration": 135, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-02-35", "timestamp": 1567648955, "time_this_iter_s": 17.48405957221985, "time_total_s": 2393.8467831611633, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28dbf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2393.8467831611633, "timesteps_since_restore": 2700000, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 30.863999999999997, "ram_util_percent": 14.6}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.9609403486964, "action_adversary": -292.9609403486964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4791781640120605, "mean_processing_ms": 2.447544204553946, "mean_inference_ms": 0.9772961637228315}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2715648, "num_steps_sampled": 2720000, "sample_time_ms": 12566.764, "load_time_ms": 34.736, "grad_time_ms": 4983.235, "update_time_ms": 7.987, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 977.6721801757812, "policy_loss": -0.009986764751374722, "vf_loss": 977.681884765625, "vf_explained_var": 0.6564220786094666, "kl": 0.014301137998700142, "entropy": 28.72844123840332, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 985.1242065429688, "policy_loss": -0.0006826126482337713, "vf_loss": 985.1221923828125, "vf_explained_var": 0.6491438746452332, "kl": 0.01681371219456196, "entropy": 1.4693856239318848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2720000, "episodes_total": 5450, "training_iteration": 136, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-02-53", "timestamp": 1567648973, "time_this_iter_s": 17.565216541290283, "time_total_s": 2411.4119997024536, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f0d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2411.4119997024536, "timesteps_since_restore": 2720000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 31.171999999999997, "ram_util_percent": 14.515999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.510844444668, "action_adversary": -292.510844444668}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.478488354711554, "mean_processing_ms": 2.4475087056569915, "mean_inference_ms": 0.9774790373456612}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2735616, "num_steps_sampled": 2740000, "sample_time_ms": 12553.353, "load_time_ms": 34.712, "grad_time_ms": 4983.18, "update_time_ms": 8.037, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 982.4967651367188, "policy_loss": -0.010589455254375935, "vf_loss": 982.5072021484375, "vf_explained_var": 0.6578195095062256, "kl": 0.01691436767578125, "entropy": 28.678115844726562, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 982.2801513671875, "policy_loss": 0.0002455551002640277, "vf_loss": 982.2776489257812, "vf_explained_var": 0.6511961221694946, "kl": 0.0135852862149477, "entropy": 1.4621738195419312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2740000, "episodes_total": 5490, "training_iteration": 137, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-03-11", "timestamp": 1567648991, "time_this_iter_s": 17.498923540115356, "time_total_s": 2428.910923242569, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805538c8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2428.910923242569, "timesteps_since_restore": 2740000, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 30.744, "ram_util_percent": 14.58}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 292.87318680494934, "action_adversary": -292.87318680494934}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4778147971852964, "mean_processing_ms": 2.447499473004453, "mean_inference_ms": 0.9776734511789877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2755584, "num_steps_sampled": 2760000, "sample_time_ms": 12542.953, "load_time_ms": 35.004, "grad_time_ms": 4982.694, "update_time_ms": 8.001, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 982.9835815429688, "policy_loss": -0.009259133599698544, "vf_loss": 982.9926147460938, "vf_explained_var": 0.6582902073860168, "kl": 0.01498120091855526, "entropy": 28.584091186523438, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 973.9306030273438, "policy_loss": 0.0008718795725144446, "vf_loss": 973.9273071289062, "vf_explained_var": 0.6501572132110596, "kl": 0.01441870629787445, "entropy": 1.4394577741622925, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2760000, "episodes_total": 5530, "training_iteration": 138, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-03-28", "timestamp": 1567649008, "time_this_iter_s": 17.535038471221924, "time_total_s": 2446.445961713791, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28806b8ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2446.445961713791, "timesteps_since_restore": 2760000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 31.108, "ram_util_percent": 14.6}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.609604275975, "action_adversary": -293.609604275975}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.477289286617801, "mean_processing_ms": 2.4475079501885304, "mean_inference_ms": 0.9779379467900767}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2775552, "num_steps_sampled": 2780000, "sample_time_ms": 12533.457, "load_time_ms": 34.681, "grad_time_ms": 4983.0, "update_time_ms": 7.712, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 987.2050170898438, "policy_loss": -0.010338532738387585, "vf_loss": 987.2151489257812, "vf_explained_var": 0.6536141633987427, "kl": 0.014988234266638756, "entropy": 28.580034255981445, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 978.8776245117188, "policy_loss": 0.0011252840049564838, "vf_loss": 978.8742065429688, "vf_explained_var": 0.6486606001853943, "kl": 0.014559922739863396, "entropy": 1.4417724609375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2780000, "episodes_total": 5570, "training_iteration": 139, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-03-46", "timestamp": 1567649026, "time_this_iter_s": 17.620993852615356, "time_total_s": 2464.0669555664062, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d21f488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2464.0669555664062, "timesteps_since_restore": 2780000, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 31.539999999999996, "ram_util_percent": 14.576}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.6763917319271, "action_adversary": -293.6763917319271}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4768154503898057, "mean_processing_ms": 2.4475268909459804, "mean_inference_ms": 0.9782103661543377}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2795520, "num_steps_sampled": 2800000, "sample_time_ms": 12522.823, "load_time_ms": 34.578, "grad_time_ms": 4982.347, "update_time_ms": 7.735, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 989.9801635742188, "policy_loss": -0.00966204795986414, "vf_loss": 989.9898071289062, "vf_explained_var": 0.6480770111083984, "kl": 0.014871847815811634, "entropy": 28.58309555053711, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 977.7029418945312, "policy_loss": 0.0006588174146600068, "vf_loss": 977.7000122070312, "vf_explained_var": 0.6494015455245972, "kl": 0.01402520202100277, "entropy": 1.4579803943634033, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2800000, "episodes_total": 5610, "training_iteration": 140, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-04-03", "timestamp": 1567649043, "time_this_iter_s": 17.528399229049683, "time_total_s": 2481.595354795456, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d202ea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2481.595354795456, "timesteps_since_restore": 2800000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 30.872000000000003, "ram_util_percent": 14.611999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.436535300872, "action_adversary": -293.436535300872}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.476252667392542, "mean_processing_ms": 2.447532476030144, "mean_inference_ms": 0.9784416199494084}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2815488, "num_steps_sampled": 2820000, "sample_time_ms": 12510.173, "load_time_ms": 34.514, "grad_time_ms": 4982.585, "update_time_ms": 7.905, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 994.470947265625, "policy_loss": -0.011243030428886414, "vf_loss": 994.4819946289062, "vf_explained_var": 0.6429728269577026, "kl": 0.016555748879909515, "entropy": 28.48084831237793, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 982.353759765625, "policy_loss": -0.0013584318803623319, "vf_loss": 982.3531494140625, "vf_explained_var": 0.6424006223678589, "kl": 0.01275665033608675, "entropy": 1.4521682262420654, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2820000, "episodes_total": 5650, "training_iteration": 141, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-04-21", "timestamp": 1567649061, "time_this_iter_s": 17.59102511405945, "time_total_s": 2499.1863799095154, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d29cb70>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2499.1863799095154, "timesteps_since_restore": 2820000, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 30.96, "ram_util_percent": 14.643999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 294.2745596168629, "action_adversary": -294.2745596168629}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4756801245804474, "mean_processing_ms": 2.447531756958163, "mean_inference_ms": 0.9786361875570213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2835456, "num_steps_sampled": 2840000, "sample_time_ms": 12499.271, "load_time_ms": 34.498, "grad_time_ms": 4981.496, "update_time_ms": 7.836, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1000.3018798828125, "policy_loss": -0.009273137897253036, "vf_loss": 1000.3109130859375, "vf_explained_var": 0.6365267634391785, "kl": 0.01494087278842926, "entropy": 28.446298599243164, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 987.030029296875, "policy_loss": -0.0004080327635165304, "vf_loss": 987.0284423828125, "vf_explained_var": 0.6381357908248901, "kl": 0.012342783622443676, "entropy": 1.4640357494354248, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2840000, "episodes_total": 5690, "training_iteration": 142, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-04-38", "timestamp": 1567649078, "time_this_iter_s": 17.47816252708435, "time_total_s": 2516.6645424365997, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a0e18>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2516.6645424365997, "timesteps_since_restore": 2840000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 31.028, "ram_util_percent": 14.643999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 295.0267403537838, "action_adversary": -295.0267403537838}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.475233047134624, "mean_processing_ms": 2.447521082581192, "mean_inference_ms": 0.9788062726365356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2855424, "num_steps_sampled": 2860000, "sample_time_ms": 12505.725, "load_time_ms": 34.421, "grad_time_ms": 4978.771, "update_time_ms": 8.134, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1021.9259033203125, "policy_loss": -0.009940160438418388, "vf_loss": 1021.9356689453125, "vf_explained_var": 0.6404761075973511, "kl": 0.016661150380969048, "entropy": 28.55912208557129, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1018.51904296875, "policy_loss": 0.0005447538569569588, "vf_loss": 1018.5159301757812, "vf_explained_var": 0.6374086737632751, "kl": 0.01557484082877636, "entropy": 1.4223886728286743, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2860000, "episodes_total": 5730, "training_iteration": 143, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-04-56", "timestamp": 1567649096, "time_this_iter_s": 17.629369020462036, "time_total_s": 2534.2939114570618, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2190d0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2534.2939114570618, "timesteps_since_restore": 2860000, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.13076923076923, "ram_util_percent": 14.592307692307692}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 296.44376871819145, "action_adversary": -296.44376871819145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4748895063912486, "mean_processing_ms": 2.4475083708136647, "mean_inference_ms": 0.978939820114829}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2875392, "num_steps_sampled": 2880000, "sample_time_ms": 12519.023, "load_time_ms": 34.213, "grad_time_ms": 4977.878, "update_time_ms": 8.228, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1018.311279296875, "policy_loss": -0.01151604950428009, "vf_loss": 1018.322509765625, "vf_explained_var": 0.6317042112350464, "kl": 0.016900772228837013, "entropy": 28.541229248046875, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1019.7680053710938, "policy_loss": 0.0009105518693104386, "vf_loss": 1019.7646484375, "vf_explained_var": 0.6346308588981628, "kl": 0.015244655311107635, "entropy": 1.4186122417449951, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2880000, "episodes_total": 5770, "training_iteration": 144, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-05-14", "timestamp": 1567649114, "time_this_iter_s": 17.628592014312744, "time_total_s": 2551.9225034713745, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d294a60>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2551.9225034713745, "timesteps_since_restore": 2880000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 30.927999999999997, "ram_util_percent": 14.607999999999999}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 298.150215575771, "action_adversary": -298.150215575771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4747026073745775, "mean_processing_ms": 2.447481201730897, "mean_inference_ms": 0.9790523406183786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2895360, "num_steps_sampled": 2900000, "sample_time_ms": 12529.347, "load_time_ms": 34.277, "grad_time_ms": 4976.935, "update_time_ms": 8.22, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1029.2486572265625, "policy_loss": -0.010160615667700768, "vf_loss": 1029.2586669921875, "vf_explained_var": 0.6332690715789795, "kl": 0.015184469521045685, "entropy": 28.463294982910156, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1026.9559326171875, "policy_loss": -0.0008806538535282016, "vf_loss": 1026.9549560546875, "vf_explained_var": 0.6320620775222778, "kl": 0.011417309753596783, "entropy": 1.4084030389785767, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2900000, "episodes_total": 5810, "training_iteration": 145, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-05-31", "timestamp": 1567649131, "time_this_iter_s": 17.57842469215393, "time_total_s": 2569.5009281635284, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1c9378>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2569.5009281635284, "timesteps_since_restore": 2900000, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 31.147999999999996, "ram_util_percent": 14.663999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 298.0095827112443, "action_adversary": -298.0095827112443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.474537214264817, "mean_processing_ms": 2.447469820681088, "mean_inference_ms": 0.9791898129484423}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2915328, "num_steps_sampled": 2920000, "sample_time_ms": 12544.252, "load_time_ms": 34.286, "grad_time_ms": 4974.689, "update_time_ms": 8.482, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1028.1822509765625, "policy_loss": -0.010508459992706776, "vf_loss": 1028.1927490234375, "vf_explained_var": 0.6368971467018127, "kl": 0.015703370794653893, "entropy": 28.40052604675293, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1028.2486572265625, "policy_loss": 0.0008798122289590538, "vf_loss": 1028.2452392578125, "vf_explained_var": 0.6331936120986938, "kl": 0.01554941851645708, "entropy": 1.4097882509231567, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2920000, "episodes_total": 5850, "training_iteration": 146, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-05-49", "timestamp": 1567649149, "time_this_iter_s": 17.693826913833618, "time_total_s": 2587.194755077362, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1dc510>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2587.194755077362, "timesteps_since_restore": 2920000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 31.14, "ram_util_percent": 14.663999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.47886011297294, "action_adversary": -299.47886011297294}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4744348418087, "mean_processing_ms": 2.447463827289833, "mean_inference_ms": 0.9793420735304835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2935296, "num_steps_sampled": 2940000, "sample_time_ms": 12561.526, "load_time_ms": 34.383, "grad_time_ms": 4974.502, "update_time_ms": 8.528, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1032.63525390625, "policy_loss": -0.01085850689560175, "vf_loss": 1032.6458740234375, "vf_explained_var": 0.6367852687835693, "kl": 0.01487648207694292, "entropy": 28.3482666015625, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1035.3880615234375, "policy_loss": -0.0005275526782497764, "vf_loss": 1035.385498046875, "vf_explained_var": 0.6265590190887451, "kl": 0.018675681203603745, "entropy": 1.3986648321151733, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2940000, "episodes_total": 5890, "training_iteration": 147, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-06-07", "timestamp": 1567649167, "time_this_iter_s": 17.67102026939392, "time_total_s": 2604.865775346756, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1dcd90>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2604.865775346756, "timesteps_since_restore": 2940000, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 31.087999999999997, "ram_util_percent": 14.628}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.2576390970907, "action_adversary": -299.2576390970907}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.474260789826724, "mean_processing_ms": 2.4474429354027327, "mean_inference_ms": 0.9794614174014782}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2955264, "num_steps_sampled": 2960000, "sample_time_ms": 12563.914, "load_time_ms": 34.385, "grad_time_ms": 4972.801, "update_time_ms": 8.53, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1031.8372802734375, "policy_loss": -0.012307374738156796, "vf_loss": 1031.849365234375, "vf_explained_var": 0.6328920125961304, "kl": 0.016786647960543633, "entropy": 28.338882446289062, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1034.62060546875, "policy_loss": 0.0021907060872763395, "vf_loss": 1034.615478515625, "vf_explained_var": 0.6313488483428955, "kl": 0.017130305990576744, "entropy": 1.3950601816177368, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2960000, "episodes_total": 5930, "training_iteration": 148, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-06-24", "timestamp": 1567649184, "time_this_iter_s": 17.54081654548645, "time_total_s": 2622.4065918922424, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d16af28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2622.4065918922424, "timesteps_since_restore": 2960000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.996, "ram_util_percent": 14.675999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.102128596836, "action_adversary": -300.102128596836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4740990857980916, "mean_processing_ms": 2.447413952906891, "mean_inference_ms": 0.9795697734996293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2975232, "num_steps_sampled": 2980000, "sample_time_ms": 12569.734, "load_time_ms": 34.808, "grad_time_ms": 4971.079, "update_time_ms": 8.594, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1038.6043701171875, "policy_loss": -0.012481709942221642, "vf_loss": 1038.6165771484375, "vf_explained_var": 0.6276358366012573, "kl": 0.017137369140982628, "entropy": 28.38724136352539, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1043.215087890625, "policy_loss": 0.0005165006150491536, "vf_loss": 1043.2127685546875, "vf_explained_var": 0.6218253970146179, "kl": 0.01260488759726286, "entropy": 1.4055944681167603, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 2980000, "episodes_total": 5970, "training_iteration": 149, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-06-42", "timestamp": 1567649202, "time_this_iter_s": 17.666025638580322, "time_total_s": 2640.0726175308228, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d294840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2640.0726175308228, "timesteps_since_restore": 2980000, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 30.26923076923077, "ram_util_percent": 14.565384615384614}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 300.6787311168053, "action_adversary": -300.6787311168053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4739447685425877, "mean_processing_ms": 2.447394229998215, "mean_inference_ms": 0.9796965059833308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2995200, "num_steps_sampled": 3000000, "sample_time_ms": 12575.756, "load_time_ms": 34.792, "grad_time_ms": 4970.62, "update_time_ms": 8.668, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1040.0718994140625, "policy_loss": -0.010578599758446217, "vf_loss": 1040.082275390625, "vf_explained_var": 0.6271737217903137, "kl": 0.015541448257863522, "entropy": 28.371288299560547, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1043.976806640625, "policy_loss": -0.000365705433068797, "vf_loss": 1043.9752197265625, "vf_explained_var": 0.6210041642189026, "kl": 0.012939144857227802, "entropy": 1.3905688524246216, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3000000, "episodes_total": 6010, "training_iteration": 150, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-07-00", "timestamp": 1567649220, "time_this_iter_s": 17.584794521331787, "time_total_s": 2657.6574120521545, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2a0ae8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2657.6574120521545, "timesteps_since_restore": 3000000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 31.112000000000002, "ram_util_percent": 14.576}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.4797613006981, "action_adversary": -299.4797613006981}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473823997302123, "mean_processing_ms": 2.447396113195966, "mean_inference_ms": 0.9798405794922738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3015168, "num_steps_sampled": 3020000, "sample_time_ms": 12578.797, "load_time_ms": 34.705, "grad_time_ms": 4969.397, "update_time_ms": 8.392, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1043.9012451171875, "policy_loss": -0.010141033679246902, "vf_loss": 1043.9112548828125, "vf_explained_var": 0.6270560026168823, "kl": 0.016871534287929535, "entropy": 28.280269622802734, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1049.2752685546875, "policy_loss": 0.0016936430474743247, "vf_loss": 1049.27099609375, "vf_explained_var": 0.6220220327377319, "kl": 0.01606350764632225, "entropy": 1.3887110948562622, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3020000, "episodes_total": 6050, "training_iteration": 151, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-07-17", "timestamp": 1567649237, "time_this_iter_s": 17.6047465801239, "time_total_s": 2675.2621586322784, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d29cd08>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2675.2621586322784, "timesteps_since_restore": 3020000, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 31.192000000000004, "ram_util_percent": 14.616}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.9183001774845, "action_adversary": -299.9183001774845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473761275263237, "mean_processing_ms": 2.447408268908966, "mean_inference_ms": 0.9800003447360912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3035136, "num_steps_sampled": 3040000, "sample_time_ms": 12592.703, "load_time_ms": 34.751, "grad_time_ms": 4967.706, "update_time_ms": 8.404, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1047.4903564453125, "policy_loss": -0.00934083852916956, "vf_loss": 1047.49951171875, "vf_explained_var": 0.6236816048622131, "kl": 0.01403170358389616, "entropy": 28.312894821166992, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1054.20654296875, "policy_loss": 0.0010119759244844317, "vf_loss": 1054.203369140625, "vf_explained_var": 0.6195996999740601, "kl": 0.01389153953641653, "entropy": 1.3919183015823364, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3040000, "episodes_total": 6090, "training_iteration": 152, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-07-35", "timestamp": 1567649255, "time_this_iter_s": 17.599963903427124, "time_total_s": 2692.8621225357056, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d1dc048>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2692.8621225357056, "timesteps_since_restore": 3040000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 31.208000000000002, "ram_util_percent": 14.679999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 299.61277738757803, "action_adversary": -299.61277738757803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473744750071906, "mean_processing_ms": 2.44741964798519, "mean_inference_ms": 0.9801216478454087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3055104, "num_steps_sampled": 3060000, "sample_time_ms": 12587.313, "load_time_ms": 34.791, "grad_time_ms": 4968.318, "update_time_ms": 8.054, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1031.9437255859375, "policy_loss": -0.009751479141414165, "vf_loss": 1031.953369140625, "vf_explained_var": 0.6129301190376282, "kl": 0.015293153002858162, "entropy": 27.89017105102539, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1029.7508544921875, "policy_loss": 0.0026113553903996944, "vf_loss": 1029.744140625, "vf_explained_var": 0.6147409081459045, "kl": 0.02385224960744381, "entropy": 1.441241979598999, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3060000, "episodes_total": 6130, "training_iteration": 153, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-07-52", "timestamp": 1567649272, "time_this_iter_s": 17.578348398208618, "time_total_s": 2710.440470933914, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d202bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2710.440470933914, "timesteps_since_restore": 3060000, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.016, "ram_util_percent": 14.616}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 297.94072430598254, "action_adversary": -297.94072430598254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473708441472344, "mean_processing_ms": 2.447422336393891, "mean_inference_ms": 0.9801780052512776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3075072, "num_steps_sampled": 3080000, "sample_time_ms": 12580.138, "load_time_ms": 35.002, "grad_time_ms": 4968.297, "update_time_ms": 8.075, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1038.1534423828125, "policy_loss": -0.011006359942257404, "vf_loss": 1038.1641845703125, "vf_explained_var": 0.6065090894699097, "kl": 0.015433221124112606, "entropy": 27.843759536743164, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1034.8087158203125, "policy_loss": 0.006883995607495308, "vf_loss": 1034.7943115234375, "vf_explained_var": 0.6054492592811584, "kl": 0.046890538185834885, "entropy": 1.4344089031219482, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3080000, "episodes_total": 6170, "training_iteration": 154, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-08-10", "timestamp": 1567649290, "time_this_iter_s": 17.55956792831421, "time_total_s": 2728.0000388622284, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d21fea0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2728.0000388622284, "timesteps_since_restore": 3080000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 31.227999999999998, "ram_util_percent": 14.651999999999997}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 295.47862687126167, "action_adversary": -295.47862687126167}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4736816734477385, "mean_processing_ms": 2.447416826023464, "mean_inference_ms": 0.9802257259675184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3095040, "num_steps_sampled": 3100000, "sample_time_ms": 12581.876, "load_time_ms": 34.945, "grad_time_ms": 4970.358, "update_time_ms": 8.045, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1035.494384765625, "policy_loss": -0.010542669333517551, "vf_loss": 1035.5047607421875, "vf_explained_var": 0.611484169960022, "kl": 0.01521607581526041, "entropy": 27.859867095947266, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.24354907870292664, "cur_lr": 4.999999873689376e-05, "total_loss": 1027.5496826171875, "policy_loss": -0.0014156218385323882, "vf_loss": 1027.548828125, "vf_explained_var": 0.6097456216812134, "kl": 0.009426889941096306, "entropy": 1.455728530883789, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3100000, "episodes_total": 6210, "training_iteration": 155, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-08-28", "timestamp": 1567649308, "time_this_iter_s": 17.615848302841187, "time_total_s": 2745.6158871650696, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f2880553bf8>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2745.6158871650696, "timesteps_since_restore": 3100000, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 31.148000000000003, "ram_util_percent": 14.66}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 295.45979175276824, "action_adversary": -295.45979175276824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473640356629, "mean_processing_ms": 2.4474152805689497, "mean_inference_ms": 0.9802955304562287}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3115008, "num_steps_sampled": 3120000, "sample_time_ms": 12576.002, "load_time_ms": 34.947, "grad_time_ms": 4971.345, "update_time_ms": 7.775, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1033.5845947265625, "policy_loss": -0.008794795721769333, "vf_loss": 1033.5931396484375, "vf_explained_var": 0.5999093055725098, "kl": 0.015180003829300404, "entropy": 27.806209564208984, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 1028.60791015625, "policy_loss": -5.495328423421597e-06, "vf_loss": 1028.606201171875, "vf_explained_var": 0.599993884563446, "kl": 0.014695176854729652, "entropy": 1.441279411315918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3120000, "episodes_total": 6250, "training_iteration": 156, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-08-45", "timestamp": 1567649325, "time_this_iter_s": 17.64202880859375, "time_total_s": 2763.2579159736633, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f288053f840>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2763.2579159736633, "timesteps_since_restore": 3120000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 31.044000000000004, "ram_util_percent": 14.66}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 295.2190032854846, "action_adversary": -295.2190032854846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473690783925381, "mean_processing_ms": 2.4473988520433396, "mean_inference_ms": 0.9804079834237149}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3134976, "num_steps_sampled": 3140000, "sample_time_ms": 12569.857, "load_time_ms": 35.067, "grad_time_ms": 4970.817, "update_time_ms": 7.675, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1040.3836669921875, "policy_loss": -0.009774291887879372, "vf_loss": 1040.3931884765625, "vf_explained_var": 0.5889957547187805, "kl": 0.015486876480281353, "entropy": 27.742427825927734, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 1030.556884765625, "policy_loss": 6.45957697997801e-05, "vf_loss": 1030.554931640625, "vf_explained_var": 0.5938022136688232, "kl": 0.015678750351071358, "entropy": 1.4657316207885742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3140000, "episodes_total": 6290, "training_iteration": 157, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-09-03", "timestamp": 1567649343, "time_this_iter_s": 17.606694221496582, "time_total_s": 2780.86461019516, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28df28>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2780.86461019516, "timesteps_since_restore": 3140000, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 31.688000000000002, "ram_util_percent": 14.668}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 294.25982947782666, "action_adversary": -294.25982947782666}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4737292479407245, "mean_processing_ms": 2.4473645016665717, "mean_inference_ms": 0.9805384910090277}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3154944, "num_steps_sampled": 3160000, "sample_time_ms": 12573.354, "load_time_ms": 35.054, "grad_time_ms": 4973.127, "update_time_ms": 7.706, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1046.01708984375, "policy_loss": -0.011394030414521694, "vf_loss": 1046.0281982421875, "vf_explained_var": 0.5871102213859558, "kl": 0.016310423612594604, "entropy": 27.657651901245117, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 1035.71630859375, "policy_loss": -0.0015474050305783749, "vf_loss": 1035.7161865234375, "vf_explained_var": 0.5932361483573914, "kl": 0.014958672225475311, "entropy": 1.4653384685516357, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3160000, "episodes_total": 6330, "training_iteration": 158, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-09-21", "timestamp": 1567649361, "time_this_iter_s": 17.59886598587036, "time_total_s": 2798.4634761810303, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d28d2f0>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2798.4634761810303, "timesteps_since_restore": 3160000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 30.43846153846154, "ram_util_percent": 14.599999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 293.2718723716731, "action_adversary": -293.2718723716731}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.4737166254413747, "mean_processing_ms": 2.447324242178284, "mean_inference_ms": 0.9806450382561048}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3174912, "num_steps_sampled": 3180000, "sample_time_ms": 12576.414, "load_time_ms": 34.9, "grad_time_ms": 4972.255, "update_time_ms": 7.655, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1043.6197509765625, "policy_loss": -0.011674387380480766, "vf_loss": 1043.6314697265625, "vf_explained_var": 0.5839643478393555, "kl": 0.01570950075984001, "entropy": 27.658164978027344, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 1035.3924560546875, "policy_loss": -0.0009871440706774592, "vf_loss": 1035.3914794921875, "vf_explained_var": 0.5922651290893555, "kl": 0.01469359640032053, "entropy": 1.4523427486419678, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": false, "timesteps_total": 3180000, "episodes_total": 6370, "training_iteration": 159, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-09-38", "timestamp": 1567649378, "time_this_iter_s": 17.68608260154724, "time_total_s": 2816.1495587825775, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f28805ff268>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2816.1495587825775, "timesteps_since_restore": 3180000, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 31.164, "ram_util_percent": 14.691999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
{"episode_reward_max": 0.0, "episode_reward_min": 0.0, "episode_reward_mean": 0.0, "episode_len_mean": 500.0, "episodes_this_iter": 40, "policy_reward_mean": {"av": 294.4819957087889, "action_adversary": -294.4819957087889}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 2.473727478707589, "mean_processing_ms": 2.4472883879654352, "mean_inference_ms": 0.9807540214527131}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3194880, "num_steps_sampled": 3200000, "sample_time_ms": 12578.503, "load_time_ms": 34.926, "grad_time_ms": 4971.717, "update_time_ms": 7.83, "learner": {"action_adversary": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 1036.611572265625, "policy_loss": -0.010095814242959023, "vf_loss": 1036.621337890625, "vf_explained_var": 0.5833501815795898, "kl": 0.016134198755025864, "entropy": 27.58415412902832, "entropy_coeff": 0.0}, "av": {"cur_kl_coeff": 0.12177453935146332, "cur_lr": 4.999999873689376e-05, "total_loss": 1033.646484375, "policy_loss": -0.0005097511457279325, "vf_loss": 1033.644775390625, "vf_explained_var": 0.5891741514205933, "kl": 0.01807476580142975, "entropy": 1.4449480772018433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 20000, "done": true, "timesteps_total": 3200000, "episodes_total": 6410, "training_iteration": 160, "experiment_id": "f84da991e2274961b558083afa4d6630", "date": "2019-09-05_02-09-56", "timestamp": 1567649396, "time_this_iter_s": 17.604206800460815, "time_total_s": 2833.7537655830383, "pid": 9661, "hostname": "ip-172-31-18-193", "node_ip": "172.31.18.193", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_adversary\": true,\n            \"adv_action_weight\": 0.1,\n            \"adv_state_weight\": 0,\n            \"batch_size\": 20000,\n            \"control_length\": 0.1,\n            \"max_accel\": 1,\n            \"max_decel\": 3,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeHumanAdversary\",\n    \"exp_tag\": \"icra_ma_77\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 10,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 10\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"rl_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_0\",\n                    \"end\": 86400,\n                    \"name\": \"idm_2\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"rl_3\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_4\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_5\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"first\",\n                    \"departSpeed\": 0,\n                    \"edge\": \"inflow_1\",\n                    \"end\": 86400,\n                    \"name\": \"idm_6\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 3,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 8,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                },\n                \"speed_mode\": 7\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiAgentUDSSCMergeHumanAdversary-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 20000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(2,)", {}], "action_adversary": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(94,)", "Box(22,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps.<locals>.policy_mapping_fn at 0x7f287d2c3488>)", "policies_to_train": ["av", "action_adversary"]}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2833.7537655830383, "timesteps_since_restore": 3200000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 31.18, "ram_util_percent": 14.691999999999998}, "num_healthy_workers": 10, "trial_id": "9d9d5156"}
