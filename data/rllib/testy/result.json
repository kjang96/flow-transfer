{"timesteps_this_iter": 20000, "episodes_this_iter": 87, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543381993, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57630>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 1, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": 436.6972373054136, "av": -436.6972373054136}, "time_total_s": 181.69068050384521, "iterations_since_restore": 1, "time_this_iter_s": 181.69068050384521, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 181.69068050384521, "pid": 13952, "timesteps_since_restore": 20000, "episodes_total": 87, "episode_len_mean": 205.70114942528735, "date": "2018-11-28_05-13-13", "info": {"grad_time_ms": 2426.23, "num_steps_trained": 20000, "opt_samples": 20000.0, "num_steps_sampled": 20000, "adversary": {"kl": 0.04555482417345047, "cur_lr": 0.009999999776482582, "policy_loss": -53.973594665527344, "total_loss": 7190.4990234375, "vf_loss": 7244.46630859375, "vf_explained_var": 1.7881393432617188e-07, "entropy": 2.741710662841797}, "sample_peak_throughput": 111.937, "learner": {}, "opt_peak_throughput": 8243.241, "av": {"kl": 0.13558872044086456, "cur_lr": 0.009999999776482582, "policy_loss": 49.09504318237305, "total_loss": 7281.8046875, "vf_loss": 7232.68017578125, "vf_explained_var": 1.7881393432617188e-07, "entropy": 2.9891698360443115}, "update_time_ms": 539.037, "sample_time_ms": 178671.299}, "num_metric_batches_dropped": 0, "timesteps_total": 20000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 61, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382116, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57f28>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 2, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": 280.43514316349416, "av": -280.43514316349416}, "time_total_s": 304.39562821388245, "iterations_since_restore": 2, "time_this_iter_s": 122.70494771003723, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 304.39562821388245, "pid": 13952, "timesteps_since_restore": 40000, "episodes_total": 148, "episode_len_mean": 278.39, "date": "2018-11-28_05-15-16", "info": {"grad_time_ms": 2069.978, "num_steps_trained": 40000, "opt_samples": 20000.0, "num_steps_sampled": 40000, "adversary": {"kl": 0.016156746074557304, "cur_lr": 0.009999999776482582, "policy_loss": -10.083035469055176, "total_loss": 502.1777648925781, "vf_loss": 512.2559204101562, "vf_explained_var": -2.384185791015625e-07, "entropy": 2.717794179916382}, "sample_peak_throughput": 133.493, "learner": {}, "opt_peak_throughput": 9661.938, "av": {"kl": 0.0644705593585968, "cur_lr": 0.009999999776482582, "policy_loss": 9.16480541229248, "total_loss": 521.658203125, "vf_loss": 512.47412109375, "vf_explained_var": 0.0, "entropy": 3.0540032386779785}, "update_time_ms": 273.288, "sample_time_ms": 149820.204}, "num_metric_batches_dropped": 0, "timesteps_total": 40000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 47, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382233, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf707b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 3, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": 111.8034753684053, "av": -111.8034753684053}, "time_total_s": 421.21647667884827, "iterations_since_restore": 3, "time_this_iter_s": 116.82084846496582, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 421.21647667884827, "pid": 13952, "timesteps_since_restore": 60000, "episodes_total": 195, "episode_len_mean": 353.91, "date": "2018-11-28_05-17-13", "info": {"grad_time_ms": 1961.712, "num_steps_trained": 60000, "opt_samples": 20000.0, "num_steps_sampled": 60000, "adversary": {"kl": 0.015074154362082481, "cur_lr": 0.009999999776482582, "policy_loss": -0.2595154643058777, "total_loss": 124.0530776977539, "vf_loss": 124.30809783935547, "vf_explained_var": -1.7881393432617188e-06, "entropy": 2.6968226432800293}, "sample_peak_throughput": 144.685, "learner": {}, "opt_peak_throughput": 10195.176, "av": {"kl": 0.02011103741824627, "cur_lr": 0.009999999776482582, "policy_loss": -0.01752181351184845, "total_loss": 124.40282440185547, "vf_loss": 124.4112777709961, "vf_explained_var": -1.3113021850585938e-06, "entropy": 3.0364432334899902}, "update_time_ms": 184.593, "sample_time_ms": 138231.607}, "num_metric_batches_dropped": 0, "timesteps_total": 60000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 42, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382316, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57978>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 4, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": 35.505489376903725, "av": -35.505489376903725}, "time_total_s": 504.65623021125793, "iterations_since_restore": 4, "time_this_iter_s": 83.43975353240967, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 504.65623021125793, "pid": 13952, "timesteps_since_restore": 80000, "episodes_total": 237, "episode_len_mean": 427.43, "date": "2018-11-28_05-18-36", "info": {"grad_time_ms": 1904.43, "num_steps_trained": 80000, "opt_samples": 20000.0, "num_steps_sampled": 80000, "adversary": {"kl": 0.02543811872601509, "cur_lr": 0.009999999776482582, "policy_loss": 2.470932722091675, "total_loss": 115.25302124023438, "vf_loss": 112.77442169189453, "vf_explained_var": -2.5033950805664062e-06, "entropy": 2.7314305305480957}, "sample_peak_throughput": 161.167, "learner": {}, "opt_peak_throughput": 10501.831, "av": {"kl": 0.01927594654262066, "cur_lr": 0.009999999776482582, "policy_loss": -2.7676315307617188, "total_loss": 110.16022491455078, "vf_loss": 112.91917419433594, "vf_explained_var": -1.6689300537109375e-06, "entropy": 3.0030901432037354}, "update_time_ms": 140.261, "sample_time_ms": 124095.133}, "num_metric_batches_dropped": 0, "timesteps_total": 80000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382399, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf704a8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 5, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -15.400991823681773, "av": 15.400991823681773}, "time_total_s": 587.4447252750397, "iterations_since_restore": 5, "time_this_iter_s": 82.78849506378174, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 587.4447252750397, "pid": 13952, "timesteps_since_restore": 100000, "episodes_total": 277, "episode_len_mean": 472.29, "date": "2018-11-28_05-19-59", "info": {"grad_time_ms": 1865.507, "num_steps_trained": 100000, "opt_samples": 20000.0, "num_steps_sampled": 100000, "adversary": {"kl": 0.0354243628680706, "cur_lr": 0.009999999776482582, "policy_loss": 3.997192859649658, "total_loss": 93.80049896240234, "vf_loss": 89.79267120361328, "vf_explained_var": -3.5762786865234375e-06, "entropy": 2.7859668731689453}, "sample_peak_throughput": 173.179, "learner": {}, "opt_peak_throughput": 10720.947, "av": {"kl": 0.01713680289685726, "cur_lr": 0.009999999776482582, "policy_loss": -4.2901082038879395, "total_loss": 85.67012786865234, "vf_loss": 89.95252227783203, "vf_explained_var": -2.7418136596679688e-06, "entropy": 2.963773488998413}, "update_time_ms": 113.852, "sample_time_ms": 115487.368}, "num_metric_batches_dropped": 0, "timesteps_total": 100000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 42, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382490, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70b38>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 6, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -42.601083920633634, "av": 42.601083920633634}, "time_total_s": 678.1806638240814, "iterations_since_restore": 6, "time_this_iter_s": 90.73593854904175, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 678.1806638240814, "pid": 13952, "timesteps_since_restore": 120000, "episodes_total": 319, "episode_len_mean": 486.18, "date": "2018-11-28_05-21-30", "info": {"grad_time_ms": 1843.479, "num_steps_trained": 120000, "opt_samples": 20000.0, "num_steps_sampled": 120000, "adversary": {"kl": 0.04382466897368431, "cur_lr": 0.009999999776482582, "policy_loss": 4.115771293640137, "total_loss": 89.56768798828125, "vf_loss": 85.43870544433594, "vf_explained_var": -3.337860107421875e-06, "entropy": 2.8581762313842773}, "sample_peak_throughput": 180.067, "learner": {}, "opt_peak_throughput": 10849.05, "av": {"kl": 0.02057040110230446, "cur_lr": 0.009999999776482582, "policy_loss": -4.448693752288818, "total_loss": 81.15343475341797, "vf_loss": 85.5928955078125, "vf_explained_var": -2.384185791015625e-06, "entropy": 2.9152491092681885}, "update_time_ms": 96.118, "sample_time_ms": 111069.588}, "num_metric_batches_dropped": 0, "timesteps_total": 120000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382571, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf709b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 7, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -57.11167360716795, "av": 57.11167360716795}, "time_total_s": 759.1724743843079, "iterations_since_restore": 7, "time_this_iter_s": 80.99181056022644, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 759.1724743843079, "pid": 13952, "timesteps_since_restore": 140000, "episodes_total": 359, "episode_len_mean": 490.87, "date": "2018-11-28_05-22-51", "info": {"grad_time_ms": 1826.339, "num_steps_trained": 140000, "opt_samples": 20000.0, "num_steps_sampled": 140000, "adversary": {"kl": 0.05456233397126198, "cur_lr": 0.009999999776482582, "policy_loss": 4.3375396728515625, "total_loss": 85.15637969970703, "vf_loss": 80.79429626464844, "vf_explained_var": -2.9802322387695312e-06, "entropy": 2.9318792819976807}, "sample_peak_throughput": 187.752, "learner": {}, "opt_peak_throughput": 10950.868, "av": {"kl": 0.015391810797154903, "cur_lr": 0.009999999776482582, "policy_loss": -4.694492340087891, "total_loss": 76.2739028930664, "vf_loss": 80.9614486694336, "vf_explained_var": -2.2649765014648438e-06, "entropy": 2.863363265991211}, "update_time_ms": 83.418, "sample_time_ms": 106523.513}, "num_metric_batches_dropped": 0, "timesteps_total": 140000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382654, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf700b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 8, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -63.31458990982256, "av": 63.31458990982256}, "time_total_s": 841.834047794342, "iterations_since_restore": 8, "time_this_iter_s": 82.66157341003418, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 841.834047794342, "pid": 13952, "timesteps_since_restore": 160000, "episodes_total": 399, "episode_len_mean": 490.87, "date": "2018-11-28_05-24-14", "info": {"grad_time_ms": 1809.638, "num_steps_trained": 160000, "opt_samples": 20000.0, "num_steps_sampled": 160000, "adversary": {"kl": 0.055354028940200806, "cur_lr": 0.009999999776482582, "policy_loss": 4.468253135681152, "total_loss": 86.91637420654297, "vf_loss": 82.41072845458984, "vf_explained_var": -2.384185791015625e-06, "entropy": 2.9581809043884277}, "sample_peak_throughput": 193.561, "learner": {}, "opt_peak_throughput": 11051.935, "av": {"kl": 0.024278778582811356, "cur_lr": 0.009999999776482582, "policy_loss": -4.8650712966918945, "total_loss": 77.72452545166016, "vf_loss": 82.57867431640625, "vf_explained_var": -1.9073486328125e-06, "entropy": 2.840385675430298}, "update_time_ms": 73.905, "sample_time_ms": 103326.39}, "num_metric_batches_dropped": 0, "timesteps_total": 160000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382737, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf709e8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 9, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -70.24351112029296, "av": 70.24351112029296}, "time_total_s": 925.2056112289429, "iterations_since_restore": 9, "time_this_iter_s": 83.37156343460083, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 925.2056112289429, "pid": 13952, "timesteps_since_restore": 180000, "episodes_total": 439, "episode_len_mean": 500.0, "date": "2018-11-28_05-25-37", "info": {"grad_time_ms": 1797.795, "num_steps_trained": 180000, "opt_samples": 20000.0, "num_steps_sampled": 180000, "adversary": {"kl": 0.06870480626821518, "cur_lr": 0.009999999776482582, "policy_loss": 4.8474345207214355, "total_loss": 85.38067626953125, "vf_loss": 80.4637222290039, "vf_explained_var": -1.5497207641601562e-06, "entropy": 3.076049566268921}, "sample_peak_throughput": 198.182, "learner": {}, "opt_peak_throughput": 11124.737, "av": {"kl": 0.02074151299893856, "cur_lr": 0.009999999776482582, "policy_loss": -5.266082763671875, "total_loss": 75.37010192871094, "vf_loss": 80.62684631347656, "vf_explained_var": -1.0728836059570312e-06, "entropy": 2.785454273223877}, "update_time_ms": 66.53, "sample_time_ms": 100917.56}, "num_metric_batches_dropped": 0, "timesteps_total": 180000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 41, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382828, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70c18>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 10, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -78.7508173485894, "av": 78.7508173485894}, "time_total_s": 1016.4855105876923, "iterations_since_restore": 10, "time_this_iter_s": 91.27989935874939, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1016.4855105876923, "pid": 13952, "timesteps_since_restore": 200000, "episodes_total": 480, "episode_len_mean": 495.34, "date": "2018-11-28_05-27-08", "info": {"grad_time_ms": 1791.011, "num_steps_trained": 200000, "opt_samples": 20000.0, "num_steps_sampled": 200000, "adversary": {"kl": 0.058183763176202774, "cur_lr": 0.009999999776482582, "policy_loss": 5.143767356872559, "total_loss": 82.34461212158203, "vf_loss": 77.11247253417969, "vf_explained_var": -4.76837158203125e-07, "entropy": 3.1137657165527344}, "sample_peak_throughput": 200.444, "learner": {}, "opt_peak_throughput": 11166.88, "av": {"kl": 0.021846545860171318, "cur_lr": 0.009999999776482582, "policy_loss": -5.414419651031494, "total_loss": 71.86758422851562, "vf_loss": 77.27217102050781, "vf_explained_var": -2.384185791015625e-07, "entropy": 2.7179105281829834}, "update_time_ms": 60.655, "sample_time_ms": 99778.615}, "num_metric_batches_dropped": 0, "timesteps_total": 200000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382910, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70be0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 11, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -83.20312424221817, "av": 83.20312424221817}, "time_total_s": 1098.298219203949, "iterations_since_restore": 11, "time_this_iter_s": 81.81270861625671, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1098.298219203949, "pid": 13952, "timesteps_since_restore": 220000, "episodes_total": 520, "episode_len_mean": 495.34, "date": "2018-11-28_05-28-30", "info": {"grad_time_ms": 1720.904, "num_steps_trained": 220000, "opt_samples": 20000.0, "num_steps_sampled": 220000, "adversary": {"kl": 0.02643258310854435, "cur_lr": 0.009999999776482582, "policy_loss": 4.958008289337158, "total_loss": 82.13140869140625, "vf_loss": 77.11320495605469, "vf_explained_var": 1.1324882507324219e-06, "entropy": 3.1503825187683105}, "sample_peak_throughput": 222.425, "learner": {}, "opt_peak_throughput": 11621.797, "av": {"kl": 0.02012150175869465, "cur_lr": 0.009999999776482582, "policy_loss": -5.317815780639648, "total_loss": 71.93824005126953, "vf_loss": 77.24702453613281, "vf_explained_var": 6.556510925292969e-07, "entropy": 2.6854989528656006}, "update_time_ms": 7.472, "sample_time_ms": 89918.096}, "num_metric_batches_dropped": 0, "timesteps_total": 220000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543382991, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70e10>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 12, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -90.1738656146405, "av": 90.1738656146405}, "time_total_s": 1179.4817140102386, "iterations_since_restore": 12, "time_this_iter_s": 81.18349480628967, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1179.4817140102386, "pid": 13952, "timesteps_since_restore": 240000, "episodes_total": 560, "episode_len_mean": 495.34, "date": "2018-11-28_05-29-51", "info": {"grad_time_ms": 1722.704, "num_steps_trained": 240000, "opt_samples": 20000.0, "num_steps_sampled": 240000, "adversary": {"kl": 0.03778216615319252, "cur_lr": 0.009999999776482582, "policy_loss": 5.436997413635254, "total_loss": 79.7354507446289, "vf_loss": 74.21240997314453, "vf_explained_var": 2.7418136596679688e-06, "entropy": 3.2205071449279785}, "sample_peak_throughput": 233.197, "learner": {}, "opt_peak_throughput": 11609.659, "av": {"kl": 0.017023516818881035, "cur_lr": 0.009999999776482582, "policy_loss": -5.871693134307861, "total_loss": 68.48271179199219, "vf_loss": 74.34677124023438, "vf_explained_var": 2.1457672119140625e-06, "entropy": 2.6497225761413574}, "update_time_ms": 7.417, "sample_time_ms": 85764.263}, "num_metric_batches_dropped": 0, "timesteps_total": 240000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 42, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383082, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf706a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 13, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -95.75864061936322, "av": 95.75864061936322}, "time_total_s": 1269.5941722393036, "iterations_since_restore": 13, "time_this_iter_s": 90.11245822906494, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1269.5941722393036, "pid": 13952, "timesteps_since_restore": 260000, "episodes_total": 602, "episode_len_mean": 492.01, "date": "2018-11-28_05-31-22", "info": {"grad_time_ms": 1720.792, "num_steps_trained": 260000, "opt_samples": 20000.0, "num_steps_sampled": 260000, "adversary": {"kl": 0.05277801677584648, "cur_lr": 0.009999999776482582, "policy_loss": 5.197610378265381, "total_loss": 80.1685791015625, "vf_loss": 74.85073852539062, "vf_explained_var": 4.947185516357422e-06, "entropy": 3.3102188110351562}, "sample_peak_throughput": 240.688, "learner": {}, "opt_peak_throughput": 11622.555, "av": {"kl": 0.021633148193359375, "cur_lr": 0.009999999776482582, "policy_loss": -5.760868072509766, "total_loss": 69.19141387939453, "vf_loss": 74.94256591796875, "vf_explained_var": 3.4570693969726562e-06, "entropy": 2.5929391384124756}, "update_time_ms": 7.504, "sample_time_ms": 83095.175}, "num_metric_batches_dropped": 0, "timesteps_total": 260000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383168, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70a58>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 14, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -101.11348445083772, "av": 101.11348445083772}, "time_total_s": 1356.3073337078094, "iterations_since_restore": 14, "time_this_iter_s": 86.71316146850586, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1356.3073337078094, "pid": 13952, "timesteps_since_restore": 280000, "episodes_total": 642, "episode_len_mean": 492.01, "date": "2018-11-28_05-32-48", "info": {"grad_time_ms": 1721.727, "num_steps_trained": 280000, "opt_samples": 20000.0, "num_steps_sampled": 280000, "adversary": {"kl": 0.02464146353304386, "cur_lr": 0.009999999776482582, "policy_loss": 5.23895263671875, "total_loss": 79.31501770019531, "vf_loss": 73.9918441772461, "vf_explained_var": 7.3909759521484375e-06, "entropy": 3.3413383960723877}, "sample_peak_throughput": 239.746, "learner": {}, "opt_peak_throughput": 11616.245, "av": {"kl": 0.02047078311443329, "cur_lr": 0.009999999776482582, "policy_loss": -5.629364967346191, "total_loss": 68.43560791015625, "vf_loss": 74.0557632446289, "vf_explained_var": 4.887580871582031e-06, "entropy": 2.5318288803100586}, "update_time_ms": 7.519, "sample_time_ms": 83421.556}, "num_metric_batches_dropped": 0, "timesteps_total": 280000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383250, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70cf8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 15, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -107.4507627020405, "av": 107.4507627020405}, "time_total_s": 1437.7169694900513, "iterations_since_restore": 15, "time_this_iter_s": 81.40963578224182, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1437.7169694900513, "pid": 13952, "timesteps_since_restore": 300000, "episodes_total": 682, "episode_len_mean": 492.01, "date": "2018-11-28_05-34-10", "info": {"grad_time_ms": 1722.258, "num_steps_trained": 300000, "opt_samples": 20000.0, "num_steps_sampled": 300000, "adversary": {"kl": 0.028609374538064003, "cur_lr": 0.009999999776482582, "policy_loss": 5.445821285247803, "total_loss": 78.20018005371094, "vf_loss": 72.65657806396484, "vf_explained_var": 1.0371208190917969e-05, "entropy": 3.373274326324463}, "sample_peak_throughput": 240.145, "learner": {}, "opt_peak_throughput": 11612.663, "av": {"kl": 0.014316278509795666, "cur_lr": 0.009999999776482582, "policy_loss": -5.891261100769043, "total_loss": 66.81365966796875, "vf_loss": 72.6985092163086, "vf_explained_var": 6.67572021484375e-06, "entropy": 2.490341901779175}, "update_time_ms": 7.391, "sample_time_ms": 83283.185}, "num_metric_batches_dropped": 0, "timesteps_total": 300000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383330, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf700f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 16, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -114.30392466018398, "av": 114.30392466018398}, "time_total_s": 1518.5170567035675, "iterations_since_restore": 16, "time_this_iter_s": 80.80008721351624, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1518.5170567035675, "pid": 13952, "timesteps_since_restore": 320000, "episodes_total": 722, "episode_len_mean": 500.0, "date": "2018-11-28_05-35-30", "info": {"grad_time_ms": 1725.63, "num_steps_trained": 320000, "opt_samples": 20000.0, "num_steps_sampled": 320000, "adversary": {"kl": 0.029336528852581978, "cur_lr": 0.009999999776482582, "policy_loss": 5.384771823883057, "total_loss": 79.31561279296875, "vf_loss": 73.83058166503906, "vf_explained_var": 1.4007091522216797e-05, "entropy": 3.4569859504699707}, "sample_peak_throughput": 243.054, "learner": {}, "opt_peak_throughput": 11589.968, "av": {"kl": 0.03086717240512371, "cur_lr": 0.009999999776482582, "policy_loss": -5.891120433807373, "total_loss": 67.96514129638672, "vf_loss": 73.84234619140625, "vf_explained_var": 9.000301361083984e-06, "entropy": 2.4697608947753906}, "update_time_ms": 7.329, "sample_time_ms": 82286.185}, "num_metric_batches_dropped": 0, "timesteps_total": 320000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383415, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70d68>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 17, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -116.92197514269243, "av": 116.92197514269243}, "time_total_s": 1602.6738464832306, "iterations_since_restore": 17, "time_this_iter_s": 84.15678977966309, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1602.6738464832306, "pid": 13952, "timesteps_since_restore": 340000, "episodes_total": 762, "episode_len_mean": 500.0, "date": "2018-11-28_05-36-55", "info": {"grad_time_ms": 1726.755, "num_steps_trained": 340000, "opt_samples": 20000.0, "num_steps_sampled": 340000, "adversary": {"kl": 0.03127235546708107, "cur_lr": 0.009999999776482582, "policy_loss": 4.805131912231445, "total_loss": 80.32666015625, "vf_loss": 75.41468811035156, "vf_explained_var": 1.7523765563964844e-05, "entropy": 3.50903582572937}, "sample_peak_throughput": 242.126, "learner": {}, "opt_peak_throughput": 11582.421, "av": {"kl": 0.025549590587615967, "cur_lr": 0.009999999776482582, "policy_loss": -5.3314313888549805, "total_loss": 70.05681610107422, "vf_loss": 75.37672424316406, "vf_explained_var": 1.1086463928222656e-05, "entropy": 2.4340286254882812}, "update_time_ms": 7.345, "sample_time_ms": 82601.526}, "num_metric_batches_dropped": 0, "timesteps_total": 340000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383499, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70fd0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 18, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -115.96465004129173, "av": 115.96465004129173}, "time_total_s": 1687.0748550891876, "iterations_since_restore": 18, "time_this_iter_s": 84.40100860595703, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1687.0748550891876, "pid": 13952, "timesteps_since_restore": 360000, "episodes_total": 802, "episode_len_mean": 500.0, "date": "2018-11-28_05-38-19", "info": {"grad_time_ms": 1731.276, "num_steps_trained": 360000, "opt_samples": 20000.0, "num_steps_sampled": 360000, "adversary": {"kl": 0.02816752903163433, "cur_lr": 0.009999999776482582, "policy_loss": 4.947113990783691, "total_loss": 81.95265197753906, "vf_loss": 76.90924072265625, "vf_explained_var": 2.586841583251953e-05, "entropy": 3.5457606315612793}, "sample_peak_throughput": 241.631, "learner": {}, "opt_peak_throughput": 11552.174, "av": {"kl": 0.026491845026612282, "cur_lr": 0.009999999776482582, "policy_loss": -5.371176719665527, "total_loss": 71.47789001464844, "vf_loss": 76.83712768554688, "vf_explained_var": 1.424551010131836e-05, "entropy": 2.3714475631713867}, "update_time_ms": 7.362, "sample_time_ms": 82770.919}, "num_metric_batches_dropped": 0, "timesteps_total": 360000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383583, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 19, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -117.7777206253052, "av": 117.7777206253052}, "time_total_s": 1771.227124452591, "iterations_since_restore": 19, "time_this_iter_s": 84.15226936340332, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1771.227124452591, "pid": 13952, "timesteps_since_restore": 380000, "episodes_total": 842, "episode_len_mean": 500.0, "date": "2018-11-28_05-39-43", "info": {"grad_time_ms": 1735.975, "num_steps_trained": 380000, "opt_samples": 20000.0, "num_steps_sampled": 380000, "adversary": {"kl": 0.031220568343997, "cur_lr": 0.009999999776482582, "policy_loss": 4.736966133117676, "total_loss": 84.77555084228516, "vf_loss": 79.93193054199219, "vf_explained_var": 3.975629806518555e-05, "entropy": 3.5808894634246826}, "sample_peak_throughput": 241.417, "learner": {}, "opt_peak_throughput": 11520.904, "av": {"kl": 0.032383110374212265, "cur_lr": 0.009999999776482582, "policy_loss": -5.272539138793945, "total_loss": 74.55387878417969, "vf_loss": 79.81185913085938, "vf_explained_var": 1.8715858459472656e-05, "entropy": 2.2949609756469727}, "update_time_ms": 7.347, "sample_time_ms": 82844.199}, "num_metric_batches_dropped": 0, "timesteps_total": 380000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383667, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57dd8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 20, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -119.28574841733494, "av": 119.28574841733494}, "time_total_s": 1854.8864912986755, "iterations_since_restore": 20, "time_this_iter_s": 83.6593668460846, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1854.8864912986755, "pid": 13952, "timesteps_since_restore": 400000, "episodes_total": 882, "episode_len_mean": 500.0, "date": "2018-11-28_05-41-07", "info": {"grad_time_ms": 1736.01, "num_steps_trained": 400000, "opt_samples": 20000.0, "num_steps_sampled": 400000, "adversary": {"kl": 0.03721541166305542, "cur_lr": 0.009999999776482582, "policy_loss": 4.419538497924805, "total_loss": 87.41868591308594, "vf_loss": 82.87197875976562, "vf_explained_var": 9.226799011230469e-05, "entropy": 3.6448965072631836}, "sample_peak_throughput": 243.659, "learner": {}, "opt_peak_throughput": 11520.669, "av": {"kl": 0.029969658702611923, "cur_lr": 0.009999999776482582, "policy_loss": -5.001263618469238, "total_loss": 77.71420288085938, "vf_loss": 82.70198822021484, "vf_explained_var": 2.586841583251953e-05, "entropy": 2.252060890197754}, "update_time_ms": 7.288, "sample_time_ms": 82082.07}, "num_metric_batches_dropped": 0, "timesteps_total": 400000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383747, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf709b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 21, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -120.71456611048936, "av": 120.71456611048936}, "time_total_s": 1935.3397216796875, "iterations_since_restore": 21, "time_this_iter_s": 80.45323038101196, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 1935.3397216796875, "pid": 13952, "timesteps_since_restore": 420000, "episodes_total": 922, "episode_len_mean": 500.0, "date": "2018-11-28_05-42-27", "info": {"grad_time_ms": 1737.868, "num_steps_trained": 420000, "opt_samples": 20000.0, "num_steps_sampled": 420000, "adversary": {"kl": 0.025751296430826187, "cur_lr": 0.009999999776482582, "policy_loss": 4.344231128692627, "total_loss": 90.33262634277344, "vf_loss": 85.90043640136719, "vf_explained_var": 0.03647500276565552, "entropy": 3.653914451599121}, "sample_peak_throughput": 244.068, "learner": {}, "opt_peak_throughput": 11508.354, "av": {"kl": 0.03219744190573692, "cur_lr": 0.009999999776482582, "policy_loss": -4.791677474975586, "total_loss": 81.46185302734375, "vf_loss": 86.23905181884766, "vf_explained_var": 4.45246696472168e-05, "entropy": 2.179518461227417}, "update_time_ms": 7.286, "sample_time_ms": 81944.27}, "num_metric_batches_dropped": 0, "timesteps_total": 420000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383833, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70898>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 22, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -118.96678673760887, "av": 118.96678673760887}, "time_total_s": 2020.7838039398193, "iterations_since_restore": 22, "time_this_iter_s": 85.44408226013184, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2020.7838039398193, "pid": 13952, "timesteps_since_restore": 440000, "episodes_total": 962, "episode_len_mean": 500.0, "date": "2018-11-28_05-43-53", "info": {"grad_time_ms": 1738.825, "num_steps_trained": 440000, "opt_samples": 20000.0, "num_steps_sampled": 440000, "adversary": {"kl": 0.041266582906246185, "cur_lr": 0.009999999776482582, "policy_loss": 3.8815524578094482, "total_loss": 91.23211669921875, "vf_loss": 87.20947265625, "vf_explained_var": -1.728534698486328e-05, "entropy": 3.7641358375549316}, "sample_peak_throughput": 242.809, "learner": {}, "opt_peak_throughput": 11502.023, "av": {"kl": 0.04699602723121643, "cur_lr": 0.009999999776482582, "policy_loss": -4.145081043243408, "total_loss": 85.40480041503906, "vf_loss": 89.52876281738281, "vf_explained_var": 0.00018733739852905273, "entropy": 2.188760995864868}, "update_time_ms": 7.288, "sample_time_ms": 82369.287}, "num_metric_batches_dropped": 0, "timesteps_total": 440000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383913, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 23, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -115.87360041199227, "av": 115.87360041199227}, "time_total_s": 2101.106950521469, "iterations_since_restore": 23, "time_this_iter_s": 80.32314658164978, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2101.106950521469, "pid": 13952, "timesteps_since_restore": 460000, "episodes_total": 1002, "episode_len_mean": 500.0, "date": "2018-11-28_05-45-13", "info": {"grad_time_ms": 1738.631, "num_steps_trained": 460000, "opt_samples": 20000.0, "num_steps_sampled": 460000, "adversary": {"kl": 0.02367980033159256, "cur_lr": 0.009999999776482582, "policy_loss": 3.6859426498413086, "total_loss": 97.45988464355469, "vf_loss": 93.652587890625, "vf_explained_var": 1.150369644165039e-05, "entropy": 3.7422101497650146}, "sample_peak_throughput": 245.728, "learner": {}, "opt_peak_throughput": 11503.303, "av": {"kl": 0.022675646468997, "cur_lr": 0.009999999776482582, "policy_loss": -4.093501567840576, "total_loss": 69.13744354248047, "vf_loss": 73.21562194824219, "vf_explained_var": 0.2995114326477051, "entropy": 2.1454663276672363}, "update_time_ms": 7.185, "sample_time_ms": 81390.716}, "num_metric_batches_dropped": 0, "timesteps_total": 460000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543383995, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57860>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 24, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -115.13581174132412, "av": 115.13581174132412}, "time_total_s": 2183.368509054184, "iterations_since_restore": 24, "time_this_iter_s": 82.26155853271484, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2183.368509054184, "pid": 13952, "timesteps_since_restore": 480000, "episodes_total": 1042, "episode_len_mean": 500.0, "date": "2018-11-28_05-46-35", "info": {"grad_time_ms": 1737.687, "num_steps_trained": 480000, "opt_samples": 20000.0, "num_steps_sampled": 480000, "adversary": {"kl": 0.032887283712625504, "cur_lr": 0.009999999776482582, "policy_loss": 3.443244457244873, "total_loss": 101.90509033203125, "vf_loss": 98.29328918457031, "vf_explained_var": 1.621246337890625e-05, "entropy": 3.8012359142303467}, "sample_peak_throughput": 247.077, "learner": {}, "opt_peak_throughput": 11509.551, "av": {"kl": 0.023536644876003265, "cur_lr": 0.009999999776482582, "policy_loss": -3.953056573867798, "total_loss": 61.263362884521484, "vf_loss": 65.2005386352539, "vf_explained_var": 0.3546963334083557, "entropy": 2.115544557571411}, "update_time_ms": 7.14, "sample_time_ms": 80946.398}, "num_metric_batches_dropped": 0, "timesteps_total": 480000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384078, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70208>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 25, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -114.4486570021223, "av": 114.4486570021223}, "time_total_s": 2265.900441646576, "iterations_since_restore": 25, "time_this_iter_s": 82.53193259239197, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2265.900441646576, "pid": 13952, "timesteps_since_restore": 500000, "episodes_total": 1082, "episode_len_mean": 500.0, "date": "2018-11-28_05-47-58", "info": {"grad_time_ms": 1740.109, "num_steps_trained": 500000, "opt_samples": 20000.0, "num_steps_sampled": 500000, "adversary": {"kl": 0.020450470969080925, "cur_lr": 0.009999999776482582, "policy_loss": 3.153759479522705, "total_loss": 104.23187255859375, "vf_loss": 100.97327423095703, "vf_explained_var": 1.9729137420654297e-05, "entropy": 3.8010735511779785}, "sample_peak_throughput": 246.743, "learner": {}, "opt_peak_throughput": 11493.535, "av": {"kl": 0.029089197516441345, "cur_lr": 0.009999999776482582, "policy_loss": -3.499202251434326, "total_loss": 61.83771896362305, "vf_loss": 65.31725311279297, "vf_explained_var": 0.37032926082611084, "entropy": 2.09294056892395}, "update_time_ms": 7.271, "sample_time_ms": 81056.144}, "num_metric_batches_dropped": 0, "timesteps_total": 500000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384159, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57898>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 26, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -114.06640951256558, "av": 114.06640951256558}, "time_total_s": 2346.615786075592, "iterations_since_restore": 26, "time_this_iter_s": 80.71534442901611, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2346.615786075592, "pid": 13952, "timesteps_since_restore": 520000, "episodes_total": 1122, "episode_len_mean": 500.0, "date": "2018-11-28_05-49-19", "info": {"grad_time_ms": 1736.022, "num_steps_trained": 520000, "opt_samples": 20000.0, "num_steps_sampled": 520000, "adversary": {"kl": 0.02069671079516411, "cur_lr": 0.009999999776482582, "policy_loss": 3.0346014499664307, "total_loss": 108.480224609375, "vf_loss": 105.33958435058594, "vf_explained_var": 2.276897430419922e-05, "entropy": 3.8563570976257324}, "sample_peak_throughput": 246.756, "learner": {}, "opt_peak_throughput": 11520.589, "av": {"kl": 0.027778396382927895, "cur_lr": 0.009999999776482582, "policy_loss": -3.485757827758789, "total_loss": 62.935001373291016, "vf_loss": 66.40201568603516, "vf_explained_var": 0.3822546601295471, "entropy": 2.034223794937134}, "update_time_ms": 7.385, "sample_time_ms": 81051.679}, "num_metric_batches_dropped": 0, "timesteps_total": 520000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384245, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37940e32b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 27, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -115.6648062066035, "av": 115.6648062066035}, "time_total_s": 2432.710109472275, "iterations_since_restore": 27, "time_this_iter_s": 86.09432339668274, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2432.710109472275, "pid": 13952, "timesteps_since_restore": 540000, "episodes_total": 1162, "episode_len_mean": 500.0, "date": "2018-11-28_05-50-45", "info": {"grad_time_ms": 1735.774, "num_steps_trained": 540000, "opt_samples": 20000.0, "num_steps_sampled": 540000, "adversary": {"kl": 0.02106432244181633, "cur_lr": 0.009999999776482582, "policy_loss": 3.0471179485321045, "total_loss": 113.6530990600586, "vf_loss": 110.4980239868164, "vf_explained_var": 3.0040740966796875e-05, "entropy": 3.8777077198028564}, "sample_peak_throughput": 246.167, "learner": {}, "opt_peak_throughput": 11522.234, "av": {"kl": 0.024991638958454132, "cur_lr": 0.009999999776482582, "policy_loss": -3.57114839553833, "total_loss": 65.07511138916016, "vf_loss": 68.62934875488281, "vf_explained_var": 0.3954543471336365, "entropy": 2.0372183322906494}, "update_time_ms": 7.321, "sample_time_ms": 81245.602}, "num_metric_batches_dropped": 0, "timesteps_total": 540000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384326, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf702b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 28, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -116.11095975860441, "av": 116.11095975860441}, "time_total_s": 2513.469485759735, "iterations_since_restore": 28, "time_this_iter_s": 80.75937628746033, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2513.469485759735, "pid": 13952, "timesteps_since_restore": 560000, "episodes_total": 1202, "episode_len_mean": 500.0, "date": "2018-11-28_05-52-06", "info": {"grad_time_ms": 1733.748, "num_steps_trained": 560000, "opt_samples": 20000.0, "num_steps_sampled": 560000, "adversary": {"kl": 0.021022656932473183, "cur_lr": 0.009999999776482582, "policy_loss": 2.8987584114074707, "total_loss": 117.62921142578125, "vf_loss": 114.6227035522461, "vf_explained_var": 4.6372413635253906e-05, "entropy": 3.9378457069396973}, "sample_peak_throughput": 247.269, "learner": {}, "opt_peak_throughput": 11535.704, "av": {"kl": 0.024088893085718155, "cur_lr": 0.009999999776482582, "policy_loss": -3.3724305629730225, "total_loss": 66.51152038574219, "vf_loss": 69.86766052246094, "vf_explained_var": 0.41081082820892334, "entropy": 2.0071260929107666}, "update_time_ms": 7.276, "sample_time_ms": 80883.591}, "num_metric_batches_dropped": 0, "timesteps_total": 560000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384406, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf707f0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 29, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -121.70219868665474, "av": 121.70219868665474}, "time_total_s": 2593.793071746826, "iterations_since_restore": 29, "time_this_iter_s": 80.32358598709106, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2593.793071746826, "pid": 13952, "timesteps_since_restore": 580000, "episodes_total": 1242, "episode_len_mean": 500.0, "date": "2018-11-28_05-53-26", "info": {"grad_time_ms": 1726.473, "num_steps_trained": 580000, "opt_samples": 20000.0, "num_steps_sampled": 580000, "adversary": {"kl": 0.025680411607027054, "cur_lr": 0.009999999776482582, "policy_loss": 3.00276255607605, "total_loss": 122.01847839355469, "vf_loss": 118.88400268554688, "vf_explained_var": 0.00010484457015991211, "entropy": 3.984556198120117}, "sample_peak_throughput": 248.422, "learner": {}, "opt_peak_throughput": 11584.312, "av": {"kl": 0.04796472191810608, "cur_lr": 0.009999999776482582, "policy_loss": -3.2718820571899414, "total_loss": 66.7934341430664, "vf_loss": 70.03295135498047, "vf_explained_var": 0.4280461072921753, "entropy": 1.9862207174301147}, "update_time_ms": 7.25, "sample_time_ms": 80508.12}, "num_metric_batches_dropped": 0, "timesteps_total": 580000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384490, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf576d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 30, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -118.8010088580325, "av": 118.8010088580325}, "time_total_s": 2678.188807487488, "iterations_since_restore": 30, "time_this_iter_s": 84.39573574066162, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2678.188807487488, "pid": 13952, "timesteps_since_restore": 600000, "episodes_total": 1282, "episode_len_mean": 500.0, "date": "2018-11-28_05-54-50", "info": {"grad_time_ms": 1727.374, "num_steps_trained": 600000, "opt_samples": 20000.0, "num_steps_sampled": 600000, "adversary": {"kl": 0.04210485890507698, "cur_lr": 0.009999999776482582, "policy_loss": 2.53149676322937, "total_loss": 107.17743682861328, "vf_loss": 104.43008422851562, "vf_explained_var": 0.19203978776931763, "entropy": 4.035383701324463}, "sample_peak_throughput": 248.198, "learner": {}, "opt_peak_throughput": 11578.265, "av": {"kl": 0.04725855588912964, "cur_lr": 0.009999999776482582, "policy_loss": -2.8278470039367676, "total_loss": 68.98995971679688, "vf_loss": 71.76995086669922, "vf_explained_var": 0.4319588541984558, "entropy": 1.9550977945327759}, "update_time_ms": 7.246, "sample_time_ms": 80580.843}, "num_metric_batches_dropped": 0, "timesteps_total": 600000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384578, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf708d0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 31, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -119.86583236504941, "av": 119.86583236504941}, "time_total_s": 2765.5817482471466, "iterations_since_restore": 31, "time_this_iter_s": 87.39294075965881, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2765.5817482471466, "pid": 13952, "timesteps_since_restore": 620000, "episodes_total": 1322, "episode_len_mean": 500.0, "date": "2018-11-28_05-56-18", "info": {"grad_time_ms": 1721.752, "num_steps_trained": 620000, "opt_samples": 20000.0, "num_steps_sampled": 620000, "adversary": {"kl": 0.011641786433756351, "cur_lr": 0.009999999776482582, "policy_loss": 2.865154266357422, "total_loss": 89.95732879638672, "vf_loss": 87.0026626586914, "vf_explained_var": 0.35308074951171875, "entropy": 4.048835277557373}, "sample_peak_throughput": 246.062, "learner": {}, "opt_peak_throughput": 11616.077, "av": {"kl": 0.019119076430797577, "cur_lr": 0.009999999776482582, "policy_loss": -3.1199727058410645, "total_loss": 71.19912719726562, "vf_loss": 74.29004669189453, "vf_explained_var": 0.4433218240737915, "entropy": 1.9615437984466553}, "update_time_ms": 7.259, "sample_time_ms": 81280.27}, "num_metric_batches_dropped": 0, "timesteps_total": 620000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384659, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57978>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 32, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -121.52414172246556, "av": 121.52414172246556}, "time_total_s": 2847.2685465812683, "iterations_since_restore": 32, "time_this_iter_s": 81.6867983341217, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2847.2685465812683, "pid": 13952, "timesteps_since_restore": 640000, "episodes_total": 1362, "episode_len_mean": 500.0, "date": "2018-11-28_05-57-39", "info": {"grad_time_ms": 1722.813, "num_steps_trained": 640000, "opt_samples": 20000.0, "num_steps_sampled": 640000, "adversary": {"kl": 0.010452612303197384, "cur_lr": 0.009999999776482582, "policy_loss": 2.642340898513794, "total_loss": 89.38817596435547, "vf_loss": 86.66548919677734, "vf_explained_var": 0.3720107674598694, "entropy": 4.060562610626221}, "sample_peak_throughput": 247.208, "learner": {}, "opt_peak_throughput": 11608.919, "av": {"kl": 0.03099014051258564, "cur_lr": 0.009999999776482582, "policy_loss": -2.8735430240631104, "total_loss": 73.04100799560547, "vf_loss": 75.86747741699219, "vf_explained_var": 0.4456256628036499, "entropy": 1.9420034885406494}, "update_time_ms": 7.257, "sample_time_ms": 80903.464}, "num_metric_batches_dropped": 0, "timesteps_total": 640000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384747, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70b00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 33, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -122.95027346455018, "av": 122.95027346455018}, "time_total_s": 2934.706204891205, "iterations_since_restore": 33, "time_this_iter_s": 87.43765830993652, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 2934.706204891205, "pid": 13952, "timesteps_since_restore": 660000, "episodes_total": 1402, "episode_len_mean": 500.0, "date": "2018-11-28_05-59-07", "info": {"grad_time_ms": 1724.326, "num_steps_trained": 660000, "opt_samples": 20000.0, "num_steps_sampled": 660000, "adversary": {"kl": 0.009443078190088272, "cur_lr": 0.009999999776482582, "policy_loss": 2.6250667572021484, "total_loss": 85.04713439941406, "vf_loss": 82.34942626953125, "vf_explained_var": 0.4457293748855591, "entropy": 4.084821701049805}, "sample_peak_throughput": 245.058, "learner": {}, "opt_peak_throughput": 11598.738, "av": {"kl": 0.03338955342769623, "cur_lr": 0.009999999776482582, "policy_loss": -2.782240629196167, "total_loss": 77.54356384277344, "vf_loss": 80.27508544921875, "vf_explained_var": 0.43463361263275146, "entropy": 1.9175771474838257}, "update_time_ms": 7.263, "sample_time_ms": 81613.306}, "num_metric_batches_dropped": 0, "timesteps_total": 660000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384830, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37940e32b0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 34, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -122.57342408670279, "av": 122.57342408670279}, "time_total_s": 3018.124077320099, "iterations_since_restore": 34, "time_this_iter_s": 83.41787242889404, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3018.124077320099, "pid": 13952, "timesteps_since_restore": 680000, "episodes_total": 1442, "episode_len_mean": 500.0, "date": "2018-11-28_06-00-30", "info": {"grad_time_ms": 1726.252, "num_steps_trained": 680000, "opt_samples": 20000.0, "num_steps_sampled": 680000, "adversary": {"kl": 0.0185086652636528, "cur_lr": 0.009999999776482582, "policy_loss": 2.336648941040039, "total_loss": 87.66146087646484, "vf_loss": 85.25364685058594, "vf_explained_var": 0.4427638053894043, "entropy": 4.105601787567139}, "sample_peak_throughput": 244.717, "learner": {}, "opt_peak_throughput": 11585.792, "av": {"kl": 0.013984601013362408, "cur_lr": 0.009999999776482582, "policy_loss": -2.594949960708618, "total_loss": 80.2451400756836, "vf_loss": 82.81884002685547, "vf_explained_var": 0.4372484087944031, "entropy": 1.868730068206787}, "update_time_ms": 7.297, "sample_time_ms": 81727.038}, "num_metric_batches_dropped": 0, "timesteps_total": 680000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384912, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57cf8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 35, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -123.26051873609131, "av": 123.26051873609131}, "time_total_s": 3099.899640083313, "iterations_since_restore": 35, "time_this_iter_s": 81.77556276321411, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3099.899640083313, "pid": 13952, "timesteps_since_restore": 700000, "episodes_total": 1482, "episode_len_mean": 500.0, "date": "2018-11-28_06-01-52", "info": {"grad_time_ms": 1724.571, "num_steps_trained": 700000, "opt_samples": 20000.0, "num_steps_sampled": 700000, "adversary": {"kl": 0.014111349359154701, "cur_lr": 0.009999999776482582, "policy_loss": 2.3975141048431396, "total_loss": 88.00780487060547, "vf_loss": 85.5560531616211, "vf_explained_var": 0.4829767942428589, "entropy": 4.127570152282715}, "sample_peak_throughput": 244.938, "learner": {}, "opt_peak_throughput": 11597.085, "av": {"kl": 0.026661455631256104, "cur_lr": 0.009999999776482582, "policy_loss": -2.5538907051086426, "total_loss": 83.2677230834961, "vf_loss": 85.7811050415039, "vf_explained_var": 0.4402947425842285, "entropy": 1.8512402772903442}, "update_time_ms": 7.237, "sample_time_ms": 81653.16}, "num_metric_batches_dropped": 0, "timesteps_total": 700000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543384996, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf704e0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 36, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -123.76680038269551, "av": 123.76680038269551}, "time_total_s": 3183.785026073456, "iterations_since_restore": 36, "time_this_iter_s": 83.88538599014282, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3183.785026073456, "pid": 13952, "timesteps_since_restore": 720000, "episodes_total": 1522, "episode_len_mean": 500.0, "date": "2018-11-28_06-03-16", "info": {"grad_time_ms": 1726.385, "num_steps_trained": 720000, "opt_samples": 20000.0, "num_steps_sampled": 720000, "adversary": {"kl": 0.012948545627295971, "cur_lr": 0.009999999776482582, "policy_loss": 2.283994197845459, "total_loss": 85.25897216796875, "vf_loss": 82.9251937866211, "vf_explained_var": 0.49500060081481934, "entropy": 4.135534286499023}, "sample_peak_throughput": 243.996, "learner": {}, "opt_peak_throughput": 11584.9, "av": {"kl": 0.019141705706715584, "cur_lr": 0.009999999776482582, "policy_loss": -2.5352840423583984, "total_loss": 87.69882202148438, "vf_loss": 90.20508575439453, "vf_explained_var": 0.43490082025527954, "entropy": 1.8395195007324219}, "update_time_ms": 7.2, "sample_time_ms": 81968.476}, "num_metric_batches_dropped": 0, "timesteps_total": 720000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385076, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b240>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 37, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -124.55717160175769, "av": 124.55717160175769}, "time_total_s": 3264.1084492206573, "iterations_since_restore": 37, "time_this_iter_s": 80.32342314720154, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3264.1084492206573, "pid": 13952, "timesteps_since_restore": 740000, "episodes_total": 1562, "episode_len_mean": 500.0, "date": "2018-11-28_06-04-36", "info": {"grad_time_ms": 1726.217, "num_steps_trained": 740000, "opt_samples": 20000.0, "num_steps_sampled": 740000, "adversary": {"kl": 0.012196800671517849, "cur_lr": 0.009999999776482582, "policy_loss": 2.08536434173584, "total_loss": 84.66639709472656, "vf_loss": 82.53416442871094, "vf_explained_var": 0.49751973152160645, "entropy": 4.139378070831299}, "sample_peak_throughput": 245.726, "learner": {}, "opt_peak_throughput": 11586.031, "av": {"kl": 0.026003731414675713, "cur_lr": 0.009999999776482582, "policy_loss": -2.2166664600372314, "total_loss": 89.27586364746094, "vf_loss": 91.4530029296875, "vf_explained_var": 0.4388141632080078, "entropy": 1.8206918239593506}, "update_time_ms": 7.273, "sample_time_ms": 81391.569}, "num_metric_batches_dropped": 0, "timesteps_total": 740000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385160, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b860>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 38, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -125.41909739752107, "av": 125.41909739752107}, "time_total_s": 3348.1110842227936, "iterations_since_restore": 38, "time_this_iter_s": 84.00263500213623, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3348.1110842227936, "pid": 13952, "timesteps_since_restore": 760000, "episodes_total": 1602, "episode_len_mean": 500.0, "date": "2018-11-28_06-06-00", "info": {"grad_time_ms": 1725.388, "num_steps_trained": 760000, "opt_samples": 20000.0, "num_steps_sampled": 760000, "adversary": {"kl": 0.01201782375574112, "cur_lr": 0.009999999776482582, "policy_loss": 2.241744041442871, "total_loss": 87.6634292602539, "vf_loss": 85.37550354003906, "vf_explained_var": 0.503267765045166, "entropy": 4.180196285247803}, "sample_peak_throughput": 244.748, "learner": {}, "opt_peak_throughput": 11591.598, "av": {"kl": 0.03504365682601929, "cur_lr": 0.009999999776482582, "policy_loss": -2.2813234329223633, "total_loss": 93.15868377685547, "vf_loss": 95.38680267333984, "vf_explained_var": 0.4340950846672058, "entropy": 1.772242546081543}, "update_time_ms": 7.254, "sample_time_ms": 81716.764}, "num_metric_batches_dropped": 0, "timesteps_total": 760000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385244, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b160>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 39, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -126.11719442207864, "av": 126.11719442207864}, "time_total_s": 3431.301958322525, "iterations_since_restore": 39, "time_this_iter_s": 83.19087409973145, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3431.301958322525, "pid": 13952, "timesteps_since_restore": 780000, "episodes_total": 1642, "episode_len_mean": 500.0, "date": "2018-11-28_06-07-24", "info": {"grad_time_ms": 1734.164, "num_steps_trained": 780000, "opt_samples": 20000.0, "num_steps_sampled": 780000, "adversary": {"kl": 0.008724198676645756, "cur_lr": 0.009999999776482582, "policy_loss": 2.1609251499176025, "total_loss": 89.12094116210938, "vf_loss": 86.92648315429688, "vf_explained_var": 0.496227502822876, "entropy": 4.199321269989014}, "sample_peak_throughput": 243.918, "learner": {}, "opt_peak_throughput": 11532.933, "av": {"kl": 0.038443658500909805, "cur_lr": 0.009999999776482582, "policy_loss": -2.1508355140686035, "total_loss": 93.62230682373047, "vf_loss": 95.7147445678711, "vf_explained_var": 0.4615268111228943, "entropy": 1.741853952407837}, "update_time_ms": 7.271, "sample_time_ms": 81994.606}, "num_metric_batches_dropped": 0, "timesteps_total": 780000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385325, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b080>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 40, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -128.27434225056192, "av": 128.27434225056192}, "time_total_s": 3512.606231689453, "iterations_since_restore": 40, "time_this_iter_s": 81.3042733669281, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3512.606231689453, "pid": 13952, "timesteps_since_restore": 800000, "episodes_total": 1682, "episode_len_mean": 500.0, "date": "2018-11-28_06-08-45", "info": {"grad_time_ms": 1735.063, "num_steps_trained": 800000, "opt_samples": 20000.0, "num_steps_sampled": 800000, "adversary": {"kl": 0.018418436869978905, "cur_lr": 0.009999999776482582, "policy_loss": 2.1807520389556885, "total_loss": 93.45703125, "vf_loss": 91.24082946777344, "vf_explained_var": 0.4914810061454773, "entropy": 4.248744964599609}, "sample_peak_throughput": 244.844, "learner": {}, "opt_peak_throughput": 11526.962, "av": {"kl": 0.018527807667851448, "cur_lr": 0.009999999776482582, "policy_loss": -2.339494228363037, "total_loss": 93.87454223632812, "vf_loss": 96.18583679199219, "vf_explained_var": 0.48251211643218994, "entropy": 1.7291525602340698}, "update_time_ms": 7.29, "sample_time_ms": 81684.654}, "num_metric_batches_dropped": 0, "timesteps_total": 800000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385408, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b7b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 41, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -128.74024041462548, "av": 128.74024041462548}, "time_total_s": 3595.8676903247833, "iterations_since_restore": 41, "time_this_iter_s": 83.2614586353302, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3595.8676903247833, "pid": 13952, "timesteps_since_restore": 820000, "episodes_total": 1722, "episode_len_mean": 500.0, "date": "2018-11-28_06-10-08", "info": {"grad_time_ms": 1742.769, "num_steps_trained": 820000, "opt_samples": 20000.0, "num_steps_sampled": 820000, "adversary": {"kl": 0.021216286346316338, "cur_lr": 0.009999999776482582, "policy_loss": 1.8575429916381836, "total_loss": 96.90740966796875, "vf_loss": 95.00910949707031, "vf_explained_var": 0.4854866862297058, "entropy": 4.2519025802612305}, "sample_peak_throughput": 246.112, "learner": {}, "opt_peak_throughput": 11475.989, "av": {"kl": 0.01834907755255699, "cur_lr": 0.009999999776482582, "policy_loss": -1.994110107421875, "total_loss": 96.88712310791016, "vf_loss": 98.85334014892578, "vf_explained_var": 0.47518712282180786, "entropy": 1.7109148502349854}, "update_time_ms": 7.274, "sample_time_ms": 81263.845}, "num_metric_batches_dropped": 0, "timesteps_total": 820000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385489, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b438>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 42, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -129.06147908517502, "av": 129.06147908517502}, "time_total_s": 3676.5197772979736, "iterations_since_restore": 42, "time_this_iter_s": 80.65208697319031, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3676.5197772979736, "pid": 13952, "timesteps_since_restore": 840000, "episodes_total": 1762, "episode_len_mean": 500.0, "date": "2018-11-28_06-11-29", "info": {"grad_time_ms": 1744.95, "num_steps_trained": 840000, "opt_samples": 20000.0, "num_steps_sampled": 840000, "adversary": {"kl": 0.02019001543521881, "cur_lr": 0.009999999776482582, "policy_loss": 1.9302937984466553, "total_loss": 99.96340942382812, "vf_loss": 97.99427032470703, "vf_explained_var": 0.47667115926742554, "entropy": 4.302917957305908}, "sample_peak_throughput": 246.432, "learner": {}, "opt_peak_throughput": 11461.648, "av": {"kl": 0.018776308745145798, "cur_lr": 0.009999999776482582, "policy_loss": -2.021080493927002, "total_loss": 100.54127502441406, "vf_loss": 102.53387451171875, "vf_explained_var": 0.46646779775619507, "entropy": 1.709304690361023}, "update_time_ms": 7.263, "sample_time_ms": 81158.186}, "num_metric_batches_dropped": 0, "timesteps_total": 840000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385570, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7ba58>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 43, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -128.01462761928232, "av": 128.01462761928232}, "time_total_s": 3757.8030977249146, "iterations_since_restore": 43, "time_this_iter_s": 81.28332042694092, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3757.8030977249146, "pid": 13952, "timesteps_since_restore": 860000, "episodes_total": 1802, "episode_len_mean": 500.0, "date": "2018-11-28_06-12-50", "info": {"grad_time_ms": 1741.776, "num_steps_trained": 860000, "opt_samples": 20000.0, "num_steps_sampled": 860000, "adversary": {"kl": 0.0159804355353117, "cur_lr": 0.009999999776482582, "policy_loss": 1.7594636678695679, "total_loss": 103.65975952148438, "vf_loss": 101.86963653564453, "vf_explained_var": 0.4659423232078552, "entropy": 4.285244464874268}, "sample_peak_throughput": 248.305, "learner": {}, "opt_peak_throughput": 11482.531, "av": {"kl": 0.01645960472524166, "cur_lr": 0.009999999776482582, "policy_loss": -1.8889564275741577, "total_loss": 103.81269073486328, "vf_loss": 105.67659759521484, "vf_explained_var": 0.4587240219116211, "entropy": 1.6820050477981567}, "update_time_ms": 7.254, "sample_time_ms": 80546.02}, "num_metric_batches_dropped": 0, "timesteps_total": 860000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385652, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf576d8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 44, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -129.83948924943977, "av": 129.83948924943977}, "time_total_s": 3839.730186700821, "iterations_since_restore": 44, "time_this_iter_s": 81.92708897590637, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3839.730186700821, "pid": 13952, "timesteps_since_restore": 880000, "episodes_total": 1842, "episode_len_mean": 500.0, "date": "2018-11-28_06-14-12", "info": {"grad_time_ms": 1743.957, "num_steps_trained": 880000, "opt_samples": 20000.0, "num_steps_sampled": 880000, "adversary": {"kl": 0.018476495519280434, "cur_lr": 0.009999999776482582, "policy_loss": 1.8119477033615112, "total_loss": 106.83740234375, "vf_loss": 104.98989868164062, "vf_explained_var": 0.4618349075317383, "entropy": 4.312431335449219}, "sample_peak_throughput": 248.772, "learner": {}, "opt_peak_throughput": 11468.174, "av": {"kl": 0.018010852858424187, "cur_lr": 0.009999999776482582, "policy_loss": -1.9153624773025513, "total_loss": 106.39140319824219, "vf_loss": 108.27936553955078, "vf_explained_var": 0.456814169883728, "entropy": 1.6541943550109863}, "update_time_ms": 7.243, "sample_time_ms": 80394.86}, "num_metric_batches_dropped": 0, "timesteps_total": 880000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385733, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b128>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 45, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.11920879932578, "av": 131.11920879932578}, "time_total_s": 3920.9409658908844, "iterations_since_restore": 45, "time_this_iter_s": 81.21077919006348, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 3920.9409658908844, "pid": 13952, "timesteps_since_restore": 900000, "episodes_total": 1882, "episode_len_mean": 500.0, "date": "2018-11-28_06-15-33", "info": {"grad_time_ms": 1744.098, "num_steps_trained": 900000, "opt_samples": 20000.0, "num_steps_sampled": 900000, "adversary": {"kl": 0.025739412754774094, "cur_lr": 0.009999999776482582, "policy_loss": 1.701007604598999, "total_loss": 110.31097412109375, "vf_loss": 108.56047821044922, "vf_explained_var": 0.4573706388473511, "entropy": 4.265908718109131}, "sample_peak_throughput": 248.948, "learner": {}, "opt_peak_throughput": 11467.247, "av": {"kl": 0.020227540284395218, "cur_lr": 0.009999999776482582, "policy_loss": -1.782984733581543, "total_loss": 109.75697326660156, "vf_loss": 111.50924682617188, "vf_explained_var": 0.44968080520629883, "entropy": 1.6662384271621704}, "update_time_ms": 7.234, "sample_time_ms": 80338.183}, "num_metric_batches_dropped": 0, "timesteps_total": 900000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385814, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf704e0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 46, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -132.041968113536, "av": 132.041968113536}, "time_total_s": 4001.9038021564484, "iterations_since_restore": 46, "time_this_iter_s": 80.96283626556396, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4001.9038021564484, "pid": 13952, "timesteps_since_restore": 920000, "episodes_total": 1922, "episode_len_mean": 500.0, "date": "2018-11-28_06-16-54", "info": {"grad_time_ms": 1743.075, "num_steps_trained": 920000, "opt_samples": 20000.0, "num_steps_sampled": 920000, "adversary": {"kl": 0.018289029598236084, "cur_lr": 0.009999999776482582, "policy_loss": 1.56892728805542, "total_loss": 113.22146606445312, "vf_loss": 111.61734771728516, "vf_explained_var": 0.45512741804122925, "entropy": 4.336436748504639}, "sample_peak_throughput": 249.853, "learner": {}, "opt_peak_throughput": 11473.974, "av": {"kl": 0.0537111759185791, "cur_lr": 0.009999999776482582, "policy_loss": -1.5514901876449585, "total_loss": 113.0456771850586, "vf_loss": 114.5156021118164, "vf_explained_var": 0.4475105404853821, "entropy": 1.6663929224014282}, "update_time_ms": 7.192, "sample_time_ms": 80046.932}, "num_metric_batches_dropped": 0, "timesteps_total": 920000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385897, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b048>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 47, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.99399368601763, "av": 130.99399368601763}, "time_total_s": 4084.8740339279175, "iterations_since_restore": 47, "time_this_iter_s": 82.97023177146912, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4084.8740339279175, "pid": 13952, "timesteps_since_restore": 940000, "episodes_total": 1962, "episode_len_mean": 500.0, "date": "2018-11-28_06-18-17", "info": {"grad_time_ms": 1743.608, "num_steps_trained": 940000, "opt_samples": 20000.0, "num_steps_sampled": 940000, "adversary": {"kl": 0.01676962897181511, "cur_lr": 0.009999999776482582, "policy_loss": 1.4523377418518066, "total_loss": 115.63408660888672, "vf_loss": 114.14947509765625, "vf_explained_var": 0.44773590564727783, "entropy": 4.291214466094971}, "sample_peak_throughput": 249.032, "learner": {}, "opt_peak_throughput": 11470.466, "av": {"kl": 0.012440964579582214, "cur_lr": 0.009999999776482582, "policy_loss": -1.558239459991455, "total_loss": 115.614501953125, "vf_loss": 117.14434814453125, "vf_explained_var": 0.4438019394874573, "entropy": 1.681268334388733}, "update_time_ms": 7.213, "sample_time_ms": 80310.976}, "num_metric_batches_dropped": 0, "timesteps_total": 940000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543385979, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b358>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 48, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.67443516750492, "av": 130.67443516750492}, "time_total_s": 4166.767552852631, "iterations_since_restore": 48, "time_this_iter_s": 81.89351892471313, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4166.767552852631, "pid": 13952, "timesteps_since_restore": 960000, "episodes_total": 2002, "episode_len_mean": 500.0, "date": "2018-11-28_06-19-39", "info": {"grad_time_ms": 1745.836, "num_steps_trained": 960000, "opt_samples": 20000.0, "num_steps_sampled": 960000, "adversary": {"kl": 0.012557015754282475, "cur_lr": 0.009999999776482582, "policy_loss": 1.4570940732955933, "total_loss": 119.49314880371094, "vf_loss": 118.01190948486328, "vf_explained_var": 0.44200021028518677, "entropy": 4.321202278137207}, "sample_peak_throughput": 249.695, "learner": {}, "opt_peak_throughput": 11455.831, "av": {"kl": 0.04397602006793022, "cur_lr": 0.009999999776482582, "policy_loss": -1.4538437128067017, "total_loss": 119.17545318603516, "vf_loss": 120.52912139892578, "vf_explained_var": 0.4386202096939087, "entropy": 1.6892001628875732}, "update_time_ms": 7.28, "sample_time_ms": 80097.76}, "num_metric_batches_dropped": 0, "timesteps_total": 960000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386068, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b6a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 49, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.9692701784855, "av": 130.9692701784855}, "time_total_s": 4255.095054864883, "iterations_since_restore": 49, "time_this_iter_s": 88.32750201225281, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4255.095054864883, "pid": 13952, "timesteps_since_restore": 980000, "episodes_total": 2042, "episode_len_mean": 500.0, "date": "2018-11-28_06-21-08", "info": {"grad_time_ms": 1741.412, "num_steps_trained": 980000, "opt_samples": 20000.0, "num_steps_sampled": 980000, "adversary": {"kl": 0.016811450943350792, "cur_lr": 0.009999999776482582, "policy_loss": 1.3831812143325806, "total_loss": 121.3390884399414, "vf_loss": 119.92353820800781, "vf_explained_var": 0.4396745562553406, "entropy": 4.338583946228027}, "sample_peak_throughput": 248.09, "learner": {}, "opt_peak_throughput": 11484.932, "av": {"kl": 0.009944519028067589, "cur_lr": 0.009999999776482582, "policy_loss": -1.4943883419036865, "total_loss": 120.9542007446289, "vf_loss": 122.4146499633789, "vf_explained_var": 0.4365578889846802, "entropy": 1.6698334217071533}, "update_time_ms": 7.278, "sample_time_ms": 80615.992}, "num_metric_batches_dropped": 0, "timesteps_total": 980000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386152, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b748>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 50, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.55919775393446, "av": 131.55919775393446}, "time_total_s": 4339.2137105464935, "iterations_since_restore": 50, "time_this_iter_s": 84.11865568161011, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4339.2137105464935, "pid": 13952, "timesteps_since_restore": 1000000, "episodes_total": 2082, "episode_len_mean": 500.0, "date": "2018-11-28_06-22-32", "info": {"grad_time_ms": 1739.952, "num_steps_trained": 1000000, "opt_samples": 20000.0, "num_steps_sampled": 1000000, "adversary": {"kl": 0.021761959418654442, "cur_lr": 0.009999999776482582, "policy_loss": 1.3305234909057617, "total_loss": 124.81950378417969, "vf_loss": 123.44715118408203, "vf_explained_var": 0.4352579116821289, "entropy": 4.334454536437988}, "sample_peak_throughput": 247.222, "learner": {}, "opt_peak_throughput": 11494.572, "av": {"kl": 0.01049143634736538, "cur_lr": 0.009999999776482582, "policy_loss": -1.4484584331512451, "total_loss": 125.14472198486328, "vf_loss": 126.57521057128906, "vf_explained_var": 0.4313873052597046, "entropy": 1.6490579843521118}, "update_time_ms": 7.293, "sample_time_ms": 80898.913}, "num_metric_batches_dropped": 0, "timesteps_total": 1000000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386234, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b0b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 51, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.8349596794735, "av": 131.8349596794735}, "time_total_s": 4421.434294939041, "iterations_since_restore": 51, "time_this_iter_s": 82.22058439254761, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4421.434294939041, "pid": 13952, "timesteps_since_restore": 1020000, "episodes_total": 2122, "episode_len_mean": 500.0, "date": "2018-11-28_06-23-54", "info": {"grad_time_ms": 1735.689, "num_steps_trained": 1020000, "opt_samples": 20000.0, "num_steps_sampled": 1020000, "adversary": {"kl": 0.02840583585202694, "cur_lr": 0.009999999776482582, "policy_loss": 1.3073534965515137, "total_loss": 127.86129760742188, "vf_loss": 126.49927520751953, "vf_explained_var": 0.429945170879364, "entropy": 4.3497233390808105}, "sample_peak_throughput": 247.527, "learner": {}, "opt_peak_throughput": 11522.799, "av": {"kl": 0.01664217747747898, "cur_lr": 0.009999999776482582, "policy_loss": -1.3953665494918823, "total_loss": 127.96405029296875, "vf_loss": 129.33099365234375, "vf_explained_var": 0.4250331521034241, "entropy": 1.6410784721374512}, "update_time_ms": 7.255, "sample_time_ms": 80799.293}, "num_metric_batches_dropped": 0, "timesteps_total": 1020000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386316, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b160>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 52, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.0533337925969, "av": 131.0533337925969}, "time_total_s": 4503.450275659561, "iterations_since_restore": 52, "time_this_iter_s": 82.01598072052002, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4503.450275659561, "pid": 13952, "timesteps_since_restore": 1040000, "episodes_total": 2162, "episode_len_mean": 500.0, "date": "2018-11-28_06-25-16", "info": {"grad_time_ms": 1734.02, "num_steps_trained": 1040000, "opt_samples": 20000.0, "num_steps_sampled": 1040000, "adversary": {"kl": 0.01598462276160717, "cur_lr": 0.009999999776482582, "policy_loss": 1.1605455875396729, "total_loss": 129.4872283935547, "vf_loss": 128.29583740234375, "vf_explained_var": 0.42962008714675903, "entropy": 4.333009719848633}, "sample_peak_throughput": 247.104, "learner": {}, "opt_peak_throughput": 11533.891, "av": {"kl": 0.01910962536931038, "cur_lr": 0.009999999776482582, "policy_loss": -1.2532340288162231, "total_loss": 130.5751495361328, "vf_loss": 131.795654296875, "vf_explained_var": 0.4250667691230774, "entropy": 1.618525743484497}, "update_time_ms": 7.258, "sample_time_ms": 80937.501}, "num_metric_batches_dropped": 0, "timesteps_total": 1040000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386399, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b0b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 53, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.213067057397, "av": 131.213067057397}, "time_total_s": 4586.55452299118, "iterations_since_restore": 53, "time_this_iter_s": 83.10424733161926, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4586.55452299118, "pid": 13952, "timesteps_since_restore": 1060000, "episodes_total": 2202, "episode_len_mean": 500.0, "date": "2018-11-28_06-26-39", "info": {"grad_time_ms": 1736.894, "num_steps_trained": 1060000, "opt_samples": 20000.0, "num_steps_sampled": 1060000, "adversary": {"kl": 0.015318873338401318, "cur_lr": 0.009999999776482582, "policy_loss": 0.9841632843017578, "total_loss": 130.44094848632812, "vf_loss": 129.4273223876953, "vf_explained_var": 0.42504000663757324, "entropy": 4.275145530700684}, "sample_peak_throughput": 246.558, "learner": {}, "opt_peak_throughput": 11514.806, "av": {"kl": 0.011684470809996128, "cur_lr": 0.009999999776482582, "policy_loss": -1.135874629020691, "total_loss": 131.68629455566406, "vf_loss": 132.8021240234375, "vf_explained_var": 0.4194890856742859, "entropy": 1.6102066040039062}, "update_time_ms": 7.229, "sample_time_ms": 81116.796}, "num_metric_batches_dropped": 0, "timesteps_total": 1060000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386479, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b860>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 54, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.0723934652754, "av": 130.0723934652754}, "time_total_s": 4666.571650266647, "iterations_since_restore": 54, "time_this_iter_s": 80.01712727546692, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4666.571650266647, "pid": 13952, "timesteps_since_restore": 1080000, "episodes_total": 2242, "episode_len_mean": 500.0, "date": "2018-11-28_06-27-59", "info": {"grad_time_ms": 1738.148, "num_steps_trained": 1080000, "opt_samples": 20000.0, "num_steps_sampled": 1080000, "adversary": {"kl": 0.014448675327003002, "cur_lr": 0.009999999776482582, "policy_loss": 0.973133385181427, "total_loss": 134.36521911621094, "vf_loss": 133.36444091796875, "vf_explained_var": 0.41937166452407837, "entropy": 4.290156841278076}, "sample_peak_throughput": 247.144, "learner": {}, "opt_peak_throughput": 11506.5, "av": {"kl": 0.04814958944916725, "cur_lr": 0.009999999776482582, "policy_loss": -0.9901572465896606, "total_loss": 135.78224182128906, "vf_loss": 136.69004821777344, "vf_explained_var": 0.4165177345275879, "entropy": 1.6094080209732056}, "update_time_ms": 7.21, "sample_time_ms": 80924.615}, "num_metric_batches_dropped": 0, "timesteps_total": 1080000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386565, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 55, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.15222211289492, "av": 130.15222211289492}, "time_total_s": 4751.96887087822, "iterations_since_restore": 55, "time_this_iter_s": 85.39722061157227, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4751.96887087822, "pid": 13952, "timesteps_since_restore": 1100000, "episodes_total": 2282, "episode_len_mean": 500.0, "date": "2018-11-28_06-29-25", "info": {"grad_time_ms": 1740.887, "num_steps_trained": 1100000, "opt_samples": 20000.0, "num_steps_sampled": 1100000, "adversary": {"kl": 0.014271548017859459, "cur_lr": 0.009999999776482582, "policy_loss": 1.0247853994369507, "total_loss": 136.90255737304688, "vf_loss": 135.8502197265625, "vf_explained_var": 0.4182282090187073, "entropy": 4.268673419952393}, "sample_peak_throughput": 245.879, "learner": {}, "opt_peak_throughput": 11488.399, "av": {"kl": 0.02458677999675274, "cur_lr": 0.009999999776482582, "policy_loss": -1.1104111671447754, "total_loss": 138.5738067626953, "vf_loss": 139.62109375, "vf_explained_var": 0.4141536355018616, "entropy": 1.5966615676879883}, "update_time_ms": 7.146, "sample_time_ms": 81340.682}, "num_metric_batches_dropped": 0, "timesteps_total": 1100000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386646, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b748>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 56, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.4033386736847, "av": 131.4033386736847}, "time_total_s": 4833.602897644043, "iterations_since_restore": 56, "time_this_iter_s": 81.63402676582336, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4833.602897644043, "pid": 13952, "timesteps_since_restore": 1120000, "episodes_total": 2322, "episode_len_mean": 500.0, "date": "2018-11-28_06-30-46", "info": {"grad_time_ms": 1737.929, "num_steps_trained": 1120000, "opt_samples": 20000.0, "num_steps_sampled": 1120000, "adversary": {"kl": 0.01354130543768406, "cur_lr": 0.009999999776482582, "policy_loss": 0.9386312365531921, "total_loss": 138.4720458984375, "vf_loss": 137.50738525390625, "vf_explained_var": 0.41818827390670776, "entropy": 4.311363697052002}, "sample_peak_throughput": 245.668, "learner": {}, "opt_peak_throughput": 11507.95, "av": {"kl": 0.01319206040352583, "cur_lr": 0.009999999776482582, "policy_loss": -1.0664710998535156, "total_loss": 140.44920349121094, "vf_loss": 141.48182678222656, "vf_explained_var": 0.4124772548675537, "entropy": 1.5972049236297607}, "update_time_ms": 7.359, "sample_time_ms": 81410.666}, "num_metric_batches_dropped": 0, "timesteps_total": 1120000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386733, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b470>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 57, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.31985486170942, "av": 131.31985486170942}, "time_total_s": 4920.086606502533, "iterations_since_restore": 57, "time_this_iter_s": 86.48370885848999, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 4920.086606502533, "pid": 13952, "timesteps_since_restore": 1140000, "episodes_total": 2362, "episode_len_mean": 500.0, "date": "2018-11-28_06-32-13", "info": {"grad_time_ms": 1734.139, "num_steps_trained": 1140000, "opt_samples": 20000.0, "num_steps_sampled": 1140000, "adversary": {"kl": 0.012689183466136456, "cur_lr": 0.009999999776482582, "policy_loss": 0.8264341950416565, "total_loss": 141.80029296875, "vf_loss": 140.9495849609375, "vf_explained_var": 0.41115301847457886, "entropy": 4.2854180335998535}, "sample_peak_throughput": 244.601, "learner": {}, "opt_peak_throughput": 11533.104, "av": {"kl": 0.027302954345941544, "cur_lr": 0.009999999776482582, "policy_loss": -0.9221183657646179, "total_loss": 144.11642456054688, "vf_loss": 144.96859741210938, "vf_explained_var": 0.40613704919815063, "entropy": 1.590661883354187}, "update_time_ms": 7.361, "sample_time_ms": 81765.92}, "num_metric_batches_dropped": 0, "timesteps_total": 1140000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386815, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b748>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 58, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -130.10181136780068, "av": 130.10181136780068}, "time_total_s": 5002.146100997925, "iterations_since_restore": 58, "time_this_iter_s": 82.05949449539185, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5002.146100997925, "pid": 13952, "timesteps_since_restore": 1160000, "episodes_total": 2402, "episode_len_mean": 500.0, "date": "2018-11-28_06-33-35", "info": {"grad_time_ms": 1733.476, "num_steps_trained": 1160000, "opt_samples": 20000.0, "num_steps_sampled": 1160000, "adversary": {"kl": 0.013660536147654057, "cur_lr": 0.009999999776482582, "policy_loss": 0.7242046594619751, "total_loss": 144.01634216308594, "vf_loss": 143.26588439941406, "vf_explained_var": 0.4042515754699707, "entropy": 4.295890808105469}, "sample_peak_throughput": 244.549, "learner": {}, "opt_peak_throughput": 11537.512, "av": {"kl": 0.01473498996347189, "cur_lr": 0.009999999776482582, "policy_loss": -0.8248165845870972, "total_loss": 146.53732299804688, "vf_loss": 147.3242950439453, "vf_explained_var": 0.40090203285217285, "entropy": 1.5957759618759155}, "update_time_ms": 7.375, "sample_time_ms": 81783.096}, "num_metric_batches_dropped": 0, "timesteps_total": 1160000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386896, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b080>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 59, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -131.52794011842883, "av": 131.52794011842883}, "time_total_s": 5083.475834131241, "iterations_since_restore": 59, "time_this_iter_s": 81.32973313331604, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5083.475834131241, "pid": 13952, "timesteps_since_restore": 1180000, "episodes_total": 2442, "episode_len_mean": 500.0, "date": "2018-11-28_06-34-56", "info": {"grad_time_ms": 1732.692, "num_steps_trained": 1180000, "opt_samples": 20000.0, "num_steps_sampled": 1180000, "adversary": {"kl": 0.015837235376238823, "cur_lr": 0.009999999776482582, "policy_loss": 0.8912318348884583, "total_loss": 144.58590698242188, "vf_loss": 143.6642303466797, "vf_explained_var": 0.4040769934654236, "entropy": 4.288106441497803}, "sample_peak_throughput": 246.657, "learner": {}, "opt_peak_throughput": 11542.729, "av": {"kl": 0.012734312564134598, "cur_lr": 0.009999999776482582, "policy_loss": -0.9947763681411743, "total_loss": 146.90867614746094, "vf_loss": 147.87081909179688, "vf_explained_var": 0.399688184261322, "entropy": 1.5866448879241943}, "update_time_ms": 7.313, "sample_time_ms": 81084.15}, "num_metric_batches_dropped": 0, "timesteps_total": 1180000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543386978, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70e80>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 60, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -132.37706659863431, "av": 132.37706659863431}, "time_total_s": 5165.337956190109, "iterations_since_restore": 60, "time_this_iter_s": 81.86212205886841, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5165.337956190109, "pid": 13952, "timesteps_since_restore": 1200000, "episodes_total": 2482, "episode_len_mean": 500.0, "date": "2018-11-28_06-36-18", "info": {"grad_time_ms": 1732.958, "num_steps_trained": 1200000, "opt_samples": 20000.0, "num_steps_sampled": 1200000, "adversary": {"kl": 0.018897604197263718, "cur_lr": 0.009999999776482582, "policy_loss": 0.9007771611213684, "total_loss": 147.51483154296875, "vf_loss": 146.57765197753906, "vf_explained_var": 0.39954710006713867, "entropy": 4.300414085388184}, "sample_peak_throughput": 247.346, "learner": {}, "opt_peak_throughput": 11540.961, "av": {"kl": 0.020874356850981712, "cur_lr": 0.009999999776482582, "policy_loss": -0.9358866214752197, "total_loss": 149.97434997558594, "vf_loss": 150.85667419433594, "vf_explained_var": 0.39544129371643066, "entropy": 1.5943161249160767}, "update_time_ms": 7.247, "sample_time_ms": 80858.315}, "num_metric_batches_dropped": 0, "timesteps_total": 1200000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387059, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b898>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 61, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.04897620955447, "av": 134.04897620955447}, "time_total_s": 5246.490478754044, "iterations_since_restore": 61, "time_this_iter_s": 81.15252256393433, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5246.490478754044, "pid": 13952, "timesteps_since_restore": 1220000, "episodes_total": 2522, "episode_len_mean": 500.0, "date": "2018-11-28_06-37-39", "info": {"grad_time_ms": 1735.055, "num_steps_trained": 1220000, "opt_samples": 20000.0, "num_steps_sampled": 1220000, "adversary": {"kl": 0.01497358363121748, "cur_lr": 0.009999999776482582, "policy_loss": 0.7934792041778564, "total_loss": 151.54832458496094, "vf_loss": 150.7261199951172, "vf_explained_var": 0.3963291049003601, "entropy": 4.299117565155029}, "sample_peak_throughput": 247.68, "learner": {}, "opt_peak_throughput": 11527.01, "av": {"kl": 0.013128320686519146, "cur_lr": 0.009999999776482582, "policy_loss": -0.8924459218978882, "total_loss": 153.58580017089844, "vf_loss": 154.44459533691406, "vf_explained_var": 0.3921806812286377, "entropy": 1.583187460899353}, "update_time_ms": 7.208, "sample_time_ms": 80749.452}, "num_metric_batches_dropped": 0, "timesteps_total": 1220000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387140, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bd68>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 62, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -133.7005316835606, "av": 133.7005316835606}, "time_total_s": 5327.509784698486, "iterations_since_restore": 62, "time_this_iter_s": 81.01930594444275, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5327.509784698486, "pid": 13952, "timesteps_since_restore": 1240000, "episodes_total": 2562, "episode_len_mean": 500.0, "date": "2018-11-28_06-39-00", "info": {"grad_time_ms": 1733.486, "num_steps_trained": 1240000, "opt_samples": 20000.0, "num_steps_sampled": 1240000, "adversary": {"kl": 0.018492037430405617, "cur_lr": 0.009999999776482582, "policy_loss": 0.804580569267273, "total_loss": 153.9125518798828, "vf_loss": 153.07240295410156, "vf_explained_var": 0.3935573101043701, "entropy": 4.320350646972656}, "sample_peak_throughput": 247.981, "learner": {}, "opt_peak_throughput": 11537.444, "av": {"kl": 0.02620430290699005, "cur_lr": 0.009999999776482582, "policy_loss": -0.868517279624939, "total_loss": 155.8791961669922, "vf_loss": 156.68055725097656, "vf_explained_var": 0.3900719881057739, "entropy": 1.5466349124908447}, "update_time_ms": 7.207, "sample_time_ms": 80651.322}, "num_metric_batches_dropped": 0, "timesteps_total": 1240000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387223, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b6a0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 63, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.26732253511736, "av": 134.26732253511736}, "time_total_s": 5410.741124868393, "iterations_since_restore": 63, "time_this_iter_s": 83.23134016990662, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5410.741124868393, "pid": 13952, "timesteps_since_restore": 1260000, "episodes_total": 2602, "episode_len_mean": 500.0, "date": "2018-11-28_06-40-23", "info": {"grad_time_ms": 1728.046, "num_steps_trained": 1260000, "opt_samples": 20000.0, "num_steps_sampled": 1260000, "adversary": {"kl": 0.016239382326602936, "cur_lr": 0.009999999776482582, "policy_loss": 0.7359420657157898, "total_loss": 155.22430419921875, "vf_loss": 154.45716857910156, "vf_explained_var": 0.38995200395584106, "entropy": 4.350916385650635}, "sample_peak_throughput": 247.926, "learner": {}, "opt_peak_throughput": 11573.766, "av": {"kl": 0.024007810279726982, "cur_lr": 0.009999999776482582, "policy_loss": -0.8363399505615234, "total_loss": 156.89100646972656, "vf_loss": 157.66586303710938, "vf_explained_var": 0.385701060295105, "entropy": 1.5409342050552368}, "update_time_ms": 7.239, "sample_time_ms": 80669.376}, "num_metric_batches_dropped": 0, "timesteps_total": 1260000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387303, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb38>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 64, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.3214921944486, "av": 134.3214921944486}, "time_total_s": 5490.487711191177, "iterations_since_restore": 64, "time_this_iter_s": 79.74658632278442, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5490.487711191177, "pid": 13952, "timesteps_since_restore": 1280000, "episodes_total": 2642, "episode_len_mean": 500.0, "date": "2018-11-28_06-41-43", "info": {"grad_time_ms": 1722.438, "num_steps_trained": 1280000, "opt_samples": 20000.0, "num_steps_sampled": 1280000, "adversary": {"kl": 0.015499105677008629, "cur_lr": 0.009999999776482582, "policy_loss": 0.7227514386177063, "total_loss": 161.50563049316406, "vf_loss": 160.7530975341797, "vf_explained_var": 0.3838093876838684, "entropy": 4.376875877380371}, "sample_peak_throughput": 247.992, "learner": {}, "opt_peak_throughput": 11611.449, "av": {"kl": 0.02154490165412426, "cur_lr": 0.009999999776482582, "policy_loss": -0.8661589026451111, "total_loss": 162.5692596435547, "vf_loss": 163.3802490234375, "vf_explained_var": 0.3835277557373047, "entropy": 1.5576012134552002}, "update_time_ms": 7.206, "sample_time_ms": 80647.88}, "num_metric_batches_dropped": 0, "timesteps_total": 1280000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387384, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b748>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 65, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.1417885493529, "av": 135.1417885493529}, "time_total_s": 5571.782655715942, "iterations_since_restore": 65, "time_this_iter_s": 81.29494452476501, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5571.782655715942, "pid": 13952, "timesteps_since_restore": 1300000, "episodes_total": 2682, "episode_len_mean": 500.0, "date": "2018-11-28_06-43-04", "info": {"grad_time_ms": 1721.681, "num_steps_trained": 1300000, "opt_samples": 20000.0, "num_steps_sampled": 1300000, "adversary": {"kl": 0.02011900395154953, "cur_lr": 0.009999999776482582, "policy_loss": 0.7851038575172424, "total_loss": 161.96389770507812, "vf_loss": 161.14012145996094, "vf_explained_var": 0.38311612606048584, "entropy": 4.3527984619140625}, "sample_peak_throughput": 249.258, "learner": {}, "opt_peak_throughput": 11616.557, "av": {"kl": 0.011572307907044888, "cur_lr": 0.009999999776482582, "policy_loss": -0.8966805934906006, "total_loss": 163.20620727539062, "vf_loss": 164.07318115234375, "vf_explained_var": 0.38215386867523193, "entropy": 1.5548070669174194}, "update_time_ms": 7.243, "sample_time_ms": 80238.286}, "num_metric_batches_dropped": 0, "timesteps_total": 1300000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387467, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b5f8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 66, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.2946575198119, "av": 135.2946575198119}, "time_total_s": 5654.625401496887, "iterations_since_restore": 66, "time_this_iter_s": 82.84274578094482, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5654.625401496887, "pid": 13952, "timesteps_since_restore": 1320000, "episodes_total": 2722, "episode_len_mean": 500.0, "date": "2018-11-28_06-44-27", "info": {"grad_time_ms": 1721.002, "num_steps_trained": 1320000, "opt_samples": 20000.0, "num_steps_sampled": 1320000, "adversary": {"kl": 0.015043600462377071, "cur_lr": 0.009999999776482582, "policy_loss": 0.6824731230735779, "total_loss": 163.51661682128906, "vf_loss": 162.80517578125, "vf_explained_var": 0.3831905126571655, "entropy": 4.387882709503174}, "sample_peak_throughput": 248.88, "learner": {}, "opt_peak_throughput": 11621.137, "av": {"kl": 0.016994882375001907, "cur_lr": 0.009999999776482582, "policy_loss": -0.8362561464309692, "total_loss": 164.2613983154297, "vf_loss": 165.0540771484375, "vf_explained_var": 0.3792515993118286, "entropy": 1.5383495092391968}, "update_time_ms": 7.007, "sample_time_ms": 80360.064}, "num_metric_batches_dropped": 0, "timesteps_total": 1320000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387552, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7ba58>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 67, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.52931424407944, "av": 135.52931424407944}, "time_total_s": 5739.507684469223, "iterations_since_restore": 67, "time_this_iter_s": 84.88228297233582, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5739.507684469223, "pid": 13952, "timesteps_since_restore": 1340000, "episodes_total": 2762, "episode_len_mean": 500.0, "date": "2018-11-28_06-45-52", "info": {"grad_time_ms": 1725.854, "num_steps_trained": 1340000, "opt_samples": 20000.0, "num_steps_sampled": 1340000, "adversary": {"kl": 0.013339642435312271, "cur_lr": 0.009999999776482582, "policy_loss": 0.4768179655075073, "total_loss": 164.80201721191406, "vf_loss": 164.2994842529297, "vf_explained_var": 0.3848726153373718, "entropy": 4.382813453674316}, "sample_peak_throughput": 249.392, "learner": {}, "opt_peak_throughput": 11588.465, "av": {"kl": 0.011749875731766224, "cur_lr": 0.009999999776482582, "policy_loss": -0.6483621001243591, "total_loss": 166.15902709960938, "vf_loss": 166.77716064453125, "vf_explained_var": 0.3820887804031372, "entropy": 1.5368443727493286}, "update_time_ms": 6.92, "sample_time_ms": 80195.15}, "num_metric_batches_dropped": 0, "timesteps_total": 1340000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387637, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7ba20>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 68, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.57147759220922, "av": 134.57147759220922}, "time_total_s": 5824.107227802277, "iterations_since_restore": 68, "time_this_iter_s": 84.59954333305359, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5824.107227802277, "pid": 13952, "timesteps_since_restore": 1360000, "episodes_total": 2802, "episode_len_mean": 500.0, "date": "2018-11-28_06-47-17", "info": {"grad_time_ms": 1725.182, "num_steps_trained": 1360000, "opt_samples": 20000.0, "num_steps_sampled": 1360000, "adversary": {"kl": 0.01530789490789175, "cur_lr": 0.009999999776482582, "policy_loss": 0.49038130044937134, "total_loss": 167.08120727539062, "vf_loss": 166.5614471435547, "vf_explained_var": 0.37930405139923096, "entropy": 4.388901710510254}, "sample_peak_throughput": 248.601, "learner": {}, "opt_peak_throughput": 11592.98, "av": {"kl": 0.019881801679730415, "cur_lr": 0.009999999776482582, "policy_loss": -0.6574125289916992, "total_loss": 168.43939208984375, "vf_loss": 169.04580688476562, "vf_explained_var": 0.3773631453514099, "entropy": 1.5387040376663208}, "update_time_ms": 6.817, "sample_time_ms": 80450.061}, "num_metric_batches_dropped": 0, "timesteps_total": 1360000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387721, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b240>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 69, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.4990894096596, "av": 135.4990894096596}, "time_total_s": 5908.4604778289795, "iterations_since_restore": 69, "time_this_iter_s": 84.35325002670288, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5908.4604778289795, "pid": 13952, "timesteps_since_restore": 1380000, "episodes_total": 2842, "episode_len_mean": 500.0, "date": "2018-11-28_06-48-41", "info": {"grad_time_ms": 1724.505, "num_steps_trained": 1380000, "opt_samples": 20000.0, "num_steps_sampled": 1380000, "adversary": {"kl": 0.014503189362585545, "cur_lr": 0.009999999776482582, "policy_loss": 0.5110988616943359, "total_loss": 169.26902770996094, "vf_loss": 168.7301025390625, "vf_explained_var": 0.3763064742088318, "entropy": 4.356418132781982}, "sample_peak_throughput": 247.669, "learner": {}, "opt_peak_throughput": 11597.529, "av": {"kl": 0.01618608832359314, "cur_lr": 0.009999999776482582, "policy_loss": -0.6794823408126831, "total_loss": 170.7684326171875, "vf_loss": 171.406494140625, "vf_explained_var": 0.3739578127861023, "entropy": 1.5445700883865356}, "update_time_ms": 6.836, "sample_time_ms": 80752.994}, "num_metric_batches_dropped": 0, "timesteps_total": 1380000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387805, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb38>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 70, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.09391657557464, "av": 135.09391657557464}, "time_total_s": 5992.117367506027, "iterations_since_restore": 70, "time_this_iter_s": 83.65688967704773, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 5992.117367506027, "pid": 13952, "timesteps_since_restore": 1400000, "episodes_total": 2882, "episode_len_mean": 500.0, "date": "2018-11-28_06-50-05", "info": {"grad_time_ms": 1723.474, "num_steps_trained": 1400000, "opt_samples": 20000.0, "num_steps_sampled": 1400000, "adversary": {"kl": 0.014444848522543907, "cur_lr": 0.009999999776482582, "policy_loss": 0.46287477016448975, "total_loss": 170.49215698242188, "vf_loss": 170.00155639648438, "vf_explained_var": 0.3741467595100403, "entropy": 4.347509384155273}, "sample_peak_throughput": 247.117, "learner": {}, "opt_peak_throughput": 11604.467, "av": {"kl": 0.020296594128012657, "cur_lr": 0.009999999776482582, "policy_loss": -0.6138005256652832, "total_loss": 172.03672790527344, "vf_loss": 172.5984344482422, "vf_explained_var": 0.3725476861000061, "entropy": 1.516922116279602}, "update_time_ms": 6.896, "sample_time_ms": 80933.367}, "num_metric_batches_dropped": 0, "timesteps_total": 1400000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387887, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bf60>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 71, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.98331592565054, "av": 134.98331592565054}, "time_total_s": 6073.876455068588, "iterations_since_restore": 71, "time_this_iter_s": 81.75908756256104, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6073.876455068588, "pid": 13952, "timesteps_since_restore": 1420000, "episodes_total": 2922, "episode_len_mean": 500.0, "date": "2018-11-28_06-51-27", "info": {"grad_time_ms": 1721.247, "num_steps_trained": 1420000, "opt_samples": 20000.0, "num_steps_sampled": 1420000, "adversary": {"kl": 0.012079523876309395, "cur_lr": 0.009999999776482582, "policy_loss": 0.36715853214263916, "total_loss": 171.28355407714844, "vf_loss": 170.8931427001953, "vf_explained_var": 0.37310487031936646, "entropy": 4.3447184562683105}, "sample_peak_throughput": 246.925, "learner": {}, "opt_peak_throughput": 11619.485, "av": {"kl": 0.027138421311974525, "cur_lr": 0.009999999776482582, "policy_loss": -0.4946845769882202, "total_loss": 172.43605041503906, "vf_loss": 172.86105346679688, "vf_explained_var": 0.3713102340698242, "entropy": 1.520663857460022}, "update_time_ms": 6.943, "sample_time_ms": 80996.208}, "num_metric_batches_dropped": 0, "timesteps_total": 1420000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543387967, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb38>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 72, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.84578582640057, "av": 134.84578582640057}, "time_total_s": 6153.911899805069, "iterations_since_restore": 72, "time_this_iter_s": 80.03544473648071, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6153.911899805069, "pid": 13952, "timesteps_since_restore": 1440000, "episodes_total": 2962, "episode_len_mean": 500.0, "date": "2018-11-28_06-52-47", "info": {"grad_time_ms": 1716.138, "num_steps_trained": 1440000, "opt_samples": 20000.0, "num_steps_sampled": 1440000, "adversary": {"kl": 0.029520131647586823, "cur_lr": 0.009999999776482582, "policy_loss": 0.5555472373962402, "total_loss": 175.15460205078125, "vf_loss": 174.54222106933594, "vf_explained_var": 0.37129324674606323, "entropy": 4.33070707321167}, "sample_peak_throughput": 247.21, "learner": {}, "opt_peak_throughput": 11654.074, "av": {"kl": 0.016857659444212914, "cur_lr": 0.009999999776482582, "policy_loss": -0.571834921836853, "total_loss": 175.82443237304688, "vf_loss": 176.3531036376953, "vf_explained_var": 0.36867958307266235, "entropy": 1.5363824367523193}, "update_time_ms": 6.928, "sample_time_ms": 80902.987}, "num_metric_batches_dropped": 0, "timesteps_total": 1440000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388048, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b780>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 73, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.39821875430385, "av": 135.39821875430385}, "time_total_s": 6234.765025615692, "iterations_since_restore": 73, "time_this_iter_s": 80.85312581062317, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6234.765025615692, "pid": 13952, "timesteps_since_restore": 1460000, "episodes_total": 3002, "episode_len_mean": 500.0, "date": "2018-11-28_06-54-08", "info": {"grad_time_ms": 1720.008, "num_steps_trained": 1460000, "opt_samples": 20000.0, "num_steps_sampled": 1460000, "adversary": {"kl": 0.015298559330403805, "cur_lr": 0.009999999776482582, "policy_loss": 0.44642236828804016, "total_loss": 176.0232696533203, "vf_loss": 175.5473175048828, "vf_explained_var": 0.3716146945953369, "entropy": 4.311791896820068}, "sample_peak_throughput": 247.951, "learner": {}, "opt_peak_throughput": 11627.855, "av": {"kl": 0.014232644811272621, "cur_lr": 0.009999999776482582, "policy_loss": -0.6234561800956726, "total_loss": 176.5580596923828, "vf_loss": 177.1449432373047, "vf_explained_var": 0.3694095015525818, "entropy": 1.5239125490188599}, "update_time_ms": 7.03, "sample_time_ms": 80661.187}, "num_metric_batches_dropped": 0, "timesteps_total": 1460000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388130, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b160>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 74, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.90965658956048, "av": 135.90965658956048}, "time_total_s": 6316.990650177002, "iterations_since_restore": 74, "time_this_iter_s": 82.22562456130981, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6316.990650177002, "pid": 13952, "timesteps_since_restore": 1480000, "episodes_total": 3042, "episode_len_mean": 500.0, "date": "2018-11-28_06-55-30", "info": {"grad_time_ms": 1718.662, "num_steps_trained": 1480000, "opt_samples": 20000.0, "num_steps_sampled": 1480000, "adversary": {"kl": 0.015507722273468971, "cur_lr": 0.009999999776482582, "policy_loss": 0.2811664640903473, "total_loss": 178.52133178710938, "vf_loss": 178.2103271484375, "vf_explained_var": 0.3688182234764099, "entropy": 4.3145318031311035}, "sample_peak_throughput": 247.187, "learner": {}, "opt_peak_throughput": 11636.958, "av": {"kl": 0.027134696021676064, "cur_lr": 0.009999999776482582, "policy_loss": -0.4565180242061615, "total_loss": 179.29293823242188, "vf_loss": 179.6798553466797, "vf_explained_var": 0.3685833215713501, "entropy": 1.5266793966293335}, "update_time_ms": 7.028, "sample_time_ms": 80910.426}, "num_metric_batches_dropped": 0, "timesteps_total": 1480000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388212, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b7b8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 75, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.38285991393516, "av": 135.38285991393516}, "time_total_s": 6399.115198373795, "iterations_since_restore": 75, "time_this_iter_s": 82.1245481967926, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6399.115198373795, "pid": 13952, "timesteps_since_restore": 1500000, "episodes_total": 3082, "episode_len_mean": 500.0, "date": "2018-11-28_06-56-52", "info": {"grad_time_ms": 1715.414, "num_steps_trained": 1500000, "opt_samples": 20000.0, "num_steps_sampled": 1500000, "adversary": {"kl": 0.020405761897563934, "cur_lr": 0.009999999776482582, "policy_loss": 0.28819701075553894, "total_loss": 177.89053344726562, "vf_loss": 177.56309509277344, "vf_explained_var": 0.3680956959724426, "entropy": 4.305617332458496}, "sample_peak_throughput": 246.924, "learner": {}, "opt_peak_throughput": 11658.993, "av": {"kl": 0.014426962472498417, "cur_lr": 0.009999999776482582, "policy_loss": -0.4831182658672333, "total_loss": 179.0355987548828, "vf_loss": 179.4816436767578, "vf_explained_var": 0.3659290075302124, "entropy": 1.5234564542770386}, "update_time_ms": 6.989, "sample_time_ms": 80996.601}, "num_metric_batches_dropped": 0, "timesteps_total": 1500000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388295, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57a90>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 76, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.0630395102529, "av": 136.0630395102529}, "time_total_s": 6482.494485616684, "iterations_since_restore": 76, "time_this_iter_s": 83.3792872428894, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6482.494485616684, "pid": 13952, "timesteps_since_restore": 1520000, "episodes_total": 3122, "episode_len_mean": 500.0, "date": "2018-11-28_06-58-15", "info": {"grad_time_ms": 1721.886, "num_steps_trained": 1520000, "opt_samples": 20000.0, "num_steps_sampled": 1520000, "adversary": {"kl": 0.014669040217995644, "cur_lr": 0.009999999776482582, "policy_loss": 0.3754374086856842, "total_loss": 179.85145568847656, "vf_loss": 179.4478302001953, "vf_explained_var": 0.3672645688056946, "entropy": 4.333637714385986}, "sample_peak_throughput": 246.78, "learner": {}, "opt_peak_throughput": 11615.171, "av": {"kl": 0.013484072871506214, "cur_lr": 0.009999999776482582, "policy_loss": -0.6240575313568115, "total_loss": 180.98143005371094, "vf_loss": 181.57083129882812, "vf_explained_var": 0.36683040857315063, "entropy": 1.4940146207809448}, "update_time_ms": 6.951, "sample_time_ms": 81043.756}, "num_metric_batches_dropped": 0, "timesteps_total": 1520000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388376, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bf98>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 77, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.52664637779716, "av": 136.52664637779716}, "time_total_s": 6562.737705230713, "iterations_since_restore": 77, "time_this_iter_s": 80.24321961402893, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6562.737705230713, "pid": 13952, "timesteps_since_restore": 1540000, "episodes_total": 3162, "episode_len_mean": 500.0, "date": "2018-11-28_06-59-36", "info": {"grad_time_ms": 1715.886, "num_steps_trained": 1540000, "opt_samples": 20000.0, "num_steps_sampled": 1540000, "adversary": {"kl": 0.016983795911073685, "cur_lr": 0.009999999776482582, "policy_loss": 0.2789103388786316, "total_loss": 181.67100524902344, "vf_loss": 181.35948181152344, "vf_explained_var": 0.3671557903289795, "entropy": 4.306392669677734}, "sample_peak_throughput": 248.182, "learner": {}, "opt_peak_throughput": 11655.786, "av": {"kl": 0.012146644294261932, "cur_lr": 0.009999999776482582, "policy_loss": -0.4722382724285126, "total_loss": 183.43936157226562, "vf_loss": 183.88043212890625, "vf_explained_var": 0.3657212257385254, "entropy": 1.4910399913787842}, "update_time_ms": 6.969, "sample_time_ms": 80585.916}, "num_metric_batches_dropped": 0, "timesteps_total": 1540000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388459, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b710>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 78, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.88175907482773, "av": 135.88175907482773}, "time_total_s": 6645.666743516922, "iterations_since_restore": 78, "time_this_iter_s": 82.9290382862091, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6645.666743516922, "pid": 13952, "timesteps_since_restore": 1560000, "episodes_total": 3202, "episode_len_mean": 500.0, "date": "2018-11-28_07-00-59", "info": {"grad_time_ms": 1718.548, "num_steps_trained": 1560000, "opt_samples": 20000.0, "num_steps_sampled": 1560000, "adversary": {"kl": 0.024866987019777298, "cur_lr": 0.009999999776482582, "policy_loss": 0.30358171463012695, "total_loss": 182.65338134765625, "vf_loss": 182.3018798828125, "vf_explained_var": 0.36294764280319214, "entropy": 4.31878137588501}, "sample_peak_throughput": 248.707, "learner": {}, "opt_peak_throughput": 11637.733, "av": {"kl": 0.012482265010476112, "cur_lr": 0.009999999776482582, "policy_loss": -0.46159881353378296, "total_loss": 184.7770538330078, "vf_loss": 185.20660400390625, "vf_explained_var": 0.36152005195617676, "entropy": 1.4880961179733276}, "update_time_ms": 6.959, "sample_time_ms": 80416.022}, "num_metric_batches_dropped": 0, "timesteps_total": 1560000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388542, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7be10>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 79, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.71924700244188, "av": 135.71924700244188}, "time_total_s": 6729.26081943512, "iterations_since_restore": 79, "time_this_iter_s": 83.59407591819763, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6729.26081943512, "pid": 13952, "timesteps_since_restore": 1580000, "episodes_total": 3242, "episode_len_mean": 500.0, "date": "2018-11-28_07-02-22", "info": {"grad_time_ms": 1720.226, "num_steps_trained": 1580000, "opt_samples": 20000.0, "num_steps_sampled": 1580000, "adversary": {"kl": 0.016483968123793602, "cur_lr": 0.009999999776482582, "policy_loss": 0.2644828259944916, "total_loss": 183.1602325439453, "vf_loss": 182.86402893066406, "vf_explained_var": 0.35981476306915283, "entropy": 4.284879207611084}, "sample_peak_throughput": 248.947, "learner": {}, "opt_peak_throughput": 11626.378, "av": {"kl": 0.023509381338953972, "cur_lr": 0.009999999776482582, "policy_loss": -0.4400070309638977, "total_loss": 185.1870574951172, "vf_loss": 185.56695556640625, "vf_explained_var": 0.356311559677124, "entropy": 1.4841699600219727}, "update_time_ms": 7.006, "sample_time_ms": 80338.363}, "num_metric_batches_dropped": 0, "timesteps_total": 1580000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388625, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b5f8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 80, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.81772409832922, "av": 135.81772409832922}, "time_total_s": 6812.600389003754, "iterations_since_restore": 80, "time_this_iter_s": 83.33956956863403, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6812.600389003754, "pid": 13952, "timesteps_since_restore": 1600000, "episodes_total": 3282, "episode_len_mean": 500.0, "date": "2018-11-28_07-03-45", "info": {"grad_time_ms": 1722.873, "num_steps_trained": 1600000, "opt_samples": 20000.0, "num_steps_sampled": 1600000, "adversary": {"kl": 0.015336657874286175, "cur_lr": 0.009999999776482582, "policy_loss": 0.14768552780151367, "total_loss": 183.92601013183594, "vf_loss": 183.748779296875, "vf_explained_var": 0.36269092559814453, "entropy": 4.23349666595459}, "sample_peak_throughput": 249.053, "learner": {}, "opt_peak_throughput": 11608.519, "av": {"kl": 0.01769638992846012, "cur_lr": 0.009999999776482582, "policy_loss": -0.3538604974746704, "total_loss": 186.0478515625, "vf_loss": 186.35643005371094, "vf_explained_var": 0.3604205250740051, "entropy": 1.486614465713501}, "update_time_ms": 6.944, "sample_time_ms": 80304.109}, "num_metric_batches_dropped": 0, "timesteps_total": 1600000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388708, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b780>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 81, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.57914275430662, "av": 136.57914275430662}, "time_total_s": 6895.309029340744, "iterations_since_restore": 81, "time_this_iter_s": 82.70864033699036, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6895.309029340744, "pid": 13952, "timesteps_since_restore": 1620000, "episodes_total": 3322, "episode_len_mean": 500.0, "date": "2018-11-28_07-05-08", "info": {"grad_time_ms": 1723.066, "num_steps_trained": 1620000, "opt_samples": 20000.0, "num_steps_sampled": 1620000, "adversary": {"kl": 0.01838715560734272, "cur_lr": 0.009999999776482582, "policy_loss": 0.25879034399986267, "total_loss": 187.0409698486328, "vf_loss": 186.7468719482422, "vf_explained_var": 0.35673660039901733, "entropy": 4.24953031539917}, "sample_peak_throughput": 248.76, "learner": {}, "opt_peak_throughput": 11607.218, "av": {"kl": 0.021984046325087547, "cur_lr": 0.009999999776482582, "policy_loss": -0.4624091684818268, "total_loss": 188.99378967285156, "vf_loss": 189.39979553222656, "vf_explained_var": 0.3553571105003357, "entropy": 1.501585602760315}, "update_time_ms": 6.923, "sample_time_ms": 80398.826}, "num_metric_batches_dropped": 0, "timesteps_total": 1620000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388790, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 82, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.41169708162946, "av": 136.41169708162946}, "time_total_s": 6977.423481225967, "iterations_since_restore": 82, "time_this_iter_s": 82.11445188522339, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 6977.423481225967, "pid": 13952, "timesteps_since_restore": 1640000, "episodes_total": 3362, "episode_len_mean": 500.0, "date": "2018-11-28_07-06-30", "info": {"grad_time_ms": 1726.896, "num_steps_trained": 1640000, "opt_samples": 20000.0, "num_steps_sampled": 1640000, "adversary": {"kl": 0.020828841254115105, "cur_lr": 0.009999999776482582, "policy_loss": 0.10458450019359589, "total_loss": 185.7749786376953, "vf_loss": 185.63023376464844, "vf_explained_var": 0.3587126135826111, "entropy": 4.223158359527588}, "sample_peak_throughput": 248.131, "learner": {}, "opt_peak_throughput": 11581.476, "av": {"kl": 0.011475874111056328, "cur_lr": 0.009999999776482582, "policy_loss": -0.3182643949985504, "total_loss": 188.19857788085938, "vf_loss": 188.4874267578125, "vf_explained_var": 0.3560682535171509, "entropy": 1.4795273542404175}, "update_time_ms": 6.991, "sample_time_ms": 80602.741}, "num_metric_batches_dropped": 0, "timesteps_total": 1640000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388873, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7be80>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 83, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.62745051067654, "av": 135.62745051067654}, "time_total_s": 7060.003303289413, "iterations_since_restore": 83, "time_this_iter_s": 82.57982206344604, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7060.003303289413, "pid": 13952, "timesteps_since_restore": 1660000, "episodes_total": 3402, "episode_len_mean": 500.0, "date": "2018-11-28_07-07-53", "info": {"grad_time_ms": 1729.096, "num_steps_trained": 1660000, "opt_samples": 20000.0, "num_steps_sampled": 1660000, "adversary": {"kl": 0.016215475276112556, "cur_lr": 0.009999999776482582, "policy_loss": 0.14892160892486572, "total_loss": 186.59751892089844, "vf_loss": 186.4175567626953, "vf_explained_var": 0.35936737060546875, "entropy": 4.20973014831543}, "sample_peak_throughput": 247.606, "learner": {}, "opt_peak_throughput": 11566.735, "av": {"kl": 0.015787795186042786, "cur_lr": 0.009999999776482582, "policy_loss": -0.3859090805053711, "total_loss": 187.1971435546875, "vf_loss": 187.54261779785156, "vf_explained_var": 0.3593480587005615, "entropy": 1.4839961528778076}, "update_time_ms": 6.873, "sample_time_ms": 80773.389}, "num_metric_batches_dropped": 0, "timesteps_total": 1660000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543388955, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7beb8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 84, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.51666449666453, "av": 134.51666449666453}, "time_total_s": 7141.957051277161, "iterations_since_restore": 84, "time_this_iter_s": 81.95374798774719, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7141.957051277161, "pid": 13952, "timesteps_since_restore": 1680000, "episodes_total": 3442, "episode_len_mean": 500.0, "date": "2018-11-28_07-09-15", "info": {"grad_time_ms": 1728.348, "num_steps_trained": 1680000, "opt_samples": 20000.0, "num_steps_sampled": 1680000, "adversary": {"kl": 0.016032950952649117, "cur_lr": 0.009999999776482582, "policy_loss": -0.05211246386170387, "total_loss": 185.8871612548828, "vf_loss": 185.90830993652344, "vf_explained_var": 0.3592418432235718, "entropy": 4.228867053985596}, "sample_peak_throughput": 247.687, "learner": {}, "opt_peak_throughput": 11571.745, "av": {"kl": 0.012803265824913979, "cur_lr": 0.009999999776482582, "policy_loss": -0.1654001772403717, "total_loss": 187.35572814941406, "vf_loss": 187.48825073242188, "vf_explained_var": 0.35954636335372925, "entropy": 1.4680588245391846}, "update_time_ms": 6.845, "sample_time_ms": 80747.098}, "num_metric_batches_dropped": 0, "timesteps_total": 1680000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389037, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 85, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.1145780693116, "av": 135.1145780693116}, "time_total_s": 7223.938321113586, "iterations_since_restore": 85, "time_this_iter_s": 81.98126983642578, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7223.938321113586, "pid": 13952, "timesteps_since_restore": 1700000, "episodes_total": 3482, "episode_len_mean": 500.0, "date": "2018-11-28_07-10-37", "info": {"grad_time_ms": 1729.722, "num_steps_trained": 1700000, "opt_samples": 20000.0, "num_steps_sampled": 1700000, "adversary": {"kl": 0.018918393179774284, "cur_lr": 0.009999999776482582, "policy_loss": 0.21149924397468567, "total_loss": 187.82247924804688, "vf_loss": 187.5746307373047, "vf_explained_var": 0.3536839485168457, "entropy": 4.163759231567383}, "sample_peak_throughput": 247.735, "learner": {}, "opt_peak_throughput": 11562.552, "av": {"kl": 0.03382861241698265, "cur_lr": 0.009999999776482582, "policy_loss": -0.3772037625312805, "total_loss": 189.33163452148438, "vf_loss": 189.6221466064453, "vf_explained_var": 0.3545200824737549, "entropy": 1.460025668144226}, "update_time_ms": 6.908, "sample_time_ms": 80731.424}, "num_metric_batches_dropped": 0, "timesteps_total": 1700000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389118, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b5f8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 86, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.6469271909407, "av": 135.6469271909407}, "time_total_s": 7304.805087566376, "iterations_since_restore": 86, "time_this_iter_s": 80.8667664527893, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7304.805087566376, "pid": 13952, "timesteps_since_restore": 1720000, "episodes_total": 3522, "episode_len_mean": 500.0, "date": "2018-11-28_07-11-58", "info": {"grad_time_ms": 1721.43, "num_steps_trained": 1720000, "opt_samples": 20000.0, "num_steps_sampled": 1720000, "adversary": {"kl": 0.01974242739379406, "cur_lr": 0.009999999776482582, "policy_loss": 0.13432449102401733, "total_loss": 189.27627563476562, "vf_loss": 189.10397338867188, "vf_explained_var": 0.35317355394363403, "entropy": 4.192121982574463}, "sample_peak_throughput": 248.483, "learner": {}, "opt_peak_throughput": 11618.244, "av": {"kl": 0.021594583988189697, "cur_lr": 0.009999999776482582, "policy_loss": -0.278820663690567, "total_loss": 191.2803192138672, "vf_loss": 191.50372314453125, "vf_explained_var": 0.3540689945220947, "entropy": 1.4788988828659058}, "update_time_ms": 6.893, "sample_time_ms": 80488.442}, "num_metric_batches_dropped": 0, "timesteps_total": 1720000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389200, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b4e0>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 87, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.72735530081175, "av": 135.72735530081175}, "time_total_s": 7386.994112968445, "iterations_since_restore": 87, "time_this_iter_s": 82.18902540206909, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7386.994112968445, "pid": 13952, "timesteps_since_restore": 1740000, "episodes_total": 3562, "episode_len_mean": 500.0, "date": "2018-11-28_07-13-20", "info": {"grad_time_ms": 1727.01, "num_steps_trained": 1740000, "opt_samples": 20000.0, "num_steps_sampled": 1740000, "adversary": {"kl": 0.0165207888931036, "cur_lr": 0.009999999776482582, "policy_loss": 0.08284950256347656, "total_loss": 190.1456756591797, "vf_loss": 190.031005859375, "vf_explained_var": 0.3540757894515991, "entropy": 4.125512599945068}, "sample_peak_throughput": 247.901, "learner": {}, "opt_peak_throughput": 11580.708, "av": {"kl": 0.01749718002974987, "cur_lr": 0.009999999776482582, "policy_loss": -0.2931486964225769, "total_loss": 192.2372283935547, "vf_loss": 192.4854278564453, "vf_explained_var": 0.35249167680740356, "entropy": 1.4800975322723389}, "update_time_ms": 6.881, "sample_time_ms": 80677.441}, "num_metric_batches_dropped": 0, "timesteps_total": 1740000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389281, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b5f8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 88, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.0342654550302, "av": 135.0342654550302}, "time_total_s": 7468.308260917664, "iterations_since_restore": 88, "time_this_iter_s": 81.31414794921875, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7468.308260917664, "pid": 13952, "timesteps_since_restore": 1760000, "episodes_total": 3602, "episode_len_mean": 500.0, "date": "2018-11-28_07-14-41", "info": {"grad_time_ms": 1730.02, "num_steps_trained": 1760000, "opt_samples": 20000.0, "num_steps_sampled": 1760000, "adversary": {"kl": 0.020415710285305977, "cur_lr": 0.009999999776482582, "policy_loss": 0.11400128155946732, "total_loss": 188.9124755859375, "vf_loss": 188.75921630859375, "vf_explained_var": 0.35329675674438477, "entropy": 4.131076335906982}, "sample_peak_throughput": 248.407, "learner": {}, "opt_peak_throughput": 11560.562, "av": {"kl": 0.015159785747528076, "cur_lr": 0.009999999776482582, "policy_loss": -0.29509544372558594, "total_loss": 192.32835388183594, "vf_loss": 192.58457946777344, "vf_explained_var": 0.3535122871398926, "entropy": 1.4707351922988892}, "update_time_ms": 6.973, "sample_time_ms": 80512.983}, "num_metric_batches_dropped": 0, "timesteps_total": 1760000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389363, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bcf8>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 89, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.37802010608024, "av": 134.37802010608024}, "time_total_s": 7549.606339454651, "iterations_since_restore": 89, "time_this_iter_s": 81.2980785369873, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7549.606339454651, "pid": 13952, "timesteps_since_restore": 1780000, "episodes_total": 3642, "episode_len_mean": 500.0, "date": "2018-11-28_07-16-03", "info": {"grad_time_ms": 1733.699, "num_steps_trained": 1780000, "opt_samples": 20000.0, "num_steps_sampled": 1780000, "adversary": {"kl": 0.03500959649682045, "cur_lr": 0.009999999776482582, "policy_loss": -0.027381371706724167, "total_loss": 189.26904296875, "vf_loss": 189.22900390625, "vf_explained_var": 0.3570345640182495, "entropy": 4.099059581756592}, "sample_peak_throughput": 249.128, "learner": {}, "opt_peak_throughput": 11536.026, "av": {"kl": 0.012100310064852238, "cur_lr": 0.009999999776482582, "policy_loss": -0.13298650085926056, "total_loss": 193.2376708984375, "vf_loss": 193.33975219726562, "vf_explained_var": 0.35592055320739746, "entropy": 1.467034101486206}, "update_time_ms": 6.908, "sample_time_ms": 80279.872}, "num_metric_batches_dropped": 0, "timesteps_total": 1780000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389444, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb38>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 90, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -133.1475461878941, "av": 133.1475461878941}, "time_total_s": 7630.825876712799, "iterations_since_restore": 90, "time_this_iter_s": 81.2195372581482, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7630.825876712799, "pid": 13952, "timesteps_since_restore": 1800000, "episodes_total": 3682, "episode_len_mean": 500.0, "date": "2018-11-28_07-17-24", "info": {"grad_time_ms": 1731.633, "num_steps_trained": 1800000, "opt_samples": 20000.0, "num_steps_sampled": 1800000, "adversary": {"kl": 0.014572951942682266, "cur_lr": 0.009999999776482582, "policy_loss": -0.13622984290122986, "total_loss": 188.226806640625, "vf_loss": 188.33489990234375, "vf_explained_var": 0.3581673502922058, "entropy": 4.107691764831543}, "sample_peak_throughput": 249.782, "learner": {}, "opt_peak_throughput": 11549.789, "av": {"kl": 0.0170079804956913, "cur_lr": 0.009999999776482582, "policy_loss": -0.07842759042978287, "total_loss": 193.35537719726562, "vf_loss": 193.39012145996094, "vf_explained_var": 0.35367530584335327, "entropy": 1.4765479564666748}, "update_time_ms": 6.884, "sample_time_ms": 80069.893}, "num_metric_batches_dropped": 0, "timesteps_total": 1800000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389526, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b550>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 91, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -132.94592960383497, "av": 132.94592960383497}, "time_total_s": 7712.956356048584, "iterations_since_restore": 91, "time_this_iter_s": 82.13047933578491, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7712.956356048584, "pid": 13952, "timesteps_since_restore": 1820000, "episodes_total": 3722, "episode_len_mean": 500.0, "date": "2018-11-28_07-18-46", "info": {"grad_time_ms": 1730.874, "num_steps_trained": 1820000, "opt_samples": 20000.0, "num_steps_sampled": 1820000, "adversary": {"kl": 0.018291449174284935, "cur_lr": 0.009999999776482582, "policy_loss": -0.002082680119201541, "total_loss": 187.73670959472656, "vf_loss": 187.70372009277344, "vf_explained_var": 0.3626636266708374, "entropy": 4.113195896148682}, "sample_peak_throughput": 249.96, "learner": {}, "opt_peak_throughput": 11554.855, "av": {"kl": 0.01682157814502716, "cur_lr": 0.009999999776482582, "policy_loss": -0.19201676547527313, "total_loss": 192.2353057861328, "vf_loss": 192.38401794433594, "vf_explained_var": 0.3580337166786194, "entropy": 1.4792348146438599}, "update_time_ms": 6.9, "sample_time_ms": 80012.854}, "num_metric_batches_dropped": 0, "timesteps_total": 1820000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389609, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b438>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 92, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -133.6442464919688, "av": 133.6442464919688}, "time_total_s": 7796.126395225525, "iterations_since_restore": 92, "time_this_iter_s": 83.17003917694092, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7796.126395225525, "pid": 13952, "timesteps_since_restore": 1840000, "episodes_total": 3762, "episode_len_mean": 500.0, "date": "2018-11-28_07-20-09", "info": {"grad_time_ms": 1732.435, "num_steps_trained": 1840000, "opt_samples": 20000.0, "num_steps_sampled": 1840000, "adversary": {"kl": 0.018532129004597664, "cur_lr": 0.009999999776482582, "policy_loss": -0.056562889367341995, "total_loss": 189.54324340820312, "vf_loss": 189.56411743164062, "vf_explained_var": 0.35784298181533813, "entropy": 4.099994659423828}, "sample_peak_throughput": 249.636, "learner": {}, "opt_peak_throughput": 11544.443, "av": {"kl": 0.02109583467245102, "cur_lr": 0.009999999776482582, "policy_loss": -0.15581247210502625, "total_loss": 192.90869140625, "vf_loss": 193.0104522705078, "vf_explained_var": 0.35389894247055054, "entropy": 1.4723029136657715}, "update_time_ms": 6.878, "sample_time_ms": 80116.802}, "num_metric_batches_dropped": 0, "timesteps_total": 1840000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389691, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7bb00>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 93, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.42286184943515, "av": 134.42286184943515}, "time_total_s": 7877.689876317978, "iterations_since_restore": 93, "time_this_iter_s": 81.563481092453, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7877.689876317978, "pid": 13952, "timesteps_since_restore": 1860000, "episodes_total": 3802, "episode_len_mean": 500.0, "date": "2018-11-28_07-21-31", "info": {"grad_time_ms": 1734.83, "num_steps_trained": 1860000, "opt_samples": 20000.0, "num_steps_sampled": 1860000, "adversary": {"kl": 0.0220397487282753, "cur_lr": 0.009999999776482582, "policy_loss": 0.025942059233784676, "total_loss": 188.2633819580078, "vf_loss": 188.19509887695312, "vf_explained_var": 0.3562626838684082, "entropy": 4.080711841583252}, "sample_peak_throughput": 249.96, "learner": {}, "opt_peak_throughput": 11528.505, "av": {"kl": 0.011013571172952652, "cur_lr": 0.009999999776482582, "policy_loss": -0.18830615282058716, "total_loss": 191.61721801757812, "vf_loss": 191.7772674560547, "vf_explained_var": 0.3530645966529846, "entropy": 1.464555263519287}, "update_time_ms": 6.898, "sample_time_ms": 80012.76}, "num_metric_batches_dropped": 0, "timesteps_total": 1860000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389771, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf57940>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 94, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.8846331690195, "av": 134.8846331690195}, "time_total_s": 7958.047103404999, "iterations_since_restore": 94, "time_this_iter_s": 80.35722708702087, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 7958.047103404999, "pid": 13952, "timesteps_since_restore": 1880000, "episodes_total": 3842, "episode_len_mean": 500.0, "date": "2018-11-28_07-22-51", "info": {"grad_time_ms": 1730.412, "num_steps_trained": 1880000, "opt_samples": 20000.0, "num_steps_sampled": 1880000, "adversary": {"kl": 0.014163925312459469, "cur_lr": 0.009999999776482582, "policy_loss": 0.06418430060148239, "total_loss": 189.06101989746094, "vf_loss": 188.96957397460938, "vf_explained_var": 0.3570118546485901, "entropy": 4.107829570770264}, "sample_peak_throughput": 250.446, "learner": {}, "opt_peak_throughput": 11557.938, "av": {"kl": 0.021113473922014236, "cur_lr": 0.009999999776482582, "policy_loss": -0.25076165795326233, "total_loss": 192.5280303955078, "vf_loss": 192.72467041015625, "vf_explained_var": 0.35427922010421753, "entropy": 1.4410029649734497}, "update_time_ms": 6.909, "sample_time_ms": 79857.504}, "num_metric_batches_dropped": 0, "timesteps_total": 1880000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389858, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 95, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.08383595767884, "av": 135.08383595767884}, "time_total_s": 8045.170044183731, "iterations_since_restore": 95, "time_this_iter_s": 87.1229407787323, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8045.170044183731, "pid": 13952, "timesteps_since_restore": 1900000, "episodes_total": 3882, "episode_len_mean": 500.0, "date": "2018-11-28_07-24-18", "info": {"grad_time_ms": 1730.495, "num_steps_trained": 1900000, "opt_samples": 20000.0, "num_steps_sampled": 1900000, "adversary": {"kl": 0.04734911769628525, "cur_lr": 0.009999999776482582, "policy_loss": 0.2544362246990204, "total_loss": 192.10679626464844, "vf_loss": 191.7612762451172, "vf_explained_var": 0.3557645082473755, "entropy": 4.067448616027832}, "sample_peak_throughput": 248.844, "learner": {}, "opt_peak_throughput": 11557.385, "av": {"kl": 0.01910298690199852, "cur_lr": 0.009999999776482582, "policy_loss": -0.22865241765975952, "total_loss": 194.72247314453125, "vf_loss": 194.90208435058594, "vf_explained_var": 0.35030317306518555, "entropy": 1.4639203548431396}, "update_time_ms": 6.86, "sample_time_ms": 80371.731}, "num_metric_batches_dropped": 0, "timesteps_total": 1900000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543389942, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70908>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 96, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -135.26706263541632, "av": 135.26706263541632}, "time_total_s": 8128.345176696777, "iterations_since_restore": 96, "time_this_iter_s": 83.17513251304626, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8128.345176696777, "pid": 13952, "timesteps_since_restore": 1920000, "episodes_total": 3922, "episode_len_mean": 500.0, "date": "2018-11-28_07-25-42", "info": {"grad_time_ms": 1735.482, "num_steps_trained": 1920000, "opt_samples": 20000.0, "num_steps_sampled": 1920000, "adversary": {"kl": 0.03663056343793869, "cur_lr": 0.009999999776482582, "policy_loss": 0.1327466368675232, "total_loss": 191.39845275878906, "vf_loss": 191.16009521484375, "vf_explained_var": 0.35367101430892944, "entropy": 4.1281890869140625}, "sample_peak_throughput": 248.146, "learner": {}, "opt_peak_throughput": 11524.177, "av": {"kl": 0.021118352189660072, "cur_lr": 0.009999999776482582, "policy_loss": -0.21785561740398407, "total_loss": 194.3927001953125, "vf_loss": 194.5563201904297, "vf_explained_var": 0.35103023052215576, "entropy": 1.45845365524292}, "update_time_ms": 6.918, "sample_time_ms": 80597.631}, "num_metric_batches_dropped": 0, "timesteps_total": 1920000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543390024, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70d68>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 97, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.81890232597436, "av": 134.81890232597436}, "time_total_s": 8211.20217204094, "iterations_since_restore": 97, "time_this_iter_s": 82.85699534416199, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8211.20217204094, "pid": 13952, "timesteps_since_restore": 1940000, "episodes_total": 3962, "episode_len_mean": 500.0, "date": "2018-11-28_07-27-04", "info": {"grad_time_ms": 1733.452, "num_steps_trained": 1940000, "opt_samples": 20000.0, "num_steps_sampled": 1940000, "adversary": {"kl": 0.02277948521077633, "cur_lr": 0.009999999776482582, "policy_loss": 0.003929582890123129, "total_loss": 190.54409790039062, "vf_loss": 190.47454833984375, "vf_explained_var": 0.35456979274749756, "entropy": 4.102766513824463}, "sample_peak_throughput": 247.935, "learner": {}, "opt_peak_throughput": 11537.671, "av": {"kl": 0.014075512997806072, "cur_lr": 0.009999999776482582, "policy_loss": -0.20711086690425873, "total_loss": 193.55381774902344, "vf_loss": 193.72486877441406, "vf_explained_var": 0.3544071316719055, "entropy": 1.4453271627426147}, "update_time_ms": 6.954, "sample_time_ms": 80666.412}, "num_metric_batches_dropped": 0, "timesteps_total": 1940000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543390107, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b278>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 98, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -134.99559052248568, "av": 134.99559052248568}, "time_total_s": 8293.9937748909, "iterations_since_restore": 98, "time_this_iter_s": 82.79160284996033, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8293.9937748909, "pid": 13952, "timesteps_since_restore": 1960000, "episodes_total": 4002, "episode_len_mean": 500.0, "date": "2018-11-28_07-28-27", "info": {"grad_time_ms": 1729.384, "num_steps_trained": 1960000, "opt_samples": 20000.0, "num_steps_sampled": 1960000, "adversary": {"kl": 0.01331818662583828, "cur_lr": 0.009999999776482582, "policy_loss": 0.02613835409283638, "total_loss": 192.11402893066406, "vf_loss": 192.0492706298828, "vf_explained_var": 0.3549574017524719, "entropy": 4.084755897521973}, "sample_peak_throughput": 247.469, "learner": {}, "opt_peak_throughput": 11564.809, "av": {"kl": 0.012336449697613716, "cur_lr": 0.009999999776482582, "policy_loss": -0.25122207403182983, "total_loss": 195.2669677734375, "vf_loss": 195.4864501953125, "vf_explained_var": 0.3542003035545349, "entropy": 1.448578119277954}, "update_time_ms": 6.967, "sample_time_ms": 80818.267}, "num_metric_batches_dropped": 0, "timesteps_total": 1960000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": false, "timestamp": 1543390189, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf7b550>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 99, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.2812353899264, "av": 136.2812353899264}, "time_total_s": 8376.221238851547, "iterations_since_restore": 99, "time_this_iter_s": 82.22746396064758, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8376.221238851547, "pid": 13952, "timesteps_since_restore": 1980000, "episodes_total": 4042, "episode_len_mean": 500.0, "date": "2018-11-28_07-29-49", "info": {"grad_time_ms": 1722.008, "num_steps_trained": 1980000, "opt_samples": 20000.0, "num_steps_sampled": 1980000, "adversary": {"kl": 0.015876339748501778, "cur_lr": 0.009999999776482582, "policy_loss": 0.04692542180418968, "total_loss": 193.66029357910156, "vf_loss": 193.5677032470703, "vf_explained_var": 0.35318154096603394, "entropy": 4.096876621246338}, "sample_peak_throughput": 247.162, "learner": {}, "opt_peak_throughput": 11614.346, "av": {"kl": 0.01753384806215763, "cur_lr": 0.009999999776482582, "policy_loss": -0.27047035098075867, "total_loss": 195.06985473632812, "vf_loss": 195.29539489746094, "vf_explained_var": 0.352780282497406, "entropy": 1.452437162399292}, "update_time_ms": 6.999, "sample_time_ms": 80918.452}, "num_metric_batches_dropped": 0, "timesteps_total": 1980000}
{"timesteps_this_iter": 20000, "episodes_this_iter": 40, "episode_reward_min": 0.0, "hostname": "ip-172-31-28-74", "done": true, "timestamp": 1543390272, "config": {"custom_resources_per_worker": {}, "observation_filter": "NoFilter", "sample_batch_size": 200, "train_batch_size": 20000, "num_gpus": 0, "gamma": 0.999, "num_cpus_for_driver": 1, "lr_schedule": null, "env": "MultiAgentUDSSCMergeEnv-v0", "lambda": 0.97, "use_gae": true, "entropy_coeff": 0.0, "vf_share_layers": false, "simple_optimizer": true, "batch_mode": "truncate_episodes", "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "kl_target": 0.02, "num_envs_per_worker": 1, "lr": 0.01, "preprocessor_pref": "deepmind", "synchronize_filters": true, "horizon": 500, "optimizer": {}, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f37aaf70518>", "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(92,)", "Box(2,)", {}]}, "policies_to_train": null}, "num_gpus_per_worker": 0, "num_workers": 10, "model": {"custom_model": null, "conv_activation": "relu", "custom_preprocessor": null, "lstm_cell_size": 256, "channel_major": false, "fcnet_activation": "tanh", "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "squash_to_range": false, "custom_options": {}, "framestack": true, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "zero_mean": true, "free_log_std": false, "use_lstm": false}, "tf_session_args": {"intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 30, "compress_observations": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"perturb_weight\": 0.03,\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnv\",\n    \"exp_tag\": \"ma_17\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_param": 0.3, "num_cpus_per_worker": 1, "vf_clip_param": 10.0, "monitor": false, "vf_loss_coeff": 1.0, "sample_async": false, "clip_rewards": null, "kl_coeff": 0.2, "callbacks": {"on_episode_start": null, "on_episode_end": null, "on_sample_end": null, "on_episode_step": null}, "log_level": "INFO"}, "episode_reward_max": 0.0, "training_iteration": 100, "episode_reward_mean": 0.0, "experiment_id": "b5cda9c7db924402905af0a6db9bdf7f", "policy_reward_mean": {"adversary": -136.8456850145206, "av": 136.8456850145206}, "time_total_s": 8459.171540260315, "iterations_since_restore": 100, "time_this_iter_s": 82.9503014087677, "node_ip": "172.31.28.74", "custom_metrics": {}, "time_since_restore": 8459.171540260315, "pid": 13952, "timesteps_since_restore": 2000000, "episodes_total": 4082, "episode_len_mean": 500.0, "date": "2018-11-28_07-31-12", "info": {"grad_time_ms": 1727.236, "num_steps_trained": 2000000, "opt_samples": 20000.0, "num_steps_sampled": 2000000, "adversary": {"kl": 0.020351745188236237, "cur_lr": 0.009999999776482582, "policy_loss": 0.057176075875759125, "total_loss": 195.1809844970703, "vf_loss": 195.06512451171875, "vf_explained_var": 0.3521655797958374, "entropy": 4.073843955993652}, "sample_peak_throughput": 246.651, "learner": {}, "opt_peak_throughput": 11579.196, "av": {"kl": 0.013018460012972355, "cur_lr": 0.009999999776482582, "policy_loss": -0.26739034056663513, "total_loss": 195.88478088378906, "vf_loss": 196.11880493164062, "vf_explained_var": 0.35245758295059204, "entropy": 1.4750196933746338}, "update_time_ms": 7.023, "sample_time_ms": 81086.325}, "num_metric_batches_dropped": 0, "timesteps_total": 2000000}
