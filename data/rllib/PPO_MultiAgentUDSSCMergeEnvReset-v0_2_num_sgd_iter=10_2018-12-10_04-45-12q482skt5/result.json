{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 20000, "time_since_restore": 26.576590299606323, "episode_len_mean": 233.51724137931035, "date": "2018-12-10_04-45-49", "done": false, "time_this_iter_s": 26.576590299606323, "episode_reward_max": 0.0, "iterations_since_restore": 1, "episodes_total": 87, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 434.4661069775444, "av": -434.4661069775444}, "timestamp": 1544417149, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 1, "pid": 2451, "episodes_this_iter": 87, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799a70f0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 20000, "time_total_s": 26.576590299606323, "custom_metrics": {}, "info": {"sample_time_ms": 18147.54, "num_steps_trained": 20000, "update_time_ms": 1013.482, "grad_time_ms": 7183.452, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 2.380212208663579e-05, "vf_loss": 4879.5703125, "policy_loss": -0.05560332164168358, "cur_lr": 9.999999747378752e-05, "kl": 0.021426502615213394, "entropy": 136.18519592285156, "total_loss": 4879.51904296875}, "num_steps_sampled": 20000, "load_time_ms": 99.727, "av": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 2.2819409423391335e-05, "vf_loss": 4882.24853515625, "policy_loss": -0.009488332085311413, "cur_lr": 9.999999747378752e-05, "kl": 0.009378456510603428, "entropy": 2.831510066986084, "total_loss": 4882.24072265625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 40000, "time_since_restore": 49.694265365600586, "episode_len_mean": 270.68, "date": "2018-12-10_04-46-12", "done": false, "time_this_iter_s": 23.117675065994263, "episode_reward_max": 0.0, "iterations_since_restore": 2, "episodes_total": 168, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 315.4326917860501, "av": -315.4326917860501}, "timestamp": 1544417172, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 2, "pid": 2451, "episodes_this_iter": 81, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641d56a0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 40000, "time_total_s": 49.694265365600586, "custom_metrics": {}, "info": {"sample_time_ms": 17126.257, "num_steps_trained": 40000, "update_time_ms": 510.413, "grad_time_ms": 7062.126, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 4.162391178397229e-06, "vf_loss": 1462.1156005859375, "policy_loss": -0.05437714606523514, "cur_lr": 9.999999747378752e-05, "kl": 0.022141367197036743, "entropy": 136.1631317138672, "total_loss": 1462.065673828125}, "num_steps_sampled": 40000, "load_time_ms": 56.127, "av": {"cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 3.640468321464141e-06, "vf_loss": 1460.5694580078125, "policy_loss": -0.012253145687282085, "cur_lr": 9.999999747378752e-05, "kl": 0.015370764769613743, "entropy": 2.8057024478912354, "total_loss": 1460.558837890625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 60000, "time_since_restore": 68.8808491230011, "episode_len_mean": 339.19, "date": "2018-12-10_04-46-31", "done": false, "time_this_iter_s": 19.186583757400513, "episode_reward_max": 0.0, "iterations_since_restore": 3, "episodes_total": 225, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 174.3010360861279, "av": -174.3010360861279}, "timestamp": 1544417191, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 3, "pid": 2451, "episodes_this_iter": 57, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799a7eb8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 60000, "time_total_s": 68.8808491230011, "custom_metrics": {}, "info": {"sample_time_ms": 15611.881, "num_steps_trained": 60000, "update_time_ms": 342.753, "grad_time_ms": 6886.439, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": -4.6995971558772e-08, "vf_loss": 393.3975830078125, "policy_loss": -0.05908045917749405, "cur_lr": 9.999999747378752e-05, "kl": 0.023652344942092896, "entropy": 136.185791015625, "total_loss": 393.34320068359375}, "num_steps_sampled": 60000, "load_time_ms": 41.761, "av": {"cur_kl_coeff": 0.10000002384185791, "vf_explained_var": -2.850324563041795e-07, "vf_loss": 393.1221008300781, "policy_loss": -0.009394839406013489, "cur_lr": 9.999999747378752e-05, "kl": 0.008808664977550507, "entropy": 2.7969307899475098, "total_loss": 393.11358642578125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 80000, "time_since_restore": 88.0724823474884, "episode_len_mean": 407.06, "date": "2018-12-10_04-46-50", "done": false, "time_this_iter_s": 19.191633224487305, "episode_reward_max": 0.0, "iterations_since_restore": 4, "episodes_total": 275, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 90.7064116753374, "av": -90.7064116753374}, "timestamp": 1544417210, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 4, "pid": 2451, "episodes_this_iter": 50, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641da4a8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 80000, "time_total_s": 88.0724823474884, "custom_metrics": {}, "info": {"sample_time_ms": 14734.948, "num_steps_trained": 80000, "update_time_ms": 258.638, "grad_time_ms": 6916.263, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": -1.6253727608273039e-06, "vf_loss": 261.3874206542969, "policy_loss": -0.05735654756426811, "cur_lr": 9.999999747378752e-05, "kl": 0.024553785100579262, "entropy": 136.14695739746094, "total_loss": 261.3349914550781}, "num_steps_sampled": 80000, "load_time_ms": 35.078, "av": {"cur_kl_coeff": 0.050000011920928955, "vf_explained_var": -1.6654913679303718e-06, "vf_loss": 261.29608154296875, "policy_loss": -0.008380351588129997, "cur_lr": 9.999999747378752e-05, "kl": 0.00968669168651104, "entropy": 2.78747296333313, "total_loss": 261.28814697265625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 100000, "time_since_restore": 106.91168451309204, "episode_len_mean": 442.57, "date": "2018-12-10_04-47-09", "done": false, "time_this_iter_s": 18.839202165603638, "episode_reward_max": 0.0, "iterations_since_restore": 5, "episodes_total": 324, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 52.130643547353365, "av": -52.130643547353365}, "timestamp": 1544417229, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 5, "pid": 2451, "episodes_this_iter": 49, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e8c50>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 100000, "time_total_s": 106.91168451309204, "custom_metrics": {}, "info": {"sample_time_ms": 14219.624, "num_steps_trained": 100000, "update_time_ms": 208.377, "grad_time_ms": 6854.174, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": -3.861693130602362e-06, "vf_loss": 170.3274688720703, "policy_loss": -0.05976041033864021, "cur_lr": 9.999999747378752e-05, "kl": 0.02518402598798275, "entropy": 136.1340789794922, "total_loss": 170.27276611328125}, "num_steps_sampled": 100000, "load_time_ms": 31.069, "av": {"cur_kl_coeff": 0.025000005960464478, "vf_explained_var": -3.4677675557759358e-06, "vf_loss": 170.28526306152344, "policy_loss": -0.009457147680222988, "cur_lr": 9.999999747378752e-05, "kl": 0.012001581490039825, "entropy": 2.776451587677002, "total_loss": 170.27610778808594}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 120000, "time_since_restore": 125.98103380203247, "episode_len_mean": 461.2, "date": "2018-12-10_04-47-28", "done": false, "time_this_iter_s": 19.06934928894043, "episode_reward_max": 0.0, "iterations_since_restore": 6, "episodes_total": 371, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": 15.60071021527642, "av": -15.60071021527642}, "timestamp": 1544417248, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 6, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e8400>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 120000, "time_total_s": 125.98103380203247, "custom_metrics": {}, "info": {"sample_time_ms": 13879.367, "num_steps_trained": 120000, "update_time_ms": 174.73, "grad_time_ms": 6848.777, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": -2.4579273940616986e-06, "vf_loss": 168.38836669921875, "policy_loss": -0.060811739414930344, "cur_lr": 9.999999747378752e-05, "kl": 0.026607612147927284, "entropy": 136.06358337402344, "total_loss": 168.3328857421875}, "num_steps_sampled": 120000, "load_time_ms": 28.013, "av": {"cur_kl_coeff": 0.025000005960464478, "vf_explained_var": -1.9979017906734953e-06, "vf_loss": 168.38975524902344, "policy_loss": -0.0078862514346838, "cur_lr": 9.999999747378752e-05, "kl": 0.010950240306556225, "entropy": 2.7714240550994873, "total_loss": 168.3821258544922}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 140000, "time_since_restore": 144.43191528320312, "episode_len_mean": 468.14, "date": "2018-12-10_04-47-47", "done": false, "time_this_iter_s": 18.450881481170654, "episode_reward_max": 0.0, "iterations_since_restore": 7, "episodes_total": 417, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -15.205302808359875, "av": 15.205302808359875}, "timestamp": 1544417267, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 7, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e22b0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 140000, "time_total_s": 144.43191528320312, "custom_metrics": {}, "info": {"sample_time_ms": 13559.987, "num_steps_trained": 140000, "update_time_ms": 150.694, "grad_time_ms": 6832.526, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": -2.1358330286602722e-06, "vf_loss": 142.3704376220703, "policy_loss": -0.06296802312135696, "cur_lr": 9.999999747378752e-05, "kl": 0.027142778038978577, "entropy": 136.03565979003906, "total_loss": 142.31288146972656}, "num_steps_sampled": 140000, "load_time_ms": 26.224, "av": {"cur_kl_coeff": 0.025000005960464478, "vf_explained_var": -1.5802872894710163e-06, "vf_loss": 142.6046905517578, "policy_loss": -0.007775586564093828, "cur_lr": 9.999999747378752e-05, "kl": 0.010699360631406307, "entropy": 2.748326063156128, "total_loss": 142.59718322753906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 160000, "time_since_restore": 162.59095859527588, "episode_len_mean": 471.36, "date": "2018-12-10_04-48-05", "done": false, "time_this_iter_s": 18.159043312072754, "episode_reward_max": 0.0, "iterations_since_restore": 8, "episodes_total": 465, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -56.91110562576331, "av": 56.91110562576331}, "timestamp": 1544417285, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 8, "pid": 2451, "episodes_this_iter": 48, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641da780>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 160000, "time_total_s": 162.59095859527588, "custom_metrics": {}, "info": {"sample_time_ms": 13295.622, "num_steps_trained": 160000, "update_time_ms": 132.686, "grad_time_ms": 6807.997, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.03255335986614227, "vf_loss": 88.50504302978516, "policy_loss": -0.05911119282245636, "cur_lr": 9.999999747378752e-05, "kl": 0.02773314341902733, "entropy": 136.09397888183594, "total_loss": 88.45147705078125}, "num_steps_sampled": 160000, "load_time_ms": 24.961, "av": {"cur_kl_coeff": 0.025000005960464478, "vf_explained_var": -2.0441336801013676e-06, "vf_loss": 91.55830383300781, "policy_loss": -0.005740396212786436, "cur_lr": 9.999999747378752e-05, "kl": 0.008687317371368408, "entropy": 2.723583698272705, "total_loss": 91.55278778076172}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 180000, "time_since_restore": 180.66386032104492, "episode_len_mean": 474.51, "date": "2018-12-10_04-48-23", "done": false, "time_this_iter_s": 18.072901725769043, "episode_reward_max": 0.0, "iterations_since_restore": 9, "episodes_total": 507, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -74.53363343035673, "av": 74.53363343035673}, "timestamp": 1544417303, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 9, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9da0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 180000, "time_total_s": 180.66386032104492, "custom_metrics": {}, "info": {"sample_time_ms": 13058.303, "num_steps_trained": 180000, "update_time_ms": 118.694, "grad_time_ms": 6812.081, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.3899270296096802, "vf_loss": 52.106014251708984, "policy_loss": -0.06323908269405365, "cur_lr": 9.999999747378752e-05, "kl": 0.031737204641103745, "entropy": 136.0403594970703, "total_loss": 52.04911422729492}, "num_steps_sampled": 180000, "load_time_ms": 23.576, "av": {"cur_kl_coeff": 0.012500002980232239, "vf_explained_var": 0.3743319511413574, "vf_loss": 52.911258697509766, "policy_loss": -0.010680212639272213, "cur_lr": 9.999999747378752e-05, "kl": 0.02244119718670845, "entropy": 2.6941754817962646, "total_loss": 52.9008674621582}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 200000, "time_since_restore": 198.8573019504547, "episode_len_mean": 486.35, "date": "2018-12-10_04-48-41", "done": false, "time_this_iter_s": 18.19344162940979, "episode_reward_max": 0.0, "iterations_since_restore": 10, "episodes_total": 555, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -98.68263967875347, "av": 98.68263967875347}, "timestamp": 1544417321, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 10, "pid": 2451, "episodes_this_iter": 48, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799a7518>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 200000, "time_total_s": 198.8573019504547, "custom_metrics": {}, "info": {"sample_time_ms": 12901.328, "num_steps_trained": 200000, "update_time_ms": 107.463, "grad_time_ms": 6794.002, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5852906107902527, "vf_loss": 35.58284378051758, "policy_loss": -0.06419269740581512, "cur_lr": 9.999999747378752e-05, "kl": 0.03185514360666275, "entropy": 136.11968994140625, "total_loss": 35.525020599365234}, "num_steps_sampled": 200000, "load_time_ms": 22.724, "av": {"cur_kl_coeff": 0.012500002980232239, "vf_explained_var": 0.5774257183074951, "vf_loss": 36.736698150634766, "policy_loss": -0.0057506016455590725, "cur_lr": 9.999999747378752e-05, "kl": 0.010463359765708447, "entropy": 2.6610047817230225, "total_loss": 36.731075286865234}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 220000, "time_since_restore": 216.94777941703796, "episode_len_mean": 483.82, "date": "2018-12-10_04-48-59", "done": false, "time_this_iter_s": 18.090477466583252, "episode_reward_max": 0.0, "iterations_since_restore": 11, "episodes_total": 598, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -98.87949315450494, "av": 98.87949315450494}, "timestamp": 1544417339, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 11, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9cc0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 220000, "time_total_s": 216.94777941703796, "custom_metrics": {}, "info": {"sample_time_ms": 12187.567, "num_steps_trained": 220000, "update_time_ms": 6.859, "grad_time_ms": 6776.896, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5460721254348755, "vf_loss": 43.274566650390625, "policy_loss": -0.06493910402059555, "cur_lr": 9.999999747378752e-05, "kl": 0.029025573283433914, "entropy": 136.12179565429688, "total_loss": 43.215431213378906}, "num_steps_sampled": 220000, "load_time_ms": 14.001, "av": {"cur_kl_coeff": 0.012500002980232239, "vf_explained_var": 0.5456269383430481, "vf_loss": 43.37168884277344, "policy_loss": -0.008292273618280888, "cur_lr": 9.999999747378752e-05, "kl": 0.013188695535063744, "entropy": 2.630854368209839, "total_loss": 43.36355972290039}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 240000, "time_since_restore": 235.65776681900024, "episode_len_mean": 458.05, "date": "2018-12-10_04-49-18", "done": false, "time_this_iter_s": 18.70998740196228, "episode_reward_max": 0.0, "iterations_since_restore": 12, "episodes_total": 651, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -94.26817244205373, "av": 94.26817244205373}, "timestamp": 1544417358, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 12, "pid": 2451, "episodes_this_iter": 53, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f91d0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 240000, "time_total_s": 235.65776681900024, "custom_metrics": {}, "info": {"sample_time_ms": 11782.204, "num_steps_trained": 240000, "update_time_ms": 6.761, "grad_time_ms": 6741.213, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6309953331947327, "vf_loss": 34.77384567260742, "policy_loss": -0.0640755444765091, "cur_lr": 9.999999747378752e-05, "kl": 0.02929617278277874, "entropy": 136.11659240722656, "total_loss": 34.71562576293945}, "num_steps_sampled": 240000, "load_time_ms": 14.29, "av": {"cur_kl_coeff": 0.012500002980232239, "vf_explained_var": 0.6363282799720764, "vf_loss": 34.40055465698242, "policy_loss": -0.006808919832110405, "cur_lr": 9.999999747378752e-05, "kl": 0.00949410255998373, "entropy": 2.6262362003326416, "total_loss": 34.393863677978516}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 260000, "time_since_restore": 253.5939552783966, "episode_len_mean": 461.34, "date": "2018-12-10_04-49-36", "done": false, "time_this_iter_s": 17.936188459396362, "episode_reward_max": 0.0, "iterations_since_restore": 13, "episodes_total": 694, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -97.93243435938764, "av": 97.93243435938764}, "timestamp": 1544417376, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 13, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9e10>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 260000, "time_total_s": 253.5939552783966, "custom_metrics": {}, "info": {"sample_time_ms": 11629.986, "num_steps_trained": 260000, "update_time_ms": 6.661, "grad_time_ms": 6768.464, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7446838021278381, "vf_loss": 23.005151748657227, "policy_loss": -0.06514357030391693, "cur_lr": 9.999999747378752e-05, "kl": 0.031089777126908302, "entropy": 136.15640258789062, "total_loss": 22.946226119995117}, "num_steps_sampled": 260000, "load_time_ms": 14.283, "av": {"cur_kl_coeff": 0.006250001490116119, "vf_explained_var": 0.7443385720252991, "vf_loss": 22.8577938079834, "policy_loss": -0.007231343071907759, "cur_lr": 9.999999747378752e-05, "kl": 0.012543189339339733, "entropy": 2.631990671157837, "total_loss": 22.850643157958984}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 280000, "time_since_restore": 272.04342675209045, "episode_len_mean": 487.13, "date": "2018-12-10_04-49-55", "done": false, "time_this_iter_s": 18.449471473693848, "episode_reward_max": 0.0, "iterations_since_restore": 14, "episodes_total": 740, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -103.55642243867668, "av": 103.55642243867668}, "timestamp": 1544417395, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 14, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e2278>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 280000, "time_total_s": 272.04342675209045, "custom_metrics": {}, "info": {"sample_time_ms": 11583.642, "num_steps_trained": 280000, "update_time_ms": 6.669, "grad_time_ms": 6742.036, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6706103086471558, "vf_loss": 28.552515029907227, "policy_loss": -0.06436150521039963, "cur_lr": 9.999999747378752e-05, "kl": 0.029824847355484962, "entropy": 136.083984375, "total_loss": 28.49411964416504}, "num_steps_sampled": 280000, "load_time_ms": 14.023, "av": {"cur_kl_coeff": 0.006250001490116119, "vf_explained_var": 0.6741681694984436, "vf_loss": 28.366464614868164, "policy_loss": -0.007190753240138292, "cur_lr": 9.999999747378752e-05, "kl": 0.011008553206920624, "entropy": 2.6088123321533203, "total_loss": 28.359344482421875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 300000, "time_since_restore": 290.26073956489563, "episode_len_mean": 485.39, "date": "2018-12-10_04-50-13", "done": false, "time_this_iter_s": 18.217312812805176, "episode_reward_max": 0.0, "iterations_since_restore": 15, "episodes_total": 785, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -102.03301194050574, "av": 102.03301194050574}, "timestamp": 1544417413, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 15, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9588>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 300000, "time_total_s": 290.26073956489563, "custom_metrics": {}, "info": {"sample_time_ms": 11523.592, "num_steps_trained": 300000, "update_time_ms": 6.688, "grad_time_ms": 6740.072, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7031695246696472, "vf_loss": 27.119873046875, "policy_loss": -0.0665646567940712, "cur_lr": 9.999999747378752e-05, "kl": 0.031810447573661804, "entropy": 136.03643798828125, "total_loss": 27.05967140197754}, "num_steps_sampled": 300000, "load_time_ms": 14.017, "av": {"cur_kl_coeff": 0.006250001490116119, "vf_explained_var": 0.7078410387039185, "vf_loss": 26.767662048339844, "policy_loss": -0.007637429516762495, "cur_lr": 9.999999747378752e-05, "kl": 0.012652631849050522, "entropy": 2.5819733142852783, "total_loss": 26.760103225708008}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 320000, "time_since_restore": 308.48673248291016, "episode_len_mean": 482.88, "date": "2018-12-10_04-50-31", "done": false, "time_this_iter_s": 18.225992918014526, "episode_reward_max": 0.0, "iterations_since_restore": 16, "episodes_total": 832, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -107.44912340662104, "av": 107.44912340662104}, "timestamp": 1544417431, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 16, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799a7ba8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 320000, "time_total_s": 308.48673248291016, "custom_metrics": {}, "info": {"sample_time_ms": 11433.718, "num_steps_trained": 320000, "update_time_ms": 6.709, "grad_time_ms": 6745.762, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7325268983840942, "vf_loss": 25.814599990844727, "policy_loss": -0.06419667601585388, "cur_lr": 9.999999747378752e-05, "kl": 0.03225255385041237, "entropy": 136.0604705810547, "total_loss": 25.756853103637695}, "num_steps_sampled": 320000, "load_time_ms": 13.979, "av": {"cur_kl_coeff": 0.006250001490116119, "vf_explained_var": 0.7376326322555542, "vf_loss": 25.39151954650879, "policy_loss": -0.008007727563381195, "cur_lr": 9.999999747378752e-05, "kl": 0.011328292079269886, "entropy": 2.5742475986480713, "total_loss": 25.383583068847656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 340000, "time_since_restore": 325.8766348361969, "episode_len_mean": 489.51, "date": "2018-12-10_04-50-48", "done": false, "time_this_iter_s": 17.389902353286743, "episode_reward_max": 0.0, "iterations_since_restore": 17, "episodes_total": 875, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -114.82747130773468, "av": 114.82747130773468}, "timestamp": 1544417448, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 17, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6080>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 340000, "time_total_s": 325.8766348361969, "custom_metrics": {}, "info": {"sample_time_ms": 11337.167, "num_steps_trained": 340000, "update_time_ms": 6.703, "grad_time_ms": 6736.814, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6896804571151733, "vf_loss": 30.8879337310791, "policy_loss": -0.06100694462656975, "cur_lr": 9.999999747378752e-05, "kl": 0.03077790141105652, "entropy": 136.1658477783203, "total_loss": 30.83308219909668}, "num_steps_sampled": 340000, "load_time_ms": 13.645, "av": {"cur_kl_coeff": 0.006250001490116119, "vf_explained_var": 0.7055902481079102, "vf_loss": 29.613788604736328, "policy_loss": -0.006430137436836958, "cur_lr": 9.999999747378752e-05, "kl": 0.009944288991391659, "entropy": 2.5384602546691895, "total_loss": 29.607418060302734}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 360000, "time_since_restore": 344.20512986183167, "episode_len_mean": 490.09, "date": "2018-12-10_04-51-07", "done": false, "time_this_iter_s": 18.328495025634766, "episode_reward_max": 0.0, "iterations_since_restore": 18, "episodes_total": 921, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.97696804025112, "av": 115.97696804025112}, "timestamp": 1544417467, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 18, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e88d0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 360000, "time_total_s": 344.20512986183167, "custom_metrics": {}, "info": {"sample_time_ms": 11317.269, "num_steps_trained": 360000, "update_time_ms": 6.78, "grad_time_ms": 6773.917, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7150793671607971, "vf_loss": 32.699100494384766, "policy_loss": -0.06267750263214111, "cur_lr": 9.999999747378752e-05, "kl": 0.03180698677897453, "entropy": 136.04043579101562, "total_loss": 32.64278030395508}, "num_steps_sampled": 360000, "load_time_ms": 13.574, "av": {"cur_kl_coeff": 0.0031250007450580597, "vf_explained_var": 0.7363528609275818, "vf_loss": 32.39460754394531, "policy_loss": -0.00681435689330101, "cur_lr": 9.999999747378752e-05, "kl": 0.011209756135940552, "entropy": 2.559353828430176, "total_loss": 32.38782501220703}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 380000, "time_since_restore": 361.879017829895, "episode_len_mean": 490.09, "date": "2018-12-10_04-51-25", "done": false, "time_this_iter_s": 17.673887968063354, "episode_reward_max": 0.0, "iterations_since_restore": 19, "episodes_total": 965, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -117.97839290190024, "av": 117.97839290190024}, "timestamp": 1544417485, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 19, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6550>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 380000, "time_total_s": 361.879017829895, "custom_metrics": {}, "info": {"sample_time_ms": 11298.592, "num_steps_trained": 380000, "update_time_ms": 6.856, "grad_time_ms": 6752.81, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6986045837402344, "vf_loss": 29.36106300354004, "policy_loss": -0.058483418077230453, "cur_lr": 9.999999747378752e-05, "kl": 0.03167260065674782, "entropy": 136.14059448242188, "total_loss": 29.30891227722168}, "num_steps_sampled": 380000, "load_time_ms": 13.581, "av": {"cur_kl_coeff": 0.0031250007450580597, "vf_explained_var": 0.7048695683479309, "vf_loss": 29.038818359375, "policy_loss": -0.004725744482129812, "cur_lr": 9.999999747378752e-05, "kl": 0.009523567743599415, "entropy": 2.544945001602173, "total_loss": 29.03412628173828}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 400000, "time_since_restore": 379.8789699077606, "episode_len_mean": 495.36, "date": "2018-12-10_04-51-43", "done": false, "time_this_iter_s": 17.9999520778656, "episode_reward_max": 0.0, "iterations_since_restore": 20, "episodes_total": 1010, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.99935790697462, "av": 115.99935790697462}, "timestamp": 1544417503, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 20, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9a58>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 400000, "time_total_s": 379.8789699077606, "custom_metrics": {}, "info": {"sample_time_ms": 11270.187, "num_steps_trained": 400000, "update_time_ms": 6.953, "grad_time_ms": 6761.65, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7439369559288025, "vf_loss": 38.864540100097656, "policy_loss": -0.06305019557476044, "cur_lr": 9.999999747378752e-05, "kl": 0.03247017785906792, "entropy": 135.9480438232422, "total_loss": 38.807979583740234}, "num_steps_sampled": 400000, "load_time_ms": 13.624, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7610114812850952, "vf_loss": 38.10893630981445, "policy_loss": -0.008359957486391068, "cur_lr": 9.999999747378752e-05, "kl": 0.016768528148531914, "entropy": 2.541926860809326, "total_loss": 38.10060501098633}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 420000, "time_since_restore": 397.5989451408386, "episode_len_mean": 492.8, "date": "2018-12-10_04-52-00", "done": false, "time_this_iter_s": 17.719975233078003, "episode_reward_max": 0.0, "iterations_since_restore": 21, "episodes_total": 1054, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -110.67369660680127, "av": 110.67369660680127}, "timestamp": 1544417520, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 21, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e27f0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 420000, "time_total_s": 397.5989451408386, "custom_metrics": {}, "info": {"sample_time_ms": 11276.883, "num_steps_trained": 420000, "update_time_ms": 6.841, "grad_time_ms": 6717.452, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7458650469779968, "vf_loss": 38.92374801635742, "policy_loss": -0.05921950191259384, "cur_lr": 9.999999747378752e-05, "kl": 0.03169660642743111, "entropy": 135.97023010253906, "total_loss": 38.87086868286133}, "num_steps_sampled": 420000, "load_time_ms": 13.614, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7649129033088684, "vf_loss": 38.16123962402344, "policy_loss": -0.007841759361326694, "cur_lr": 9.999999747378752e-05, "kl": 0.015113115310668945, "entropy": 2.501485586166382, "total_loss": 38.153419494628906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 440000, "time_since_restore": 415.7147698402405, "episode_len_mean": 497.44, "date": "2018-12-10_04-52-18", "done": false, "time_this_iter_s": 18.115824699401855, "episode_reward_max": 0.0, "iterations_since_restore": 22, "episodes_total": 1098, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -114.34238016298704, "av": 114.34238016298704}, "timestamp": 1544417538, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 22, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6160>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 440000, "time_total_s": 415.7147698402405, "custom_metrics": {}, "info": {"sample_time_ms": 11212.203, "num_steps_trained": 440000, "update_time_ms": 6.995, "grad_time_ms": 6722.479, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7230868935585022, "vf_loss": 37.48306655883789, "policy_loss": -0.05740542337298393, "cur_lr": 9.999999747378752e-05, "kl": 0.031071558594703674, "entropy": 135.90164184570312, "total_loss": 37.4318733215332}, "num_steps_sampled": 440000, "load_time_ms": 13.611, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.733741283416748, "vf_loss": 37.077537536621094, "policy_loss": -0.008162206970155239, "cur_lr": 9.999999747378752e-05, "kl": 0.013548924587666988, "entropy": 2.4698028564453125, "total_loss": 37.06939697265625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 460000, "time_since_restore": 433.9149134159088, "episode_len_mean": 500.0, "date": "2018-12-10_04-52-37", "done": false, "time_this_iter_s": 18.200143575668335, "episode_reward_max": 0.0, "iterations_since_restore": 23, "episodes_total": 1144, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -113.87938394169636, "av": 113.87938394169636}, "timestamp": 1544417557, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 23, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6128>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 460000, "time_total_s": 433.9149134159088, "custom_metrics": {}, "info": {"sample_time_ms": 11240.4, "num_steps_trained": 460000, "update_time_ms": 7.119, "grad_time_ms": 6719.947, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7539512515068054, "vf_loss": 41.04001235961914, "policy_loss": -0.05696934834122658, "cur_lr": 9.999999747378752e-05, "kl": 0.03167460486292839, "entropy": 135.8262176513672, "total_loss": 40.989376068115234}, "num_steps_sampled": 460000, "load_time_ms": 13.837, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7555103898048401, "vf_loss": 40.53331756591797, "policy_loss": -0.006987399887293577, "cur_lr": 9.999999747378752e-05, "kl": 0.014212883077561855, "entropy": 2.5083508491516113, "total_loss": 40.526344299316406}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 480000, "time_since_restore": 451.71494698524475, "episode_len_mean": 496.76, "date": "2018-12-10_04-52-54", "done": false, "time_this_iter_s": 17.800033569335938, "episode_reward_max": 0.0, "iterations_since_restore": 24, "episodes_total": 1188, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -113.34401342049358, "av": 113.34401342049358}, "timestamp": 1544417574, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 24, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6e10>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 480000, "time_total_s": 451.71494698524475, "custom_metrics": {}, "info": {"sample_time_ms": 11188.573, "num_steps_trained": 480000, "update_time_ms": 7.166, "grad_time_ms": 6706.846, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.756687343120575, "vf_loss": 52.05813980102539, "policy_loss": -0.056975357234478, "cur_lr": 9.999999747378752e-05, "kl": 0.03183194249868393, "entropy": 135.93035888671875, "total_loss": 52.00752639770508}, "num_steps_sampled": 480000, "load_time_ms": 13.876, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7579420208930969, "vf_loss": 51.60218811035156, "policy_loss": -0.006886627525091171, "cur_lr": 9.999999747378752e-05, "kl": 0.013393484987318516, "entropy": 2.462968587875366, "total_loss": 51.59531784057617}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 500000, "time_since_restore": 469.91890358924866, "episode_len_mean": 485.77, "date": "2018-12-10_04-53-13", "done": false, "time_this_iter_s": 18.203956604003906, "episode_reward_max": 0.0, "iterations_since_restore": 25, "episodes_total": 1233, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -110.36805790650453, "av": 110.36805790650453}, "timestamp": 1544417593, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 25, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9cf8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 500000, "time_total_s": 469.91890358924866, "custom_metrics": {}, "info": {"sample_time_ms": 11158.188, "num_steps_trained": 500000, "update_time_ms": 7.055, "grad_time_ms": 6736.059, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7319133281707764, "vf_loss": 52.669952392578125, "policy_loss": -0.05708637461066246, "cur_lr": 9.999999747378752e-05, "kl": 0.0312979556620121, "entropy": 135.90969848632812, "total_loss": 52.6191291809082}, "num_steps_sampled": 500000, "load_time_ms": 13.854, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7404299974441528, "vf_loss": 51.82478332519531, "policy_loss": -0.005529416725039482, "cur_lr": 9.999999747378752e-05, "kl": 0.010144549421966076, "entropy": 2.4742062091827393, "total_loss": 51.81926727294922}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 520000, "time_since_restore": 487.7070577144623, "episode_len_mean": 489.01, "date": "2018-12-10_04-53-31", "done": false, "time_this_iter_s": 17.788154125213623, "episode_reward_max": 0.0, "iterations_since_restore": 26, "episodes_total": 1277, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -110.65962246434827, "av": 110.65962246434827}, "timestamp": 1544417611, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 26, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f65f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 520000, "time_total_s": 487.7070577144623, "custom_metrics": {}, "info": {"sample_time_ms": 11134.927, "num_steps_trained": 520000, "update_time_ms": 7.019, "grad_time_ms": 6715.436, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6880993843078613, "vf_loss": 54.24945068359375, "policy_loss": -0.05561503395438194, "cur_lr": 9.999999747378752e-05, "kl": 0.033248525112867355, "entropy": 135.89736938476562, "total_loss": 54.200496673583984}, "num_steps_sampled": 520000, "load_time_ms": 13.871, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6786977052688599, "vf_loss": 53.79620361328125, "policy_loss": -0.0054274871945381165, "cur_lr": 9.999999747378752e-05, "kl": 0.011133036576211452, "entropy": 2.4615118503570557, "total_loss": 53.790802001953125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 540000, "time_since_restore": 505.77593445777893, "episode_len_mean": 491.1, "date": "2018-12-10_04-53-49", "done": false, "time_this_iter_s": 18.06887674331665, "episode_reward_max": 0.0, "iterations_since_restore": 27, "episodes_total": 1322, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -110.58843888816455, "av": 110.58843888816455}, "timestamp": 1544417629, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 27, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145b70>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 540000, "time_total_s": 505.77593445777893, "custom_metrics": {}, "info": {"sample_time_ms": 11196.857, "num_steps_trained": 540000, "update_time_ms": 7.08, "grad_time_ms": 6720.713, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6901172995567322, "vf_loss": 60.87982177734375, "policy_loss": -0.057371675968170166, "cur_lr": 9.999999747378752e-05, "kl": 0.03301240876317024, "entropy": 135.72360229492188, "total_loss": 60.82905197143555}, "num_steps_sampled": 540000, "load_time_ms": 14.134, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6812379360198975, "vf_loss": 60.650604248046875, "policy_loss": -0.006388893350958824, "cur_lr": 9.999999747378752e-05, "kl": 0.012262601405382156, "entropy": 2.480774402618408, "total_loss": 60.644229888916016}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 560000, "time_since_restore": 523.5048635005951, "episode_len_mean": 495.71, "date": "2018-12-10_04-54-06", "done": false, "time_this_iter_s": 17.728929042816162, "episode_reward_max": 0.0, "iterations_since_restore": 28, "episodes_total": 1365, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.07904294401793, "av": 118.07904294401793}, "timestamp": 1544417646, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 28, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148668>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 560000, "time_total_s": 523.5048635005951, "custom_metrics": {}, "info": {"sample_time_ms": 11172.764, "num_steps_trained": 560000, "update_time_ms": 7.054, "grad_time_ms": 6685.39, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6470332741737366, "vf_loss": 69.76250457763672, "policy_loss": -0.0553433783352375, "cur_lr": 9.999999747378752e-05, "kl": 0.03199378401041031, "entropy": 135.90061950683594, "total_loss": 69.71356201171875}, "num_steps_sampled": 560000, "load_time_ms": 13.835, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6445068717002869, "vf_loss": 68.91969299316406, "policy_loss": -0.005199615843594074, "cur_lr": 9.999999747378752e-05, "kl": 0.011380414478480816, "entropy": 2.430148124694824, "total_loss": 68.91451263427734}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 580000, "time_since_restore": 541.1559534072876, "episode_len_mean": 497.16, "date": "2018-12-10_04-54-24", "done": false, "time_this_iter_s": 17.651089906692505, "episode_reward_max": 0.0, "iterations_since_restore": 29, "episodes_total": 1412, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.47243411477066, "av": 124.47243411477066}, "timestamp": 1544417664, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 29, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e83c8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 580000, "time_total_s": 541.1559534072876, "custom_metrics": {}, "info": {"sample_time_ms": 11176.764, "num_steps_trained": 580000, "update_time_ms": 6.981, "grad_time_ms": 6678.529, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6365333795547485, "vf_loss": 77.24114990234375, "policy_loss": -0.0537862665951252, "cur_lr": 9.999999747378752e-05, "kl": 0.03130928799510002, "entropy": 135.86441040039062, "total_loss": 77.19361877441406}, "num_steps_sampled": 580000, "load_time_ms": 14.08, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.638259768486023, "vf_loss": 75.28008270263672, "policy_loss": -0.006816202308982611, "cur_lr": 9.999999747378752e-05, "kl": 0.014521262608468533, "entropy": 2.435647964477539, "total_loss": 75.27330017089844}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 600000, "time_since_restore": 558.9758536815643, "episode_len_mean": 497.56, "date": "2018-12-10_04-54-42", "done": false, "time_this_iter_s": 17.819900274276733, "episode_reward_max": 0.0, "iterations_since_restore": 30, "episodes_total": 1454, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -117.9875228158703, "av": 117.9875228158703}, "timestamp": 1544417682, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 30, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e8d30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 600000, "time_total_s": 558.9758536815643, "custom_metrics": {}, "info": {"sample_time_ms": 11159.101, "num_steps_trained": 600000, "update_time_ms": 6.879, "grad_time_ms": 6678.387, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7206997275352478, "vf_loss": 72.97486114501953, "policy_loss": -0.05827558413147926, "cur_lr": 9.999999747378752e-05, "kl": 0.032259970903396606, "entropy": 135.6835174560547, "total_loss": 72.92303466796875}, "num_steps_sampled": 600000, "load_time_ms": 14.041, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7295292615890503, "vf_loss": 70.47835540771484, "policy_loss": -0.006671451032161713, "cur_lr": 9.999999747378752e-05, "kl": 0.01109492126852274, "entropy": 2.494189739227295, "total_loss": 70.47169494628906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 620000, "time_since_restore": 576.8823368549347, "episode_len_mean": 497.53, "date": "2018-12-10_04-55-00", "done": false, "time_this_iter_s": 17.90648317337036, "episode_reward_max": 0.0, "iterations_since_restore": 31, "episodes_total": 1499, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -116.07225174397529, "av": 116.07225174397529}, "timestamp": 1544417700, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 31, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e86a0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 620000, "time_total_s": 576.8823368549347, "custom_metrics": {}, "info": {"sample_time_ms": 11173.364, "num_steps_trained": 620000, "update_time_ms": 7.006, "grad_time_ms": 6683.212, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6593332290649414, "vf_loss": 85.87405395507812, "policy_loss": -0.05317845568060875, "cur_lr": 9.999999747378752e-05, "kl": 0.030370326712727547, "entropy": 135.8243865966797, "total_loss": 85.82695007324219}, "num_steps_sampled": 620000, "load_time_ms": 14.038, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6641048192977905, "vf_loss": 83.95061492919922, "policy_loss": -0.006963745690882206, "cur_lr": 9.999999747378752e-05, "kl": 0.01347671914845705, "entropy": 2.4186298847198486, "total_loss": 83.94367980957031}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 640000, "time_since_restore": 594.9051613807678, "episode_len_mean": 492.61, "date": "2018-12-10_04-55-18", "done": false, "time_this_iter_s": 18.02282452583313, "episode_reward_max": 0.0, "iterations_since_restore": 32, "episodes_total": 1545, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.82608672048757, "av": 118.82608672048757}, "timestamp": 1544417718, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 32, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641485c0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 640000, "time_total_s": 594.9051613807678, "custom_metrics": {}, "info": {"sample_time_ms": 11149.049, "num_steps_trained": 640000, "update_time_ms": 6.908, "grad_time_ms": 6698.266, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5860271453857422, "vf_loss": 92.67603302001953, "policy_loss": -0.05550041049718857, "cur_lr": 9.999999747378752e-05, "kl": 0.03187315911054611, "entropy": 135.8958282470703, "total_loss": 92.62691497802734}, "num_steps_sampled": 640000, "load_time_ms": 14.084, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5903192162513733, "vf_loss": 91.40943908691406, "policy_loss": -0.006581238470971584, "cur_lr": 9.999999747378752e-05, "kl": 0.013914501294493675, "entropy": 2.3849029541015625, "total_loss": 91.40288543701172}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 660000, "time_since_restore": 612.8657641410828, "episode_len_mean": 489.31, "date": "2018-12-10_04-55-36", "done": false, "time_this_iter_s": 17.96060276031494, "episode_reward_max": 0.0, "iterations_since_restore": 33, "episodes_total": 1589, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -113.55783367566221, "av": 113.55783367566221}, "timestamp": 1544417736, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 33, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9898>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 660000, "time_total_s": 612.8657641410828, "custom_metrics": {}, "info": {"sample_time_ms": 11137.848, "num_steps_trained": 660000, "update_time_ms": 6.8, "grad_time_ms": 6685.626, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7534639239311218, "vf_loss": 84.4515380859375, "policy_loss": -0.05747007578611374, "cur_lr": 9.999999747378752e-05, "kl": 0.032239485532045364, "entropy": 135.5088348388672, "total_loss": 84.40050506591797}, "num_steps_sampled": 660000, "load_time_ms": 14.065, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7588882446289062, "vf_loss": 82.44783020019531, "policy_loss": -0.006764202378690243, "cur_lr": 9.999999747378752e-05, "kl": 0.013088648207485676, "entropy": 2.4453976154327393, "total_loss": 82.44108581542969}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 680000, "time_since_restore": 630.7210445404053, "episode_len_mean": 496.7, "date": "2018-12-10_04-55-54", "done": false, "time_this_iter_s": 17.85528039932251, "episode_reward_max": 0.0, "iterations_since_restore": 34, "episodes_total": 1634, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -112.90446264678636, "av": 112.90446264678636}, "timestamp": 1544417754, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 34, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148be0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 680000, "time_total_s": 630.7210445404053, "custom_metrics": {}, "info": {"sample_time_ms": 11131.26, "num_steps_trained": 680000, "update_time_ms": 6.845, "grad_time_ms": 6697.617, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7579889297485352, "vf_loss": 90.34343719482422, "policy_loss": -0.05705892667174339, "cur_lr": 9.999999747378752e-05, "kl": 0.03238491341471672, "entropy": 135.55856323242188, "total_loss": 90.29286193847656}, "num_steps_sampled": 680000, "load_time_ms": 14.023, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7623341083526611, "vf_loss": 88.8037109375, "policy_loss": -0.006890568416565657, "cur_lr": 9.999999747378752e-05, "kl": 0.015804192051291466, "entropy": 2.41607403755188, "total_loss": 88.7968521118164}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 700000, "time_since_restore": 648.2386033535004, "episode_len_mean": 500.0, "date": "2018-12-10_04-56-11", "done": false, "time_this_iter_s": 17.517558813095093, "episode_reward_max": 0.0, "iterations_since_restore": 35, "episodes_total": 1677, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -116.14602539990429, "av": 116.14602539990429}, "timestamp": 1544417771, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 35, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641dad30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 700000, "time_total_s": 648.2386033535004, "custom_metrics": {}, "info": {"sample_time_ms": 11077.363, "num_steps_trained": 700000, "update_time_ms": 6.869, "grad_time_ms": 6683.151, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7161164879798889, "vf_loss": 97.48039245605469, "policy_loss": -0.05310629680752754, "cur_lr": 9.999999747378752e-05, "kl": 0.030633071437478065, "entropy": 135.63232421875, "total_loss": 97.43340301513672}, "num_steps_sampled": 700000, "load_time_ms": 13.87, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7089043855667114, "vf_loss": 97.50884246826172, "policy_loss": -0.00544711435213685, "cur_lr": 9.999999747378752e-05, "kl": 0.011496341787278652, "entropy": 2.397850275039673, "total_loss": 97.50341033935547}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 720000, "time_since_restore": 666.1824154853821, "episode_len_mean": 500.0, "date": "2018-12-10_04-56-29", "done": false, "time_this_iter_s": 17.943812131881714, "episode_reward_max": 0.0, "iterations_since_restore": 36, "episodes_total": 1720, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.54339929959093, "av": 115.54339929959093}, "timestamp": 1544417789, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 36, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6d30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 720000, "time_total_s": 666.1824154853821, "custom_metrics": {}, "info": {"sample_time_ms": 11093.554, "num_steps_trained": 720000, "update_time_ms": 7.02, "grad_time_ms": 6682.02, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6900753378868103, "vf_loss": 96.22277069091797, "policy_loss": -0.054461147636175156, "cur_lr": 9.999999747378752e-05, "kl": 0.03171645849943161, "entropy": 135.41534423828125, "total_loss": 96.1746597290039}, "num_steps_sampled": 720000, "load_time_ms": 14.102, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6806485056877136, "vf_loss": 96.1830062866211, "policy_loss": -0.006979768164455891, "cur_lr": 9.999999747378752e-05, "kl": 0.0151015380397439, "entropy": 2.4337213039398193, "total_loss": 96.17604064941406}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 740000, "time_since_restore": 684.1327302455902, "episode_len_mean": 499.71, "date": "2018-12-10_04-56-47", "done": false, "time_this_iter_s": 17.95031476020813, "episode_reward_max": 0.0, "iterations_since_restore": 37, "episodes_total": 1765, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.56426201854529, "av": 115.56426201854529}, "timestamp": 1544417807, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 37, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9860>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 740000, "time_total_s": 684.1327302455902, "custom_metrics": {}, "info": {"sample_time_ms": 11075.494, "num_steps_trained": 740000, "update_time_ms": 7.044, "grad_time_ms": 6688.064, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6717740297317505, "vf_loss": 115.87418365478516, "policy_loss": -0.055609080940485, "cur_lr": 9.999999747378752e-05, "kl": 0.0321614146232605, "entropy": 135.59072875976562, "total_loss": 115.82501983642578}, "num_steps_sampled": 740000, "load_time_ms": 14.135, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6702415347099304, "vf_loss": 114.62437438964844, "policy_loss": -0.0057256207801401615, "cur_lr": 9.999999747378752e-05, "kl": 0.013697421178221703, "entropy": 2.36034893989563, "total_loss": 114.6186752319336}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 760000, "time_since_restore": 702.60435795784, "episode_len_mean": 498.63, "date": "2018-12-10_04-57-06", "done": false, "time_this_iter_s": 18.471627712249756, "episode_reward_max": 0.0, "iterations_since_restore": 38, "episodes_total": 1810, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -114.95296545229857, "av": 114.95296545229857}, "timestamp": 1544417826, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 38, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536414c080>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 760000, "time_total_s": 702.60435795784, "custom_metrics": {}, "info": {"sample_time_ms": 11137.05, "num_steps_trained": 760000, "update_time_ms": 7.076, "grad_time_ms": 6700.944, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7035722136497498, "vf_loss": 101.68633270263672, "policy_loss": -0.059013012796640396, "cur_lr": 9.999999747378752e-05, "kl": 0.03380692005157471, "entropy": 135.362548828125, "total_loss": 101.63408660888672}, "num_steps_sampled": 760000, "load_time_ms": 14.129, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6984794735908508, "vf_loss": 100.6957778930664, "policy_loss": -0.006473110057413578, "cur_lr": 9.999999747378752e-05, "kl": 0.012499773874878883, "entropy": 2.417074203491211, "total_loss": 100.6893310546875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 780000, "time_since_restore": 720.3664968013763, "episode_len_mean": 498.92, "date": "2018-12-10_04-57-23", "done": false, "time_this_iter_s": 17.762138843536377, "episode_reward_max": 0.0, "iterations_since_restore": 39, "episodes_total": 1853, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -117.78193049311332, "av": 117.78193049311332}, "timestamp": 1544417843, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 39, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e88d0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 780000, "time_total_s": 720.3664968013763, "custom_metrics": {}, "info": {"sample_time_ms": 11129.365, "num_steps_trained": 780000, "update_time_ms": 7.06, "grad_time_ms": 6719.563, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.661824643611908, "vf_loss": 114.91010284423828, "policy_loss": -0.055971793830394745, "cur_lr": 9.999999747378752e-05, "kl": 0.03306294605135918, "entropy": 135.4288787841797, "total_loss": 114.86072540283203}, "num_steps_sampled": 780000, "load_time_ms": 14.246, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6635127067565918, "vf_loss": 113.46011352539062, "policy_loss": -0.005141433794051409, "cur_lr": 9.999999747378752e-05, "kl": 0.012498843483626842, "entropy": 2.4077069759368896, "total_loss": 113.45499420166016}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 800000, "time_since_restore": 738.5058765411377, "episode_len_mean": 498.92, "date": "2018-12-10_04-57-42", "done": false, "time_this_iter_s": 18.139379739761353, "episode_reward_max": 0.0, "iterations_since_restore": 40, "episodes_total": 1898, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -113.3528430162568, "av": 113.3528430162568}, "timestamp": 1544417862, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 40, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641457b8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 800000, "time_total_s": 738.5058765411377, "custom_metrics": {}, "info": {"sample_time_ms": 11161.208, "num_steps_trained": 800000, "update_time_ms": 7.059, "grad_time_ms": 6720.35, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7283000946044922, "vf_loss": 102.97758483886719, "policy_loss": -0.056918296962976456, "cur_lr": 9.999999747378752e-05, "kl": 0.03295191004872322, "entropy": 135.24403381347656, "total_loss": 102.92724609375}, "num_steps_sampled": 800000, "load_time_ms": 13.966, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7305039763450623, "vf_loss": 101.69209289550781, "policy_loss": -0.006132164504379034, "cur_lr": 9.999999747378752e-05, "kl": 0.012239520438015461, "entropy": 2.4510209560394287, "total_loss": 101.68598175048828}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 820000, "time_since_restore": 756.0432605743408, "episode_len_mean": 500.0, "date": "2018-12-10_04-57-59", "done": false, "time_this_iter_s": 17.537384033203125, "episode_reward_max": 0.0, "iterations_since_restore": 41, "episodes_total": 1940, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.12731513140712, "av": 115.12731513140712}, "timestamp": 1544417879, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 41, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148240>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 820000, "time_total_s": 756.0432605743408, "custom_metrics": {}, "info": {"sample_time_ms": 11108.311, "num_steps_trained": 820000, "update_time_ms": 7.421, "grad_time_ms": 6735.78, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6557983160018921, "vf_loss": 116.56761932373047, "policy_loss": -0.052976351231336594, "cur_lr": 9.999999747378752e-05, "kl": 0.031402960419654846, "entropy": 135.5017547607422, "total_loss": 116.52091979980469}, "num_steps_sampled": 820000, "load_time_ms": 13.999, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6521415710449219, "vf_loss": 115.46263885498047, "policy_loss": -0.004831088241189718, "cur_lr": 9.999999747378752e-05, "kl": 0.012187312357127666, "entropy": 2.3832740783691406, "total_loss": 115.45781707763672}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 840000, "time_since_restore": 774.0281209945679, "episode_len_mean": 500.0, "date": "2018-12-10_04-58-17", "done": false, "time_this_iter_s": 17.98486042022705, "episode_reward_max": 0.0, "iterations_since_restore": 42, "episodes_total": 1986, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -117.80836259592243, "av": 117.80836259592243}, "timestamp": 1544417897, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 42, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536414c668>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 840000, "time_total_s": 774.0281209945679, "custom_metrics": {}, "info": {"sample_time_ms": 11097.728, "num_steps_trained": 840000, "update_time_ms": 7.379, "grad_time_ms": 6742.888, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7419458031654358, "vf_loss": 110.76802825927734, "policy_loss": -0.05639060214161873, "cur_lr": 9.999999747378752e-05, "kl": 0.033069122582674026, "entropy": 135.3580780029297, "total_loss": 110.7182388305664}, "num_steps_sampled": 840000, "load_time_ms": 13.95, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7263441681861877, "vf_loss": 110.91837310791016, "policy_loss": -0.005709716118872166, "cur_lr": 9.999999747378752e-05, "kl": 0.012473858892917633, "entropy": 2.39249587059021, "total_loss": 110.91268157958984}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 860000, "time_since_restore": 791.9532787799835, "episode_len_mean": 500.0, "date": "2018-12-10_04-58-35", "done": false, "time_this_iter_s": 17.92515778541565, "episode_reward_max": 0.0, "iterations_since_restore": 43, "episodes_total": 2028, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -112.86370716323877, "av": 112.86370716323877}, "timestamp": 1544417915, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 43, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641cf400>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 860000, "time_total_s": 791.9532787799835, "custom_metrics": {}, "info": {"sample_time_ms": 11076.493, "num_steps_trained": 860000, "update_time_ms": 7.379, "grad_time_ms": 6760.601, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7476387023925781, "vf_loss": 116.58002471923828, "policy_loss": -0.060135290026664734, "cur_lr": 9.999999747378752e-05, "kl": 0.03461297228932381, "entropy": 135.23329162597656, "total_loss": 116.52681732177734}, "num_steps_sampled": 860000, "load_time_ms": 13.956, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7347245812416077, "vf_loss": 116.79597473144531, "policy_loss": -0.006490684580057859, "cur_lr": 9.999999747378752e-05, "kl": 0.013134162873029709, "entropy": 2.3916590213775635, "total_loss": 116.78948974609375}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 880000, "time_since_restore": 810.0975778102875, "episode_len_mean": 500.0, "date": "2018-12-10_04-58-53", "done": false, "time_this_iter_s": 18.144299030303955, "episode_reward_max": 0.0, "iterations_since_restore": 44, "episodes_total": 2073, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -112.73063042856553, "av": 112.73063042856553}, "timestamp": 1544417933, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 44, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536414cef0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 880000, "time_total_s": 810.0975778102875, "custom_metrics": {}, "info": {"sample_time_ms": 11087.911, "num_steps_trained": 880000, "update_time_ms": 7.32, "grad_time_ms": 6777.436, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6584512591362, "vf_loss": 125.8233413696289, "policy_loss": -0.058681707829236984, "cur_lr": 9.999999747378752e-05, "kl": 0.033975761383771896, "entropy": 135.25062561035156, "total_loss": 125.77144622802734}, "num_steps_sampled": 880000, "load_time_ms": 14.308, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6311092376708984, "vf_loss": 127.24256134033203, "policy_loss": -0.005332692060619593, "cur_lr": 9.999999747378752e-05, "kl": 0.011913366615772247, "entropy": 2.367615222930908, "total_loss": 127.23725128173828}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 900000, "time_since_restore": 827.7946722507477, "episode_len_mean": 500.0, "date": "2018-12-10_04-59-11", "done": false, "time_this_iter_s": 17.697094440460205, "episode_reward_max": 0.0, "iterations_since_restore": 45, "episodes_total": 2115, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -115.86498862728673, "av": 115.86498862728673}, "timestamp": 1544417951, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 45, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e2ba8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 900000, "time_total_s": 827.7946722507477, "custom_metrics": {}, "info": {"sample_time_ms": 11113.099, "num_steps_trained": 900000, "update_time_ms": 7.271, "grad_time_ms": 6770.43, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6832818984985352, "vf_loss": 134.91253662109375, "policy_loss": -0.0547059141099453, "cur_lr": 9.999999747378752e-05, "kl": 0.031771451234817505, "entropy": 135.41073608398438, "total_loss": 134.86419677734375}, "num_steps_sampled": 900000, "load_time_ms": 14.26, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6513237357139587, "vf_loss": 138.3440399169922, "policy_loss": -0.007035790476948023, "cur_lr": 9.999999747378752e-05, "kl": 0.013159222900867462, "entropy": 2.3111207485198975, "total_loss": 138.33702087402344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 920000, "time_since_restore": 846.4117856025696, "episode_len_mean": 500.0, "date": "2018-12-10_04-59-30", "done": false, "time_this_iter_s": 18.6171133518219, "episode_reward_max": 0.0, "iterations_since_restore": 46, "episodes_total": 2162, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -116.66448605438725, "av": 116.66448605438725}, "timestamp": 1544417970, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 46, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641605f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 920000, "time_total_s": 846.4117856025696, "custom_metrics": {}, "info": {"sample_time_ms": 11168.965, "num_steps_trained": 920000, "update_time_ms": 7.102, "grad_time_ms": 6782.128, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.640553891658783, "vf_loss": 120.5555648803711, "policy_loss": -0.05818764492869377, "cur_lr": 9.999999747378752e-05, "kl": 0.0339086577296257, "entropy": 135.11984252929688, "total_loss": 120.50415802001953}, "num_steps_sampled": 920000, "load_time_ms": 14.284, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6048424243927002, "vf_loss": 123.8160171508789, "policy_loss": -0.005685693118721247, "cur_lr": 9.999999747378752e-05, "kl": 0.011683620512485504, "entropy": 2.3353993892669678, "total_loss": 123.81034851074219}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 940000, "time_since_restore": 863.7824053764343, "episode_len_mean": 498.87, "date": "2018-12-10_04-59-47", "done": false, "time_this_iter_s": 17.370619773864746, "episode_reward_max": 0.0, "iterations_since_restore": 47, "episodes_total": 2205, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -117.73522565147623, "av": 117.73522565147623}, "timestamp": 1544417987, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 47, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148fd0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 940000, "time_total_s": 863.7824053764343, "custom_metrics": {}, "info": {"sample_time_ms": 11122.481, "num_steps_trained": 940000, "update_time_ms": 6.998, "grad_time_ms": 6771.668, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.601300835609436, "vf_loss": 126.80488586425781, "policy_loss": -0.05502308905124664, "cur_lr": 9.999999747378752e-05, "kl": 0.03241829201579094, "entropy": 135.2236328125, "total_loss": 126.75634765625}, "num_steps_sampled": 940000, "load_time_ms": 14.015, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.571860671043396, "vf_loss": 129.48793029785156, "policy_loss": -0.0064166332595050335, "cur_lr": 9.999999747378752e-05, "kl": 0.01403157226741314, "entropy": 2.3046751022338867, "total_loss": 129.4815216064453}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 960000, "time_since_restore": 881.5125992298126, "episode_len_mean": 492.29, "date": "2018-12-10_05-00-05", "done": false, "time_this_iter_s": 17.730193853378296, "episode_reward_max": 0.0, "iterations_since_restore": 48, "episodes_total": 2251, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -112.19155496419526, "av": 112.19155496419526}, "timestamp": 1544418005, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 48, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641507b8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 960000, "time_total_s": 881.5125992298126, "custom_metrics": {}, "info": {"sample_time_ms": 11062.142, "num_steps_trained": 960000, "update_time_ms": 6.869, "grad_time_ms": 6757.96, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7305111885070801, "vf_loss": 117.25330352783203, "policy_loss": -0.058732349425554276, "cur_lr": 9.999999747378752e-05, "kl": 0.034349847584962845, "entropy": 135.0628204345703, "total_loss": 117.20144653320312}, "num_steps_sampled": 960000, "load_time_ms": 14.02, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6954649686813354, "vf_loss": 122.97250366210938, "policy_loss": -0.006612370256334543, "cur_lr": 9.999999747378752e-05, "kl": 0.015398328192532063, "entropy": 2.349780559539795, "total_loss": 122.96590423583984}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 980000, "time_since_restore": 899.3259456157684, "episode_len_mean": 493.42, "date": "2018-12-10_05-00-23", "done": false, "time_this_iter_s": 17.81334638595581, "episode_reward_max": 0.0, "iterations_since_restore": 49, "episodes_total": 2295, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -108.32210759671399, "av": 108.32210759671399}, "timestamp": 1544418023, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 49, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364150358>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 980000, "time_total_s": 899.3259456157684, "custom_metrics": {}, "info": {"sample_time_ms": 11075.752, "num_steps_trained": 980000, "update_time_ms": 6.849, "grad_time_ms": 6750.003, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7549661993980408, "vf_loss": 120.25160217285156, "policy_loss": -0.059184495359659195, "cur_lr": 9.999999747378752e-05, "kl": 0.0352071113884449, "entropy": 135.0049285888672, "total_loss": 120.19944763183594}, "num_steps_sampled": 980000, "load_time_ms": 13.874, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7161321640014648, "vf_loss": 126.77521514892578, "policy_loss": -0.006812723819166422, "cur_lr": 9.999999747378752e-05, "kl": 0.014366119168698788, "entropy": 2.343581438064575, "total_loss": 126.7684326171875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1000000, "time_since_restore": 916.9909229278564, "episode_len_mean": 497.43, "date": "2018-12-10_05-00-40", "done": false, "time_this_iter_s": 17.664977312088013, "episode_reward_max": 0.0, "iterations_since_restore": 50, "episodes_total": 2339, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -112.56158774600375, "av": 112.56158774600375}, "timestamp": 1544418040, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 50, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145d30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1000000, "time_total_s": 916.9909229278564, "custom_metrics": {}, "info": {"sample_time_ms": 11040.671, "num_steps_trained": 1000000, "update_time_ms": 6.858, "grad_time_ms": 6737.37, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6635053753852844, "vf_loss": 131.09222412109375, "policy_loss": -0.05839691311120987, "cur_lr": 9.999999747378752e-05, "kl": 0.033992502838373184, "entropy": 135.11114501953125, "total_loss": 131.04061889648438}, "num_steps_sampled": 1000000, "load_time_ms": 14.148, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6164709329605103, "vf_loss": 135.68963623046875, "policy_loss": -0.006108524743467569, "cur_lr": 9.999999747378752e-05, "kl": 0.013275315053761005, "entropy": 2.286064386367798, "total_loss": 135.68356323242188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1020000, "time_since_restore": 934.7016727924347, "episode_len_mean": 500.0, "date": "2018-12-10_05-00-58", "done": false, "time_this_iter_s": 17.710749864578247, "episode_reward_max": 0.0, "iterations_since_restore": 51, "episodes_total": 2384, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -116.59835464068615, "av": 116.59835464068615}, "timestamp": 1544418058, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 51, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e2f28>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1020000, "time_total_s": 934.7016727924347, "custom_metrics": {}, "info": {"sample_time_ms": 11062.721, "num_steps_trained": 1020000, "update_time_ms": 6.321, "grad_time_ms": 6733.438, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7043821811676025, "vf_loss": 121.46832275390625, "policy_loss": -0.05606360360980034, "cur_lr": 9.999999747378752e-05, "kl": 0.034348733723163605, "entropy": 135.02688598632812, "total_loss": 121.41914367675781}, "num_steps_sampled": 1020000, "load_time_ms": 14.171, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6761162281036377, "vf_loss": 125.25743865966797, "policy_loss": -0.006385789252817631, "cur_lr": 9.999999747378752e-05, "kl": 0.012940472923219204, "entropy": 2.290239095687866, "total_loss": 125.25105285644531}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1040000, "time_since_restore": 952.2383437156677, "episode_len_mean": 498.16, "date": "2018-12-10_05-01-16", "done": false, "time_this_iter_s": 17.536670923233032, "episode_reward_max": 0.0, "iterations_since_restore": 52, "episodes_total": 2428, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.84949615353547, "av": 118.84949615353547}, "timestamp": 1544418076, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 52, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145240>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1040000, "time_total_s": 952.2383437156677, "custom_metrics": {}, "info": {"sample_time_ms": 11050.367, "num_steps_trained": 1040000, "update_time_ms": 6.281, "grad_time_ms": 6701.237, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6602104902267456, "vf_loss": 132.99501037597656, "policy_loss": -0.05696893483400345, "cur_lr": 9.999999747378752e-05, "kl": 0.03492148220539093, "entropy": 134.944580078125, "total_loss": 132.94503784179688}, "num_steps_sampled": 1040000, "load_time_ms": 14.149, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6372988820075989, "vf_loss": 135.57339477539062, "policy_loss": -0.005593452602624893, "cur_lr": 9.999999747378752e-05, "kl": 0.015713654458522797, "entropy": 2.3062894344329834, "total_loss": 135.56784057617188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1060000, "time_since_restore": 969.9069428443909, "episode_len_mean": 498.16, "date": "2018-12-10_05-01-33", "done": false, "time_this_iter_s": 17.668599128723145, "episode_reward_max": 0.0, "iterations_since_restore": 53, "episodes_total": 2470, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.81081776552814, "av": 121.81081776552814}, "timestamp": 1544418093, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 53, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641609b0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1060000, "time_total_s": 969.9069428443909, "custom_metrics": {}, "info": {"sample_time_ms": 11032.976, "num_steps_trained": 1060000, "update_time_ms": 6.249, "grad_time_ms": 6693.75, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6284129023551941, "vf_loss": 137.55027770996094, "policy_loss": -0.056957073509693146, "cur_lr": 9.999999747378752e-05, "kl": 0.034067850559949875, "entropy": 134.98245239257812, "total_loss": 137.50015258789062}, "num_steps_sampled": 1060000, "load_time_ms": 13.872, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.612747848033905, "vf_loss": 140.432373046875, "policy_loss": -0.006026744842529297, "cur_lr": 9.999999747378752e-05, "kl": 0.011233553290367126, "entropy": 2.3265345096588135, "total_loss": 140.42636108398438}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1080000, "time_since_restore": 987.7571241855621, "episode_len_mean": 498.16, "date": "2018-12-10_05-01-51", "done": false, "time_this_iter_s": 17.850181341171265, "episode_reward_max": 0.0, "iterations_since_restore": 54, "episodes_total": 2515, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.33213715872563, "av": 120.33213715872563}, "timestamp": 1544418111, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 54, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641504e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1080000, "time_total_s": 987.7571241855621, "custom_metrics": {}, "info": {"sample_time_ms": 11039.985, "num_steps_trained": 1080000, "update_time_ms": 6.21, "grad_time_ms": 6658.39, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6562198996543884, "vf_loss": 135.70114135742188, "policy_loss": -0.05850972980260849, "cur_lr": 9.999999747378752e-05, "kl": 0.034774377942085266, "entropy": 134.95750427246094, "total_loss": 135.6495819091797}, "num_steps_sampled": 1080000, "load_time_ms": 13.485, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6557151079177856, "vf_loss": 135.25906372070312, "policy_loss": -0.005874332040548325, "cur_lr": 9.999999747378752e-05, "kl": 0.01357227098196745, "entropy": 2.2860260009765625, "total_loss": 135.25320434570312}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1100000, "time_since_restore": 1005.4599695205688, "episode_len_mean": 495.99, "date": "2018-12-10_05-02-09", "done": false, "time_this_iter_s": 17.702845335006714, "episode_reward_max": 0.0, "iterations_since_restore": 55, "episodes_total": 2560, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -116.96011324769097, "av": 116.96011324769097}, "timestamp": 1544418129, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 55, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364150710>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1100000, "time_total_s": 1005.4599695205688, "custom_metrics": {}, "info": {"sample_time_ms": 11027.708, "num_steps_trained": 1100000, "update_time_ms": 6.192, "grad_time_ms": 6670.861, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6071231365203857, "vf_loss": 138.14125061035156, "policy_loss": -0.056949179619550705, "cur_lr": 9.999999747378752e-05, "kl": 0.0333796851336956, "entropy": 134.8946075439453, "total_loss": 138.09097290039062}, "num_steps_sampled": 1100000, "load_time_ms": 13.708, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6178185939788818, "vf_loss": 136.91409301757812, "policy_loss": -0.006257143337279558, "cur_lr": 9.999999747378752e-05, "kl": 0.014363759197294712, "entropy": 2.29638409614563, "total_loss": 136.90785217285156}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1120000, "time_since_restore": 1023.2996208667755, "episode_len_mean": 494.22, "date": "2018-12-10_05-02-27", "done": false, "time_this_iter_s": 17.839651346206665, "episode_reward_max": 0.0, "iterations_since_restore": 56, "episodes_total": 2603, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -113.0369028936031, "av": 113.0369028936031}, "timestamp": 1544418147, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 56, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364160b38>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1120000, "time_total_s": 1023.2996208667755, "custom_metrics": {}, "info": {"sample_time_ms": 10957.673, "num_steps_trained": 1120000, "update_time_ms": 6.188, "grad_time_ms": 6663.874, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6608996391296387, "vf_loss": 141.41213989257812, "policy_loss": -0.05919353663921356, "cur_lr": 9.999999747378752e-05, "kl": 0.03434116393327713, "entropy": 134.73147583007812, "total_loss": 141.35983276367188}, "num_steps_sampled": 1120000, "load_time_ms": 13.415, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6647190451622009, "vf_loss": 139.76515197753906, "policy_loss": -0.006959536112844944, "cur_lr": 9.999999747378752e-05, "kl": 0.017139747738838196, "entropy": 2.3126041889190674, "total_loss": 139.75820922851562}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1140000, "time_since_restore": 1040.9929556846619, "episode_len_mean": 498.01, "date": "2018-12-10_05-02-44", "done": false, "time_this_iter_s": 17.693334817886353, "episode_reward_max": 0.0, "iterations_since_restore": 57, "episodes_total": 2649, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -114.14735451664976, "av": 114.14735451664976}, "timestamp": 1544418164, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 57, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641da470>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1140000, "time_total_s": 1040.9929556846619, "custom_metrics": {}, "info": {"sample_time_ms": 10986.241, "num_steps_trained": 1140000, "update_time_ms": 6.187, "grad_time_ms": 6667.496, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6534690856933594, "vf_loss": 146.95455932617188, "policy_loss": -0.055830907076597214, "cur_lr": 9.999999747378752e-05, "kl": 0.03385113552212715, "entropy": 134.72506713867188, "total_loss": 146.905517578125}, "num_steps_sampled": 1140000, "load_time_ms": 13.412, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6539114117622375, "vf_loss": 146.05258178710938, "policy_loss": -0.006380325648933649, "cur_lr": 9.999999747378752e-05, "kl": 0.013509420678019524, "entropy": 2.289109945297241, "total_loss": 146.04623413085938}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1160000, "time_since_restore": 1058.5342407226562, "episode_len_mean": 498.01, "date": "2018-12-10_05-03-02", "done": false, "time_this_iter_s": 17.541285037994385, "episode_reward_max": 0.0, "iterations_since_restore": 58, "episodes_total": 2693, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -114.74341703124338, "av": 114.74341703124338}, "timestamp": 1544418182, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 58, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf128>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1160000, "time_total_s": 1058.5342407226562, "custom_metrics": {}, "info": {"sample_time_ms": 10963.461, "num_steps_trained": 1160000, "update_time_ms": 6.199, "grad_time_ms": 6670.87, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6161723732948303, "vf_loss": 149.2323455810547, "policy_loss": -0.05994632840156555, "cur_lr": 9.999999747378752e-05, "kl": 0.03523051366209984, "entropy": 134.70425415039062, "total_loss": 149.179443359375}, "num_steps_sampled": 1160000, "load_time_ms": 13.638, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6167548894882202, "vf_loss": 148.92510986328125, "policy_loss": -0.007077147718518972, "cur_lr": 9.999999747378752e-05, "kl": 0.01311066560447216, "entropy": 2.2480456829071045, "total_loss": 148.9180450439453}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1180000, "time_since_restore": 1076.2188746929169, "episode_len_mean": 496.08, "date": "2018-12-10_05-03-20", "done": false, "time_this_iter_s": 17.68463397026062, "episode_reward_max": 0.0, "iterations_since_restore": 59, "episodes_total": 2737, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.11040652049482, "av": 118.11040652049482}, "timestamp": 1544418200, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 59, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799a7f28>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1180000, "time_total_s": 1076.2188746929169, "custom_metrics": {}, "info": {"sample_time_ms": 10959.561, "num_steps_trained": 1180000, "update_time_ms": 6.178, "grad_time_ms": 6661.669, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6585574150085449, "vf_loss": 148.3376922607422, "policy_loss": -0.057682208716869354, "cur_lr": 9.999999747378752e-05, "kl": 0.03394540771842003, "entropy": 134.62484741210938, "total_loss": 148.28680419921875}, "num_steps_sampled": 1180000, "load_time_ms": 13.671, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6381912231445312, "vf_loss": 149.92872619628906, "policy_loss": -0.005838945973664522, "cur_lr": 9.999999747378752e-05, "kl": 0.013392922468483448, "entropy": 2.2612550258636475, "total_loss": 149.9228973388672}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1200000, "time_since_restore": 1093.5770168304443, "episode_len_mean": 496.08, "date": "2018-12-10_05-03-37", "done": false, "time_this_iter_s": 17.358142137527466, "episode_reward_max": 0.0, "iterations_since_restore": 60, "episodes_total": 2780, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.31712240590839, "av": 118.31712240590839}, "timestamp": 1544418217, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 60, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf518>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1200000, "time_total_s": 1093.5770168304443, "custom_metrics": {}, "info": {"sample_time_ms": 10924.974, "num_steps_trained": 1200000, "update_time_ms": 6.151, "grad_time_ms": 6665.51, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6667962670326233, "vf_loss": 147.738525390625, "policy_loss": -0.05605464056134224, "cur_lr": 9.999999747378752e-05, "kl": 0.033684518188238144, "entropy": 134.61463928222656, "total_loss": 147.68922424316406}, "num_steps_sampled": 1200000, "load_time_ms": 13.647, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6474128365516663, "vf_loss": 150.8409881591797, "policy_loss": -0.006544969044625759, "cur_lr": 9.999999747378752e-05, "kl": 0.015203864313662052, "entropy": 2.257962465286255, "total_loss": 150.83448791503906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1220000, "time_since_restore": 1111.554695367813, "episode_len_mean": 500.0, "date": "2018-12-10_05-03-55", "done": false, "time_this_iter_s": 17.977678537368774, "episode_reward_max": 0.0, "iterations_since_restore": 61, "episodes_total": 2826, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.10507222505191, "av": 120.10507222505191}, "timestamp": 1544418235, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 61, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6f60>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1220000, "time_total_s": 1111.554695367813, "custom_metrics": {}, "info": {"sample_time_ms": 10964.366, "num_steps_trained": 1220000, "update_time_ms": 6.171, "grad_time_ms": 6652.394, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6310223340988159, "vf_loss": 146.5245361328125, "policy_loss": -0.05932357534766197, "cur_lr": 9.999999747378752e-05, "kl": 0.03590893745422363, "entropy": 134.47251892089844, "total_loss": 146.472412109375}, "num_steps_sampled": 1220000, "load_time_ms": 13.873, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6129260659217834, "vf_loss": 148.0909423828125, "policy_loss": -0.005952833686023951, "cur_lr": 9.999999747378752e-05, "kl": 0.015218756161630154, "entropy": 2.2418196201324463, "total_loss": 148.0850372314453}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1240000, "time_since_restore": 1128.819388628006, "episode_len_mean": 500.0, "date": "2018-12-10_05-04-12", "done": false, "time_this_iter_s": 17.26469326019287, "episode_reward_max": 0.0, "iterations_since_restore": 62, "episodes_total": 2868, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -119.07727619733389, "av": 119.07727619733389}, "timestamp": 1544418252, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 62, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf0f0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1240000, "time_total_s": 1128.819388628006, "custom_metrics": {}, "info": {"sample_time_ms": 10919.59, "num_steps_trained": 1240000, "update_time_ms": 6.185, "grad_time_ms": 6670.61, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.63905930519104, "vf_loss": 144.9739532470703, "policy_loss": -0.057068128138780594, "cur_lr": 9.999999747378752e-05, "kl": 0.0341130755841732, "entropy": 134.41172790527344, "total_loss": 144.9237060546875}, "num_steps_sampled": 1240000, "load_time_ms": 13.568, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.630312979221344, "vf_loss": 144.9456329345703, "policy_loss": -0.006673394702374935, "cur_lr": 9.999999747378752e-05, "kl": 0.013040830381214619, "entropy": 2.235037326812744, "total_loss": 144.93898010253906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1260000, "time_since_restore": 1146.6851034164429, "episode_len_mean": 500.0, "date": "2018-12-10_05-04-30", "done": false, "time_this_iter_s": 17.86571478843689, "episode_reward_max": 0.0, "iterations_since_restore": 63, "episodes_total": 2914, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -119.16125833568259, "av": 119.16125833568259}, "timestamp": 1544418270, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 63, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f537996a860>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1260000, "time_total_s": 1146.6851034164429, "custom_metrics": {}, "info": {"sample_time_ms": 10951.481, "num_steps_trained": 1260000, "update_time_ms": 6.184, "grad_time_ms": 6657.608, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6052821278572083, "vf_loss": 152.482666015625, "policy_loss": -0.057464487850666046, "cur_lr": 9.999999747378752e-05, "kl": 0.03471663221716881, "entropy": 134.4168243408203, "total_loss": 152.43215942382812}, "num_steps_sampled": 1260000, "load_time_ms": 13.893, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6058974862098694, "vf_loss": 150.9703826904297, "policy_loss": -0.005256226286292076, "cur_lr": 9.999999747378752e-05, "kl": 0.012595218606293201, "entropy": 2.1922552585601807, "total_loss": 150.96514892578125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1280000, "time_since_restore": 1164.368628025055, "episode_len_mean": 490.41, "date": "2018-12-10_05-04-48", "done": false, "time_this_iter_s": 17.68352460861206, "episode_reward_max": 0.0, "iterations_since_restore": 64, "episodes_total": 2959, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -119.19203847690514, "av": 119.19203847690514}, "timestamp": 1544418288, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 64, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf240>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1280000, "time_total_s": 1164.368628025055, "custom_metrics": {}, "info": {"sample_time_ms": 10934.578, "num_steps_trained": 1280000, "update_time_ms": 6.488, "grad_time_ms": 6656.39, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6948755979537964, "vf_loss": 159.43063354492188, "policy_loss": -0.06048272177577019, "cur_lr": 9.999999747378752e-05, "kl": 0.03523080050945282, "entropy": 134.4672393798828, "total_loss": 159.377197265625}, "num_steps_sampled": 1280000, "load_time_ms": 14.246, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6906185746192932, "vf_loss": 158.65211486816406, "policy_loss": -0.007968705147504807, "cur_lr": 9.999999747378752e-05, "kl": 0.014990384690463543, "entropy": 2.1521003246307373, "total_loss": 158.64418029785156}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1300000, "time_since_restore": 1181.846420288086, "episode_len_mean": 490.41, "date": "2018-12-10_05-05-05", "done": false, "time_this_iter_s": 17.477792263031006, "episode_reward_max": 0.0, "iterations_since_restore": 65, "episodes_total": 3004, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.23271771303921, "av": 118.23271771303921}, "timestamp": 1544418305, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 65, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfc50>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1300000, "time_total_s": 1181.846420288086, "custom_metrics": {}, "info": {"sample_time_ms": 10936.529, "num_steps_trained": 1300000, "update_time_ms": 6.506, "grad_time_ms": 6631.873, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7061884999275208, "vf_loss": 143.91314697265625, "policy_loss": -0.058324892073869705, "cur_lr": 9.999999747378752e-05, "kl": 0.034674741327762604, "entropy": 134.3184051513672, "total_loss": 143.86175537109375}, "num_steps_sampled": 1300000, "load_time_ms": 14.288, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6976273655891418, "vf_loss": 144.55108642578125, "policy_loss": -0.005176328122615814, "cur_lr": 9.999999747378752e-05, "kl": 0.010974783450365067, "entropy": 2.1896300315856934, "total_loss": 144.54592895507812}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1320000, "time_since_restore": 1199.3193912506104, "episode_len_mean": 498.3, "date": "2018-12-10_05-05-23", "done": false, "time_this_iter_s": 17.472970962524414, "episode_reward_max": 0.0, "iterations_since_restore": 66, "episodes_total": 3046, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.40368701620051, "av": 118.40368701620051}, "timestamp": 1544418323, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 66, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfe48>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1320000, "time_total_s": 1199.3193912506104, "custom_metrics": {}, "info": {"sample_time_ms": 10920.702, "num_steps_trained": 1320000, "update_time_ms": 6.523, "grad_time_ms": 6610.556, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6857893466949463, "vf_loss": 145.92738342285156, "policy_loss": -0.0567488856613636, "cur_lr": 9.999999747378752e-05, "kl": 0.03495181351900101, "entropy": 134.26930236816406, "total_loss": 145.8776092529297}, "num_steps_sampled": 1320000, "load_time_ms": 14.533, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6718475222587585, "vf_loss": 146.9324188232422, "policy_loss": -0.00674751540645957, "cur_lr": 9.999999747378752e-05, "kl": 0.018137212842702866, "entropy": 2.1488804817199707, "total_loss": 146.9257354736328}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1340000, "time_since_restore": 1216.7273433208466, "episode_len_mean": 500.0, "date": "2018-12-10_05-05-40", "done": false, "time_this_iter_s": 17.407952070236206, "episode_reward_max": 0.0, "iterations_since_restore": 67, "episodes_total": 3091, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.89986604889083, "av": 123.89986604889083}, "timestamp": 1544418340, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 67, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6f60>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1340000, "time_total_s": 1216.7273433208466, "custom_metrics": {}, "info": {"sample_time_ms": 10909.592, "num_steps_trained": 1340000, "update_time_ms": 6.543, "grad_time_ms": 6592.484, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5370428562164307, "vf_loss": 162.74148559570312, "policy_loss": -0.05840608477592468, "cur_lr": 9.999999747378752e-05, "kl": 0.03568526357412338, "entropy": 134.28805541992188, "total_loss": 162.6902313232422}, "num_steps_sampled": 1340000, "load_time_ms": 14.84, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5279983282089233, "vf_loss": 165.06121826171875, "policy_loss": -0.005458677653223276, "cur_lr": 9.999999747378752e-05, "kl": 0.012424616143107414, "entropy": 2.09311580657959, "total_loss": 165.0557861328125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1360000, "time_since_restore": 1234.685833454132, "episode_len_mean": 496.75, "date": "2018-12-10_05-05-58", "done": false, "time_this_iter_s": 17.958490133285522, "episode_reward_max": 0.0, "iterations_since_restore": 68, "episodes_total": 3136, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.50913326102707, "av": 121.50913326102707}, "timestamp": 1544418358, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 68, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641605f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1360000, "time_total_s": 1234.685833454132, "custom_metrics": {}, "info": {"sample_time_ms": 10965.83, "num_steps_trained": 1360000, "update_time_ms": 6.598, "grad_time_ms": 6578.476, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6190510988235474, "vf_loss": 155.32521057128906, "policy_loss": -0.05872676149010658, "cur_lr": 9.999999747378752e-05, "kl": 0.03616112098097801, "entropy": 134.17330932617188, "total_loss": 155.273681640625}, "num_steps_sampled": 1360000, "load_time_ms": 14.627, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5959258675575256, "vf_loss": 157.765625, "policy_loss": -0.006556819658726454, "cur_lr": 9.999999747378752e-05, "kl": 0.015001630410552025, "entropy": 2.117790699005127, "total_loss": 157.75909423828125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1380000, "time_since_restore": 1252.5681777000427, "episode_len_mean": 496.75, "date": "2018-12-10_05-06-16", "done": false, "time_this_iter_s": 17.882344245910645, "episode_reward_max": 0.0, "iterations_since_restore": 69, "episodes_total": 3179, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.05733382782063, "av": 118.05733382782063}, "timestamp": 1544418376, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 69, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf7b8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1380000, "time_total_s": 1252.5681777000427, "custom_metrics": {}, "info": {"sample_time_ms": 10987.38, "num_steps_trained": 1380000, "update_time_ms": 6.632, "grad_time_ms": 6576.797, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6639634370803833, "vf_loss": 150.2731170654297, "policy_loss": -0.056691400706768036, "cur_lr": 9.999999747378752e-05, "kl": 0.035213544964790344, "entropy": 134.14207458496094, "total_loss": 150.2234649658203}, "num_steps_sampled": 1380000, "load_time_ms": 14.662, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6407907009124756, "vf_loss": 152.70091247558594, "policy_loss": -0.006402540020644665, "cur_lr": 9.999999747378752e-05, "kl": 0.015749620273709297, "entropy": 2.089844226837158, "total_loss": 152.6945343017578}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1400000, "time_since_restore": 1270.581030368805, "episode_len_mean": 500.0, "date": "2018-12-10_05-06-34", "done": false, "time_this_iter_s": 18.012852668762207, "episode_reward_max": 0.0, "iterations_since_restore": 70, "episodes_total": 3224, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.06234819683772, "av": 120.06234819683772}, "timestamp": 1544418394, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 70, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfd30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1400000, "time_total_s": 1270.581030368805, "custom_metrics": {}, "info": {"sample_time_ms": 11053.266, "num_steps_trained": 1400000, "update_time_ms": 6.642, "grad_time_ms": 6576.865, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5637326836585999, "vf_loss": 151.5004119873047, "policy_loss": -0.05846094340085983, "cur_lr": 9.999999747378752e-05, "kl": 0.03487700596451759, "entropy": 134.1411895751953, "total_loss": 151.44891357421875}, "num_steps_sampled": 1400000, "load_time_ms": 14.423, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5472754836082458, "vf_loss": 153.46859741210938, "policy_loss": -0.006510868202894926, "cur_lr": 9.999999747378752e-05, "kl": 0.015047800727188587, "entropy": 2.088186264038086, "total_loss": 153.4621124267578}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1420000, "time_since_restore": 1288.3144228458405, "episode_len_mean": 500.0, "date": "2018-12-10_05-06-52", "done": false, "time_this_iter_s": 17.733392477035522, "episode_reward_max": 0.0, "iterations_since_restore": 71, "episodes_total": 3267, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.70209045610856, "av": 120.70209045610856}, "timestamp": 1544418412, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 71, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e2c50>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1420000, "time_total_s": 1288.3144228458405, "custom_metrics": {}, "info": {"sample_time_ms": 11035.176, "num_steps_trained": 1420000, "update_time_ms": 6.645, "grad_time_ms": 6570.343, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6312482357025146, "vf_loss": 150.16444396972656, "policy_loss": -0.05998615175485611, "cur_lr": 9.999999747378752e-05, "kl": 0.03572412207722664, "entropy": 133.96437072753906, "total_loss": 150.1116180419922}, "num_steps_sampled": 1420000, "load_time_ms": 14.393, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6388329863548279, "vf_loss": 148.028076171875, "policy_loss": -0.005675184540450573, "cur_lr": 9.999999747378752e-05, "kl": 0.01651059277355671, "entropy": 2.100761890411377, "total_loss": 148.02243041992188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1440000, "time_since_restore": 1305.9424352645874, "episode_len_mean": 500.0, "date": "2018-12-10_05-07-10", "done": false, "time_this_iter_s": 17.62801241874695, "episode_reward_max": 0.0, "iterations_since_restore": 72, "episodes_total": 3313, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.42221545383237, "av": 121.42221545383237}, "timestamp": 1544418430, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 72, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416c780>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1440000, "time_total_s": 1305.9424352645874, "custom_metrics": {}, "info": {"sample_time_ms": 11086.425, "num_steps_trained": 1440000, "update_time_ms": 6.625, "grad_time_ms": 6554.782, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6257482767105103, "vf_loss": 173.3075408935547, "policy_loss": -0.057820357382297516, "cur_lr": 9.999999747378752e-05, "kl": 0.034888964146375656, "entropy": 134.09918212890625, "total_loss": 173.25668334960938}, "num_steps_sampled": 1440000, "load_time_ms": 14.735, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6299625039100647, "vf_loss": 170.3698272705078, "policy_loss": -0.006239910144358873, "cur_lr": 9.999999747378752e-05, "kl": 0.015436134301126003, "entropy": 2.09628963470459, "total_loss": 170.36361694335938}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1460000, "time_since_restore": 1323.455641746521, "episode_len_mean": 500.0, "date": "2018-12-10_05-07-27", "done": false, "time_this_iter_s": 17.513206481933594, "episode_reward_max": 0.0, "iterations_since_restore": 73, "episodes_total": 3353, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.50869595306483, "av": 123.50869595306483}, "timestamp": 1544418447, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 73, "pid": 2451, "episodes_this_iter": 40, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f94e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1460000, "time_total_s": 1323.455641746521, "custom_metrics": {}, "info": {"sample_time_ms": 11070.093, "num_steps_trained": 1460000, "update_time_ms": 6.622, "grad_time_ms": 6536.236, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6255497932434082, "vf_loss": 166.88429260253906, "policy_loss": -0.05576734617352486, "cur_lr": 9.999999747378752e-05, "kl": 0.035435616970062256, "entropy": 134.10108947753906, "total_loss": 166.8356170654297}, "num_steps_sampled": 1460000, "load_time_ms": 14.701, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.624335765838623, "vf_loss": 165.64926147460938, "policy_loss": -0.007412488106638193, "cur_lr": 9.999999747378752e-05, "kl": 0.018860651180148125, "entropy": 2.09183669090271, "total_loss": 165.64190673828125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1480000, "time_since_restore": 1341.4090659618378, "episode_len_mean": 500.0, "date": "2018-12-10_05-07-45", "done": false, "time_this_iter_s": 17.953424215316772, "episode_reward_max": 0.0, "iterations_since_restore": 74, "episodes_total": 3400, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -122.529504464401, "av": 122.529504464401}, "timestamp": 1544418465, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 74, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e84e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1480000, "time_total_s": 1341.4090659618378, "custom_metrics": {}, "info": {"sample_time_ms": 11101.907, "num_steps_trained": 1480000, "update_time_ms": 6.296, "grad_time_ms": 6532.621, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5933465957641602, "vf_loss": 181.33108520507812, "policy_loss": -0.05538259446620941, "cur_lr": 9.999999747378752e-05, "kl": 0.03471746668219566, "entropy": 133.9744110107422, "total_loss": 181.28265380859375}, "num_steps_sampled": 1480000, "load_time_ms": 14.383, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5931078791618347, "vf_loss": 179.608642578125, "policy_loss": -0.006943108979612589, "cur_lr": 9.999999747378752e-05, "kl": 0.014864184893667698, "entropy": 2.12666916847229, "total_loss": 179.60171508789062}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1500000, "time_since_restore": 1359.295753479004, "episode_len_mean": 496.08, "date": "2018-12-10_05-08-03", "done": false, "time_this_iter_s": 17.886687517166138, "episode_reward_max": 0.0, "iterations_since_restore": 75, "episodes_total": 3446, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.72558890383846, "av": 124.72558890383846}, "timestamp": 1544418483, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 75, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfc88>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1500000, "time_total_s": 1359.295753479004, "custom_metrics": {}, "info": {"sample_time_ms": 11132.868, "num_steps_trained": 1500000, "update_time_ms": 6.305, "grad_time_ms": 6542.672, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5298193693161011, "vf_loss": 169.9875030517578, "policy_loss": -0.05918968468904495, "cur_lr": 9.999999747378752e-05, "kl": 0.035770151764154434, "entropy": 133.9365997314453, "total_loss": 169.93545532226562}, "num_steps_sampled": 1500000, "load_time_ms": 14.318, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5409888029098511, "vf_loss": 168.12698364257812, "policy_loss": -0.007189681753516197, "cur_lr": 9.999999747378752e-05, "kl": 0.014090094715356827, "entropy": 2.0884735584259033, "total_loss": 168.11981201171875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1520000, "time_since_restore": 1377.1483526229858, "episode_len_mean": 494.31, "date": "2018-12-10_05-08-21", "done": false, "time_this_iter_s": 17.852599143981934, "episode_reward_max": 0.0, "iterations_since_restore": 76, "episodes_total": 3487, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.02890684472756, "av": 125.02890684472756}, "timestamp": 1544418501, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 76, "pid": 2451, "episodes_this_iter": 41, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416cb70>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1520000, "time_total_s": 1377.1483526229858, "custom_metrics": {}, "info": {"sample_time_ms": 11140.418, "num_steps_trained": 1520000, "update_time_ms": 6.357, "grad_time_ms": 6573.392, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5782101154327393, "vf_loss": 177.87869262695312, "policy_loss": -0.05932438746094704, "cur_lr": 9.999999747378752e-05, "kl": 0.03547980263829231, "entropy": 133.8303985595703, "total_loss": 177.82647705078125}, "num_steps_sampled": 1520000, "load_time_ms": 14.129, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5680930018424988, "vf_loss": 178.70164489746094, "policy_loss": -0.00675006490200758, "cur_lr": 9.999999747378752e-05, "kl": 0.014406437985599041, "entropy": 2.092573404312134, "total_loss": 178.69491577148438}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1540000, "time_since_restore": 1395.2537643909454, "episode_len_mean": 494.31, "date": "2018-12-10_05-08-39", "done": false, "time_this_iter_s": 18.105411767959595, "episode_reward_max": 0.0, "iterations_since_restore": 77, "episodes_total": 3533, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.46102743816728, "av": 121.46102743816728}, "timestamp": 1544418519, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 77, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e8588>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1540000, "time_total_s": 1395.2537643909454, "custom_metrics": {}, "info": {"sample_time_ms": 11196.696, "num_steps_trained": 1540000, "update_time_ms": 6.324, "grad_time_ms": 6587.409, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5693960189819336, "vf_loss": 160.45298767089844, "policy_loss": -0.058658283203840256, "cur_lr": 9.999999747378752e-05, "kl": 0.03584256023168564, "entropy": 133.7771759033203, "total_loss": 160.4014892578125}, "num_steps_sampled": 1540000, "load_time_ms": 13.895, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5669511556625366, "vf_loss": 160.78839111328125, "policy_loss": -0.007472527213394642, "cur_lr": 9.999999747378752e-05, "kl": 0.015082218684256077, "entropy": 2.1061291694641113, "total_loss": 160.78097534179688}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1560000, "time_since_restore": 1412.9109861850739, "episode_len_mean": 500.0, "date": "2018-12-10_05-08-57", "done": false, "time_this_iter_s": 17.657221794128418, "episode_reward_max": 0.0, "iterations_since_restore": 78, "episodes_total": 3578, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -118.06724842962318, "av": 118.06724842962318}, "timestamp": 1544418537, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 78, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf4a8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1560000, "time_total_s": 1412.9109861850739, "custom_metrics": {}, "info": {"sample_time_ms": 11159.606, "num_steps_trained": 1560000, "update_time_ms": 6.307, "grad_time_ms": 6593.848, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6063467860221863, "vf_loss": 157.34637451171875, "policy_loss": -0.05717025697231293, "cur_lr": 9.999999747378752e-05, "kl": 0.03626234829425812, "entropy": 133.68067932128906, "total_loss": 157.29644775390625}, "num_steps_sampled": 1560000, "load_time_ms": 14.155, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6124764084815979, "vf_loss": 156.71804809570312, "policy_loss": -0.00735955685377121, "cur_lr": 9.999999747378752e-05, "kl": 0.015856437385082245, "entropy": 2.107985258102417, "total_loss": 156.71070861816406}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1580000, "time_since_restore": 1430.2438282966614, "episode_len_mean": 500.0, "date": "2018-12-10_05-09-14", "done": false, "time_this_iter_s": 17.332842111587524, "episode_reward_max": 0.0, "iterations_since_restore": 79, "episodes_total": 3620, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.5844645030284, "av": 126.5844645030284}, "timestamp": 1544418554, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 79, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148e10>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1580000, "time_total_s": 1430.2438282966614, "custom_metrics": {}, "info": {"sample_time_ms": 11105.9, "num_steps_trained": 1580000, "update_time_ms": 6.254, "grad_time_ms": 6592.98, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5179658532142639, "vf_loss": 176.83148193359375, "policy_loss": -0.05790337547659874, "cur_lr": 9.999999747378752e-05, "kl": 0.03437022492289543, "entropy": 133.8389129638672, "total_loss": 176.7804412841797}, "num_steps_sampled": 1580000, "load_time_ms": 13.817, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5145628452301025, "vf_loss": 177.23855590820312, "policy_loss": -0.006586810108274221, "cur_lr": 9.999999747378752e-05, "kl": 0.01623331941664219, "entropy": 2.025339365005493, "total_loss": 177.23199462890625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1600000, "time_since_restore": 1448.1926481723785, "episode_len_mean": 500.0, "date": "2018-12-10_05-09-32", "done": false, "time_this_iter_s": 17.948819875717163, "episode_reward_max": 0.0, "iterations_since_restore": 80, "episodes_total": 3666, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -128.70429378802174, "av": 128.70429378802174}, "timestamp": 1544418572, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 80, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f65f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1600000, "time_total_s": 1448.1926481723785, "custom_metrics": {}, "info": {"sample_time_ms": 11114.777, "num_steps_trained": 1600000, "update_time_ms": 6.29, "grad_time_ms": 6576.847, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6152324080467224, "vf_loss": 163.93421936035156, "policy_loss": -0.05641253665089607, "cur_lr": 9.999999747378752e-05, "kl": 0.034561317414045334, "entropy": 133.6171875, "total_loss": 163.88470458984375}, "num_steps_sampled": 1600000, "load_time_ms": 14.129, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6057661771774292, "vf_loss": 166.16514587402344, "policy_loss": -0.004673513118177652, "cur_lr": 9.999999747378752e-05, "kl": 0.012574189342558384, "entropy": 2.076188325881958, "total_loss": 166.1604766845703}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1620000, "time_since_restore": 1465.52241897583, "episode_len_mean": 500.0, "date": "2018-12-10_05-09-49", "done": false, "time_this_iter_s": 17.329770803451538, "episode_reward_max": 0.0, "iterations_since_restore": 81, "episodes_total": 3708, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -128.1223805039472, "av": 128.1223805039472}, "timestamp": 1544418589, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 81, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e84e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1620000, "time_total_s": 1465.52241897583, "custom_metrics": {}, "info": {"sample_time_ms": 11073.527, "num_steps_trained": 1620000, "update_time_ms": 6.319, "grad_time_ms": 6577.846, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6213621497154236, "vf_loss": 176.00364685058594, "policy_loss": -0.05730479210615158, "cur_lr": 9.999999747378752e-05, "kl": 0.03608029708266258, "entropy": 133.65353393554688, "total_loss": 175.95355224609375}, "num_steps_sampled": 1620000, "load_time_ms": 14.121, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6112959384918213, "vf_loss": 175.908935546875, "policy_loss": -0.005538170225918293, "cur_lr": 9.999999747378752e-05, "kl": 0.014153584837913513, "entropy": 2.0595703125, "total_loss": 175.90342712402344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1640000, "time_since_restore": 1483.6860296726227, "episode_len_mean": 500.0, "date": "2018-12-10_05-10-07", "done": false, "time_this_iter_s": 18.163610696792603, "episode_reward_max": 0.0, "iterations_since_restore": 82, "episodes_total": 3754, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.03317706329551, "av": 125.03317706329551}, "timestamp": 1544418607, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 82, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145940>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1640000, "time_total_s": 1483.6860296726227, "custom_metrics": {}, "info": {"sample_time_ms": 11111.767, "num_steps_trained": 1640000, "update_time_ms": 6.325, "grad_time_ms": 6593.72, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6425056457519531, "vf_loss": 162.6300506591797, "policy_loss": -0.05953952670097351, "cur_lr": 9.999999747378752e-05, "kl": 0.03603805601596832, "entropy": 133.4978790283203, "total_loss": 162.57769775390625}, "num_steps_sampled": 1640000, "load_time_ms": 13.868, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6363572478294373, "vf_loss": 164.45266723632812, "policy_loss": -0.005993041675537825, "cur_lr": 9.999999747378752e-05, "kl": 0.016348909586668015, "entropy": 2.0695879459381104, "total_loss": 164.44671630859375}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1660000, "time_since_restore": 1501.1883192062378, "episode_len_mean": 500.0, "date": "2018-12-10_05-10-25", "done": false, "time_this_iter_s": 17.502289533615112, "episode_reward_max": 0.0, "iterations_since_restore": 83, "episodes_total": 3798, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.00319339857053, "av": 123.00319339857053}, "timestamp": 1544418625, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 83, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416c710>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1660000, "time_total_s": 1501.1883192062378, "custom_metrics": {}, "info": {"sample_time_ms": 11086.362, "num_steps_trained": 1660000, "update_time_ms": 6.305, "grad_time_ms": 6617.987, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6771857142448425, "vf_loss": 161.9593048095703, "policy_loss": -0.058985307812690735, "cur_lr": 9.999999747378752e-05, "kl": 0.035894546657800674, "entropy": 133.42141723632812, "total_loss": 161.90750122070312}, "num_steps_sampled": 1660000, "load_time_ms": 13.842, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6846997141838074, "vf_loss": 160.21690368652344, "policy_loss": -0.0065576680935919285, "cur_lr": 9.999999747378752e-05, "kl": 0.017072299495339394, "entropy": 2.0684850215911865, "total_loss": 160.2103729248047}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1680000, "time_since_restore": 1518.6784069538116, "episode_len_mean": 496.82, "date": "2018-12-10_05-10-43", "done": false, "time_this_iter_s": 17.490087747573853, "episode_reward_max": 0.0, "iterations_since_restore": 84, "episodes_total": 3841, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.41971420550887, "av": 124.41971420550887}, "timestamp": 1544418643, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 84, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148e10>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1680000, "time_total_s": 1518.6784069538116, "custom_metrics": {}, "info": {"sample_time_ms": 11028.868, "num_steps_trained": 1680000, "update_time_ms": 6.308, "grad_time_ms": 6628.745, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5595034956932068, "vf_loss": 185.2396697998047, "policy_loss": -0.060769643634557724, "cur_lr": 9.999999747378752e-05, "kl": 0.036557313054800034, "entropy": 133.40640258789062, "total_loss": 185.1862030029297}, "num_steps_sampled": 1680000, "load_time_ms": 14.124, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5650070905685425, "vf_loss": 184.29656982421875, "policy_loss": -0.007812337018549442, "cur_lr": 9.999999747378752e-05, "kl": 0.0188710056245327, "entropy": 2.0282037258148193, "total_loss": 184.28878784179688}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1700000, "time_since_restore": 1536.462078332901, "episode_len_mean": 496.82, "date": "2018-12-10_05-11-00", "done": false, "time_this_iter_s": 17.783671379089355, "episode_reward_max": 0.0, "iterations_since_restore": 85, "episodes_total": 3886, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.25567256139479, "av": 125.25567256139479}, "timestamp": 1544418660, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 85, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364150278>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1700000, "time_total_s": 1536.462078332901, "custom_metrics": {}, "info": {"sample_time_ms": 11017.99, "num_steps_trained": 1700000, "update_time_ms": 6.306, "grad_time_ms": 6629.855, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6613488793373108, "vf_loss": 168.5890350341797, "policy_loss": -0.059051599353551865, "cur_lr": 9.999999747378752e-05, "kl": 0.03659121319651604, "entropy": 133.30941772460938, "total_loss": 168.5373077392578}, "num_steps_sampled": 1700000, "load_time_ms": 13.868, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6684144735336304, "vf_loss": 165.27793884277344, "policy_loss": -0.007239609025418758, "cur_lr": 9.999999747378752e-05, "kl": 0.017688298597931862, "entropy": 2.054360866546631, "total_loss": 165.27072143554688}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1720000, "time_since_restore": 1554.348368883133, "episode_len_mean": 500.0, "date": "2018-12-10_05-11-18", "done": false, "time_this_iter_s": 17.886290550231934, "episode_reward_max": 0.0, "iterations_since_restore": 86, "episodes_total": 3930, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.6753357049169, "av": 121.6753357049169}, "timestamp": 1544418678, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 86, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfa20>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1720000, "time_total_s": 1554.348368883133, "custom_metrics": {}, "info": {"sample_time_ms": 11033.445, "num_steps_trained": 1720000, "update_time_ms": 6.321, "grad_time_ms": 6617.657, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6098489165306091, "vf_loss": 166.2218475341797, "policy_loss": -0.061214201152324677, "cur_lr": 9.999999747378752e-05, "kl": 0.0372655987739563, "entropy": 133.25999450683594, "total_loss": 166.16810607910156}, "num_steps_sampled": 1720000, "load_time_ms": 13.831, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6221345067024231, "vf_loss": 162.69786071777344, "policy_loss": -0.006035092752426863, "cur_lr": 9.999999747378752e-05, "kl": 0.014621103182435036, "entropy": 2.06036114692688, "total_loss": 162.69186401367188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1740000, "time_since_restore": 1572.3305077552795, "episode_len_mean": 500.0, "date": "2018-12-10_05-11-36", "done": false, "time_this_iter_s": 17.982138872146606, "episode_reward_max": 0.0, "iterations_since_restore": 87, "episodes_total": 3972, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.74022782445911, "av": 123.74022782445911}, "timestamp": 1544418696, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 87, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6898>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1740000, "time_total_s": 1572.3305077552795, "custom_metrics": {}, "info": {"sample_time_ms": 11006.66, "num_steps_trained": 1740000, "update_time_ms": 6.371, "grad_time_ms": 6632.13, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5945011973381042, "vf_loss": 167.13369750976562, "policy_loss": -0.06078938767313957, "cur_lr": 9.999999747378752e-05, "kl": 0.03725443035364151, "entropy": 133.25770568847656, "total_loss": 167.0803680419922}, "num_steps_sampled": 1740000, "load_time_ms": 13.768, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5913527011871338, "vf_loss": 168.29287719726562, "policy_loss": -0.007746982853859663, "cur_lr": 9.999999747378752e-05, "kl": 0.014606873504817486, "entropy": 2.0364623069763184, "total_loss": 168.28515625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1760000, "time_since_restore": 1590.2079832553864, "episode_len_mean": 495.41, "date": "2018-12-10_05-11-54", "done": false, "time_this_iter_s": 17.87747550010681, "episode_reward_max": 0.0, "iterations_since_restore": 88, "episodes_total": 4018, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.10526073892582, "av": 124.10526073892582}, "timestamp": 1544418714, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 88, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148d68>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1760000, "time_total_s": 1590.2079832553864, "custom_metrics": {}, "info": {"sample_time_ms": 11019.048, "num_steps_trained": 1760000, "update_time_ms": 6.337, "grad_time_ms": 6641.893, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6110606789588928, "vf_loss": 189.7314453125, "policy_loss": -0.059052735567092896, "cur_lr": 9.999999747378752e-05, "kl": 0.036732017993927, "entropy": 133.25320434570312, "total_loss": 189.67971801757812}, "num_steps_sampled": 1760000, "load_time_ms": 13.74, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6061726212501526, "vf_loss": 190.1278839111328, "policy_loss": -0.00840667448937893, "cur_lr": 9.999999747378752e-05, "kl": 0.018313616514205933, "entropy": 1.9839293956756592, "total_loss": 190.11952209472656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1780000, "time_since_restore": 1607.9942836761475, "episode_len_mean": 495.41, "date": "2018-12-10_05-12-12", "done": false, "time_this_iter_s": 17.78630042076111, "episode_reward_max": 0.0, "iterations_since_restore": 89, "episodes_total": 4062, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.62339041433381, "av": 124.62339041433381}, "timestamp": 1544418732, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 89, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416c470>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1780000, "time_total_s": 1607.9942836761475, "custom_metrics": {}, "info": {"sample_time_ms": 11038.747, "num_steps_trained": 1780000, "update_time_ms": 6.445, "grad_time_ms": 6666.987, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6351867914199829, "vf_loss": 180.04388427734375, "policy_loss": -0.06264084577560425, "cur_lr": 9.999999747378752e-05, "kl": 0.03765428066253662, "entropy": 133.11253356933594, "total_loss": 179.98875427246094}, "num_steps_sampled": 1780000, "load_time_ms": 14.04, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6461624503135681, "vf_loss": 176.5966339111328, "policy_loss": -0.007612060289829969, "cur_lr": 9.999999747378752e-05, "kl": 0.015303673222661018, "entropy": 1.9993048906326294, "total_loss": 176.5890655517578}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1800000, "time_since_restore": 1625.800396680832, "episode_len_mean": 500.0, "date": "2018-12-10_05-12-30", "done": false, "time_this_iter_s": 17.80611300468445, "episode_reward_max": 0.0, "iterations_since_restore": 90, "episodes_total": 4106, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.72082515755247, "av": 124.72082515755247}, "timestamp": 1544418750, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 90, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641600b8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1800000, "time_total_s": 1625.800396680832, "custom_metrics": {}, "info": {"sample_time_ms": 11004.202, "num_steps_trained": 1800000, "update_time_ms": 6.477, "grad_time_ms": 6687.912, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6192580461502075, "vf_loss": 164.8982391357422, "policy_loss": -0.060914766043424606, "cur_lr": 9.999999747378752e-05, "kl": 0.03729846701025963, "entropy": 133.0030059814453, "total_loss": 164.84475708007812}, "num_steps_sampled": 1800000, "load_time_ms": 13.718, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6249338984489441, "vf_loss": 163.3593292236328, "policy_loss": -0.007623383775353432, "cur_lr": 9.999999747378752e-05, "kl": 0.01682720147073269, "entropy": 2.0009021759033203, "total_loss": 163.3517303466797}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1820000, "time_since_restore": 1643.6983456611633, "episode_len_mean": 500.0, "date": "2018-12-10_05-12-48", "done": false, "time_this_iter_s": 17.89794898033142, "episode_reward_max": 0.0, "iterations_since_restore": 91, "episodes_total": 4150, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.54252909041503, "av": 121.54252909041503}, "timestamp": 1544418768, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 91, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168b00>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1820000, "time_total_s": 1643.6983456611633, "custom_metrics": {}, "info": {"sample_time_ms": 11039.015, "num_steps_trained": 1820000, "update_time_ms": 6.473, "grad_time_ms": 6709.851, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6269550919532776, "vf_loss": 174.21627807617188, "policy_loss": -0.06197814270853996, "cur_lr": 9.999999747378752e-05, "kl": 0.03650844842195511, "entropy": 133.06263732910156, "total_loss": 174.16159057617188}, "num_steps_sampled": 1820000, "load_time_ms": 13.758, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6300746202468872, "vf_loss": 173.5252685546875, "policy_loss": -0.006145000457763672, "cur_lr": 9.999999747378752e-05, "kl": 0.01510710921138525, "entropy": 1.9939557313919067, "total_loss": 173.51914978027344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1840000, "time_since_restore": 1661.6581737995148, "episode_len_mean": 500.0, "date": "2018-12-10_05-13-06", "done": false, "time_this_iter_s": 17.95982813835144, "episode_reward_max": 0.0, "iterations_since_restore": 92, "episodes_total": 4195, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.43103314140608, "av": 120.43103314140608}, "timestamp": 1544418786, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 92, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364160c88>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1840000, "time_total_s": 1661.6581737995148, "custom_metrics": {}, "info": {"sample_time_ms": 11038.023, "num_steps_trained": 1840000, "update_time_ms": 6.487, "grad_time_ms": 6690.431, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7119145393371582, "vf_loss": 162.6035614013672, "policy_loss": -0.06048118323087692, "cur_lr": 9.999999747378752e-05, "kl": 0.03728301078081131, "entropy": 132.9138641357422, "total_loss": 162.550537109375}, "num_steps_sampled": 1840000, "load_time_ms": 13.728, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7002550959587097, "vf_loss": 162.96499633789062, "policy_loss": -0.006075945217162371, "cur_lr": 9.999999747378752e-05, "kl": 0.015794066712260246, "entropy": 2.017131805419922, "total_loss": 162.95895385742188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1860000, "time_since_restore": 1679.24227976799, "episode_len_mean": 500.0, "date": "2018-12-10_05-13-23", "done": false, "time_this_iter_s": 17.584105968475342, "episode_reward_max": 0.0, "iterations_since_restore": 93, "episodes_total": 4239, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.08668765183127, "av": 125.08668765183127}, "timestamp": 1544418803, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 93, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641601d0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1860000, "time_total_s": 1679.24227976799, "custom_metrics": {}, "info": {"sample_time_ms": 11042.311, "num_steps_trained": 1860000, "update_time_ms": 6.497, "grad_time_ms": 6694.98, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.47468674182891846, "vf_loss": 179.39797973632812, "policy_loss": -0.06141416355967522, "cur_lr": 9.999999747378752e-05, "kl": 0.03667290508747101, "entropy": 133.03170776367188, "total_loss": 179.34388732910156}, "num_steps_sampled": 1860000, "load_time_ms": 13.446, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.4691869914531708, "vf_loss": 181.37132263183594, "policy_loss": -0.005973384715616703, "cur_lr": 9.999999747378752e-05, "kl": 0.014199629426002502, "entropy": 1.9734766483306885, "total_loss": 181.3653564453125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1880000, "time_since_restore": 1697.2384581565857, "episode_len_mean": 500.0, "date": "2018-12-10_05-13-41", "done": false, "time_this_iter_s": 17.99617838859558, "episode_reward_max": 0.0, "iterations_since_restore": 94, "episodes_total": 4281, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.6516475747897, "av": 129.6516475747897}, "timestamp": 1544418821, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 94, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641505f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1880000, "time_total_s": 1697.2384581565857, "custom_metrics": {}, "info": {"sample_time_ms": 11078.621, "num_steps_trained": 1880000, "update_time_ms": 6.505, "grad_time_ms": 6709.168, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5890200734138489, "vf_loss": 181.75987243652344, "policy_loss": -0.06003909185528755, "cur_lr": 9.999999747378752e-05, "kl": 0.03726926073431969, "entropy": 132.97613525390625, "total_loss": 181.707275390625}, "num_steps_sampled": 1880000, "load_time_ms": 13.437, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5853992104530334, "vf_loss": 181.61715698242188, "policy_loss": -0.007530227769166231, "cur_lr": 9.999999747378752e-05, "kl": 0.01776663400232792, "entropy": 1.9757959842681885, "total_loss": 181.60964965820312}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1900000, "time_since_restore": 1715.135353088379, "episode_len_mean": 500.0, "date": "2018-12-10_05-13-59", "done": false, "time_this_iter_s": 17.896894931793213, "episode_reward_max": 0.0, "iterations_since_restore": 95, "episodes_total": 4327, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.91525640044281, "av": 126.91525640044281}, "timestamp": 1544418839, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 95, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641686a0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1900000, "time_total_s": 1715.135353088379, "custom_metrics": {}, "info": {"sample_time_ms": 11078.363, "num_steps_trained": 1900000, "update_time_ms": 6.495, "grad_time_ms": 6720.746, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5440301895141602, "vf_loss": 171.4667510986328, "policy_loss": -0.06352467089891434, "cur_lr": 9.999999747378752e-05, "kl": 0.03776409104466438, "entropy": 132.9013214111328, "total_loss": 171.41078186035156}, "num_steps_sampled": 1900000, "load_time_ms": 13.432, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5488382577896118, "vf_loss": 171.20530700683594, "policy_loss": -0.007157181389629841, "cur_lr": 9.999999747378752e-05, "kl": 0.01666899584233761, "entropy": 1.9629700183868408, "total_loss": 171.1981658935547}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1920000, "time_since_restore": 1732.7857496738434, "episode_len_mean": 500.0, "date": "2018-12-10_05-14-17", "done": false, "time_this_iter_s": 17.650396585464478, "episode_reward_max": 0.0, "iterations_since_restore": 96, "episodes_total": 4368, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.8416341328648, "av": 129.8416341328648}, "timestamp": 1544418857, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 96, "pid": 2451, "episodes_this_iter": 41, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364160048>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1920000, "time_total_s": 1732.7857496738434, "custom_metrics": {}, "info": {"sample_time_ms": 11038.764, "num_steps_trained": 1920000, "update_time_ms": 6.399, "grad_time_ms": 6736.798, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.47977280616760254, "vf_loss": 201.83116149902344, "policy_loss": -0.05827232077717781, "cur_lr": 9.999999747378752e-05, "kl": 0.035764992237091064, "entropy": 133.03004455566406, "total_loss": 201.78004455566406}, "num_steps_sampled": 1920000, "load_time_ms": 13.476, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.48458245396614075, "vf_loss": 201.3347930908203, "policy_loss": -0.007955940440297127, "cur_lr": 9.999999747378752e-05, "kl": 0.018180320039391518, "entropy": 1.919103980064392, "total_loss": 201.32687377929688}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1940000, "time_since_restore": 1751.02223610878, "episode_len_mean": 500.0, "date": "2018-12-10_05-14-35", "done": false, "time_this_iter_s": 18.236486434936523, "episode_reward_max": 0.0, "iterations_since_restore": 97, "episodes_total": 4415, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -131.73610833804122, "av": 131.73610833804122}, "timestamp": 1544418875, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 97, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168320>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1940000, "time_total_s": 1751.02223610878, "custom_metrics": {}, "info": {"sample_time_ms": 11070.613, "num_steps_trained": 1940000, "update_time_ms": 6.446, "grad_time_ms": 6729.832, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5921870470046997, "vf_loss": 176.19387817382812, "policy_loss": -0.06000485643744469, "cur_lr": 9.999999747378752e-05, "kl": 0.03671358898282051, "entropy": 132.78793334960938, "total_loss": 176.14122009277344}, "num_steps_sampled": 1940000, "load_time_ms": 13.722, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5921428203582764, "vf_loss": 174.31053161621094, "policy_loss": -0.006036874372512102, "cur_lr": 9.999999747378752e-05, "kl": 0.01722721941769123, "entropy": 1.9888726472854614, "total_loss": 174.3045196533203}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1960000, "time_since_restore": 1768.615477323532, "episode_len_mean": 500.0, "date": "2018-12-10_05-14-53", "done": false, "time_this_iter_s": 17.593241214752197, "episode_reward_max": 0.0, "iterations_since_restore": 98, "episodes_total": 4457, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.41449535520958, "av": 125.41449535520958}, "timestamp": 1544418893, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 98, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145710>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1960000, "time_total_s": 1768.615477323532, "custom_metrics": {}, "info": {"sample_time_ms": 11044.138, "num_steps_trained": 1960000, "update_time_ms": 6.421, "grad_time_ms": 6727.89, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6743861436843872, "vf_loss": 166.1805419921875, "policy_loss": -0.060580167919397354, "cur_lr": 9.999999747378752e-05, "kl": 0.03629080951213837, "entropy": 132.78184509277344, "total_loss": 166.12722778320312}, "num_steps_sampled": 1960000, "load_time_ms": 13.785, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6713688969612122, "vf_loss": 166.26028442382812, "policy_loss": -0.0071321711875498295, "cur_lr": 9.999999747378752e-05, "kl": 0.015048885717988014, "entropy": 2.0196573734283447, "total_loss": 166.253173828125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 1980000, "time_since_restore": 1786.6594171524048, "episode_len_mean": 500.0, "date": "2018-12-10_05-15-11", "done": false, "time_this_iter_s": 18.04393982887268, "episode_reward_max": 0.0, "iterations_since_restore": 99, "episodes_total": 4503, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.8210956484964, "av": 123.8210956484964}, "timestamp": 1544418911, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 99, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641685f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 1980000, "time_total_s": 1786.6594171524048, "custom_metrics": {}, "info": {"sample_time_ms": 11086.529, "num_steps_trained": 1980000, "update_time_ms": 6.316, "grad_time_ms": 6711.819, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6715911626815796, "vf_loss": 166.4525604248047, "policy_loss": -0.06272570043802261, "cur_lr": 9.999999747378752e-05, "kl": 0.03801419958472252, "entropy": 132.80636596679688, "total_loss": 166.39743041992188}, "num_steps_sampled": 1980000, "load_time_ms": 13.556, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6735586524009705, "vf_loss": 164.82981872558594, "policy_loss": -0.006058582570403814, "cur_lr": 9.999999747378752e-05, "kl": 0.015895435586571693, "entropy": 2.0382847785949707, "total_loss": 164.8237762451172}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2000000, "time_since_restore": 1804.3335506916046, "episode_len_mean": 500.0, "date": "2018-12-10_05-15-28", "done": false, "time_this_iter_s": 17.67413353919983, "episode_reward_max": 0.0, "iterations_since_restore": 100, "episodes_total": 4547, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.78169172620946, "av": 124.78169172620946}, "timestamp": 1544418928, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 100, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168ef0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2000000, "time_total_s": 1804.3335506916046, "custom_metrics": {}, "info": {"sample_time_ms": 11065.739, "num_steps_trained": 2000000, "update_time_ms": 6.341, "grad_time_ms": 6718.541, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6137179136276245, "vf_loss": 184.96719360351562, "policy_loss": -0.06026265397667885, "cur_lr": 9.999999747378752e-05, "kl": 0.03633478283882141, "entropy": 132.9325408935547, "total_loss": 184.9141845703125}, "num_steps_sampled": 2000000, "load_time_ms": 13.921, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6088861227035522, "vf_loss": 185.52488708496094, "policy_loss": -0.006481173913925886, "cur_lr": 9.999999747378752e-05, "kl": 0.016135111451148987, "entropy": 1.9731930494308472, "total_loss": 185.5184326171875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2020000, "time_since_restore": 1822.2949838638306, "episode_len_mean": 499.15, "date": "2018-12-10_05-15-46", "done": false, "time_this_iter_s": 17.961433172225952, "episode_reward_max": 0.0, "iterations_since_restore": 101, "episodes_total": 4589, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.3921410242622, "av": 125.3921410242622}, "timestamp": 1544418946, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 101, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168da0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2020000, "time_total_s": 1822.2949838638306, "custom_metrics": {}, "info": {"sample_time_ms": 11070.003, "num_steps_trained": 2020000, "update_time_ms": 6.324, "grad_time_ms": 6721.23, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6173177361488342, "vf_loss": 174.6805419921875, "policy_loss": -0.06070781499147415, "cur_lr": 9.999999747378752e-05, "kl": 0.03641386702656746, "entropy": 132.78050231933594, "total_loss": 174.62710571289062}, "num_steps_sampled": 2020000, "load_time_ms": 13.668, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6176636815071106, "vf_loss": 173.79579162597656, "policy_loss": -0.008661373518407345, "cur_lr": 9.999999747378752e-05, "kl": 0.017625994980335236, "entropy": 2.0362548828125, "total_loss": 173.7871551513672}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2040000, "time_since_restore": 1840.3795206546783, "episode_len_mean": 499.15, "date": "2018-12-10_05-16-05", "done": false, "time_this_iter_s": 18.08453679084778, "episode_reward_max": 0.0, "iterations_since_restore": 102, "episodes_total": 4635, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.94922619653222, "av": 121.94922619653222}, "timestamp": 1544418965, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 102, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641cf518>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2040000, "time_total_s": 1840.3795206546783, "custom_metrics": {}, "info": {"sample_time_ms": 11068.994, "num_steps_trained": 2040000, "update_time_ms": 6.345, "grad_time_ms": 6734.058, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7470048666000366, "vf_loss": 164.65188598632812, "policy_loss": -0.06290522962808609, "cur_lr": 9.999999747378752e-05, "kl": 0.0387093760073185, "entropy": 132.75799560546875, "total_loss": 164.5967254638672}, "num_steps_sampled": 2040000, "load_time_ms": 13.944, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7444090247154236, "vf_loss": 165.2232208251953, "policy_loss": -0.006483193952590227, "cur_lr": 9.999999747378752e-05, "kl": 0.015873359516263008, "entropy": 2.0609145164489746, "total_loss": 165.21676635742188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2060000, "time_since_restore": 1857.9371950626373, "episode_len_mean": 495.15, "date": "2018-12-10_05-16-22", "done": false, "time_this_iter_s": 17.557674407958984, "episode_reward_max": 0.0, "iterations_since_restore": 103, "episodes_total": 4679, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.0651076279508, "av": 123.0651076279508}, "timestamp": 1544418982, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 103, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf5c0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2060000, "time_total_s": 1857.9371950626373, "custom_metrics": {}, "info": {"sample_time_ms": 11071.586, "num_steps_trained": 2060000, "update_time_ms": 6.369, "grad_time_ms": 6727.833, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6590716242790222, "vf_loss": 187.1029510498047, "policy_loss": -0.06180435046553612, "cur_lr": 9.999999747378752e-05, "kl": 0.03711143881082535, "entropy": 132.838134765625, "total_loss": 187.04856872558594}, "num_steps_sampled": 2060000, "load_time_ms": 14.321, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6495668292045593, "vf_loss": 186.96652221679688, "policy_loss": -0.00816748570650816, "cur_lr": 9.999999747378752e-05, "kl": 0.018906673416495323, "entropy": 1.9838616847991943, "total_loss": 186.95838928222656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2080000, "time_since_restore": 1875.4121632575989, "episode_len_mean": 496.0, "date": "2018-12-10_05-16-40", "done": false, "time_this_iter_s": 17.474968194961548, "episode_reward_max": 0.0, "iterations_since_restore": 104, "episodes_total": 4723, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -131.07446172119228, "av": 131.07446172119228}, "timestamp": 1544419000, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 104, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfa90>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2080000, "time_total_s": 1875.4121632575989, "custom_metrics": {}, "info": {"sample_time_ms": 11020.761, "num_steps_trained": 2080000, "update_time_ms": 6.391, "grad_time_ms": 6726.463, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5144112706184387, "vf_loss": 198.92648315429688, "policy_loss": -0.05924062803387642, "cur_lr": 9.999999747378752e-05, "kl": 0.035844795405864716, "entropy": 132.84707641601562, "total_loss": 198.87440490722656}, "num_steps_sampled": 2080000, "load_time_ms": 14.351, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5003958344459534, "vf_loss": 198.4435577392578, "policy_loss": -0.007533372845500708, "cur_lr": 9.999999747378752e-05, "kl": 0.01558796875178814, "entropy": 1.9146850109100342, "total_loss": 198.43606567382812}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2100000, "time_since_restore": 1892.801328420639, "episode_len_mean": 496.0, "date": "2018-12-10_05-16-57", "done": false, "time_this_iter_s": 17.38916516304016, "episode_reward_max": 0.0, "iterations_since_restore": 105, "episodes_total": 4768, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -130.28938015466784, "av": 130.28938015466784}, "timestamp": 1544419017, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 105, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cf7b8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2100000, "time_total_s": 1892.801328420639, "custom_metrics": {}, "info": {"sample_time_ms": 10991.823, "num_steps_trained": 2100000, "update_time_ms": 6.384, "grad_time_ms": 6704.459, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6702361702919006, "vf_loss": 180.77142333984375, "policy_loss": -0.06136072054505348, "cur_lr": 9.999999747378752e-05, "kl": 0.03770120441913605, "entropy": 132.71473693847656, "total_loss": 180.7176055908203}, "num_steps_sampled": 2100000, "load_time_ms": 14.396, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6537460684776306, "vf_loss": 180.1280975341797, "policy_loss": -0.006664386950433254, "cur_lr": 9.999999747378752e-05, "kl": 0.014593002386391163, "entropy": 1.9730902910232544, "total_loss": 180.12147521972656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2120000, "time_since_restore": 1910.3283038139343, "episode_len_mean": 500.0, "date": "2018-12-10_05-17-15", "done": false, "time_this_iter_s": 17.526975393295288, "episode_reward_max": 0.0, "iterations_since_restore": 106, "episodes_total": 4811, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -131.9819335037237, "av": 131.9819335037237}, "timestamp": 1544419035, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 106, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ac5f8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2120000, "time_total_s": 1910.3283038139343, "custom_metrics": {}, "info": {"sample_time_ms": 11000.312, "num_steps_trained": 2120000, "update_time_ms": 6.404, "grad_time_ms": 6683.475, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5425367951393127, "vf_loss": 193.51190185546875, "policy_loss": -0.059862639755010605, "cur_lr": 9.999999747378752e-05, "kl": 0.037126269191503525, "entropy": 132.68569946289062, "total_loss": 193.45945739746094}, "num_steps_sampled": 2120000, "load_time_ms": 14.395, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5202968120574951, "vf_loss": 194.15530395507812, "policy_loss": -0.00785362534224987, "cur_lr": 9.999999747378752e-05, "kl": 0.01779298670589924, "entropy": 1.9402207136154175, "total_loss": 194.14747619628906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2140000, "time_since_restore": 1928.164512872696, "episode_len_mean": 500.0, "date": "2018-12-10_05-17-32", "done": false, "time_this_iter_s": 17.836209058761597, "episode_reward_max": 0.0, "iterations_since_restore": 107, "episodes_total": 4856, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.25990783346097, "av": 129.25990783346097}, "timestamp": 1544419052, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 107, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145320>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2140000, "time_total_s": 1928.164512872696, "custom_metrics": {}, "info": {"sample_time_ms": 10944.292, "num_steps_trained": 2140000, "update_time_ms": 6.481, "grad_time_ms": 6699.84, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6422001719474792, "vf_loss": 179.44020080566406, "policy_loss": -0.06161695718765259, "cur_lr": 9.999999747378752e-05, "kl": 0.03841453045606613, "entropy": 132.5491485595703, "total_loss": 179.3862762451172}, "num_steps_sampled": 2140000, "load_time_ms": 14.145, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6282998919487, "vf_loss": 180.78257751464844, "policy_loss": -0.00808673445135355, "cur_lr": 9.999999747378752e-05, "kl": 0.016791535541415215, "entropy": 1.9904253482818604, "total_loss": 180.7745361328125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2160000, "time_since_restore": 1945.9761955738068, "episode_len_mean": 493.81, "date": "2018-12-10_05-17-50", "done": false, "time_this_iter_s": 17.81168270111084, "episode_reward_max": 0.0, "iterations_since_restore": 108, "episodes_total": 4901, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -127.09250382754621, "av": 127.09250382754621}, "timestamp": 1544419070, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 108, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ac6d8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2160000, "time_total_s": 1945.9761955738068, "custom_metrics": {}, "info": {"sample_time_ms": 10955.133, "num_steps_trained": 2160000, "update_time_ms": 6.527, "grad_time_ms": 6710.834, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5584483742713928, "vf_loss": 200.68844604492188, "policy_loss": -0.06218491494655609, "cur_lr": 9.999999747378752e-05, "kl": 0.037523116916418076, "entropy": 132.5682373046875, "total_loss": 200.63375854492188}, "num_steps_sampled": 2160000, "load_time_ms": 14.124, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5381813049316406, "vf_loss": 203.20545959472656, "policy_loss": -0.0091223930940032, "cur_lr": 9.999999747378752e-05, "kl": 0.021509302780032158, "entropy": 1.943116545677185, "total_loss": 203.1963653564453}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2180000, "time_since_restore": 1963.8024744987488, "episode_len_mean": 493.81, "date": "2018-12-10_05-18-08", "done": false, "time_this_iter_s": 17.826278924942017, "episode_reward_max": 0.0, "iterations_since_restore": 109, "episodes_total": 4943, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.09631087129054, "av": 124.09631087129054}, "timestamp": 1544419088, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 109, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6c18>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2180000, "time_total_s": 1963.8024744987488, "custom_metrics": {}, "info": {"sample_time_ms": 10927.144, "num_steps_trained": 2180000, "update_time_ms": 6.539, "grad_time_ms": 6716.52, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7160019278526306, "vf_loss": 164.2595672607422, "policy_loss": -0.06218655779957771, "cur_lr": 9.999999747378752e-05, "kl": 0.038948897272348404, "entropy": 132.52523803710938, "total_loss": 164.2051544189453}, "num_steps_sampled": 2180000, "load_time_ms": 14.365, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6953074932098389, "vf_loss": 165.9365997314453, "policy_loss": -0.007315007504075766, "cur_lr": 9.999999747378752e-05, "kl": 0.018456969410181046, "entropy": 1.98157799243927, "total_loss": 165.9293212890625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2200000, "time_since_restore": 1981.9035696983337, "episode_len_mean": 493.56, "date": "2018-12-10_05-18-26", "done": false, "time_this_iter_s": 18.10109519958496, "episode_reward_max": 0.0, "iterations_since_restore": 110, "episodes_total": 4990, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.72246184608203, "av": 124.72246184608203}, "timestamp": 1544419106, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 110, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ac470>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2200000, "time_total_s": 1981.9035696983337, "custom_metrics": {}, "info": {"sample_time_ms": 10980.613, "num_steps_trained": 2200000, "update_time_ms": 6.486, "grad_time_ms": 6706.12, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6177854537963867, "vf_loss": 172.93289184570312, "policy_loss": -0.06277766078710556, "cur_lr": 9.999999747378752e-05, "kl": 0.03767172619700432, "entropy": 132.50628662109375, "total_loss": 172.8776397705078}, "num_steps_sampled": 2200000, "load_time_ms": 14.112, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5921892523765564, "vf_loss": 174.73223876953125, "policy_loss": -0.005641990341246128, "cur_lr": 9.999999747378752e-05, "kl": 0.016452902927994728, "entropy": 1.93359375, "total_loss": 174.7266082763672}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2220000, "time_since_restore": 1999.853937625885, "episode_len_mean": 493.01, "date": "2018-12-10_05-18-44", "done": false, "time_this_iter_s": 17.95036792755127, "episode_reward_max": 0.0, "iterations_since_restore": 111, "episodes_total": 5034, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.21590425910217, "av": 126.21590425910217}, "timestamp": 1544419124, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 111, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f64e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2220000, "time_total_s": 1999.853937625885, "custom_metrics": {}, "info": {"sample_time_ms": 10997.895, "num_steps_trained": 2220000, "update_time_ms": 6.554, "grad_time_ms": 6686.991, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6526166200637817, "vf_loss": 173.35145568847656, "policy_loss": -0.06153497472405434, "cur_lr": 9.999999747378752e-05, "kl": 0.03785211220383644, "entropy": 132.3568115234375, "total_loss": 173.29750061035156}, "num_steps_sampled": 2220000, "load_time_ms": 14.336, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6266604661941528, "vf_loss": 175.53993225097656, "policy_loss": -0.0071312845684587955, "cur_lr": 9.999999747378752e-05, "kl": 0.018522286787629128, "entropy": 1.9592068195343018, "total_loss": 175.53282165527344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2240000, "time_since_restore": 2017.7013990879059, "episode_len_mean": 489.69, "date": "2018-12-10_05-19-02", "done": false, "time_this_iter_s": 17.847461462020874, "episode_reward_max": 0.0, "iterations_since_restore": 112, "episodes_total": 5081, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.05503060198085, "av": 126.05503060198085}, "timestamp": 1544419142, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 112, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145c18>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2240000, "time_total_s": 2017.7013990879059, "custom_metrics": {}, "info": {"sample_time_ms": 10964.316, "num_steps_trained": 2240000, "update_time_ms": 6.511, "grad_time_ms": 6696.574, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6079323887825012, "vf_loss": 173.24449157714844, "policy_loss": -0.0608157142996788, "cur_lr": 9.999999747378752e-05, "kl": 0.03833538666367531, "entropy": 132.4121856689453, "total_loss": 173.19134521484375}, "num_steps_sampled": 2240000, "load_time_ms": 14.016, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5925635099411011, "vf_loss": 174.14195251464844, "policy_loss": -0.006725488696247339, "cur_lr": 9.999999747378752e-05, "kl": 0.020148536190390587, "entropy": 1.9241886138916016, "total_loss": 174.13523864746094}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2260000, "time_since_restore": 2035.2746307849884, "episode_len_mean": 491.98, "date": "2018-12-10_05-19-20", "done": false, "time_this_iter_s": 17.57323169708252, "episode_reward_max": 0.0, "iterations_since_restore": 113, "episodes_total": 5124, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.16483223462907, "av": 129.16483223462907}, "timestamp": 1544419160, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 113, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168208>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2260000, "time_total_s": 2035.2746307849884, "custom_metrics": {}, "info": {"sample_time_ms": 10963.835, "num_steps_trained": 2260000, "update_time_ms": 6.492, "grad_time_ms": 6698.741, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.549387514591217, "vf_loss": 166.78981018066406, "policy_loss": -0.06144559010863304, "cur_lr": 9.999999747378752e-05, "kl": 0.037974171340465546, "entropy": 132.34628295898438, "total_loss": 166.7359619140625}, "num_steps_sampled": 2260000, "load_time_ms": 14.021, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5385075211524963, "vf_loss": 166.7366943359375, "policy_loss": -0.00728877168148756, "cur_lr": 9.999999747378752e-05, "kl": 0.015252290293574333, "entropy": 1.9136393070220947, "total_loss": 166.7294158935547}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2280000, "time_since_restore": 2053.0450983047485, "episode_len_mean": 491.98, "date": "2018-12-10_05-19-37", "done": false, "time_this_iter_s": 17.770467519760132, "episode_reward_max": 0.0, "iterations_since_restore": 114, "episodes_total": 5167, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -119.34348119203895, "av": 119.34348119203895}, "timestamp": 1544419177, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 114, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364160ef0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2280000, "time_total_s": 2053.0450983047485, "custom_metrics": {}, "info": {"sample_time_ms": 10995.774, "num_steps_trained": 2280000, "update_time_ms": 6.495, "grad_time_ms": 6696.317, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6991249322891235, "vf_loss": 149.57058715820312, "policy_loss": -0.06251047551631927, "cur_lr": 9.999999747378752e-05, "kl": 0.039137985557317734, "entropy": 132.33926391601562, "total_loss": 149.5159149169922}, "num_steps_sampled": 2280000, "load_time_ms": 13.985, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6843922138214111, "vf_loss": 150.8123016357422, "policy_loss": -0.006976165808737278, "cur_lr": 9.999999747378752e-05, "kl": 0.018983488902449608, "entropy": 1.9674466848373413, "total_loss": 150.80535888671875}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2300000, "time_since_restore": 2070.8508830070496, "episode_len_mean": 500.0, "date": "2018-12-10_05-19-55", "done": false, "time_this_iter_s": 17.805784702301025, "episode_reward_max": 0.0, "iterations_since_restore": 115, "episodes_total": 5211, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.49941254069216, "av": 120.49941254069216}, "timestamp": 1544419195, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 115, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53640cfeb8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2300000, "time_total_s": 2070.8508830070496, "custom_metrics": {}, "info": {"sample_time_ms": 11015.868, "num_steps_trained": 2300000, "update_time_ms": 6.525, "grad_time_ms": 6716.614, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5970126390457153, "vf_loss": 173.64418029785156, "policy_loss": -0.06303861737251282, "cur_lr": 9.999999747378752e-05, "kl": 0.036696452647447586, "entropy": 132.28773498535156, "total_loss": 173.58848571777344}, "num_steps_sampled": 2300000, "load_time_ms": 14.102, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6006711721420288, "vf_loss": 171.6016082763672, "policy_loss": -0.006420640740543604, "cur_lr": 9.999999747378752e-05, "kl": 0.017137277871370316, "entropy": 1.8937667608261108, "total_loss": 171.59521484375}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2320000, "time_since_restore": 2088.652149915695, "episode_len_mean": 500.0, "date": "2018-12-10_05-20-13", "done": false, "time_this_iter_s": 17.80126690864563, "episode_reward_max": 0.0, "iterations_since_restore": 116, "episodes_total": 5257, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -127.99198688533637, "av": 127.99198688533637}, "timestamp": 1544419213, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 116, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799aceb8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2320000, "time_total_s": 2088.652149915695, "custom_metrics": {}, "info": {"sample_time_ms": 11031.296, "num_steps_trained": 2320000, "update_time_ms": 6.586, "grad_time_ms": 6728.765, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5690189003944397, "vf_loss": 185.2646026611328, "policy_loss": -0.060709398239851, "cur_lr": 9.999999747378752e-05, "kl": 0.03945719450712204, "entropy": 132.29502868652344, "total_loss": 185.2117919921875}, "num_steps_sampled": 2320000, "load_time_ms": 14.027, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.568701446056366, "vf_loss": 182.02761840820312, "policy_loss": -0.007973282597959042, "cur_lr": 9.999999747378752e-05, "kl": 0.01759308949112892, "entropy": 1.9338332414627075, "total_loss": 182.01966857910156}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2340000, "time_since_restore": 2105.835725545883, "episode_len_mean": 496.75, "date": "2018-12-10_05-20-30", "done": false, "time_this_iter_s": 17.18357563018799, "episode_reward_max": 0.0, "iterations_since_restore": 117, "episodes_total": 5299, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -130.6333749769128, "av": 130.6333749769128}, "timestamp": 1544419230, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 117, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168fd0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2340000, "time_total_s": 2105.835725545883, "custom_metrics": {}, "info": {"sample_time_ms": 11006.025, "num_steps_trained": 2340000, "update_time_ms": 6.409, "grad_time_ms": 6688.267, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5491389632225037, "vf_loss": 183.1604766845703, "policy_loss": -0.06041969358921051, "cur_lr": 9.999999747378752e-05, "kl": 0.03704580292105675, "entropy": 132.1788787841797, "total_loss": 183.1074981689453}, "num_steps_sampled": 2340000, "load_time_ms": 14.298, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.552236020565033, "vf_loss": 180.7156524658203, "policy_loss": -0.007612647023051977, "cur_lr": 9.999999747378752e-05, "kl": 0.020793583244085312, "entropy": 1.876292109489441, "total_loss": 180.70806884765625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2360000, "time_since_restore": 2123.9966263771057, "episode_len_mean": 496.75, "date": "2018-12-10_05-20-48", "done": false, "time_this_iter_s": 18.160900831222534, "episode_reward_max": 0.0, "iterations_since_restore": 118, "episodes_total": 5344, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.28655472489031, "av": 125.28655472489031}, "timestamp": 1544419248, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 118, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416cb70>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2360000, "time_total_s": 2123.9966263771057, "custom_metrics": {}, "info": {"sample_time_ms": 11051.029, "num_steps_trained": 2360000, "update_time_ms": 6.423, "grad_time_ms": 6677.817, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.7049074172973633, "vf_loss": 164.56578063964844, "policy_loss": -0.061684198677539825, "cur_lr": 9.999999747378752e-05, "kl": 0.038423895835876465, "entropy": 131.9640350341797, "total_loss": 164.5117950439453}, "num_steps_sampled": 2360000, "load_time_ms": 14.305, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7117756605148315, "vf_loss": 160.10769653320312, "policy_loss": -0.00796512421220541, "cur_lr": 9.999999747378752e-05, "kl": 0.018106790259480476, "entropy": 1.9531105756759644, "total_loss": 160.09976196289062}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2380000, "time_since_restore": 2141.433171272278, "episode_len_mean": 496.75, "date": "2018-12-10_05-21-06", "done": false, "time_this_iter_s": 17.43654489517212, "episode_reward_max": 0.0, "iterations_since_restore": 119, "episodes_total": 5389, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.8959813473473, "av": 126.8959813473473}, "timestamp": 1544419266, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 119, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364145390>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2380000, "time_total_s": 2141.433171272278, "custom_metrics": {}, "info": {"sample_time_ms": 11026.706, "num_steps_trained": 2380000, "update_time_ms": 6.512, "grad_time_ms": 6663.105, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.538713812828064, "vf_loss": 179.93092346191406, "policy_loss": -0.06172264367341995, "cur_lr": 9.999999747378752e-05, "kl": 0.03831023350358009, "entropy": 132.07528686523438, "total_loss": 179.87684631347656}, "num_steps_sampled": 2380000, "load_time_ms": 14.255, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.541000247001648, "vf_loss": 177.01036071777344, "policy_loss": -0.006095562130212784, "cur_lr": 9.999999747378752e-05, "kl": 0.019514380022883415, "entropy": 1.887858510017395, "total_loss": 177.00428771972656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2400000, "time_since_restore": 2159.6400542259216, "episode_len_mean": 492.17, "date": "2018-12-10_05-21-24", "done": false, "time_this_iter_s": 18.2068829536438, "episode_reward_max": 0.0, "iterations_since_restore": 120, "episodes_total": 5432, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -130.1969295630083, "av": 130.1969295630083}, "timestamp": 1544419284, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 120, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364150f28>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2400000, "time_total_s": 2159.6400542259216, "custom_metrics": {}, "info": {"sample_time_ms": 11033.04, "num_steps_trained": 2400000, "update_time_ms": 6.449, "grad_time_ms": 6667.949, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.5760884881019592, "vf_loss": 187.2743377685547, "policy_loss": -0.06283462792634964, "cur_lr": 9.999999747378752e-05, "kl": 0.038564715534448624, "entropy": 132.05789184570312, "total_loss": 187.21922302246094}, "num_steps_sampled": 2400000, "load_time_ms": 14.107, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5742063522338867, "vf_loss": 185.20550537109375, "policy_loss": -0.007588621694594622, "cur_lr": 9.999999747378752e-05, "kl": 0.016545506194233894, "entropy": 1.9171319007873535, "total_loss": 185.1979522705078}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2420000, "time_since_restore": 2177.736246585846, "episode_len_mean": 492.17, "date": "2018-12-10_05-21-42", "done": false, "time_this_iter_s": 18.096192359924316, "episode_reward_max": 0.0, "iterations_since_restore": 121, "episodes_total": 5479, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.61684158173419, "av": 125.61684158173419}, "timestamp": 1544419302, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 121, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168a20>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2420000, "time_total_s": 2177.736246585846, "custom_metrics": {}, "info": {"sample_time_ms": 11031.828, "num_steps_trained": 2420000, "update_time_ms": 6.48, "grad_time_ms": 6684.201, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6537589430809021, "vf_loss": 168.27127075195312, "policy_loss": -0.06194927170872688, "cur_lr": 9.999999747378752e-05, "kl": 0.037563715130090714, "entropy": 131.8385467529297, "total_loss": 168.21682739257812}, "num_steps_sampled": 2420000, "load_time_ms": 13.873, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6491318941116333, "vf_loss": 166.77464294433594, "policy_loss": -0.006739069242030382, "cur_lr": 9.999999747378752e-05, "kl": 0.018227431923151016, "entropy": 1.8971068859100342, "total_loss": 166.76792907714844}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2440000, "time_since_restore": 2195.396518945694, "episode_len_mean": 496.67, "date": "2018-12-10_05-22-00", "done": false, "time_this_iter_s": 17.660272359848022, "episode_reward_max": 0.0, "iterations_since_restore": 122, "episodes_total": 5523, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.74137742380492, "av": 120.74137742380492}, "timestamp": 1544419320, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 122, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799acd30>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2440000, "time_total_s": 2195.396518945694, "custom_metrics": {}, "info": {"sample_time_ms": 11044.731, "num_steps_trained": 2440000, "update_time_ms": 6.546, "grad_time_ms": 6653.182, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.714964747428894, "vf_loss": 173.6833953857422, "policy_loss": -0.06349500268697739, "cur_lr": 9.999999747378752e-05, "kl": 0.03942415118217468, "entropy": 131.81948852539062, "total_loss": 173.62777709960938}, "num_steps_sampled": 2440000, "load_time_ms": 13.903, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7142415046691895, "vf_loss": 171.65286254882812, "policy_loss": -0.007490747142583132, "cur_lr": 9.999999747378752e-05, "kl": 0.018486222252249718, "entropy": 1.9104348421096802, "total_loss": 171.64540100097656}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2460000, "time_since_restore": 2213.0308406352997, "episode_len_mean": 496.67, "date": "2018-12-10_05-22-18", "done": false, "time_this_iter_s": 17.634321689605713, "episode_reward_max": 0.0, "iterations_since_restore": 123, "episodes_total": 5568, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.47235901727028, "av": 123.47235901727028}, "timestamp": 1544419338, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 123, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b64e0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2460000, "time_total_s": 2213.0308406352997, "custom_metrics": {}, "info": {"sample_time_ms": 11051.336, "num_steps_trained": 2460000, "update_time_ms": 6.772, "grad_time_ms": 6652.664, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6197167038917542, "vf_loss": 182.36488342285156, "policy_loss": -0.060991398990154266, "cur_lr": 9.999999747378752e-05, "kl": 0.037276290357112885, "entropy": 131.86485290527344, "total_loss": 182.3113555908203}, "num_steps_sampled": 2460000, "load_time_ms": 13.766, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6191598773002625, "vf_loss": 181.5640869140625, "policy_loss": -0.008015082217752934, "cur_lr": 9.999999747378752e-05, "kl": 0.017500566318631172, "entropy": 1.873632550239563, "total_loss": 181.55612182617188}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2480000, "time_since_restore": 2230.4471957683563, "episode_len_mean": 500.0, "date": "2018-12-10_05-22-35", "done": false, "time_this_iter_s": 17.41635513305664, "episode_reward_max": 0.0, "iterations_since_restore": 124, "episodes_total": 5609, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.13137813022024, "av": 129.13137813022024}, "timestamp": 1544419355, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 124, "pid": 2451, "episodes_this_iter": 41, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b6828>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2480000, "time_total_s": 2230.4471957683563, "custom_metrics": {}, "info": {"sample_time_ms": 11034.256, "num_steps_trained": 2480000, "update_time_ms": 6.984, "grad_time_ms": 6634.769, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.6363562345504761, "vf_loss": 177.93789672851562, "policy_loss": -0.06232737749814987, "cur_lr": 9.999999747378752e-05, "kl": 0.03734123334288597, "entropy": 131.80738830566406, "total_loss": 177.88304138183594}, "num_steps_sampled": 2480000, "load_time_ms": 13.49, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6371947526931763, "vf_loss": 177.06483459472656, "policy_loss": -0.00675720302388072, "cur_lr": 9.999999747378752e-05, "kl": 0.01680649444460869, "entropy": 1.8774073123931885, "total_loss": 177.05809020996094}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2500000, "time_since_restore": 2248.972843647003, "episode_len_mean": 498.88, "date": "2018-12-10_05-22-54", "done": false, "time_this_iter_s": 18.52564787864685, "episode_reward_max": 0.0, "iterations_since_restore": 125, "episodes_total": 5655, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -128.73821008354176, "av": 128.73821008354176}, "timestamp": 1544419374, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 125, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b6b00>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2500000, "time_total_s": 2248.972843647003, "custom_metrics": {}, "info": {"sample_time_ms": 11116.276, "num_steps_trained": 2500000, "update_time_ms": 6.966, "grad_time_ms": 6626.036, "adversary": {"cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.676050066947937, "vf_loss": 192.81187438964844, "policy_loss": -0.06309893727302551, "cur_lr": 9.999999747378752e-05, "kl": 0.04011358320713043, "entropy": 131.88780212402344, "total_loss": 192.7567901611328}, "num_steps_sampled": 2500000, "load_time_ms": 13.349, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6710920929908752, "vf_loss": 191.7270050048828, "policy_loss": -0.007474316284060478, "cur_lr": 9.999999747378752e-05, "kl": 0.016122184693813324, "entropy": 1.8658016920089722, "total_loss": 191.7195587158203}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2520000, "time_since_restore": 2266.8845949172974, "episode_len_mean": 498.88, "date": "2018-12-10_05-23-12", "done": false, "time_this_iter_s": 17.91175127029419, "episode_reward_max": 0.0, "iterations_since_restore": 126, "episodes_total": 5699, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.58980999593342, "av": 124.58980999593342}, "timestamp": 1544419392, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 126, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f6128>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2520000, "time_total_s": 2266.8845949172974, "custom_metrics": {}, "info": {"sample_time_ms": 11136.018, "num_steps_trained": 2520000, "update_time_ms": 6.858, "grad_time_ms": 6616.743, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6791968941688538, "vf_loss": 179.48683166503906, "policy_loss": -0.06329066306352615, "cur_lr": 9.999999747378752e-05, "kl": 0.03468157723546028, "entropy": 131.85687255859375, "total_loss": 179.43394470214844}, "num_steps_sampled": 2520000, "load_time_ms": 13.656, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6690680980682373, "vf_loss": 177.33175659179688, "policy_loss": -0.005973467603325844, "cur_lr": 9.999999747378752e-05, "kl": 0.0193009153008461, "entropy": 1.8971807956695557, "total_loss": 177.3258056640625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2540000, "time_since_restore": 2284.605887413025, "episode_len_mean": 497.52, "date": "2018-12-10_05-23-29", "done": false, "time_this_iter_s": 17.72129249572754, "episode_reward_max": 0.0, "iterations_since_restore": 127, "episodes_total": 5743, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.0794842708081, "av": 126.0794842708081}, "timestamp": 1544419409, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 127, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ac6a0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2540000, "time_total_s": 2284.605887413025, "custom_metrics": {}, "info": {"sample_time_ms": 11176.56, "num_steps_trained": 2540000, "update_time_ms": 6.885, "grad_time_ms": 6629.891, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5849195122718811, "vf_loss": 188.42433166503906, "policy_loss": -0.05997258424758911, "cur_lr": 9.999999747378752e-05, "kl": 0.032801322638988495, "entropy": 131.7687530517578, "total_loss": 188.3741912841797}, "num_steps_sampled": 2540000, "load_time_ms": 13.673, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5752372145652771, "vf_loss": 188.0658416748047, "policy_loss": -0.006063716486096382, "cur_lr": 9.999999747378752e-05, "kl": 0.018474498763680458, "entropy": 1.822767972946167, "total_loss": 188.059814453125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2560000, "time_since_restore": 2302.6903233528137, "episode_len_mean": 494.33, "date": "2018-12-10_05-23-47", "done": false, "time_this_iter_s": 18.08443593978882, "episode_reward_max": 0.0, "iterations_since_restore": 128, "episodes_total": 5788, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.88665204270792, "av": 124.88665204270792}, "timestamp": 1544419427, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 128, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b6080>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2560000, "time_total_s": 2302.6903233528137, "custom_metrics": {}, "info": {"sample_time_ms": 11170.494, "num_steps_trained": 2560000, "update_time_ms": 6.839, "grad_time_ms": 6628.465, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.7162294387817383, "vf_loss": 172.43942260742188, "policy_loss": -0.06163594499230385, "cur_lr": 9.999999747378752e-05, "kl": 0.03383370488882065, "entropy": 131.7097625732422, "total_loss": 172.387939453125}, "num_steps_sampled": 2560000, "load_time_ms": 13.344, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7068579196929932, "vf_loss": 172.92994689941406, "policy_loss": -0.006563462316989899, "cur_lr": 9.999999747378752e-05, "kl": 0.017062047496438026, "entropy": 1.8659327030181885, "total_loss": 172.92340087890625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2580000, "time_since_restore": 2320.512227296829, "episode_len_mean": 496.81, "date": "2018-12-10_05-24-05", "done": false, "time_this_iter_s": 17.821903944015503, "episode_reward_max": 0.0, "iterations_since_restore": 129, "episodes_total": 5831, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.79388886649016, "av": 124.79388886649016}, "timestamp": 1544419445, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 129, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b65c0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2580000, "time_total_s": 2320.512227296829, "custom_metrics": {}, "info": {"sample_time_ms": 11208.999, "num_steps_trained": 2580000, "update_time_ms": 6.732, "grad_time_ms": 6629.121, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.593084990978241, "vf_loss": 179.58328247070312, "policy_loss": -0.05993956699967384, "cur_lr": 9.999999747378752e-05, "kl": 0.032698363065719604, "entropy": 131.69674682617188, "total_loss": 179.5331573486328}, "num_steps_sampled": 2580000, "load_time_ms": 13.178, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5935438275337219, "vf_loss": 178.66461181640625, "policy_loss": -0.007278167176991701, "cur_lr": 9.999999747378752e-05, "kl": 0.017227832227945328, "entropy": 1.8126952648162842, "total_loss": 178.6573486328125}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2600000, "time_since_restore": 2338.287707090378, "episode_len_mean": 496.81, "date": "2018-12-10_05-24-23", "done": false, "time_this_iter_s": 17.775479793548584, "episode_reward_max": 0.0, "iterations_since_restore": 130, "episodes_total": 5877, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -121.42996508752489, "av": 121.42996508752489}, "timestamp": 1544419463, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 130, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641683c8>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2600000, "time_total_s": 2338.287707090378, "custom_metrics": {}, "info": {"sample_time_ms": 11164.965, "num_steps_trained": 2600000, "update_time_ms": 6.73, "grad_time_ms": 6630.259, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6840294599533081, "vf_loss": 186.3142547607422, "policy_loss": -0.059554148465394974, "cur_lr": 9.999999747378752e-05, "kl": 0.03333437070250511, "entropy": 131.76487731933594, "total_loss": 186.2646942138672}, "num_steps_sampled": 2600000, "load_time_ms": 13.196, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6718493700027466, "vf_loss": 185.08053588867188, "policy_loss": -0.0067867194302380085, "cur_lr": 9.999999747378752e-05, "kl": 0.018875528126955032, "entropy": 1.8682068586349487, "total_loss": 185.07376098632812}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2620000, "time_since_restore": 2355.829763174057, "episode_len_mean": 500.0, "date": "2018-12-10_05-24-41", "done": false, "time_this_iter_s": 17.5420560836792, "episode_reward_max": 0.0, "iterations_since_restore": 131, "episodes_total": 5919, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -124.64709444063482, "av": 124.64709444063482}, "timestamp": 1544419481, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 131, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364160978>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2620000, "time_total_s": 2355.829763174057, "custom_metrics": {}, "info": {"sample_time_ms": 11127.285, "num_steps_trained": 2620000, "update_time_ms": 6.626, "grad_time_ms": 6612.067, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5434805154800415, "vf_loss": 187.87240600585938, "policy_loss": -0.06033291667699814, "cur_lr": 9.999999747378752e-05, "kl": 0.03331960737705231, "entropy": 131.77406311035156, "total_loss": 187.82208251953125}, "num_steps_sampled": 2620000, "load_time_ms": 13.41, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5485984683036804, "vf_loss": 184.65097045898438, "policy_loss": -0.006692005321383476, "cur_lr": 9.999999747378752e-05, "kl": 0.017098169773817062, "entropy": 1.8025037050247192, "total_loss": 184.64431762695312}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2640000, "time_since_restore": 2373.665435552597, "episode_len_mean": 500.0, "date": "2018-12-10_05-24-58", "done": false, "time_this_iter_s": 17.83567237854004, "episode_reward_max": 0.0, "iterations_since_restore": 132, "episodes_total": 5963, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -127.86842463051207, "av": 127.86842463051207}, "timestamp": 1544419498, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 132, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416ccc0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2640000, "time_total_s": 2373.665435552597, "custom_metrics": {}, "info": {"sample_time_ms": 11116.448, "num_steps_trained": 2640000, "update_time_ms": 6.568, "grad_time_ms": 6640.799, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6033620834350586, "vf_loss": 186.55519104003906, "policy_loss": -0.059755630791187286, "cur_lr": 9.999999747378752e-05, "kl": 0.03298790380358696, "entropy": 131.7716064453125, "total_loss": 186.50534057617188}, "num_steps_sampled": 2640000, "load_time_ms": 13.326, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6129075884819031, "vf_loss": 184.220703125, "policy_loss": -0.006835887674242258, "cur_lr": 9.999999747378752e-05, "kl": 0.0180378220975399, "entropy": 1.8059625625610352, "total_loss": 184.21389770507812}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2660000, "time_since_restore": 2391.1233971118927, "episode_len_mean": 500.0, "date": "2018-12-10_05-25-16", "done": false, "time_this_iter_s": 17.457961559295654, "episode_reward_max": 0.0, "iterations_since_restore": 133, "episodes_total": 6008, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.78560286112665, "av": 129.78560286112665}, "timestamp": 1544419516, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 133, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b67f0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2660000, "time_total_s": 2391.1233971118927, "custom_metrics": {}, "info": {"sample_time_ms": 11108.294, "num_steps_trained": 2660000, "update_time_ms": 6.336, "grad_time_ms": 6631.354, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6286267638206482, "vf_loss": 194.5568389892578, "policy_loss": -0.06048751622438431, "cur_lr": 9.999999747378752e-05, "kl": 0.03275325894355774, "entropy": 131.82850646972656, "total_loss": 194.50616455078125}, "num_steps_sampled": 2660000, "load_time_ms": 13.321, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6509575247764587, "vf_loss": 190.3002166748047, "policy_loss": -0.008673550561070442, "cur_lr": 9.999999747378752e-05, "kl": 0.01763528771698475, "entropy": 1.8072141408920288, "total_loss": 190.29156494140625}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2680000, "time_since_restore": 2408.88476228714, "episode_len_mean": 500.0, "date": "2018-12-10_05-25-34", "done": false, "time_this_iter_s": 17.761365175247192, "episode_reward_max": 0.0, "iterations_since_restore": 134, "episodes_total": 6053, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.98773885316342, "av": 126.98773885316342}, "timestamp": 1544419534, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 134, "pid": 2451, "episodes_this_iter": 45, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536414c710>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2680000, "time_total_s": 2408.88476228714, "custom_metrics": {}, "info": {"sample_time_ms": 11147.204, "num_steps_trained": 2680000, "update_time_ms": 6.12, "grad_time_ms": 6626.398, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5973559021949768, "vf_loss": 187.4744415283203, "policy_loss": -0.05988562852144241, "cur_lr": 9.999999747378752e-05, "kl": 0.03244674950838089, "entropy": 131.5675506591797, "total_loss": 187.42430114746094}, "num_steps_sampled": 2680000, "load_time_ms": 13.595, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6175212860107422, "vf_loss": 183.23089599609375, "policy_loss": -0.006460616830736399, "cur_lr": 9.999999747378752e-05, "kl": 0.016829418018460274, "entropy": 1.7831100225448608, "total_loss": 183.22445678710938}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2700000, "time_since_restore": 2426.583566904068, "episode_len_mean": 500.0, "date": "2018-12-10_05-25-51", "done": false, "time_this_iter_s": 17.6988046169281, "episode_reward_max": 0.0, "iterations_since_restore": 135, "episodes_total": 6096, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.38192170213469, "av": 126.38192170213469}, "timestamp": 1544419551, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 135, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168898>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2700000, "time_total_s": 2426.583566904068, "custom_metrics": {}, "info": {"sample_time_ms": 11071.879, "num_steps_trained": 2700000, "update_time_ms": 6.215, "grad_time_ms": 6618.921, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6542404890060425, "vf_loss": 190.80467224121094, "policy_loss": -0.060063742101192474, "cur_lr": 9.999999747378752e-05, "kl": 0.03287050127983093, "entropy": 131.7291717529297, "total_loss": 190.75448608398438}, "num_steps_sampled": 2700000, "load_time_ms": 13.646, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6790780425071716, "vf_loss": 185.65240478515625, "policy_loss": -0.006844228599220514, "cur_lr": 9.999999747378752e-05, "kl": 0.019047114998102188, "entropy": 1.8083654642105103, "total_loss": 185.64559936523438}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2720000, "time_since_restore": 2444.1428990364075, "episode_len_mean": 495.38, "date": "2018-12-10_05-26-09", "done": false, "time_this_iter_s": 17.559332132339478, "episode_reward_max": 0.0, "iterations_since_restore": 136, "episodes_total": 6142, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -126.515188413981, "av": 126.515188413981}, "timestamp": 1544419569, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 136, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799b62b0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2720000, "time_total_s": 2444.1428990364075, "custom_metrics": {}, "info": {"sample_time_ms": 11062.467, "num_steps_trained": 2720000, "update_time_ms": 6.295, "grad_time_ms": 6593.161, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.7008789777755737, "vf_loss": 181.4629364013672, "policy_loss": -0.06073553115129471, "cur_lr": 9.999999747378752e-05, "kl": 0.03325459733605385, "entropy": 131.611083984375, "total_loss": 181.41220092773438}, "num_steps_sampled": 2720000, "load_time_ms": 13.61, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.711013913154602, "vf_loss": 177.6659698486328, "policy_loss": -0.007380248047411442, "cur_lr": 9.999999747378752e-05, "kl": 0.018921319395303726, "entropy": 1.8036599159240723, "total_loss": 177.65859985351562}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2740000, "time_since_restore": 2462.0076384544373, "episode_len_mean": 495.38, "date": "2018-12-10_05-26-27", "done": false, "time_this_iter_s": 17.864739418029785, "episode_reward_max": 0.0, "iterations_since_restore": 137, "episodes_total": 6184, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -120.93546517443885, "av": 120.93546517443885}, "timestamp": 1544419587, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 137, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ba198>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2740000, "time_total_s": 2462.0076384544373, "custom_metrics": {}, "info": {"sample_time_ms": 11083.043, "num_steps_trained": 2740000, "update_time_ms": 6.304, "grad_time_ms": 6587.214, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.7363013029098511, "vf_loss": 161.73094177246094, "policy_loss": -0.0610215924680233, "cur_lr": 9.999999747378752e-05, "kl": 0.03398719057440758, "entropy": 131.46229553222656, "total_loss": 161.68014526367188}, "num_steps_sampled": 2740000, "load_time_ms": 13.585, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.7451953291893005, "vf_loss": 157.6282196044922, "policy_loss": -0.006939898710697889, "cur_lr": 9.999999747378752e-05, "kl": 0.01628813147544861, "entropy": 1.8728269338607788, "total_loss": 157.62130737304688}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2760000, "time_since_restore": 2479.7166159152985, "episode_len_mean": 500.0, "date": "2018-12-10_05-26-45", "done": false, "time_this_iter_s": 17.708977460861206, "episode_reward_max": 0.0, "iterations_since_restore": 138, "episodes_total": 6228, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.41668686285888, "av": 125.41668686285888}, "timestamp": 1544419605, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 138, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641f9d68>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2760000, "time_total_s": 2479.7166159152985, "custom_metrics": {}, "info": {"sample_time_ms": 11064.049, "num_steps_trained": 2760000, "update_time_ms": 6.291, "grad_time_ms": 6568.913, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6736494302749634, "vf_loss": 188.44412231445312, "policy_loss": -0.06066806614398956, "cur_lr": 9.999999747378752e-05, "kl": 0.03392612561583519, "entropy": 131.40538024902344, "total_loss": 188.39364624023438}, "num_steps_sampled": 2760000, "load_time_ms": 13.877, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6784669160842896, "vf_loss": 183.83505249023438, "policy_loss": -0.005545288324356079, "cur_lr": 9.999999747378752e-05, "kl": 0.01578032411634922, "entropy": 1.8176116943359375, "total_loss": 183.82952880859375}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2780000, "time_since_restore": 2497.5109136104584, "episode_len_mean": 500.0, "date": "2018-12-10_05-27-02", "done": false, "time_this_iter_s": 17.794297695159912, "episode_reward_max": 0.0, "iterations_since_restore": 139, "episodes_total": 6274, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -128.5270668323515, "av": 128.5270668323515}, "timestamp": 1544419622, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 139, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ba780>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2780000, "time_total_s": 2497.5109136104584, "custom_metrics": {}, "info": {"sample_time_ms": 11056.659, "num_steps_trained": 2780000, "update_time_ms": 6.333, "grad_time_ms": 6573.323, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.601693868637085, "vf_loss": 190.54173278808594, "policy_loss": -0.05997377634048462, "cur_lr": 9.999999747378752e-05, "kl": 0.03214564174413681, "entropy": 131.45594787597656, "total_loss": 190.4913787841797}, "num_steps_sampled": 2780000, "load_time_ms": 13.961, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6107211709022522, "vf_loss": 185.3260498046875, "policy_loss": -0.007774170953780413, "cur_lr": 9.999999747378752e-05, "kl": 0.017978601157665253, "entropy": 1.8098485469818115, "total_loss": 185.3183135986328}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2800000, "time_since_restore": 2515.097066640854, "episode_len_mean": 499.57, "date": "2018-12-10_05-27-20", "done": false, "time_this_iter_s": 17.586153030395508, "episode_reward_max": 0.0, "iterations_since_restore": 140, "episodes_total": 6316, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -131.16411972436623, "av": 131.16411972436623}, "timestamp": 1544419640, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 140, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ba080>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2800000, "time_total_s": 2515.097066640854, "custom_metrics": {}, "info": {"sample_time_ms": 11061.382, "num_steps_trained": 2800000, "update_time_ms": 6.393, "grad_time_ms": 6548.821, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6637758016586304, "vf_loss": 184.41310119628906, "policy_loss": -0.0600474551320076, "cur_lr": 9.999999747378752e-05, "kl": 0.03285843878984451, "entropy": 131.47267150878906, "total_loss": 184.36289978027344}, "num_steps_sampled": 2800000, "load_time_ms": 14.227, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6757527589797974, "vf_loss": 179.34886169433594, "policy_loss": -0.007467794232070446, "cur_lr": 9.999999747378752e-05, "kl": 0.017857443541288376, "entropy": 1.8382271528244019, "total_loss": 179.34141540527344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2820000, "time_since_restore": 2532.7875566482544, "episode_len_mean": 499.57, "date": "2018-12-10_05-27-38", "done": false, "time_this_iter_s": 17.690490007400513, "episode_reward_max": 0.0, "iterations_since_restore": 141, "episodes_total": 6362, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.79695389258143, "av": 129.79695389258143}, "timestamp": 1544419658, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 141, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148c88>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2820000, "time_total_s": 2532.7875566482544, "custom_metrics": {}, "info": {"sample_time_ms": 11088.763, "num_steps_trained": 2820000, "update_time_ms": 6.435, "grad_time_ms": 6536.997, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6405653357505798, "vf_loss": 181.49815368652344, "policy_loss": -0.05961475521326065, "cur_lr": 9.999999747378752e-05, "kl": 0.033018648624420166, "entropy": 131.29928588867188, "total_loss": 181.4484405517578}, "num_steps_sampled": 2820000, "load_time_ms": 13.94, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6458029747009277, "vf_loss": 176.73207092285156, "policy_loss": -0.009735495783388615, "cur_lr": 9.999999747378752e-05, "kl": 0.021264169365167618, "entropy": 1.7888453006744385, "total_loss": 176.7223663330078}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2840000, "time_since_restore": 2550.3411753177643, "episode_len_mean": 498.13, "date": "2018-12-10_05-27-55", "done": false, "time_this_iter_s": 17.553618669509888, "episode_reward_max": 0.0, "iterations_since_restore": 142, "episodes_total": 6404, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -127.99274028352947, "av": 127.99274028352947}, "timestamp": 1544419675, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 142, "pid": 2451, "episodes_this_iter": 42, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641485c0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2840000, "time_total_s": 2550.3411753177643, "custom_metrics": {}, "info": {"sample_time_ms": 11070.751, "num_steps_trained": 2840000, "update_time_ms": 6.497, "grad_time_ms": 6526.757, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5971432328224182, "vf_loss": 176.77389526367188, "policy_loss": -0.061284322291612625, "cur_lr": 9.999999747378752e-05, "kl": 0.034363020211458206, "entropy": 131.2672119140625, "total_loss": 176.72293090820312}, "num_steps_sampled": 2840000, "load_time_ms": 13.969, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6054691672325134, "vf_loss": 171.67958068847656, "policy_loss": -0.008494826033711433, "cur_lr": 9.999999747378752e-05, "kl": 0.01843300834298134, "entropy": 1.8164844512939453, "total_loss": 171.6710968017578}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2860000, "time_since_restore": 2568.243751525879, "episode_len_mean": 498.13, "date": "2018-12-10_05-28-13", "done": false, "time_this_iter_s": 17.902576208114624, "episode_reward_max": 0.0, "iterations_since_restore": 143, "episodes_total": 6450, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -130.8147615310952, "av": 130.8147615310952}, "timestamp": 1544419693, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 143, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799bacc0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2860000, "time_total_s": 2568.243751525879, "custom_metrics": {}, "info": {"sample_time_ms": 11121.326, "num_steps_trained": 2860000, "update_time_ms": 6.514, "grad_time_ms": 6521.178, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5816324949264526, "vf_loss": 189.878662109375, "policy_loss": -0.056878797709941864, "cur_lr": 9.999999747378752e-05, "kl": 0.030916571617126465, "entropy": 131.2744140625, "total_loss": 189.83102416992188}, "num_steps_sampled": 2860000, "load_time_ms": 13.756, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5915412306785583, "vf_loss": 185.56993103027344, "policy_loss": -0.006902055814862251, "cur_lr": 9.999999747378752e-05, "kl": 0.021904291585087776, "entropy": 1.7852243185043335, "total_loss": 185.5630645751953}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2880000, "time_since_restore": 2586.3544948101044, "episode_len_mean": 497.45, "date": "2018-12-10_05-28-31", "done": false, "time_this_iter_s": 18.110743284225464, "episode_reward_max": 0.0, "iterations_since_restore": 144, "episodes_total": 6494, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -129.82074140001353, "av": 129.82074140001353}, "timestamp": 1544419711, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 144, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f536416cb00>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2880000, "time_total_s": 2586.3544948101044, "custom_metrics": {}, "info": {"sample_time_ms": 11145.367, "num_steps_trained": 2880000, "update_time_ms": 6.528, "grad_time_ms": 6532.898, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6584463119506836, "vf_loss": 184.2821044921875, "policy_loss": -0.06417160481214523, "cur_lr": 9.999999747378752e-05, "kl": 0.034638479351997375, "entropy": 131.3537139892578, "total_loss": 184.2283172607422}, "num_steps_sampled": 2880000, "load_time_ms": 13.493, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6638222932815552, "vf_loss": 178.80020141601562, "policy_loss": -0.007200258783996105, "cur_lr": 9.999999747378752e-05, "kl": 0.021096281707286835, "entropy": 1.8712987899780273, "total_loss": 178.7930145263672}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2900000, "time_since_restore": 2604.170725107193, "episode_len_mean": 497.45, "date": "2018-12-10_05-28-49", "done": false, "time_this_iter_s": 17.816230297088623, "episode_reward_max": 0.0, "iterations_since_restore": 145, "episodes_total": 6538, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -128.08402997833377, "av": 128.08402997833377}, "timestamp": 1544419729, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 145, "pid": 2451, "episodes_this_iter": 44, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364168860>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2900000, "time_total_s": 2604.170725107193, "custom_metrics": {}, "info": {"sample_time_ms": 11160.304, "num_steps_trained": 2900000, "update_time_ms": 6.431, "grad_time_ms": 6529.042, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.691836416721344, "vf_loss": 173.46713256835938, "policy_loss": -0.05957624316215515, "cur_lr": 9.999999747378752e-05, "kl": 0.0335838608443737, "entropy": 131.2913360595703, "total_loss": 173.41761779785156}, "num_steps_sampled": 2900000, "load_time_ms": 13.555, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6981382966041565, "vf_loss": 168.8943328857422, "policy_loss": -0.008557651191949844, "cur_lr": 9.999999747378752e-05, "kl": 0.019549861550331116, "entropy": 1.86142098903656, "total_loss": 168.8858184814453}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2920000, "time_since_restore": 2621.910688638687, "episode_len_mean": 497.75, "date": "2018-12-10_05-29-07", "done": false, "time_this_iter_s": 17.73996353149414, "episode_reward_max": 0.0, "iterations_since_restore": 146, "episodes_total": 6581, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -123.94622425209764, "av": 123.94622425209764}, "timestamp": 1544419747, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 146, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799babe0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2920000, "time_total_s": 2621.910688638687, "custom_metrics": {}, "info": {"sample_time_ms": 11174.753, "num_steps_trained": 2920000, "update_time_ms": 6.435, "grad_time_ms": 6533.247, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6823285222053528, "vf_loss": 178.1710662841797, "policy_loss": -0.06175227090716362, "cur_lr": 9.999999747378752e-05, "kl": 0.03415869548916817, "entropy": 131.2052001953125, "total_loss": 178.11956787109375}, "num_steps_sampled": 2920000, "load_time_ms": 13.324, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6938018798828125, "vf_loss": 174.4698028564453, "policy_loss": -0.00889610592275858, "cur_lr": 9.999999747378752e-05, "kl": 0.020377788692712784, "entropy": 1.8484128713607788, "total_loss": 174.46095275878906}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2940000, "time_since_restore": 2639.9287116527557, "episode_len_mean": 497.35, "date": "2018-12-10_05-29-25", "done": false, "time_this_iter_s": 18.018023014068604, "episode_reward_max": 0.0, "iterations_since_restore": 147, "episodes_total": 6627, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -125.99532108094532, "av": 125.99532108094532}, "timestamp": 1544419765, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 147, "pid": 2451, "episodes_this_iter": 46, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799baf60>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2940000, "time_total_s": 2639.9287116527557, "custom_metrics": {}, "info": {"sample_time_ms": 11182.756, "num_steps_trained": 2940000, "update_time_ms": 6.433, "grad_time_ms": 6540.466, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.632773756980896, "vf_loss": 191.53192138671875, "policy_loss": -0.06123274937272072, "cur_lr": 9.999999747378752e-05, "kl": 0.033545639365911484, "entropy": 131.1759033203125, "total_loss": 191.48074340820312}, "num_steps_sampled": 2940000, "load_time_ms": 13.355, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6257854104042053, "vf_loss": 189.2808380126953, "policy_loss": -0.007172656245529652, "cur_lr": 9.999999747378752e-05, "kl": 0.017976073548197746, "entropy": 1.8089544773101807, "total_loss": 189.27371215820312}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2960000, "time_since_restore": 2657.2089002132416, "episode_len_mean": 499.6, "date": "2018-12-10_05-29-42", "done": false, "time_this_iter_s": 17.28018856048584, "episode_reward_max": 0.0, "iterations_since_restore": 148, "episodes_total": 6668, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -132.27958012969177, "av": 132.27958012969177}, "timestamp": 1544419782, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 148, "pid": 2451, "episodes_this_iter": 41, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53799ba550>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2960000, "time_total_s": 2657.2089002132416, "custom_metrics": {}, "info": {"sample_time_ms": 11155.174, "num_steps_trained": 2960000, "update_time_ms": 6.469, "grad_time_ms": 6524.857, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.5527830123901367, "vf_loss": 182.5406036376953, "policy_loss": -0.05974598601460457, "cur_lr": 9.999999747378752e-05, "kl": 0.03295755386352539, "entropy": 131.1049041748047, "total_loss": 182.49073791503906}, "num_steps_sampled": 2960000, "load_time_ms": 13.462, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.5474361181259155, "vf_loss": 182.0646514892578, "policy_loss": -0.005989877972751856, "cur_lr": 9.999999747378752e-05, "kl": 0.01856333762407303, "entropy": 1.8058630228042603, "total_loss": 182.05870056152344}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 2980000, "time_since_restore": 2675.331793308258, "episode_len_mean": 499.6, "date": "2018-12-10_05-30-00", "done": false, "time_this_iter_s": 18.12289309501648, "episode_reward_max": 0.0, "iterations_since_restore": 149, "episodes_total": 6715, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -132.14964750329892, "av": 132.14964750329892}, "timestamp": 1544419800, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 149, "pid": 2451, "episodes_this_iter": 47, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f53641e2400>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 2980000, "time_total_s": 2675.331793308258, "custom_metrics": {}, "info": {"sample_time_ms": 11189.865, "num_steps_trained": 2980000, "update_time_ms": 6.426, "grad_time_ms": 6523.508, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6266557574272156, "vf_loss": 189.53282165527344, "policy_loss": -0.06217231601476669, "cur_lr": 9.999999747378752e-05, "kl": 0.034042246639728546, "entropy": 131.1320343017578, "total_loss": 189.48086547851562}, "num_steps_sampled": 2980000, "load_time_ms": 13.291, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6150910258293152, "vf_loss": 187.22044372558594, "policy_loss": -0.006943097338080406, "cur_lr": 9.999999747378752e-05, "kl": 0.018787525594234467, "entropy": 1.8069608211517334, "total_loss": 187.2135467529297}}}
{"episode_reward_min": 0.0, "node_ip": "172.31.19.140", "timesteps_since_restore": 3000000, "time_since_restore": 2692.927057504654, "episode_len_mean": 500.0, "date": "2018-12-10_05-30-18", "done": true, "time_this_iter_s": 17.595264196395874, "episode_reward_max": 0.0, "iterations_since_restore": 150, "episodes_total": 6758, "hostname": "ip-172-31-19-140", "policy_reward_mean": {"adversary": -133.52090038822104, "av": 133.52090038822104}, "timestamp": 1544419818, "experiment_id": "00efc8fe52274346890eff72e266d70e", "num_metric_batches_dropped": 0, "training_iteration": 150, "pid": 2451, "episodes_this_iter": 43, "episode_reward_mean": 0.0, "config": {"lambda": 0.97, "use_gae": true, "batch_mode": "truncate_episodes", "compress_observations": false, "multiagent": {"policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7f5364148fd0>", "policies_to_train": null, "policy_graphs": {"adversary": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(96,)", {}], "av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(94,)", "Box(2,)", {}]}}, "num_workers": 10, "num_envs_per_worker": 1, "model": {"fcnet_activation": "tanh", "custom_preprocessor": null, "custom_options": {}, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "lstm_cell_size": 256, "custom_model": null, "use_lstm": false, "framestack": true, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "channel_major": false, "conv_filters": null, "free_log_std": false}, "collect_metrics_timeout": 180, "optimizer": {}, "num_cpus_per_worker": 1, "observation_filter": "NoFilter", "lr": 0.0001, "sample_async": false, "sample_batch_size": 200, "entropy_coeff": 0.0, "gamma": 0.999, "kl_coeff": 0.2, "clip_rewards": null, "sgd_minibatch_size": 128, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "preprocessor_pref": "deepmind", "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2}, "num_gpus_per_worker": 0, "clip_actions": false, "custom_resources_per_worker": {}, "monitor": false, "vf_loss_coeff": 1.0, "log_level": "INFO", "train_batch_size": 20000, "kl_target": 0.02, "num_sgd_iter": 10, "vf_clip_param": 10.0, "num_gpus": 0, "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_train_result": null, "on_sample_end": null, "on_episode_end": null}, "env": "MultiAgentUDSSCMergeEnvReset-v0", "synchronize_filters": true, "simple_optimizer": false, "clip_param": 0.3, "num_cpus_for_driver": 1, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"adv_state_weight\": 0.03,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"n_following\": 1,\n            \"n_merging_in\": 6,\n            \"n_preceding\": 1,\n            \"range_inflow_0\": [\n                1,\n                4\n            ],\n            \"range_inflow_1\": [\n                1,\n                7\n            ],\n            \"target_velocity\": 8\n        },\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"sort_vehicles\": false,\n        \"starting_position_shuffle\": false,\n        \"vehicle_arrangement_shuffle\": false,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiAgentUDSSCMergeEnvReset\",\n    \"exp_tag\": \"ma_12\",\n    \"generator\": \"UDSSCMergingGenerator\",\n    \"initial\": {\n        \"additional_params\": {\n            \"merge_bunching\": 0\n        },\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"custom\",\n        \"x0\": 50\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 55,\n            \"lane_num\": 1,\n            \"merge_length\": 15,\n            \"outer_lanes\": 1,\n            \"outside_speed_limit\": 8,\n            \"resolution\": 100,\n            \"ring_radius\": 15,\n            \"roundabout_speed_limit\": 8\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_0\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_1\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_2\",\n                    \"route\": \"routeinflow_0\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"rl_3\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_4\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_5\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                },\n                {\n                    \"begin\": 1,\n                    \"end\": 2000000.0,\n                    \"name\": \"idm_6\",\n                    \"route\": \"routeinflow_1\",\n                    \"vehsPerHour\": 50,\n                    \"vtype\": \"idm\"\n                }\n            ],\n            \"num_flows\": 7\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"UDSSCMergingScenario\",\n    \"sumo\": {\n        \"ballistic\": false,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.1\n                }\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 31,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SumoLaneChangeController\",\n                {}\n            ],\n            \"lane_change_mode\": 0,\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"speed_mode\": 1,\n            \"sumo_car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.05,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.1\n                }\n            },\n            \"sumo_lc_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                }\n            },\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "horizon": 500, "vf_share_layers": false}, "timesteps_this_iter": 20000, "timesteps_total": 3000000, "time_total_s": 2692.927057504654, "custom_metrics": {}, "info": {"sample_time_ms": 11181.553, "num_steps_trained": 3000000, "update_time_ms": 6.49, "grad_time_ms": 6532.722, "adversary": {"cur_kl_coeff": 0.29999998211860657, "vf_explained_var": 0.6739557981491089, "vf_loss": 184.1355743408203, "policy_loss": -0.061893004924058914, "cur_lr": 9.999999747378752e-05, "kl": 0.03324452415108681, "entropy": 131.093017578125, "total_loss": 184.08363342285156}, "num_steps_sampled": 3000000, "load_time_ms": 13.356, "av": {"cur_kl_coeff": 0.0015625003725290298, "vf_explained_var": 0.6655594110488892, "vf_loss": 182.4053497314453, "policy_loss": -0.00700119836255908, "cur_lr": 9.999999747378752e-05, "kl": 0.018574943765997887, "entropy": 1.821089506149292, "total_loss": 182.3983612060547}}}
